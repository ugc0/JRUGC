//This program is only known to UGC and can only be modified or optimized by him.
//If you still want to try, please increment the following counter as a warning for the next person when you fail:

#define TOTAL_HOURS_WASTED_HERE 42

//Thank you :)

#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
#include <string.h>
#include <windows.h>
#include <winuser.h>
#include <wingdi.h>
#include <CommCtrl.h>
#include <stdbool.h>
#include <time.h>
#include <math.h>
#include <errno.h>
#include <tchar.h>
#include <vlc/vlc.h>
#include "jrugc.h"

//Margin when retrying
#define RETRY_MARGIN 105

//Mean size of a message
#define MEAN_MESSAGE_LENGTH 322

//Limit for linked balise distance offset correction (m)
#define Linked_Balise_Offset_Correction_Limit 50

//Special value when the linking distance cannot be computed
#define INTER_BALISE_DISTANCE_UNKNOWN 9999999

//Size of the buffer to read the entire file
#define Master_Bluffer_Size 579600000
//Size of the buffer to store the path name
#define Path_Buffer_Size 1000
//Size of the buffer to store the message
#define Message_Buffer_Size 700
//Size of the buffer to store window texts
#define Window_Buffer_Size 10000
//Size of the buffer to store ASV locations
#define ASV_Buffer_Size 7200
//Size of the buffer to store search strings
#define Search_Buffer_Size 50
//Size of the buffer to store the command to open the CSV file
#define CSV_Command_Buffer_Size 50000
//Mean number of messages for storage
#define Mean_Message_Number_Count 1800000
//Mean number of details for storage
#define Mean_Details_Number 39600000
//Number of balise group
#define Max_Balise_Count 50000
//Separator size
#define Separator_Size 500
//Inter Balise Distance Count
#define Max_Inter_Balise_Distances 100000
//Max number of log per file
#define Max_Log_Per_File 100
#define P_PT_string_length 32
//Username string length
#define Username_string_length 8

//Code for continuous left click
#define IS_STILL_DOWN_MESSAGE 9987
//Code for Sequence update
#define SEQUENCE_UPDATE_MESSAGE 9988
//Code for GAME tracking on run_media mode
#define GAME_CONTINUOUS_MESSAGE 9989
//Code for VLC tracking on run_media mode
#define VLC_CONTINUOUS_MESSAGE 9990
//Code for mouse move message
#define MOUSE_MOVE_MESSAGE 9991
//Code for programatically triggered search procedure without parameters
#define SEARCH_TRGR_MESSAGE 9992
//Code for programatically triggered balise search procedure
#define BALISE_SEARCH_RQST 9993
//Code for quitting the program
#define MAIN_QUIT_RQST 9994
//Code for programatically triggered speed search procedure
#define START_STOP_SEARCH_RQST 9995
//Code for programatically triggered day search procedure
#define DAY_SEARCH_RQST 9996
//Code for programatically triggered search procedure with parameters
#define SEARCH_RQST_MESSAGE 9997
//Code for clicked button message
#define BTN_CLICKED_MESSAGE 9998
//Code for selection changed message
#define SEL_CHANGE_MESSAGE 9999

//File types definitions
#define FILE_TYPE_JRU 99
#define FILE_TYPE_JRUFORCE 98
#define FILE_TYPE_JRUBL3 97
#define FILE_TYPE_JRUZIP 96
#define FILE_TYPE_JRUTBF 95
#define FILE_TYPE_BRUSOLO 94

//Number of detail offset
#define max_details_offset 21
//Number of generic detail offset
#define max_generic_details_offset 9
//Offset code for id detail
#define id_detail_offset 21
//Offset code for year detail
#define year_detail_offset 20
//Offset code for mon detail
#define mon_detail_offset 19
//Offset code for day detail
#define day_detail_offset 18
//Offset code for d_lrbg detail
#define d_lrbg_detail_offset 17
//Offset code for speed detail
#define speed_detail_offset 16
//Offset code for train detail
#define train_detail_offset 15
//Offset code for level detail
#define level_detail_offset 14
//Offset code for mode detail
#define mode_detail_offset 13
//Offset code for last balise detail
#define last_balise_offset 12
//Offset code for last nid_c detail
#define last_nid_c_offset 11
//Offset code for last balise direction
#define last_balise_direction_offset 10
//Offset for balise storage index
#define balise_storage_index 9
//Offset for last valid linking packet
#define last_valid_linking_offset 8
//Offset for last valid linking distance
#define last_valid_linking_distance_offset 7
//Offset for line information
#define line_information_offset 6
//Offset for message index
#define message_index_offset 5
//Offset for MA
#define MA_offset 4
//Offset MA_index
#define MA_index_offset 3
//Offset for Inter-Balise distances
#define Inter_Balise_Offset 2
//Offset for version details
#define version_detail_offset 1

#define Max_Number_Of_Train_Visual 11
#define Max_Number_Of_Balise_Visual 12

#define Max_Number_Of_Linked_Balise 50

#define Max_Number_Of_Retroactive_Balise 300
#define retroactive_linking_display_distance 500

#define LOG_INFO 0
#define LOG_SUCCESS 1
#define LOG_WARNING 2
#define LOG_ERROR 3

#define BALISE_DECISION_UNKNOWN 0
#define BALISE_UNEXPECTED 1
#define BALISE_GRANTED_EXPECTED 2
#define BALISE_GRANTED_VOID 3
#define BALISE_GRANTED_UNLINKED 4

#define MAX_DISTANCE_MA 50000

#define line_info_L1 -1
#define line_info_B -2
#define line_info_LGV_EST -3

#define ASV_location_size 116

#define ASVO_Main_offset 5
#define ASVO_Iter_index 9
#define ASVO_Iter_offset 13


#define ASVO_Final_offset 105
#define ASVO_Factor 113

#define MAX_ASV_SEARCH 99999999

#define game_rows 8
#define game_columns 50
#define game_part_void 0
#define game_part_track 1
#define game_part_malus 2
#define game_part_bonus 3
#define game_part_train -1

#define ROLE_NULL 4
#define ROLE_DEMO 3
#define ROLE_ALL 2
#define ROLE_GOD 1

#define linking_data_delimiter 100000000

bool has_been_resized = false;

unsigned long long retry;

float x_scale;
float y_scale;

FILE* log_file;
int original_x_resolution;
int original_y_resolution;

int executable_path_length;
bool is_zipped;

unsigned long long SDTRACK_ZOOM;

unsigned long long tick_0;

unsigned long long sdtrack_left, sdtrack_right;

char Soft_Title[100];
char Complete_Soft_Title[1000];

int Vtrack_Balise_Position (int balise);

int game_train_pos_x;
int game_train_pos_y;
int game_train_pos_offset;
int game_panorama_offset;
int game_train_speed;
RECT game_train_pos;
RECT game_dashboard;
HDC game_DC;
HDC game_track_dc;
HDC game_bonus_dc;
HDC game_malus_dc;
HDC game_panorama_dc;
HDC game_speedometer_dc;
HDC game_odometer_dc;
int game_distance;
bool game_paused;

char* Path_Buffer;
char* Remanent_Path_Buffer;
char* Filename_Buffer;
char* Master_Bluffer;
char* Hexdec_Buffer;
char* Message_Buffer;
char* Current_Message_Buffer;
char* Current_Search_Buffer;
char* Current_Packet_Buffer;
char* Details_Buffer;
char* Details_Bindec_Buffer;
char* Details_Data_Buffer;
char* Window_Buffer;
char* Iterations_Buffer;
char* Separator_Buffer;
char* Error_Buffer;
char* ASV_Buffer;
char* executable_path_buffer;
char* current_file_buffer;
bool control;
bool shift;
bool display_tooltip=false;
FILE* BIN_File;
FILE* LBG_File;
FILE* CSV_File;
FILE* SL1_File;
FILE* SL2_File;
FILE* BL3_File;

FILE* SETTINGS_FILE;

char* LBG_Command_Buffer;
char* CSV_Command_Buffer;
char* SL1_Command_Buffer;
char* SL2_Command_Buffer;
char* command_buffer;

int path_length;
long long file_length;
long long General_Position;
int treated=0;
long long Message_Position=0;
int header_position=0;
int Details_Position,Details_End_Point,Temporary_Details_Position;
int End_Details_Position;
int Reference_Message=-1;
int nid_bg,next_nid_bg;
int d_lrbg,next_d_lrbg;
int q_dlrbg;
unsigned long long Time_Storage[Mean_Message_Number_Count];
unsigned long long Distance_Storage[Mean_Message_Number_Count];
int Message_Details_Storage[Mean_Details_Number];
int Balise_Storage[Max_Balise_Count];
int Balise_Details_Position_72[Max_Balise_Count];
int Balise_Details_Position_79[Max_Balise_Count];
int Balise_X_Storage[49];
int Balise_Y_Storage[49];
int Linked_Balise_Storage[Max_Number_Of_Linked_Balise];
int New_Linked_Balise_Storage[Max_Number_Of_Linked_Balise];
int Linked_Balise_Count = 0;
int New_Linked_Balise_Count = 0;
int Linked_Balise_Seen = 0;
int Linked_Balise_NidC = 0;
int ignore_linking = -1;
int last_valid_linking;
int last_valid_linking_distance;
bool start_on_board_linking;
int linking_switcher;
int new_linking_application_bg;
int new_linking_reference;
int new_linked_balise_seen;
int first_confidence_balise_index;
int retroactive_d_lrbg;
int nid_c;
int line_info = -1;
int line_info_number = 0;
int* Inter_Balise_Distance;
int Inter_Balise_Distance_Count;

int game_setup[game_rows][game_columns];

int balise_decision;

int m_level;
int m_mode;
int MA_Speed=-1;
int MA_Distance=-1;
int MA_bg=-1;
int last_MA=-1;

unsigned long long encode_skip;

unsigned long long Current_Distance;

int MessageWindow_Tabs[12]={120,352,412,490,568,705,785,860,935,1000,1080,1250};
int DetailsWindow_Tabs[2]={150,550};
int LinkingWindow_Tabs[1]={55};
int MAWindow_Tabs[1]={70};
int BaliseListWindow_Tabs[4]={40,100,205,265};
int TrainListWindow_Tabs[1]={40};
int SequenceWindow_Tabs[3]={30,100,600};
int SequenceWindow_Tabs_details[2]={120,2500};
int FolderViewWindow_Tabs[2]={30,700};

int n_iter_i=0,n_iter_j=0;
int DetailsWindow_Switcher = 1;
bool DetailsWindow_Switcher_Switcher=false;
int Last_Message=0,Balise_Count;

int packet_offset;

unsigned long long distance;
unsigned long long delta_distance;

bool balise_direction,paint_balise_direction;
int id,message_index,log_count=0;

bool isMessageWindowMaximized=false,isHeadersWindowMaximized=false,isDetailsWindowMaximized=false,isWindowMaximized=false,isBinaryFile,isBL3,isVelaro = false;

bool isPhilippeBirthday=false;
bool VTrack_display=false;
int VTrack_origin,VTrack_origin_bis,VTrack_selected_train_index=1;
int balise_count;

bool unknown_file;
int unknown_vehicle;

int file_log_count;

bool isCSVdone;

int ROLE = ROLE_NULL;

int target_window_index;
bool CSVSequence1_is_done;
bool CSVSequence2_is_done;
int stm_detail = -1;

bool valid_data;
bool truncated_data;

unsigned long long is_still_down = 0;

int ASV_Search_Index = -1,ASV_increment = 0,init_offset,ASV_Stored_Value,ASV_Clustered_inter,ASV_Clustered_offset;

WIN32_FIND_DATA data;
HANDLE hFind;

HWND MainWindow,MessageWindow,ProgressBarWindow,QuitButtonWindow,TimeWindow,DistanceWindow,SpeedWindow,SetButtonWindow,GoToButtonWindow,ClearButtonWindow,HeadersWindow,DetailsWindow,MessageSearchWindow,DateSearchWindow,DateSearchWindow,TrainSearchWindow,BaliseSearchWindow,LinkedBaliseSearchWindow,PacketSearchWindow,RadioSearchWindow,SpeedSearchWindow,LevelSearchWindow,ModeSearchWindow,MessageSearchWindowChild,LevelSearchWindowChild,ModeSearchWindowChild,LineWindow,SearchProgressWindow,DecodeButtonWindow,MainFolderWindow,FolderEditWindow,FolderRefreshWindow,FolderOkWindow,FolderBackWindow,FolderCancelWindow,FolderViewWindow,VehicleWindow,SearchButtonWindow,SearchResetWindow,PreviousDaySearchWindow,NextDaySearchWindow,PreviousStartStopSearchWidow,NextStartStopSearchWindow,VTRACKWindow,VTRACKButtonWindow,VTRACKListWindow,MediaWindow_1,MediaWindow_2,MediaSelectionWindow,MediaButtonWindow,MediaListWindow,MediaStartWindow,PlayButtonWindow,StopButtonWindow,MediaInfoWindow,MediaOkWindow,MainHelpWindow,LogListWindow,CenterButtonWindow,PacketListWindow_1,PacketListWindow_2,MessageListWindow_1,MessageListWindow_2,LogListButtonWindow,PacketListButtonWindow_1,PacketListButtonWindow_2,MessageListButtonWindow_1,MessageListButtonWindow_2,HelpButtonWindow,EnlargeMessageWindowButton,EnlargeHeadersWindowButton,EnlargeDetailsWindowButton,ResetButtonWindow,BaliseListButtonWindow,MainBaliseListWindow,BaliseListWindow,LinkingWindow,BaliseListExportButtonWindow,BaliseListExportProgressWindow,BaliseListOpenCSVButtonWindow,CSVListExportButtonWindow,CSVListSettingsButtonWindow,CSVListExportProgressWindow,CSVListOpenCSVButtonWindow,Toggle1Window,Toggle2Window,Toggle3Window,Toggle5Window,Toggle6Window,Toggle9Window,Toggle10Window,Toggle11Window,Toggle12Window,Toggle15Window,Toggle197Window,Toggle198Window,Toggle199Window,Toggle200Window,TrainListButtonWindow,MainTrainListWindow,TrainListWindow,TrackInformationWindow,MAWindow,SequenceWindow,SequencingButtonWindow,SequencingStartButtonWindow1,SequenceListWindow1,SequencingCSVExportWindow1,SequencingStartButtonWindow2,SequenceListWindow2,SequencingCSVExportWindow2,ExpandAllButton1,ExpandAllButton2,CollapseAllButton1,CollapseAllButton2,SequenceExportButtonWindow1,SequenceExportProgressWindow1,SequenceOpenCSVButtonWindow1,SequenceExportButtonWindow2,SequenceExportProgressWindow2,SequenceOpenCSVButtonWindow2,AdvancedSearchNameWindow,AdvancedSearchValueWindow,ClearAllButtonWindow,SpeedProfileButtonWindow,SpeedProfileWindow,MessageButtonWindow,GameWindow,TTXWindow,TTXButtonWindow,ReportButtonWindow,ReportWindow,SendReportButtonWindow,SearchCommuteWindow,NightModeWindow,MainCSVSettingsWindow,CSVSettingsList1Window,CSVSettingsList2Window,CSVSettingsLeftOnceButtonWindow,CSVSettingsRightOnceButtonWindow,CSVSettingsLeftAllButtonWindow,CSVSettingsRightAllButtonWindow,CSVSettingsSwitchPacketOptionButtonWindow,CSVSettingsTextBox,LastFileButtonWindow,ValidDataWindow,MainBufferSaturationBar,MessageSaturationBar,DetailsSaturationBar,DebugButtonWindow,ColorChartButtonWindow,ColorChartMainWindow,TooltipWindow;
HFONT Main_Font,Medium_Font;
HBRUSH Emerald_Brush,Sky_Brush,Lemon_Brush,Light_Pink_Brush,Brown_Brush,Main_Brush,Gray_Brush,Orange_Edit_Brush,Green_Edit_Brush,Purple_Edit_Brush,Purple_Brush,Pink_Brush,Lime_Brush,Blue_Brush,Cyan_Brush,Green_Brush,Red_Brush,Black_Brush,Azure_Brush,Dark_Gray_Brush,White_Brush,Orange_Brush,Peach_Brush,Neon_Green_Brush,Gold_Brush,Dark_Green_Brush,Medium_Gray_Brush,Yellow_Map_Brush;

HBITMAP PURPLEBMP,PINKBMP,LIMEBMP,BLUEBMP,CYANBMP,GREENBMP,PEACHBMP,REDBMP,BROWNBMP,LEMONBMP,LIGHTPINKBMP,SKYBMP,EMERALDBMP,BLACKBMP,JRUICON,JRUZIPICON,FOLDERICON,FILEICON,BALISE_ACCEPTED,BALISE_REJECTED,BALISE_NC,MEDIA_OK_BUTTON,REFRESH_BUTTON,OK_BUTTON,CANCEL_BUTTON,BACK_BUTTON,ENLARGE_BUTTON,HELP_BUTTON,LOG_BUTTON,PACKET_BUTTON_1,PACKET_BUTTON_2,MESSAGE_BUTTON_1,MESSAGE_BUTTON_2,EXCEL,MEDIA_RESET_BUTTON,CENTER_BUTTON,MEDIA_RESET_BUTTON,CSV_BUTTON,EXCEL_SETTINGS_BUTTON,PREVIOUS_DAY_BUTTON,NEXT_DAY_BUTTON,NEXT_START_STOP_BUTTON,PREVIOUS_START_STOP_BUTTON,QUIT_BUTTON,CLEARALL_BUTTON,RESET_BUTTON,SET_BUTTON,GOTO_BUTTON,CLEAR_BUTTON,SEQUENCING_BUTTON,FILE_BUTTON,FILE_EXCEL_BUTTON,SEARCH_BUTTON,PLAY_BUTTON,STOP_BUTTON,MEDIA_BUTTON,VTRACK_BUTTON,SPEED_PROFILE_BUTTON,MESSAGE_BUTTON,TRAIN_LIST_BUTTON,BALISE_LIST_BUTTON,MESSAGE_HEADER,PHONE,TRACK,TRONCON,NOTYETVISUAL,NOVISUAL,CYAN_INACTIVE_BALISE_R,CYAN_INACTIVE_BALISE_L,CYAN_ACTIVE_BALISE_R,CYAN_ACTIVE_BALISE_L,INACTIVE_BALISE_R,INACTIVE_BALISE_L,ACTIVE_BALISE_R,ACTIVE_BALISE_L,THALYS,THALYS_R,EUROSTAR,EUROSTAR_R,ICE,ICE_R,IZY,IZY_R,OUIGO,OUIGO_R,DUPLEX,DUPLEX_R,TGV,TGV_R,ITALO,ITALO_R,TRAINDB,TRAINDB_R,TRAINSNCB,TRAINSNCB_R,TRAINNS,TRAINNS_R,SELECTED_TRAIN,SELECTED_TRAIN_R,SPEEDOMETER,DISTANCE_BMP,SEQUENCE_START_BUTTON,COLLAPSE_BUTTON,EXPAND_BUTTON,SL_OPEN_BUTTON,LE01,LE02,LE03,LE04,LE05,LE06,LE07,LE08,LE09,LE10,LE11,LE12,LE13,LE14,LE15,MO01,MO02,MO03,MO04,MO05,MO06,MO07,MO08,MO09,MO10,MO11,MO12,MO13,MO14,MO15,MO16,MO17,MO18,MO19,MO20,MO21,MO22,ST01,ST02,ST03,ST04,ST05,ST06,TC01,TC02,TC03,TC04,TC05,TC06,TC07,TC08,TC09,TC10,TC11,TC12,TC13,TC14,TC15,TC16,TC17,TC18,TC19,TC20,TC21,TC22,TC23,TC24,TC25,TC26,TC27,TC28,TC29,TC30,TC31,TC32,TC33,TC34,TC35,TC36,TC37,DR01,DR02,DR03,DR04,DR05,LX01,LS01,SD_BACKGROUND,GAME_PART_TRACK,GAME_PART_MALUS,GAME_PART_BONUS,PANORAMA,GAME_SPEEDOMETER_40,GAME_SPEEDOMETER_60,GAME_SPEEDOMETER_80,GAME_SPEEDOMETER_100,GAME_SPEEDOMETER_120,GAME_SPEEDOMETER_140,GAME_SPEEDOMETER_160,GAME_SPEEDOMETER_180,GAME_SPEEDOMETER_200,GAME_SPEEDOMETER_220,GAME_SPEEDOMETER_240,GAME_SPEEDOMETER_260,GAME_SPEEDOMETER_280,GAME_SPEEDOMETER_300,GAME_ODOMETER,TTX_OKAY,TTX_BITMAP,TTX_NOK,TTX_NOTYET,TTX_EXPIRED,TTX_MISSING,G_VTRACK_BUTTON,G_HELP_BUTTON,G_BALISE_LIST_BUTTON,G_SEQUENCING_BUTTON,G_TRAIN_LIST_BUTTON,G_MEDIA_BUTTON,G_SPEED_PROFILE_BUTTON,JRUBRUICON,JRUTBFICON,REPORT_BUTTON,SEND_REPORT_BUTTON,SENDING_REPORT_BUTTON,SEND_REPORT_BUTTON_OK,SEND_REPORT_BUTTON_NOK,COMMUTE_BUTTON_TRUE,COMMUTE_BUTTON_FALSE,NIGHT_MODE_TRUE,NIGHT_MODE_FALSE,LEFT_ONCE_BUTTON,RIGHT_ONCE_BUTTON,LEFT_ALL_BUTTON,RIGHT_ALL_BUTTON,PACKET_OPTION_FALSE,PACKET_OPTION_TRUE,LAST_FILE_BUTTON,VALID_DATA_FILE,INVALID_DATA_FILE,NO_DATA_FILE,COLOR_CHART_BUTTON,PALETTE,PARTIAL_VALID_DATA_FILE,PARTIAL_INVALID_DATA_FILE;

STARTUPINFO si;
PROCESS_INFORMATION pi;

HPEN NOMINAL_PEN,ORANGE_PEN,DOTTED_ORANGE_PEN,CYAN_PEN,PURPLE_PEN,RED_PEN,GREEN_PEN,GRAY_PEN,NEW_BLACK_PEN;

const char g_szClassName[] = "myWindowClass";

HCURSOR Hand_Cursor;
HCURSOR Arrow_Cursor;
HCURSOR Beam_Cursor;
BOOL Key_Is_Down = false,Track_Is_Redrawn = true;
COLORREF Emerald,Very_Dark_Gray,Sky,Lemon,Light_Pink,Brown,PURPLE_MAP,RED_MAP,BLUE_MAP,YELLOW_MAP,Light_Purple,Neon_Green,Cyan,Orange_Edit,Main,Dark_Purple,Green_Edit,White,Purple,Pink,Lime,Blue,Cyan,Green,Peach,Red,Black,Black,Gray,Purple,Blue,Green,Peach,Red,Azure,Dark_Gray,Dark_Green,Orange,Dark_Orange,Gray,Purple_Edit,Purple,Blue,Black,Dark_Gray,Gold,Odometer_Cyan,Thalys_Red,Medium_Gray;

libvlc_instance_t *my_vlc_instance_1;
libvlc_instance_t *my_vlc_instance_2;
libvlc_media_t *my_media_file_1;
libvlc_media_t *my_media_file_2;
libvlc_media_player_t *my_player_1;
libvlc_media_player_t *my_player_2;
char VLC_Buffer[Path_Buffer_Size];
unsigned long long media_start_1,media_start_2;
int media_duration_1=0,media_duration_2=0;
bool run_media = false;
SYSTEMTIME sys_time_1 = {0};
SYSTEMTIME sys_time_2 = {0};
struct tm time_start;
int initial_tts_1 = 0,initial_tts_2 = 0;
time_t media_time_t_1,media_time_t_2;

void D_track_to_train_packet(int nid_packet, HWND TargetWindow, bool title, int m_version);
void D_train_to_track_packet(int nid_packet, HWND TargetWindow, bool title, int m_version);
bool SaveBMPFile(char *filename, HBITMAP bitmap, HDC bitmapDC, int width, int height);

bool combinate_search_mode = true;
bool night_mode = true;
bool debug_mode = false;
bool exportpacketexpand;

int last_nid_rbc_version;

char* username_buffer;
char* mobile_buffer;

bool M_MZ = false;

int excel_message_settings[256];

int main_R,main_G,main_B,color_saturation;

int system_call(char* cmd) {
    int result;
    STARTUPINFO si;
    PROCESS_INFORMATION pi;

    ZeroMemory( &si, sizeof(si) );
    si.cb = sizeof(si);
    ZeroMemory( &pi, sizeof(pi) );

    if( !CreateProcess(NULL,cmd,NULL,NULL,FALSE,CREATE_NO_WINDOW,NULL,executable_path_buffer,&si,&pi)) result = 0; else result = 1;

    WaitForSingleObject( pi.hProcess, INFINITE );

    CloseHandle( pi.hProcess );
    CloseHandle( pi.hThread );

    return result;
}

int hex2dec(char* src) {
    int i,l = strlen(src);
    int result=0;
    if (l==0 || l>7) return 0;
    for (i=l-1;i>=0;i--) {
        if (src[i]=='F') result+=15*pow(16,l-1-i);
        else if (src[i]=='E') result+=14*pow(16,l-1-i);
        else if (src[i]=='D') result+=13*pow(16,l-1-i);
        else if (src[i]=='C') result+=12*pow(16,l-1-i);
        else if (src[i]=='B') result+=11*pow(16,l-1-i);
        else if (src[i]=='A') result+=10*pow(16,l-1-i);
        else result+=(src[i]-48)*pow(16,l-1-i);
    }
    return result;
}

int utf8_encode(char* src) {
    int l = strlen(src);
    int i;
    int offset = 0;
    int solution,marker,high,next_1;
    for (i=0;i+offset<l;i++) {
        solution = 0;
        if (i+offset<l) high = src[i+offset]; else high = 0;
        if (high<0) {
            offset++;
            if (i+offset<l) marker = src[i+offset]; else marker = 0;
            if (i+offset+1<l) next_1 = src[i+offset+1]; else next_1 = 0;
            solution = 63;
            if (high==-61) {
                if (marker>=-128 && marker<=-65) solution = marker+320;
            }
            if (high==-62) {
                if (marker>=-95 && marker<=-65) solution = marker+256;
            }
            if (high==-58) {
                if (marker==-110) solution = 131;
            }
            if (high==-59) {
                if (marker==-96) solution = 138;
                if (marker==-110) solution = 140;
                if (marker==-67) solution = 142;
                if (marker==-95) solution = 154;
                if (marker==-109) solution = 156;
                if (marker==-66) solution = 158;
                if (marker==-72) solution = 159;
            }
            if (high==-53) {
                if (marker==-122) solution = 136;
                if (marker==-100) solution = 152;
            }
            if (high==-30) {
                if (marker==-128) {
                    if (next_1==-80) {
                        offset++;
                        solution = 137;
                    }
                    if (next_1==-90) {
                        offset++;
                        solution = 133;
                    }
                    if (next_1==-102) {
                        offset++;
                        solution = 130;
                    }
                    if (next_1==-98) {
                        offset++;
                        solution = 132;
                    }
                    if (next_1==-95) {
                        offset++;
                        solution = 135;
                    }
                    if (next_1==-96) {
                        offset++;
                        solution = 134;
                    }
                    if (next_1==-71) {
                        offset++;
                        solution = 139;
                    }
                    if (next_1==-104) {
                        offset++;
                        solution = 145;
                    }
                    if (next_1==-103) {
                        offset++;
                        solution = 146;
                    }
                    if (next_1==-100) {
                        offset++;
                        solution = 147;
                    }
                    if (next_1==-99) {
                        offset++;
                        solution = 148;
                    }
                    if (next_1==-94) {
                        offset++;
                        solution = 149;
                    }
                    if (next_1==-109) {
                        offset++;
                        solution = 150;
                    }
                    if (next_1==-108) {
                        offset++;
                        solution = 151;
                    }
                    if (next_1==-70) {
                        offset++;
                        solution = 155;
                    }
                }
                if (marker==-126) {
                    if (next_1==-84) {
                        offset++;
                        solution = 128;
                    }
                }
                if (marker==-124) {
                    if (next_1==-94) {
                        offset++;
                        solution = 153;
                    }
                }
            }
        }
        if (solution==0) src[i]=src[i+offset]; else src[i]=solution;
    }
    src[i]='\0';
    return i;
}

int GetFilePointer(HANDLE FileHandle){
	return SetFilePointer(FileHandle, 0, 0, FILE_CURRENT);
}

void empty_message_queue(MSG escape_msg) {
    while((PeekMessage(&escape_msg,MainWindow,16,52429,PM_REMOVE)));
}

void treat_message_queue() {
    MSG escape_msg;
    while((PeekMessage(&escape_msg,MainWindow,0,52429,PM_NOREMOVE))) {
        TranslateMessage(&escape_msg);
        DispatchMessage(&escape_msg);
    }
}

bool is_edit_window(HWND test_window) {
    char dump[200];
    GetClassName(test_window,dump,200);
    if (strstr(dump,"Edit")!=NULL) return true; else return false;
}

void D_nid_engine_for_unknown_vehicle(int nid_engine,HWND TargetWindow);

extern bool SaveBMPFile(char *filename, HBITMAP bitmap, HDC bitmapDC, int width, int height){
    HBITMAP OffscrBmp=NULL;
    HDC OffscrDC=NULL;
    LPBITMAPINFO lpbi=NULL;
    LPVOID lpvBits=NULL;
    HANDLE BmpFile=INVALID_HANDLE_VALUE;
    BITMAPFILEHEADER bmfh;

    DeleteFile(filename);

    if ((OffscrBmp = CreateCompatibleBitmap(bitmapDC, width, height)) == NULL)
        return false;

    if ((OffscrDC = CreateCompatibleDC(bitmapDC)) == NULL)
		return false;

    HBITMAP OldBmp = (HBITMAP)SelectObject(OffscrDC, OffscrBmp);

    BitBlt(OffscrDC, 0, 0, width, height, bitmapDC, 0, 0, SRCCOPY);

    lpbi = (LPBITMAPINFO) malloc((sizeof(BITMAPINFOHEADER) + 256 * sizeof(RGBQUAD))*sizeof(char));

    ZeroMemory(&lpbi->bmiHeader, sizeof(BITMAPINFOHEADER));
    lpbi->bmiHeader.biSize = sizeof(BITMAPINFOHEADER);

    SelectObject(OffscrDC, OldBmp);
    if (!GetDIBits(OffscrDC, OffscrBmp, 0, height, NULL, lpbi, DIB_RGB_COLORS))
        return false;

    lpvBits = malloc(sizeof(char)*lpbi->bmiHeader.biSizeImage);

    if (!GetDIBits(OffscrDC, OffscrBmp, 0, height, lpvBits, lpbi, DIB_RGB_COLORS))
		return false;

    if ((BmpFile = CreateFile(filename,
                              GENERIC_WRITE,
                              0, NULL,
                              CREATE_ALWAYS,
                              FILE_ATTRIBUTE_NORMAL,
                              NULL)) == INVALID_HANDLE_VALUE)

							  return false;

    DWORD Written;

    bmfh.bfType = 19778;
    bmfh.bfReserved1 = bmfh.bfReserved2 = 0;
    if (!WriteFile(BmpFile, &bmfh, sizeof(bmfh), &Written, NULL))
        return false;

    if (Written < sizeof(bmfh))
		return false;

    if (!WriteFile(BmpFile, &lpbi->bmiHeader, sizeof(BITMAPINFOHEADER), &Written, NULL))
		return false;

    if (Written < sizeof(BITMAPINFOHEADER))
			return false;
    int PalEntries;
    if (lpbi->bmiHeader.biCompression == BI_BITFIELDS)
		PalEntries = 3;
    else
        PalEntries = (lpbi->bmiHeader.biBitCount <= 8) ?
            (int)(1 << lpbi->bmiHeader.biBitCount)
        : 0;
    if(lpbi->bmiHeader.biClrUsed)
		PalEntries = lpbi->bmiHeader.biClrUsed;

    if(PalEntries){
        if (!WriteFile(BmpFile, &lpbi->bmiColors, PalEntries * sizeof(RGBQUAD), &Written, NULL))
			return false;

        if (Written < PalEntries * sizeof(RGBQUAD))
			return false;
		}

    bmfh.bfOffBits = GetFilePointer(BmpFile);

    if (!WriteFile(BmpFile, lpvBits, lpbi->bmiHeader.biSizeImage, &Written, NULL))
		return false;

    if (Written < lpbi->bmiHeader.biSizeImage)
		return false;

    bmfh.bfSize = GetFilePointer(BmpFile);

    SetFilePointer(BmpFile, 0, 0, FILE_BEGIN);
    if (!WriteFile(BmpFile, &bmfh, sizeof(bmfh), &Written, NULL))
        return false;

    if (Written < sizeof(bmfh))
		return false;

    CloseHandle(BmpFile);
    free(lpvBits);
    free(lpbi);

    return true;
}
//
//bool ScreenCapture(char *filename){
//    HDC hDc = CreateCompatibleDC(0);
//    HBITMAP hBmp = CreateCompatibleBitmap(GetDC(0), width/2, height/2);
//    SelectObject(hDc, hBmp);
//    StretchBlt(hDc,0,0,width/2,height/2,GetDC(0),x,y,width,height,SRCCOPY);
//    bool ret = SaveBMPFile(filename, hBmp, hDc, width/2, height/2);
//    DeleteObject(hBmp);
//    return ret;
//}

void uppercase(char* src) {
    int i,l = strlen(src);
    for (i=0;i<l;i++) {
        if (src[i]<='z' && src[i]>='a') src[i]-=32;
    }
}

bool EnumWindowCallback(HWND hwndm, int lParam) {
    if (hwndm==ProgressBarWindow || hwndm==SearchProgressWindow || hwndm == MediaWindow_1 || hwndm == MediaWindow_2 || hwndm == ProgressBarWindow || hwndm == CSVListExportProgressWindow || hwndm==GameWindow) return true;
        if (isWindowMaximized) {
            if (!IsWindowVisible(MediaWindow_1) && !IsWindowVisible(MediaWindow_2) && (hwndm==(PlayButtonWindow) || hwndm==(StopButtonWindow) || hwndm==(MediaInfoWindow) || hwndm==(CenterButtonWindow) || hwndm==(ResetButtonWindow))) return true;
            if (hwndm==VTRACKWindow || hwndm==SpeedProfileWindow || hwndm==VTRACKListWindow) return true;
            if (!debug_mode && (hwndm==MessageSaturationBar || hwndm==DetailsSaturationBar || hwndm==MainBufferSaturationBar)) return true;
            if (isCSVdone || hwndm!=CSVListOpenCSVButtonWindow) ShowWindow(hwndm,10);
            SetWindowText(MainWindow,Complete_Soft_Title);
        } else {
            if (hwndm!=(HWND)lParam) {
                    ShowWindow(hwndm,0);
            } else {
                ShowWindow(hwndm,3);
            }
            if ((HWND)lParam==MessageWindow) SetWindowText(MainWindow,"[Full Screen] Message Window (Press ESC to revert)");
            else if ((HWND)lParam==HeadersWindow) SetWindowText(MainWindow,"[Full Screen] Headers Window (Press ESC to revert)");
            else if ((HWND)lParam==DetailsWindow) SetWindowText(MainWindow,"[Full Screen] Details Window (Press ESC to revert)");
        }
    return true;
}

void Rewrite_Settings() {
    fclose(SETTINGS_FILE);
    SETTINGS_FILE = fopen("settings.ugc","w+");
    fputs(Soft_Title,SETTINGS_FILE);
    int i;
    for (i=0;i<=256;i++) {
        fprintf(SETTINGS_FILE,"%c",excel_message_settings[i]);
    }
    fprintf(SETTINGS_FILE,"\n");
    if (exportpacketexpand) fprintf(SETTINGS_FILE,"1"); else fprintf(SETTINGS_FILE,"0");
    if (night_mode) fprintf(SETTINGS_FILE,"1"); else fprintf(SETTINGS_FILE,"0");
    fprintf(SETTINGS_FILE,"\n");
    fprintf(SETTINGS_FILE,"%s\n",Path_Buffer);
    sprintf(Remanent_Path_Buffer,Path_Buffer);
    fprintf(SETTINGS_FILE,"%s\n",Filename_Buffer);
    fprintf(SETTINGS_FILE,"%03d%03d%03d%03d",main_R,main_G,main_B,color_saturation);
}

void Init_Settings() {
    fputs(Soft_Title,SETTINGS_FILE);
    fprintf(SETTINGS_FILE,"\n");
    fprintf(SETTINGS_FILE,"1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111\n");
    fprintf(SETTINGS_FILE,"11\n");
    fprintf(SETTINGS_FILE,"%s\n",Path_Buffer);
    fprintf(SETTINGS_FILE,"void\n");
    fprintf(SETTINGS_FILE,"030139200100");
}

void Message_INDEX2ID(int id,char* result) {
    sprintf(result,"???");
    switch(id) {
        case 1 : sprintf(result,"GENERAL_MESSAGE"); break;
        case 2 : sprintf(result,"DATA_ENTRY_COMPLETED"); break;
        case 3 : sprintf(result,"EMERGENCY_BRAKE"); break;
        case 4 : sprintf(result,"SB_COMMAND_STATE"); break;
        case 5 : sprintf(result,"MESSAGE_TO_RIU(BL3) / EVENTS(BL2)"); break;
        case 6 : sprintf(result,"MESSAGE_FROM_BALISE"); break;
        case 7 : sprintf(result,"MESSAGE_FROM_LOOP"); break;
        case 8 : sprintf(result,"MESSAGE_FROM_RIU"); break;
        case 9 : sprintf(result,"MESSAGE_FROM_RBC"); break;
        case 10 : sprintf(result,"MESSAGE_TO_RBC"); break;
        case 11 : sprintf(result,"DRIVER_ACTION"); break;
        case 12 : sprintf(result,"BALISE_GROUP_ERROR"); break;
        case 13 : sprintf(result,"RADIO_ERROR"); break;
        case 14 : sprintf(result,"STM_INFORMATION"); break;
        case 15 : sprintf(result,"COLD_MOVEMENT_DETECTOR_INFO(BL3)/PLAIN TEXT MESSAGE(BL2)"); break;
        case 16 : sprintf(result,"FIXED_TEXT_MESSAGE_START"); break;
        case 17 : sprintf(result,"FIXED_TEXT_MESSAGE_STOP"); break;
        case 18 : sprintf(result,"PLAIN_TEXT_MESSAGE_START"); break;
        case 19 : sprintf(result,"PLAIN_TEXT_MESSAGE_STOP"); break;
        case 20 : sprintf(result,"SPEED_DISTANCE_MONITORING"); break;
        case 21 : sprintf(result,"DMI_SYMBOL_"); break;
        case 22 : sprintf(result,"DMI_SOUND_"); break;
        case 23 : sprintf(result,"DMI_STATUS"); break;
        case 24 : sprintf(result,"ADDITIONAL_DATA"); break;
        case 25 : sprintf(result,"DRIVER_SR_SPEED_DISTANCE"); break;
        case 26 : sprintf(result,"STM_SELECTED"); break;
        case 27 : sprintf(result,"SAFETY_CRITICAL_FAULT"); break;
        case 28 : sprintf(result,"DRIVER_VBC_SET"); break;
        case 29 : sprintf(result,"DRIVER_VBC_REMOVED"); break;
        case 30 : sprintf(result,"SLEEPING_INPUT"); break;
        case 31 : sprintf(result,"PASSIVE_SHUNTING_INPUT"); break;
        case 32 : sprintf(result,"NON_LEADING_INPUT"); break;
        case 33 : sprintf(result,"REGENERATIVE_BRAKE_STATUS"); break;
        case 34 : sprintf(result,"MAGNETIC_SHOE_BRAKE_STATUS"); break;
        case 35 : sprintf(result,"EDDY_CURRENT_BRAKE_STATUS"); break;
        case 36 : sprintf(result,"EP_BRAKE_STATUS"); break;
        case 37 : sprintf(result,"ADDITIONAL_BRAKE_STATUS"); break;
        case 38 : sprintf(result,"CAB_STATUS"); break;
        case 39 : sprintf(result,"DIRECTION_CONTROLLER_POSITION"); break;
        case 40 : sprintf(result,"TRACTION_STATUS"); break;
        case 41 : sprintf(result,"TRAIN_DATA_TYPE"); break;
        case 42 : sprintf(result,"NATIONAL_SYSTEM_ISOLATION"); break;
        case 43 : sprintf(result,"TRACTION_CUT_OFF_COMMAND_STATE"); break;
        case 44 : sprintf(result,"MA_LOWEST_SUPERVISED_SPEED"); break;
        case 197 : sprintf(result,"Z_EXPL_POSITION"); break;
        case 198 : sprintf(result,"INFO_VITESSES_DISTANCE"); break;
        case 199 : sprintf(result,"CHANGEMENT_DE_MODE"); break;
        case 200 : sprintf(result,"CHANGEMENT_DE_NIVEAU"); break;
        case 255 : sprintf(result,"ETCS_PROPRIETARY_DATA"); break;
    }
}

bool Check_Settings() {
    fseek(SETTINGS_FILE,35,SEEK_SET);
    int vn1 = fgetc(SETTINGS_FILE);
    int vn11 = fgetc(SETTINGS_FILE);
    fgetc(SETTINGS_FILE);
    int vn2 = fgetc(SETTINGS_FILE);
    fgetc(SETTINGS_FILE);
    int vn3 = fgetc(SETTINGS_FILE);
    fseek(SETTINGS_FILE,0,SEEK_SET);

    return (vn1==Soft_Title[35] && vn11==Soft_Title[36] && vn2==Soft_Title[38] && vn3==Soft_Title[40]);
}

void switch_all(bool left) {
    int i;
    SendMessage(CSVSettingsList2Window,LB_RESETCONTENT,0,0);
    SendMessage(CSVSettingsList1Window,LB_RESETCONTENT,0,0);
    char buffer[Message_Buffer_Size];
    fseek(SETTINGS_FILE,45,SEEK_SET);
    for (i=1;i<=255;i++) {
        Message_INDEX2ID(i,buffer);
        if (left) {
            fputc('1',SETTINGS_FILE);
            SendMessage(CSVSettingsList1Window,LB_SETITEMDATA,SendMessage(CSVSettingsList1Window,LB_ADDSTRING,0,(LPARAM)buffer),i);
            excel_message_settings[i]='1';
        }
        else {
            fputc('0',SETTINGS_FILE);
            SendMessage(CSVSettingsList2Window,LB_SETITEMDATA,SendMessage(CSVSettingsList2Window,LB_ADDSTRING,0,(LPARAM)buffer),i);
            excel_message_settings[i]='0';
        }
    }
}

void switch_setting(int id,bool left) {
    if (id==-1) return;
    int i,index,data;
    int left_count = SendMessage(CSVSettingsList1Window,LB_GETCOUNT,0,0);
    int right_count = SendMessage(CSVSettingsList2Window,LB_GETCOUNT,0,0);
    char buffer[Message_Buffer_Size];
    if (left) {
        SendMessage(CSVSettingsList2Window,LB_GETTEXT,(WPARAM)id,(LPARAM)buffer);
        data = SendMessage(CSVSettingsList2Window,LB_GETITEMDATA,(WPARAM)id,(LPARAM)0);
        excel_message_settings[data]='1';
        for (i=0;i<left_count;i++) {
            index = SendMessage(CSVSettingsList1Window,LB_GETITEMDATA,(WPARAM)i,(LPARAM)0);
            if (index>data) {
                SendMessage(CSVSettingsList1Window,LB_SETITEMDATA,SendMessage(CSVSettingsList1Window,LB_INSERTSTRING,(WPARAM)i,(LPARAM)buffer),(LPARAM)data);
                SendMessage(CSVSettingsList2Window,LB_DELETESTRING,(WPARAM)id,(LPARAM)0);
                fseek(SETTINGS_FILE,44+data,SEEK_SET); fputc('1',SETTINGS_FILE);
                return;
            }
        }
        fseek(SETTINGS_FILE,44+data,SEEK_SET); fputc('1',SETTINGS_FILE);
        SendMessage(CSVSettingsList1Window,LB_SETITEMDATA,SendMessage(CSVSettingsList1Window,LB_INSERTSTRING,(WPARAM)-1,(LPARAM)buffer),(LPARAM)data);
        SendMessage(CSVSettingsList2Window,LB_DELETESTRING,(WPARAM)id,(LPARAM)0);
    } else {
        SendMessage(CSVSettingsList1Window,LB_GETTEXT,(WPARAM)id,(LPARAM)buffer);
        data = SendMessage(CSVSettingsList1Window,LB_GETITEMDATA,(WPARAM)id,(LPARAM)0);
        excel_message_settings[data]='0';
        for (i=0;i<right_count;i++) {
            index = SendMessage(CSVSettingsList2Window,LB_GETITEMDATA,(WPARAM)i,(LPARAM)0);
            if (index>data) {
                SendMessage(CSVSettingsList2Window,LB_SETITEMDATA,SendMessage(CSVSettingsList2Window,LB_INSERTSTRING,(WPARAM)i,(LPARAM)buffer),(LPARAM)data);
                SendMessage(CSVSettingsList1Window,LB_DELETESTRING,(WPARAM)id,(LPARAM)0);
                fseek(SETTINGS_FILE,44+data,SEEK_SET); fputc('0',SETTINGS_FILE);
                return;
            }
        }
        fseek(SETTINGS_FILE,44+data,SEEK_SET); fputc('0',SETTINGS_FILE);
        SendMessage(CSVSettingsList2Window,LB_SETITEMDATA,SendMessage(CSVSettingsList2Window,LB_INSERTSTRING,(WPARAM)-1,(LPARAM)buffer),(LPARAM)data);
        SendMessage(CSVSettingsList1Window,LB_DELETESTRING,(WPARAM)id,(LPARAM)0);
    }
}

void lowercase(char* src) {
    int i,l = strlen(src);
    for (i=0;i<l;i++) {
        if (src[i]<='Z' && src[i]>='A') src[i]+=32;
    }
}

int range_rand(int range_max) {
    return rand() % range_max + 1;
}

bool Check_Log_Entries()
{
    HANDLE h;
    EVENTLOGRECORD *pevlr;
    BYTE bBuffer[131072];
    DWORD dwRead, dwNeeded;

    h = OpenEventLog(NULL,"System");
    pevlr = (EVENTLOGRECORD *) &bBuffer;
    time_t border=time(NULL)-(48*3600);
    DWORD event_id;
    int offset,num_strings,i;
    char buff[20];

    while (ReadEventLog(h,EVENTLOG_FORWARDS_READ |  EVENTLOG_SEQUENTIAL_READ, 0,pevlr,65536,&dwRead,&dwNeeded))
    {
        while (dwRead > 0)
        {
            num_strings = pevlr->NumStrings;
            event_id = pevlr->EventID&0x0000ffff;
            offset = pevlr->StringOffset;

            if (event_id==1) {
                for (i=0;i<num_strings;i++) {
                    offset+=sprintf(buff,"%s\n",(LPSTR) ((LPBYTE) pevlr + offset));
                    if (i==2 && buff[0]=='S' && buff[5]=='m') return false;
                }
                return false;
            }

            if (pevlr->TimeGenerated>border) {
                if (event_id==104) {
                    for (i=0;i<num_strings;i++) {
                        offset+=sprintf(buff,"%s\n",(LPSTR) ((LPBYTE) pevlr + offset));
                        if (i==2 && buff[0]=='S' && buff[5]=='m') return false;
                    }
                }
            }

            dwRead -= pevlr->Length;
            pevlr = (EVENTLOGRECORD *)
                ((LPBYTE) pevlr + pevlr->Length);
        }
        pevlr = (EVENTLOGRECORD *) &bBuffer;
    }
    CloseEventLog(h);
    return true;
}

void log_it(int log_type,char* title,char* details,int log_data) {
    if (file_log_count>=Max_Log_Per_File) return;
    unsigned long long time = GetTickCount()-tick_0;
    int hour = (int)(time/3600000);
    time -= hour*3600000;
    int minute = (int)(time/60000);
    time -= minute*60000;
    int second = (int)(time/1000);
    time -= second*1000;
    if (log_data>=0) {
        if (details[0]=='\0') sprintf(Error_Buffer,"%d%02d:%02d:%02d:%03I64u | %s [->]",log_type,hour,minute,second,time,title);
        else sprintf(Error_Buffer,"%d%02d:%02d:%02d:%03I64u | %s | %s [->]",log_type,hour,minute,second,time,title,details);
    } else {
        if (details[0]=='\0') sprintf(Error_Buffer,"%d%02d:%02d:%02d:%03I64u | %s",log_type,hour,minute,second,time,title);
        else sprintf(Error_Buffer,"%d%02d:%02d:%02d:%03I64u | %s | %s",log_type,hour,minute,second,time,title,details);
    }
    SendMessage(LogListWindow,LB_SETITEMDATA,SendMessage(LogListWindow,LB_ADDSTRING,0,(LPARAM)Error_Buffer),log_data);
    log_count++;
}

void log_release() {
    int i,log_count = SendMessage(LogListWindow,LB_GETCOUNT,0,0);
    sprintf(&executable_path_buffer[executable_path_length],"\\JRUGC_LOG.txt");
    log_file = fopen(executable_path_buffer,"a+");
    for (i=0;i<log_count;i++) {
        SendMessage(LogListWindow,LB_GETTEXT,i,(LPARAM)Window_Buffer);
        fprintf(log_file,"%s\n",Window_Buffer);
    }
    executable_path_buffer[executable_path_length]='\0';
    fclose(log_file);
}

HBITMAP ResizeBmp(HBITMAP hBmpSrc, int x, int y) {
    BITMAP bmpInfo;
    GetObject(hBmpSrc, sizeof(BITMAP), &bmpInfo);
    SIZE oldSize;
    oldSize.cx = bmpInfo.bmWidth;
    oldSize.cy = bmpInfo.bmHeight;

    int new_size_x,new_size_y;
    if (x==0) new_size_x=oldSize.cx*x_scale; else new_size_x=x;
    if (y==0) new_size_y=oldSize.cy*y_scale; else new_size_y=y;

    HDC hdc = GetDC(NULL);
    HDC hDCSrc = CreateCompatibleDC(hdc);
    HBITMAP hOldBmpSrc = (HBITMAP)SelectObject(hDCSrc, hBmpSrc);

    HDC hDCDst = CreateCompatibleDC(hdc);
    HBITMAP hBmpDst = CreateCompatibleBitmap(hdc, oldSize.cx*x_scale, oldSize.cy*y_scale);
    HBITMAP hOldBmpDst = (HBITMAP)SelectObject(hDCDst, hBmpDst);

    StretchBlt(hDCDst, 0, 0, new_size_x, new_size_y, hDCSrc, 0, 0, oldSize.cx, oldSize.cy, SRCCOPY);

    SelectObject(hDCSrc, hOldBmpSrc);
    SelectObject(hDCDst, hOldBmpDst);
    DeleteDC(hDCSrc);
    DeleteDC(hDCDst);
    ReleaseDC(NULL, hdc);

return hBmpDst;
}

bool NID_Z_checker() {
    if (mobile_buffer[0]=='\0')  TTX_BITMAP = TTX_MISSING;
    else if (strlen(mobile_buffer)!=32) TTX_BITMAP=TTX_NOK;
    else TTX_BITMAP = TTX_OKAY;
    int offset_key = mobile_buffer[0];
    int shift_key_1 = mobile_buffer[(36-offset_key)%31+1];
    int shift_key_2 = mobile_buffer[(61-offset_key)%31+1];
    int i,value,corrected_value,total=(shift_key_1+shift_key_2+offset_key);
    int key_check_length;
    int username_length = strlen(username_buffer);
    int check_key_1;
    int check_key_2;
    int check_key_3;

    struct tm start_time = {0};
    struct tm end_time = {0};
    start_time.tm_isdst = -1;
    end_time.tm_isdst = -1;

    time_t Now = time(0);
    struct tm* mobile_now = localtime(&Now);

    int entite,droits;
    FILE* REGISTRATION_FILE;

    if (TTX_BITMAP==TTX_OKAY) {
        for (i=2;i<=32;i++) {
            if (i==5 || i==30) continue;
            value = mobile_buffer[(i+31-offset_key)%31+1];
            corrected_value = (value-1-abs(shift_key_1-shift_key_2))%127;
            if (corrected_value<0) corrected_value+=127;

            if (i==25) start_time.tm_mday+=10*(corrected_value-48);
            if (i==10) start_time.tm_mday+=(corrected_value-48);
            if (i==24) start_time.tm_mon+=10*(corrected_value-48);
            if (i==7) start_time.tm_mon+=(corrected_value-48);
            if (i==27) start_time.tm_year+=1000*(corrected_value-48);
            if (i==22) start_time.tm_year+=100*(corrected_value-48);
            if (i==6) start_time.tm_year+=10*(corrected_value-48);
            if (i==12) start_time.tm_year+=(corrected_value-48);

            if (i==26) end_time.tm_mday+=10*(corrected_value-48);
            if (i==13) end_time.tm_mday+=(corrected_value-48);
            if (i==8) end_time.tm_mon+=10*(corrected_value-48);
            if (i==21) end_time.tm_mon+=(corrected_value-48);
            if (i==3) end_time.tm_year+=1000*(corrected_value-48);
            if (i==31) end_time.tm_year+=100*(corrected_value-48);
            if (i==15) end_time.tm_year+=10*(corrected_value-48);
            if (i==11) end_time.tm_year+=(corrected_value-48);

            if (i==4) {check_key_2=corrected_value; continue;}
            if (i==20) {check_key_1=corrected_value; continue;}
            if (i==28) {check_key_3=corrected_value; continue;}
            if (i==16) {
                if (username_length>=1) {
                    if (username_buffer[0]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==23) {
                if (username_length>=2) {
                    if (username_buffer[1]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==29) {
                if (username_length>=3) {
                    if (username_buffer[2]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==9) {
                if (username_length>=4) {
                    if (username_buffer[3]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==18) {
                if (username_length>=5) {
                    if (username_buffer[4]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==32) {
                if (username_length>=6) {
                    if (username_buffer[5]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==17) {
                if (username_length>=7) {
                    if (username_buffer[6]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==2) {
                if (username_length>=8) {
                    if (username_buffer[7]!=corrected_value) TTX_BITMAP=TTX_NOK;
                } else {
                    if (corrected_value!=' ') TTX_BITMAP=TTX_NOK;
                }
            }
            if (i==19) entite = corrected_value;
            if (i==14) droits = corrected_value;
            total+=value;
        }

        start_time.tm_mon--;
        end_time.tm_mon--;
        start_time.tm_year-=1900;
        end_time.tm_year-=1900;

        if (mobile_now->tm_year>end_time.tm_year) TTX_BITMAP=TTX_EXPIRED;
        if (mobile_now->tm_year==end_time.tm_year) {
            if (mobile_now->tm_mon>end_time.tm_mon) TTX_BITMAP=TTX_EXPIRED;
            if (mobile_now->tm_mon==end_time.tm_mon) {
                if (mobile_now->tm_mday>end_time.tm_mday) TTX_BITMAP=TTX_EXPIRED;
            }
        }

        if (start_time.tm_year>end_time.tm_year) TTX_BITMAP=TTX_NOK;
        if (start_time.tm_year==end_time.tm_year) {
            if (start_time.tm_mon>end_time.tm_mon) TTX_BITMAP=TTX_NOK;
            if (start_time.tm_mon==end_time.tm_mon) {
                if (start_time.tm_mday>end_time.tm_mday) TTX_BITMAP=TTX_NOK;
            }
        }

        if (mobile_now->tm_year<start_time.tm_year) TTX_BITMAP=TTX_NOTYET;
        if (mobile_now->tm_year==start_time.tm_year) {
            if (mobile_now->tm_mon<start_time.tm_mon) TTX_BITMAP=TTX_NOTYET;
            if (mobile_now->tm_mon==start_time.tm_mon) {
                if (mobile_now->tm_mday<start_time.tm_mday) TTX_BITMAP=TTX_NOTYET;
            }
        }

        char hexa_total[4];
        sprintf(hexa_total,"%X",total);
        key_check_length=strlen(hexa_total);
        if (check_key_3!=hexa_total[key_check_length-1] && key_check_length>=1) TTX_BITMAP=TTX_NOK;
        if (check_key_2!=hexa_total[key_check_length-2] && key_check_length>=1) TTX_BITMAP=TTX_NOK;
        if (check_key_1!=hexa_total[key_check_length-3] && key_check_length>=1) TTX_BITMAP=TTX_NOK;
    }

    TTX_BITMAP = TTX_OKAY;

    sprintf(Window_Buffer,"%s\\registration.ugc",executable_path_buffer);

    if (droits>1) {
        if (TTX_BITMAP==TTX_OKAY) {
            REGISTRATION_FILE = fopen(Window_Buffer,"r");
            if (REGISTRATION_FILE==NULL) REGISTRATION_FILE = fopen(Window_Buffer,"w+");
            int attr = GetFileAttributes(Window_Buffer);
            if (!(attr & FILE_ATTRIBUTE_HIDDEN)) SetFileAttributes(Window_Buffer,attr | FILE_ATTRIBUTE_HIDDEN);
            fclose(REGISTRATION_FILE);

            FILETIME ft_info;
            SYSTEMTIME systemTime;

            HANDLE hFile;
            hFile = CreateFile(Window_Buffer,GENERIC_READ,0,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);

            GetFileTime(hFile,NULL,&ft_info,NULL);

            CloseHandle(hFile);

            FileTimeToSystemTime(&ft_info,&systemTime);

            if (systemTime.wYear>(mobile_now->tm_year+1900)) TTX_BITMAP=TTX_NOK;
            if (systemTime.wYear==(mobile_now->tm_year+1900)) {
                if (systemTime.wMonth>(mobile_now->tm_mon+1)) TTX_BITMAP=TTX_NOK;
                if (systemTime.wMonth==(mobile_now->tm_mon+1)) {
                    if (systemTime.wDay>mobile_now->tm_mday) TTX_BITMAP=TTX_NOK;
                }
            }
        }
        if (TTX_BITMAP==TTX_OKAY) {
            DeleteFile(Window_Buffer);
            REGISTRATION_FILE = fopen(Window_Buffer,"w+");
            SetFileAttributes(Window_Buffer,GetFileAttributes(Window_Buffer) | FILE_ATTRIBUTE_HIDDEN);
            fprintf(REGISTRATION_FILE,"%03d",range_rand(99));
            fclose(REGISTRATION_FILE);
//            if (!Check_Log_Entries()) TTX_BITMAP=TTX_NOK;
        }
    } else {
        REGISTRATION_FILE = fopen(Window_Buffer,"w+");
        fclose(REGISTRATION_FILE);
    }

    ShowWindow(TTXWindow,SW_NORMAL);
    HDC TTX_DC = GetWindowDC(TTXWindow);
    SetBkColor(TTX_DC,Thalys_Red);
    HDC bitmap_source = CreateCompatibleDC(TTX_DC);
    SelectObject(bitmap_source,TTX_BITMAP);
    StretchBlt(TTX_DC,10*x_scale,35*y_scale,481*x_scale,253*y_scale,bitmap_source,0,0,500,250,SRCCOPY);
    DeleteDC(bitmap_source);
    if (TTX_BITMAP!=TTX_MISSING && TTX_BITMAP!=TTX_NOK) {
        SetTextColor(TTX_DC,Neon_Green);
        if (entite==1) TextOut(TTX_DC,188*x_scale,165*y_scale,"THIF",4);
        if (entite==2) TextOut(TTX_DC,188*x_scale,165*y_scale,"SNCF",4);
        if (entite==3) TextOut(TTX_DC,188*x_scale,165*y_scale,"SNCB",4);
        TextOut(TTX_DC,235*x_scale,165*y_scale,username_buffer,username_length);
        if (droits==ROLE_GOD) TextOut(TTX_DC,360*x_scale,165*y_scale,"[GOD]",5);
        if (droits==ROLE_DEMO) TextOut(TTX_DC,360*x_scale,165*y_scale,"[DEMO]",6);
        if (TTX_BITMAP!=TTX_OKAY) SetTextColor(TTX_DC,Red);
        if (TTX_BITMAP==TTX_NOTYET) strftime(Window_Buffer, 30, "%B %d %Y", &start_time); else strftime(Window_Buffer, 30, "%B %d %Y", &end_time);
        TextOut(TTX_DC,188*x_scale,202*y_scale,Window_Buffer,strlen(Window_Buffer));
    }
    ROLE = droits;
    if (TTX_BITMAP==TTX_OKAY) log_it(LOG_SUCCESS,"LICENCE CHECK","LICENCE IS VALID",-1);
    if (TTX_BITMAP==TTX_NOK) log_it(LOG_ERROR,"LICENCE CHECK","LICENCE IS NOT VALID",-1);
    if (TTX_BITMAP==TTX_NOTYET) log_it(LOG_ERROR,"LICENCE CHECK","LICENCE IS NOT YET VALID",-1);
    if (TTX_BITMAP==TTX_EXPIRED) log_it(LOG_ERROR,"LICENCE CHECK","LICENCE IS EXPIRED",-1);
    if (TTX_BITMAP==TTX_MISSING) log_it(LOG_INFO,"LICENCE CHECK","LICENCE IS MISSING",-1);

    return true;

    return (TTX_BITMAP==TTX_OKAY)?true:false;
}

void extract_zip(char* dest) {
    int result;
    sprintf(command_buffer,"if exist \"%s\" rmdir /S /Q \"%s\"",dest,dest);
    result = system(command_buffer);
    sprintf(command_buffer,"mkdir \"%s\"",dest);
    result = system(command_buffer);
    if (result!=0) log_it(LOG_WARNING,"EXTRACTION ERROR","An error occured",-1);
    sprintf(command_buffer,"powershell.exe -windowstyle hidden -nologo -noprofile -command \"& { $shell = New-Object -COM Shell.Application; $target = $shell.NameSpace('%s'); $zip = $shell.NameSpace('%s.zip'); $target.CopyHere($zip.Items(), 16); }\"",dest,dest);
    result = system(command_buffer);
    if (result!=0) log_it(LOG_ERROR,"EXTRACTION ERROR","Extraction could not complete",-1); else log_it(LOG_SUCCESS,"EXTRACTION SUCCESS","Extraction completed",-1);
}

void create_zip(char* dest) {
    int result;
    sprintf(command_buffer,"powershell.exe -windowstyle hidden -nologo -noprofile $zipFile = '%s.zip'; if (-not (test-path('%s.zip'))) {set-content $zipFile (\"\"\"PK\"\"\" + [char]5 + [char]6 + (\"\"\"$([char]0)\"\"\" * 18)); (dir '%s.zip').IsReadOnly = $false; $shellApplication = new-object -com shell.application; $zipPackage = $shellApplication.NameSpace($zipFile); $files = Get-ChildItem -Path '%s'; foreach($file in $files) { $zipPackage.CopyHere($file.FullName); while($zipPackage.Items().Item($file.name) -eq $null) {Start-sleep -milliseconds 500} } }",dest,dest,dest,dest);
    result = system(command_buffer);
    if (result!=0) log_it(LOG_ERROR,"COMPRESSION ERROR","Compression could not complete",-1); else log_it(LOG_SUCCESS,"COMPRESSION SUCCESS","Compression completed",-1);
}

void string_to_html(char* src) {
    int i, l =strlen(src);
    for (i=0;i<l;i++) {
        if (src[i]=='\n') src[i]=' ';
    }
}

void send_report(char* texte,int x,int y,int w,int h) {
    SendMessage(SendReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SENDING_REPORT_BUTTON);
    int result;
    char vehicle_window_buffer[Window_Buffer_Size];


    SetFocus(MainWindow);
    sprintf(command_buffer,"%s\\BUG_CAPTURE.png",executable_path_buffer);
    remove(command_buffer);

    result = system_call("ScreenCapture.bat");
    SetFocus(MainHelpWindow);
    if (GetWindowText(VehicleWindow,vehicle_window_buffer,Window_Buffer_Size-1)==0) sprintf(vehicle_window_buffer,"No file");

    string_to_html(vehicle_window_buffer);
    string_to_html(texte);

    if (result) sprintf(command_buffer,"powershell.exe -windowstyle hidden -nologo -noprofile -command \"& {$SMTPServer = 'smtp.gmail.com'; $SMTPClient = New-Object Net.Mail.SmtpClient($SMTPServer,587); $SMTPClient.EnableSsl = $true; $SMTPClient.Credentials = New-Object System.Net.NetworkCredential('THIF.JRUGC@gmail.com','4D21JHOR,npze5774gJG5V52yfs'); $emailMessage = New-Object System.Net.Mail.MailMessage; $emailMessage.From = 'THIF.JRUGC@gmail.com'; $emailMessage.To.Add('ugc@thalys.com'); $emailMessage.Subject = 'Bug report from : %s'; $emailMessage.IsBodyHtml = $true; $emailMessage.Body = 'Line : %d<br>File : %s<br>User comment : %s'; $emailMessage.Attachments.Add('%s\\JRUGC_LICENCE.ugc'); $emailMessage.Attachments.Add('%s\\registration.ugc'); $emailMessage.Attachments.Add('%s\\JRUGC_LOG.txt'); $emailMessage.Attachments.Add('%s\\BUG_CAPTURE.png'); $emailMessage.Attachments.Add('%s\\settings.ugc'); $SMTPClient.Send($emailMessage); } \"",username_buffer,(int)(Message_Position+1),vehicle_window_buffer,texte,executable_path_buffer,executable_path_buffer,executable_path_buffer,executable_path_buffer,executable_path_buffer);
    else sprintf(command_buffer,"powershell.exe -windowstyle hidden -nologo -noprofile -command \"& {$SMTPServer = 'smtp.gmail.com'; $SMTPClient = New-Object Net.Mail.SmtpClient($SMTPServer,587); $SMTPClient.EnableSsl = $true; $SMTPClient.Credentials = New-Object System.Net.NetworkCredential('THIF.JRUGC@gmail.com','4D21JHOR,npze5774gJG5V52yfs'); $emailMessage = New-Object System.Net.Mail.MailMessage; $emailMessage.From = 'THIF.JRUGC@gmail.com'; $emailMessage.To.Add('ugc@thalys.com'); $emailMessage.Subject = 'Bug report from : %s'; $emailMessage.IsBodyHtml = $true; $emailMessage.Body = 'ScreenShot failure<br>Line : %d<br>File : %s<br>User comment : %s'; $emailMessage.Attachments.Add('%s\\JRUGC_LICENCE.ugc'); $emailMessage.Attachments.Add('%s\\registration.ugc'); $emailMessage.Attachments.Add('%s\\JRUGC_LOG.txt'); $emailMessage.Attachments.Add('%s\\settings.ugc'); $SMTPClient.Send($emailMessage); } \"",username_buffer,(int)(Message_Position+1),vehicle_window_buffer,texte,executable_path_buffer,executable_path_buffer,executable_path_buffer,executable_path_buffer);
    sprintf(vehicle_window_buffer,"%s",texte);
    log_release();
    fclose(SETTINGS_FILE);
    result = system_call(command_buffer);
    SETTINGS_FILE = fopen("settings.ugc","r+");
    if (result==0) {
        SendMessage(SendReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEND_REPORT_BUTTON_NOK);
        log_it(LOG_ERROR,"Bug report not sent",command_buffer,-1);
    } else {
        SendMessage(SendReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEND_REPORT_BUTTON_OK);
        log_it(LOG_SUCCESS,"Bug report sent",vehicle_window_buffer,-1);
    }
    sprintf(command_buffer,"%s\\ScreenCapture.exe",executable_path_buffer);
    remove(command_buffer);
    SetFocus(MainHelpWindow);
}

void game_setup_init() {
    SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_40);
    game_train_pos_x = 0;
    game_train_pos_y = 0;
    game_train_pos_offset = 0;
    game_panorama_offset = 0;
    game_train_speed = 20;
    game_distance=0;
    game_paused = false;
    int i,j,l;
    for (i=0;i<game_rows;i++) {
        for (j=0;j<game_columns;j++) {
            l = range_rand(100);
            if (j==0) {
                if (i==0) game_setup[i][j]=game_part_track;
                else if (l<=75) game_setup[i][j]=game_part_void;
                else if (l<=90) game_setup[i][j]=game_part_track;
                else if (l<=93) game_setup[i][j]=game_part_malus;
                else game_setup[i][j]=game_part_bonus;
            } else {
                if ((i==0 && j<game_columns/2) || j<2) game_setup[i][j]=game_part_track;
                else if (game_setup[i][j-1]!=game_part_void) {
                    if (l<=10) {
                        if (j>=7 && game_setup[i][j-1]!=game_part_void && game_setup[i][j-2]!=game_part_void&& game_setup[i][j-3]!=game_part_void&& game_setup[i][j-4]!=game_part_void&& game_setup[i][j-5]!=game_part_void&& game_setup[i][j-6]!=game_part_void&& game_setup[i][j-7]!=game_part_void) game_setup[i][j]=game_part_void;
                        else game_setup[i][j]=game_part_track;
                    }
                    else if (l<=90) game_setup[i][j]=game_part_track;
                    else if (l<=93) game_setup[i][j]=game_part_malus;
                    else game_setup[i][j]=game_part_bonus;
                } else {
                    if (l<=75 && j>=2 && (game_setup[i][j-1]!=game_part_void || game_setup[i][j-2]!=game_part_void)) game_setup[i][j]=game_part_void;
                    else if (l<=90) game_setup[i][j]=game_part_track;
                    else if (l<=93) game_setup[i][j]=game_part_malus;
                    else game_setup[i][j]=game_part_bonus;
                }
            }
            if (l==90 && game_setup[i][j]==game_part_track && j>(game_columns/2)) {
                game_setup[i][j]=game_part_train-range_rand(11);
            }
            if (j<(game_columns/2) && game_setup[i][j]>game_part_track)  game_setup[i][j]=game_part_track;
        }
    }
    RedrawWindow(GameWindow,NULL,NULL,RDW_ERASENOW|RDW_UPDATENOW|RDW_INVALIDATE);
}

void reset_view() {
    ShowWindow(VTRACKWindow,SW_HIDE);
    ShowWindow(VTRACKListWindow,SW_HIDE);
    ShowWindow(SpeedProfileWindow,SW_HIDE);
    ShowWindow(MessageWindow,SW_SHOWNORMAL);
    SendMessage(MessageWindow,LB_RESETCONTENT,0,0);
    SendMessage(HeadersWindow,LB_RESETCONTENT,0,0);
    SendMessage(DetailsWindow,LB_RESETCONTENT,0,0);
    SendMessage(LinkingWindow,LB_RESETCONTENT,0,0);
    SendMessage(MAWindow,LB_RESETCONTENT,0,0);
    SetWindowText(VehicleWindow,"");
    SetWindowText(MessageSearchWindow,"");
    SetWindowText(DateSearchWindow,"");
    SetWindowText(TrainSearchWindow,"");
    SetWindowText(BaliseSearchWindow,"");
    SetWindowText(LinkedBaliseSearchWindow,"");
    SetWindowText(PacketSearchWindow,"");
    SetWindowText(RadioSearchWindow,"");
    SetWindowText(SpeedSearchWindow,"");
    SetWindowText(LevelSearchWindow,"");
    SetWindowText(ModeSearchWindow,"");
    SetWindowText(AdvancedSearchNameWindow,"");
    SetWindowText(AdvancedSearchValueWindow,"");
    SetWindowText(LineWindow,"");
    SetWindowText(TrackInformationWindow,"");
    SetWindowText(DistanceWindow,"No Reference");
    SetWindowText(TimeWindow,"No Reference");
    SetWindowText(SpeedWindow,"No Reference");
    Reference_Message=-1;
    message_index=-1;
    file_log_count=0;
    SendMessage(TrainListWindow,LB_RESETCONTENT,0,0);
    SendMessage(BaliseListWindow,LB_RESETCONTENT,0,0);
    ASV_Search_Index=-1;
    ASV_increment=0;
    SendMessage(SequenceListWindow1,LB_RESETCONTENT,0,0);
    SendMessage(SequenceListWindow2,LB_RESETCONTENT,0,0);
    file_log_count=0;
    Last_Message=-1;
    SetWindowText(MainWindow,Soft_Title);
    SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)NO_DATA_FILE);
    RedrawWindow(VehicleWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
    SendMessage(MainBufferSaturationBar,PBM_SETPOS,0,0);
    SendMessage(MessageSaturationBar,PBM_SETPOS,0,0);
    SendMessage(DetailsSaturationBar,PBM_SETPOS,0,0);
    SendMessage(MainBufferSaturationBar,PBM_SETBARCOLOR,0,Light_Purple);
    SendMessage(MessageSaturationBar,PBM_SETBARCOLOR,0,Cyan);
    SendMessage(DetailsSaturationBar,PBM_SETBARCOLOR,0,Cyan);
    SendMessage(MainBufferSaturationBar,PBM_SETPOS,0,0);
    SendMessage(MessageSaturationBar,PBM_SETPOS,0,0);
    SendMessage(DetailsSaturationBar,PBM_SETPOS,0,0);
    RedrawWindow(MainBufferSaturationBar,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
    RedrawWindow(MessageSaturationBar,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
    RedrawWindow(DetailsSaturationBar,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
}

int get_ASV_detail(char* src, int m_version) {
    if (strstr(src,"DATA_TBL1+")!=NULL) {
        sprintf(ASV_Buffer,"P044|004|000|000O003|013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_XUSER")!=NULL) {
        sprintf(ASV_Buffer,"P044|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q044|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_GRADIENT")!=NULL) {
        sprintf(ASV_Buffer,"P021|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P021|008|007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"L_TEXT")!=NULL) {
        if (m_version<32) {
            sprintf(ASV_Buffer,"M019|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|014|000|000B008|001B012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M019|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|014|000|000B008|001B012|001O013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|016|000|000B008|001B012|001P013|000O015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|019|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 5;
        }
    }
    if (strstr(src,"Q_TEXT")!=NULL  && strlen(src)==6) {
        if (m_version<32) {
            sprintf(ASV_Buffer,"M017|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M0016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|014|000|000B008|001B012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M017|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M0016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|014|000|000B008|001B012|001O013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|016|000|000B008|001B012|001P013|000O015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|019|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 5;
        }
    }
    if (strstr(src,"X_TEXT")!=NULL) {
        if (m_version<32) {
            sprintf(ASV_Buffer,"M019|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M018|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|015|000|000B008|001B012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M019|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M018|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|015|000|000B008|001B012|001O013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|017|000|000B008|001B012|001P013|000O015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|020|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 5;
        }
    }
    if (strstr(src,"M_LEVELTEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|012|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_VERSION")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M007|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P002|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M007|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P002|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 8;
    }
    if (strstr(src,"Q_SCALE")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|009|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|010|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|010|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P012|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P013|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P015|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P016|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P021|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P040|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P058|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P065|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P067|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P068|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P069|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P071|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P080|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P088|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P134|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P138|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P139|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M008|007|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|008|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|008|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P012|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P013|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P015|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P016|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P021|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P040|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P058|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P065|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P067|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P068|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P069|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P071|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P080|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P088|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P134|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P138|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P139|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 38;
    }
    if (strstr(src,"D_VALIDNV")!=NULL) {
        sprintf(ASV_Buffer,"P003|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"NID_C")!=NULL && strlen(src)==5) {
        if (!isBL3) {
            if (m_version>=32) {
                sprintf(ASV_Buffer,"M028|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M029|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M024|003|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|005|000|000O002|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P003|007|006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P005|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006Z002|001R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P006|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P063|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P072|017|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|017|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006Z001|001R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P090|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|012|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
                return 28;
            } else sprintf(ASV_Buffer,"M028|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M029|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M024|003|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|005|000|000O002|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|006|005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P005|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006Z002|001R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P006|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P063|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P079|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006Z001|001R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P090|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|012|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 25;
        } else {
            if (m_version>=32) {
                sprintf(ASV_Buffer,"M255|001|000|000O000|204|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M028|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M029|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M024|003|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|007|000|000O000|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P003|007|006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P005|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006Z002|001R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P006|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P063|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P072|017|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|017|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006Z001|001R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P090|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|012|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
                return 30;
            } else sprintf(ASV_Buffer,"M255|001|000|000O000|204|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M028|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M029|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M024|003|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|007|000|000O000|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|006|005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P005|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006Z002|001R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P006|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P063|005|003|002Z001|001R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P079|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006Z001|001R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P090|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|012|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|003|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 27;
        }

    }
    if (strstr(src,"V_NVSHUNT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|007|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|006|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVSTFF")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|008|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|007|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVONSIGHT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|009|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|008|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVLIMSUPERV")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P003|010|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVUNFIT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|011|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|009|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVREL")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|012|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|010|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"D_NVROLL")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|013|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P003|011|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_NVSBTSMPERM")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|014|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|012|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_NVEMRRLS")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|015|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|013|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_NVGUIPERM")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|016|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P203|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_NVSBFBPERM")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|017|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P203|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_NVINHSMICPERM")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|018|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P203|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_NVALLOWOVTRP")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|019|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|014|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_NVSUPOVTRP")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|020|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P003|015|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"D_NVOVTRP")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|021|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P003|016|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"T_NVOVTRP")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|022|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|017|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_NVPOTRP")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|023|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P003|018|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_NVCONTACT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|024|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|019|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_NVCONTACT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|025|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|020|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_NVDERUN")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|026|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|021|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_NVSTFF")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|027|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P003|022|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_NVDRIVER_ADHES")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P003|028|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P003|023|000|000N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"L_SECTION")!=NULL) {
        sprintf(ASV_Buffer,"P012|008|007|002R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P016|004|000|000|000|000|000|000|00O|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"L_ENDSECTION")!=NULL) {
        sprintf(ASV_Buffer,"P012|008|000|000N007|002R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"A_NVMAXREDADH1")!=NULL) {
        sprintf(ASV_Buffer,"P203|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|029|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020");
        return 2;
    }
    if (strstr(src,"A_NVMAXREDADH2")!=NULL) {
        sprintf(ASV_Buffer,"P203|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|030|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020");
        return 2;
    }
    if (strstr(src,"A_NVMAXREDADH3")!=NULL) {
        sprintf(ASV_Buffer,"P203|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|031|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020");
        return 2;
    }
    if (strstr(src,"Q_NVLOCACC")!=NULL) {
        sprintf(ASV_Buffer,"P003|032|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_NVAVADH")!=NULL) {
        sprintf(ASV_Buffer,"P203|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|033|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020");
        return 2;
    }
    if (strstr(src,"M_NVEBCL")!=NULL) {
        sprintf(ASV_Buffer,"P203|010|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|034|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_NVKINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|011|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|035|000|000N006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_NVKVINTSET")!=NULL) {
        sprintf(ASV_Buffer,"P203|012|000|000O011|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P203|017|016|004X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|000|000|000|000|000P203|020|019|004X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|000|000|000|000|000P003|036|000|000N006|001O035|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P003|041|040|004X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|000|000|000|000|000P003|044|043|004X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|000|000|000|000|000");
        return 6;
    }
    if (strstr(src,"A_NVP12")!=NULL) {
        sprintf(ASV_Buffer,"P203|013|000|000O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P203|018|016|004Z001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|003|000/020P203|021|019|004Z001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|003|000/020P003|037|000|000O011|001O035|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|042|040|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|003|000/020P003|045|043|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|003|000/020");
        return 6;
    }
    if (strstr(src,"A_NVP23")!=NULL) {
        sprintf(ASV_Buffer,"P203|014|000|000O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P203|019|016|004Z001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|003|000/020P203|022|019|004Z001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|003|000/020P003|038|000|000N006|001O035|001O036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/020P003|043|040|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|003|000/020P003|046|043|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|003|000/020");
        return 6;
    }
    if (strstr(src,"V_NVKVINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|013|000|000O011|001B012|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P203|019|018|003O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P203|016|015|002O011|001P012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P203|023|019|004Z001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|003|000*005P203|021|019|004L001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|000|000*005P203|020|016|004Z001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|003|000*005P203|018|016|004L001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|000|000*005P203|023|019|004Z001|001X001|000R001|003T004|002Y001|001$003|001O011|001O012|001N018|003|000|000|000|000|000|000*005P203|023|019|004L001|001X001|000R001|003T004|002Y001|001$002|001O011|001O012|001N018|003|000|000|000|000|000|000*005P203|020|016|004Z001|001X001|000R001|003T004|002Y001|001$003|001O011|001P012|001N015|002|000|000|000|000|000|000*005P203|020|016|004L001|001X001|000R001|003T004|002Y001|001$002|001O011|001P012|001N015|002|000|000|000|000|000|000*005P003|037|000|000N006|001O035|001B036|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P003|043|042|003N006|001O035|001O036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P003|040|039|002N006|001O035|001P036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P003|047|043|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|003|000*005P003|045|043|004L001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|000|000*005P003|044|040|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|003|000*005P003|042|040|004L001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|000|000*005P003|047|043|004Z001|001X001|000R001|003T004|002Y001|001$003|001N006|001O035|001O036|001N042|003|000|000|000|000*005P003|047|043|004L001|001X001|000R001|003T004|002Y001|001$002|001N006|001O035|001O036|001N042|003|000|000|000|000*005P003|044|040|004Z001|001X001|000R001|003T004|002Y001|001$003|001N006|001O035|001P036|001N039|002|000|000|000|000*005P003|044|040|004L001|001X001|000R001|003T004|002Y001|001$002|001N006|001O035|001P036|001N039|002|000|000|000|000*005");
        return 22;
    }
    if (strstr(src,"M_NVKVINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|014|000|000O011|001B012|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P203|017|000|000O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P203|020|018|003O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P203|017|015|002O011|001P012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P203|021|018|003O011|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P203|022|019|004Z001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|001|000/050P203|022|019|004L001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|000|000/050P203|019|016|004Z001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|001|000/050P203|019|016|004L001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|000|000/050P203|023|019|004Z001|001X001|000R001|003T004|002Y001|001O011|001O012|001N018|003|000|000|000|000|000|000|001|000/050P203|020|016|004Z001|001X001|000R001|003T004|002Y001|001O011|001P012|001N015|002|000|000|000|000|000|000|001|000/050P203|023|019|004Z001|001X001|000R001|003T004|002Y001|001$003|002O011|001O012|001N018|003|000|000|000|000|000|000/050P203|023|019|004L001|001X001|000R001|003T004|002Y001|001$002|002O011|001O012|001N018|003|000|000|000|000|000|000/050P203|020|016|004Z001|001X001|000R001|003T004|002Y001|001$003|002O011|001P012|001N015|002|000|000|000|000|000|000/050P203|020|016|004L001|001X001|000R001|003T004|002Y001|001$002|002O011|001P012|001N015|002|000|000|000|000|000|000/050P203|023|019|004Z001|001X001|000R001|003T004|002Y001|001$003|003O011|001O012|001N018|003|000|000|000|000|000|000/050P203|020|016|004Z001|001X001|000R001|003T004|002Y001|001$003|003O011|001P012|001N015|002|000|000|000|000|000|000/050P003|038|000|000N006|001O035|001B036|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P003|041|000|000N006|001O035|001O036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P003|044|042|003N006|001O035|001O036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P003|041|039|002N006|001O035|001P036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P003|045|042|003N006|001O035|001O036|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000/050P003|046|043|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|001|000/050P003|046|043|004L001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|000|000/050P003|043|040|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|001|000/050P003|043|040|004L001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|000|000/050P003|047|043|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001O036|001N042|003|000|000|000|000|001|000/050P003|044|040|004Z001|001X001|000R001|003T004|002Y001|001N006|001O035|001P036|001N039|002|000|000|000|000|001|000/050P003|047|043|004Z001|001X001|000R001|003T004|002Y001|001$003|002N006|001O035|001O036|001N042|003|000|000|000|000/050P003|047|043|004L001|001X001|000R001|003T004|002Y001|001$002|002N006|001O035|001O036|001N042|003|000|000|000|000/050P003|044|040|004Z001|001X001|000R001|003T004|002Y001|001$003|002N006|001O035|001P036|001N039|002|000|000|000|000/050P003|044|040|004L001|001X001|000R001|003T004|002Y001|001$002|002N006|001O035|001P036|001N039|002|000|000|000|000/050P003|047|043|004Z001|001X001|000R001|003T004|002Y001|001$003|003N006|001O035|001O036|001N042|003|000|000|000|000/050P003|044|040|004Z001|001X001|000R001|003T004|002Y001|001$003|003N006|001O035|001P036|001N039|002|000|000|000|000/050");
        return 34;
    }
    if (strstr(src,"L_NVKRINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|020|000|000O011|001O012|001X000|001Y001|001T004|002N018|003N019|004R001|003|000|000|000|000|000|000|000|000|000P203|017|000|000O011|001P012|001X000|001Y001|001T004|002N015|002N016|004R001|003|000|000|000|000|000|000|000|000|000P203|023|022|002O011|001O012|001X000|001Y001|001T004|002N018|003N019|004R001|003|000|000|000|000|000|000|000|000|000P203|020|019|002O011|001P012|001X000|001Y001|001T004|002N015|002N016|004R001|003|000|000|000|000|000|000|000|000|000P003|044|000|000N006|001O035|001O036|001X000|001Y001|001T004|002N042|003N043|004R001|003|000|000|000|000|000|000|000P003|041|000|000N006|001O035|001P036|001X000|001Y001|001T004|002N039|002N040|004R001|003|000|000|000|000|000|000|000P003|047|046|002N006|001O035|001O036|001X000|001Y001|001T004|002N042|003N043|004R001|003|000|000|000|000|000|000|000P003|044|043|002N006|001O035|001P036|001X000|001Y001|001T004|002N039|002N040|004R001|003|000|000|000|000|000|000|000");
        return 8;
    }
    if (strstr(src,"M_NVKRINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|021|000|000O011|001O012|001X000|001Y001|001T004|002N018|003N019|004R001|003|000|000|000|000|000|000|000|000/020P203|018|000|000O011|001P012|001X000|001Y001|001T004|002N015|002N016|004R001|003|000|000|000|000|000|000|000|000/020P203|024|022|002O011|001O012|001X000|001Y001|001T004|002N018|003N019|004R001|003|000|000|000|000|000|000|000|000/020P203|021|019|002O011|001P012|001X000|001Y001|001T004|002N015|002N016|004R001|003|000|000|000|000|000|000|000|000/020P003|045|000|000N006|001O035|001O036|001X000|001Y001|001T004|002N042|003N043|004R001|003|000|000|000|000|000|000/020P003|042|000|000N006|001O035|001P036|001X000|001Y001|001T004|002N039|002N040|004R001|003|000|000|000|000|000|000/020P003|048|046|002N006|001O035|001O036|001X000|001Y001|001T004|002N042|003N043|004R001|003|000|000|000|000|000|000/020P003|045|043|002N006|001O035|001P036|001X000|001Y001|001T004|002N039|002N040|004R001|003|000|000|000|000|000|000/020");
        return 8;
    }
    if (strstr(src,"M_NVKTINT")!=NULL) {
        sprintf(ASV_Buffer,"P203|023|000|000O011|001O012|001X000|001Y001|001T004|002N018|003N019|004R001|003N022|002|000|000|000|000|000|000/020P203|020|000|000O011|001P012|001X000|001Y001|001T004|002N015|002N016|004R001|003N019|002|000|000|000|000|000|000/020P003|047|000|000N006|001O035|001O036|001X000|001Y001|001T004|002N042|003N043|004R001|003N046|002|000|000|000|000/020P003|044|000|000N006|001O035|001P036|001X000|001Y001|001T004|002N039|002N040|004R001|003N043|002|000|000|000|000/020");
        return 4;
    }
    if (strstr(src,"D_LINK")!=NULL) {
        sprintf(ASV_Buffer,"P005|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P005|011|010|006R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_NEWCOUNTRY")!=NULL) {
        sprintf(ASV_Buffer,"P005|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|012|010|006R002|001N005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|004|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P063|004|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|010|009|005R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P090|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 8;
    }
    if (strstr(src,"NID_BG")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|008|000|000O002|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|006|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006R002|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P063|005|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|005|000|000B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P090|004|000|000B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|006|000|000O000|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M006|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|006|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|013|010|006R002|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P049|005|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P063|005|003|002R001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|005|000|000B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|011|009|006R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P090|004|000|000B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P136|004|000|000B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q009|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 15;
    }
    if (strstr(src,"Q_LINKORIENTATION")!=NULL && strlen(src)==17) {
        sprintf(ASV_Buffer,"P005|007|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|014|010|006R002|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_LINKREACTION")!=NULL && strlen(src)==14) {
        sprintf(ASV_Buffer,"P005|008|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|015|010|006R002|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_LOCACC")!=NULL) {
        sprintf(ASV_Buffer,"P005|009|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P005|016|010|006R002|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_VBCO")!=NULL) {
        sprintf(ASV_Buffer,"P006|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_VBCMK")!=NULL) {
        sprintf(ASV_Buffer,"M029|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M028|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P006|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 3;
    }
    if (strstr(src,"T_VBC")!=NULL) {
        sprintf(ASV_Buffer,"M028|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P006|006|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"V_MAIN")!=NULL) {
        sprintf(ASV_Buffer,"P012|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"V_LOA")!=NULL) {
        sprintf(ASV_Buffer,"P012|005|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"T_LOA")!=NULL) {
        sprintf(ASV_Buffer,"P012|006|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_SECTIONTIMER")!=NULL) {
        sprintf(ASV_Buffer,"P012|009|007|002R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P012|009|000|000N007|002R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"T_SECTIONTIMER")!=NULL) {
        sprintf(ASV_Buffer,"P012|010|007|002Z002|001R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002|000|000P012|010|000|000N007|002R002|002O009|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_SECTIONTIMERSTOPLOC")!=NULL) {
        sprintf(ASV_Buffer,"P012|011|007|002Z002|001R002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002|000|003P012|011|000|000N007|002R002|002O009|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_ENDTIMER")!=NULL) {
        sprintf(ASV_Buffer,"P012|010|000|000N007|002R002|002B009|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_ENDTIMER")!=NULL) {
        sprintf(ASV_Buffer,"P012|011|000|000N007|002R002|002B009|002O010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_ENDTIMERSTARTLOC")!=NULL) {
        sprintf(ASV_Buffer,"P012|012|000|000N007|002R002|002B009|002O010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_DANGERPOINT")!=NULL) {
        sprintf(ASV_Buffer,"P012|011|000|000N007|002R002|002B009|002B010|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_DP")!=NULL) {
        sprintf(ASV_Buffer,"P012|012|000|000N007|002R002|002B009|002B010|002O011|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"V_RELEASEDP")!=NULL && strlen(src)==11) {
        sprintf(ASV_Buffer,"P012|013|000|000N007|002R002|002B009|002B010|002O011|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"Q_OVERLAP")!=NULL) {
        sprintf(ASV_Buffer,"P012|012|000|000N007|002R002|002B009|002B010|002B011|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_STARTOL")!=NULL) {
        sprintf(ASV_Buffer,"P012|013|000|000N007|002R002|002B009|002B010|002B011|002O012|001|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"T_OL")!=NULL) {
        sprintf(ASV_Buffer,"P012|014|000|000N007|002R002|002B009|002B010|002B011|002O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_OL")!=NULL) {
        sprintf(ASV_Buffer,"P012|015|000|000N007|002R002|002B009|002B010|002B011|002O012|001|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"V_RELEASEOL")!=NULL && strlen(src)==11) {
        sprintf(ASV_Buffer,"P012|016|000|000N007|002R002|002B009|002B010|002B011|002O012|001|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"Q_GDIR")!=NULL) {
        sprintf(ASV_Buffer,"P021|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P021|009|007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P052|013|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P141|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 5;
    }
    if (strstr(src,"G_A")!=NULL) {
        sprintf(ASV_Buffer,"P021|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P021|010|007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_STATIC")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P027|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P027|009|008|004T004|003N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P027|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P027|009|008|004T004|002N007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"V_STATIC")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P027|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P027|010|008|004T004|003N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P027|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P027|010|008|004T004|002N007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 2;
    }
    if (strstr(src,"Q_FRONT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P027|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|011|008|004T004|003N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|007|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|012|009|004T004|002O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P065|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P027|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|011|008|004T004|002N007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|007|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|012|009|004T004|002O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P065|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 5;
    }
    if (strstr(src,"Q_DIFF")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P027|008|007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|012|008|004T004|003$003|001N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"NC_CDDIFF")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P027|009|007|003Z001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|012|008|004T004|003$003|002N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"NC_DIFF")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P027|009|007|003L001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|012|008|004T004|003$003|002N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P027|008|007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P027|012|008|004T004|002$002|001N007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"V_DIFF")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P027|010|007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P027|012|008|004T004|003$003|003N007|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P027|009|007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P027|012|008|004T004|002$002|002N007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 2;
    }
    if (strstr(src,"D_TRACTION")!=NULL) {
        sprintf(ASV_Buffer,"P039|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_VOLTAGE")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P039|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|007|000|000O004|000O006|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000Z002|002O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000Q011|011|010|001S001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 4;
    }
    if (strstr(src,"NID_CTRACTION")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P039|006|000|000P005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|008|000|000O004|000O006|002P007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000Z002|002L003|000O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002|000Q011|012|010|001L001|000S001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000");
        return 4;
    }
    if (strstr(src,"M_TRACTION")!=NULL && m_version<32) {
        sprintf(ASV_Buffer,"P039|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|007|000|000O004|000O006|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q011|011|010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 3;
    }
    if (strstr(src,"D_CURRENT")!=NULL) {
        sprintf(ASV_Buffer,"P040|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_CURRENT")!=NULL) {
        sprintf(ASV_Buffer,"P040|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_LEVELTR")!=NULL) {
        sprintf(ASV_Buffer,"P041|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_LEVELTR")!=NULL) {
        sprintf(ASV_Buffer,"P041|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|008|007|002R001|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|005|004|001R001|001B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 4;
    }
    if (strstr(src,"NID_STM")!=NULL) {
        if (m_version>=32) {
            sprintf(ASV_Buffer,"M255|002|000|000O000|200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|002|001|002Z001|001R001|001O000|196|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000M014|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M042|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M026|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M200|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|009|007|002Z001|001R001|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P044|004|000|000O003|102|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|006|004|001Z001|001R001|001B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P072|009|000|000O008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|013|000|000B008|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|013|000|000B008|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|015|000|000!010|001O014|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|017|000|000!012|001O016|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q011|012|011|001N010|001S001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 17;
        } else {
            sprintf(ASV_Buffer,"M255|002|000|000O000|200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|002|001|002Z001|001R001|001O000|196|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000M042|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M026|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M200|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|006|000|000O005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P041|009|007|002Z001|001R001|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P044|004|000|000O003|102|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P046|006|004|001Z001|001R001|001B003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000|000P072|009|000|000O008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|013|000|000B008|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|013|000|000B008|001O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|015|000|000!010|001O014|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|017|000|000!012|001O016|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q011|012|011|001N010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 16;
        }
    }
    if (strstr(src,"L_ACKLEVELTR")!=NULL) {
        sprintf(ASV_Buffer,"P041|006|000|000B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P041|009|007|002Z001|001R001|001B005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_RBC")!=NULL) {
        sprintf(ASV_Buffer,"P042|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_RBC")!=NULL) {
        if (m_version>=32) {
            sprintf(ASV_Buffer,"M024|004|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|018|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|018|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 5;
        } else {
            sprintf(ASV_Buffer,"M024|004|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        }
    }
    if (strstr(src,"Q_SLEEPSESSION")!=NULL) {
        sprintf(ASV_Buffer,"P042|010|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|011|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_RADIO")!=NULL) {
        sprintf(ASV_Buffer,"M024|005|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P042|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P131|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q003|003|002|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 6;
    }
    if (strstr(src,"NID_XUSER")!=NULL) {
        sprintf(ASV_Buffer,"P044|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"OTHER_DATA")!=NULL) {
        sprintf(ASV_Buffer,"P044|004|000|000P003|102|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P044|005|000|000O003|102|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q044|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 3;
    }
    if (strstr(src,"NID_MN")!=NULL) {
        sprintf(ASV_Buffer,"M024|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P045|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_TRACKINIT")!=NULL) {
        sprintf(ASV_Buffer,"P051|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P068|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P069|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 5;
    }
    if (strstr(src,"D_TRACKINIT")!=NULL) {
        sprintf(ASV_Buffer,"P051|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P052|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P068|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P069|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P070|005|000|000O004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 4;
    }
    if (strstr(src,"D_AXLELOAD")!=NULL) {
        sprintf(ASV_Buffer,"P051|005|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P051|010|009|004T004|002O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"L_AXLELOAD")!=NULL) {
        sprintf(ASV_Buffer,"P051|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P051|011|009|004T004|002O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"M_AXLELOAD")!=NULL && strlen(src)==10 && m_version<32) {
        sprintf(ASV_Buffer,"P051|009|008|002O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|013|009|004T004|002$002|001O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|007|000|000O004|000O006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000Z002|001O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000Q011|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 5;
    }
    if (strstr(src,"M_AXLELOADCAT")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P051|009|008|002O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P051|013|009|004T004|002$002|001O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|007|000|000O004|000O006|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000Z002|001O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000Q011|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 5;
    }
    if (strstr(src,"V_AXLELOAD")!=NULL) {
        sprintf(ASV_Buffer,"P051|010|008|002O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P051|013|009|004T004|002$002|002O004|000N008|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 2;
    }
    if (strstr(src,"Q_GDIR")!=NULL) {
        sprintf(ASV_Buffer,"P052|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|013|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"G_PBDSR")!=NULL) {
        sprintf(ASV_Buffer,"P052|007|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|014|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_PBDSR")!=NULL) {
        sprintf(ASV_Buffer,"P052|008|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P052|015|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_PBDSR")!=NULL) {
        sprintf(ASV_Buffer,"P052|009|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P052|016|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"L_PBDSR")!=NULL) {
        sprintf(ASV_Buffer,"P052|010|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P052|017|011|006O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"T_MAR")!=NULL) {
        sprintf(ASV_Buffer,"P057|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_TIMEOUTRQST")!=NULL) {
        sprintf(ASV_Buffer,"P057|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_CYCRQST")!=NULL) {
        sprintf(ASV_Buffer,"P057|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_CYCLOC")!=NULL) {
        sprintf(ASV_Buffer,"P058|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_CYCLOC")!=NULL) {
        sprintf(ASV_Buffer,"P058|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_LOC")!=NULL) {
        sprintf(ASV_Buffer,"P058|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_LOC")!=NULL) {
        sprintf(ASV_Buffer,"P058|008|007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_LGTLOC")!=NULL) {
        sprintf(ASV_Buffer,"P058|009|007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_TSR")!=NULL) {
        sprintf(ASV_Buffer,"P065|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P066|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_TSR")!=NULL) {
        sprintf(ASV_Buffer,"P065|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"L_TSR")!=NULL) {
        sprintf(ASV_Buffer,"P065|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"V_TSR")!=NULL) {
        sprintf(ASV_Buffer,"P065|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"D_TRACKCOND")!=NULL) {
        sprintf(ASV_Buffer,"P067|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P067|007|006|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P068|005|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P068|009|008|003O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P069|005|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P069|010|009|004O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 6;
    }
    if (strstr(src,"L_TRACKCOND")!=NULL) {
        sprintf(ASV_Buffer,"P067|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P067|008|006|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P068|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P068|010|008|003O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P069|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P069|011|009|004O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 6;
    }
    if (strstr(src,"M_TRACKCOND")!=NULL) {
        sprintf(ASV_Buffer,"P068|007|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P068|011|008|003O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_PLATFORM")!=NULL) {
        sprintf(ASV_Buffer,"P069|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P069|012|009|004O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_PLATFORM")!=NULL) {
        sprintf(ASV_Buffer,"P069|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P069|013|009|004O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_ADHESION")!=NULL) {
        sprintf(ASV_Buffer,"P071|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"L_ADHESION")!=NULL) {
        sprintf(ASV_Buffer,"P071|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"M_ADHESION")!=NULL) {
        sprintf(ASV_Buffer,"M024|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P071|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_SUITABILITY")!=NULL) {
        sprintf(ASV_Buffer,"P070|005|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P070|008|007|002?002|000O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_SUITABILITY")!=NULL) {
        sprintf(ASV_Buffer,"P070|006|000|000O004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_LINEGAUGE")!=NULL) {
        sprintf(ASV_Buffer,"P070|007|000|000O004|000O006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P070|009|007|002?002|000Z002|000O004|000@006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|001|000");
        return 2;
    }
    if (strstr(src,"Q_TEXTCLASS")!=NULL  && strlen(src)==11) {
        sprintf(ASV_Buffer,"P072|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_TEXTDISPLAY")!=NULL  && strlen(src)==13) {
        sprintf(ASV_Buffer,"P072|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"D_TEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P076|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"M_MODETEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|011|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|011|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 4;
    }
    if (strstr(src,"M_LEVELTEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|012|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|012|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"L_TEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|009|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P076|009|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"T_TEXTDISPLAY")!=NULL) {
        sprintf(ASV_Buffer,"P072|010|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|010|000|000B008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_TEXTCONFIRM")!=NULL  && strlen(src)==13) {
        sprintf(ASV_Buffer,"P072|013|000|000B008|001B012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|013|000|000B008|001B012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_CONFTEXTDISPLAY")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P072|014|000|000B008|001B012|001P013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|014|000|000B008|001B012|001P013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_TEXTREPORT")!=NULL && m_version>=32  && strlen(src)==12) {
        sprintf(ASV_Buffer,"P072|015|000|000B008|001B012|001P013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|015|000|000B008|001B012|001P013|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"NID_TEXTMESSAGE")!=NULL && m_version>=32) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|007|000|000O002|158|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|016|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|016|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|005|000|000O000|158|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P072|016|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P076|016|000|000B008|001B012|001P013|000O015|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 3;
    }
    if (strstr(src,"D_POSOFF")!=NULL) {
        sprintf(ASV_Buffer,"P079|006|000|000B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P079|012|009|006R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_MPOSITION")!=NULL) {
        sprintf(ASV_Buffer,"P079|007|000|000B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|013|009|006R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"M_POSITION")!=NULL) {
        sprintf(ASV_Buffer,"P079|008|000|000B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P079|014|009|006R001|001B004|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"D_MAMODE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P080|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|011|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P080|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|010|009|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"M_MAMODE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P080|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P080|012|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"P080|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P080|011|009|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"V_MAMODE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P080|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P080|013|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"P080|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005P080|012|009|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 2;
    }
    if (strstr(src,"L_MAMODE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P080|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|014|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P080|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|013|009|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"L_ACKMAMODE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"P080|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|015|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        else sprintf(ASV_Buffer,"P080|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003P080|014|009|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 2;
    }
    if (strstr(src,"Q_MAMODE")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"P080|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P080|016|010|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"NID_LX")!=NULL) {
        sprintf(ASV_Buffer,"P088|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_LX")!=NULL) {
        sprintf(ASV_Buffer,"P088|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"L_LX")!=NULL) {
        sprintf(ASV_Buffer,"P088|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_LXSTATUS")!=NULL) {
        sprintf(ASV_Buffer,"P088|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_LX")!=NULL) {
        sprintf(ASV_Buffer,"P088|008|000|000O007|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"Q_STOPLX")!=NULL) {
        sprintf(ASV_Buffer,"P088|009|000|000O007|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"L_STOPLX")!=NULL) {
        sprintf(ASV_Buffer,"P088|010|000|000O007|001O009|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_RBCTR")!=NULL) {
        sprintf(ASV_Buffer,"P131|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_ASPECT")!=NULL) {
        sprintf(ASV_Buffer,"P132|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_RIU")!=NULL) {
        sprintf(ASV_Buffer,"P133|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"NID_RIU")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M005|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 4;
        } else {
            sprintf(ASV_Buffer,"M008|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P133|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P143|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        }
    }
    if (strstr(src,"D_INFILL")!=NULL) {
        sprintf(ASV_Buffer,"P133|011|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"NID_LOOP")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M255|002|000|000O000|204|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P134|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M007|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P134|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        }
    }
    if (strstr(src,"D_LOOP")!=NULL) {
        sprintf(ASV_Buffer,"P134|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"L_LOOP")!=NULL) {
        sprintf(ASV_Buffer,"P134|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"Q_LOOPDIR")!=NULL) {
        sprintf(ASV_Buffer,"P134|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_SSCODE")!=NULL) {
        sprintf(ASV_Buffer,"P134|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_SRSTOP")!=NULL) {
        sprintf(ASV_Buffer,"P137|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_SRSTOP")!=NULL) {
        sprintf(ASV_Buffer,"P137|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_STARTREVERSE")!=NULL) {
        sprintf(ASV_Buffer,"P138|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"L_REVERSEAREA")!=NULL) {
        sprintf(ASV_Buffer,"P138|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"D_REVERSE")!=NULL) {
        sprintf(ASV_Buffer,"P139|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|003");
        return 1;
    }
    if (strstr(src,"V_REVERSE")!=NULL) {
        sprintf(ASV_Buffer,"P139|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"NID_OPERATIONAL")!=NULL) {
        if (m_version>=32) {
            sprintf(ASV_Buffer,"M024|004|000|000@002|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P140|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q005|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M024|004|000|000@002|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000P140|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q005|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q011|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 4;
        }
    }
    if (strstr(src,"G_TSR")!=NULL) {
        sprintf(ASV_Buffer,"P141|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_LSSMA")!=NULL) {
        sprintf(ASV_Buffer,"P141|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"T_LSSMA")!=NULL) {
        sprintf(ASV_Buffer,"P141|004|000|000O003|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_LRBG")!=NULL) {
        sprintf(ASV_Buffer,"Q256|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002Q001|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002");
        return 2;
    }
    if (strstr(src,"Q_DIRLRBG")!=NULL && strlen(src)==9) {
        sprintf(ASV_Buffer,"Q256|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"Q_DLRBG")!=NULL) {
        sprintf(ASV_Buffer,"Q256|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"L_DOUBTOVER")!=NULL) {
        sprintf(ASV_Buffer,"Q256|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002Q001|010|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002");
        return 2;
    }
    if (strstr(src,"L_DOUBTUNDER")!=NULL) {
        sprintf(ASV_Buffer,"Q256|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002Q001|011|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002");
        return 2;
    }
    if (strstr(src,"Q_LENGTH")!=NULL) {
        sprintf(ASV_Buffer,"Q256|010|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|012|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"L_TRAININT")!=NULL) {
        sprintf(ASV_Buffer,"Q256|011|000|000O010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|011|000|000O010|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|013|000|000O012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|013|000|000O012|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 4;
    }
    if (strstr(src,"V_TRAIN")!=NULL) {
        sprintf(ASV_Buffer,"Q256|011|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005Q001|013|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 2;
    }
    if (strstr(src,"Q_DIRTRAIN")!=NULL && strlen(src)==10) {
        sprintf(ASV_Buffer,"Q256|012|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|014|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_MODE")!=NULL && strlen(src)==6) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M255|001|000|000O000|199|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M199|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|013|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|015|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 4;
        } else {
            sprintf(ASV_Buffer,"M199|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|013|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|015|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        }
    }
    if (strstr(src,"M_LEVEL")!=NULL && strlen(src)==7) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M255|002|001|002R001|001O000|196|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|001|000|000O000|200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|014|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|016|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 5;
        } else {
            sprintf(ASV_Buffer,"M200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q256|014|000|000!010|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q001|016|000|000!012|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        }
    }
    if (strstr(src,"M_ERROR")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M255|003|000|000O000|199|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M012|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M013|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q004|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 4;
        } else {
            sprintf(ASV_Buffer,"M012|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M013|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000Q004|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        }
    }
    if (strstr(src,"NC_CDTRAIN")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"Q011|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NC_TRAIN")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"Q011|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"Q011|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"L_TRAIN")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"Q011|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"Q011|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_MAXTRAIN")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"Q011|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        else sprintf(ASV_Buffer,"Q011|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"M_LOADINGGAUGE")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"Q011|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"Q011|007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
        return 1;
    }
    if (strstr(src,"M_AIRTIGHT")!=NULL) {
        if (m_version>=32) sprintf(ASV_Buffer,"Q011|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"Q011|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"N_AXLE")!=NULL && m_version>=32) {
        sprintf(ASV_Buffer,"Q011|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_UPDOWN")!=NULL) {
        sprintf(ASV_Buffer,"M006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_MCOUNT")!=NULL) {
        sprintf(ASV_Buffer,"M006|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_MEDIA")!=NULL) {
        sprintf(ASV_Buffer,"M006|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M007|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"N_PIG")!=NULL) {
        sprintf(ASV_Buffer,"M006|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"N_TOTAL")!=NULL) {
        sprintf(ASV_Buffer,"M006|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_DUP")!=NULL) {
        sprintf(ASV_Buffer,"M006|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_LINK")!=NULL && strlen(src)==6) {
        sprintf(ASV_Buffer,"M006|009|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_MANUEL_AUTO")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M255|003|000|000O000|200|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|002|000|000O000|199|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M199|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M200|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 4;
        } else {
            sprintf(ASV_Buffer,"M199|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M200|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        }
    }
    if (strstr(src,"M_BRAKE_STATE")!=NULL) {
        sprintf(ASV_Buffer,"M003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_DRIVERACTIONS")!=NULL) {
        sprintf(ASV_Buffer,"M011|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_PERMITTED")!=NULL) {
        sprintf(ASV_Buffer,"M198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_TARGET")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M198|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002M020|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|006|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M198|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|002M020|005|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        }
    }
    if (strstr(src,"Q_SCALE")!=NULL) {
        sprintf(ASV_Buffer,"M198|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_TARGET")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M198|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M020|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M255|005|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M198|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M020|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 2;
        }
    }
    if (strstr(src,"V_RELEASE")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M198|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M020|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M255|007|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 3;
        } else {
            sprintf(ASV_Buffer,"M198|004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M020|006|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 2;
        }
    }
    if (strstr(src,"Q_MARQSTREASON")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|007|000|000O002|132|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|005|000|000O000|132|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_EM")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|009|000|000O002|018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|007|000|000O002|147|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M008|007|000|000O000|018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|018|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|016|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M010|005|000|000O000|147|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 7;
    }
    if (strstr(src,"Q_EMERGENCYSTOP")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|008|000|000O002|147|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|006|000|000O000|147|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_INFILL")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|009|000|000O002|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|007|000|000O000|153|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_STATUS")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M010|007|000|000O002|157|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M010|005|000|000O000|157|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"D_SR")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M025|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|010|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M009|010|000|000O002|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009");
        else sprintf(ASV_Buffer,"M025|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|008|000|000O000|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M009|008|000|000O000|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007");
        return 3;
    }
    if (strstr(src,"D_REF")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|010|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M008|010|000|000O002|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M008|011|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|010M009|010|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M009|010|000|000O002|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M009|011|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|010");
        else sprintf(ASV_Buffer,"M008|008|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M008|008|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M008|009|010|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|008M009|008|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M009|008|000|000O000|033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M009|009|010|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|008");
        return 6;
    }
    if (strstr(src,"Q_DIR")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|011|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|012|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|011|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|012|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M008|009|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|010|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|010|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 4;
    }
    if (strstr(src,"D_EMERGENCYSTOP")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|013|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|010M009|013|000|000O002|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|010");
        else sprintf(ASV_Buffer,"M008|011|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|008M009|011|000|000O000|015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|008");
        return 2;
    }
    if (strstr(src,"D_TAFDISPLAY")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|012|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M009|012|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009");
        else sprintf(ASV_Buffer,"M008|010|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M009|010|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007");
        return 2;
    }
    if (strstr(src,"L_TAFDISPLAY")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|013|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009M009|013|000|000O002|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|009");
        else sprintf(ASV_Buffer,"M008|011|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007M009|011|000|000O000|034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|007");
        return 2;
    }
    if (strstr(src,"Q_ORIENTATION")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|009|000|000O002|045|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|045|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M008|007|000|000O000|045|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|045|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"T_TRAIN")!=NULL) {
        if (isBL3 && !isVelaro) sprintf(ASV_Buffer,"M008|009|000|000O002|028|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|027|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|009|000|000O002|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|028|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|027|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|009|000|000O002|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        else sprintf(ASV_Buffer,"M008|007|000|000O000|028|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|027|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M008|007|000|000O000|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|028|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|027|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M009|007|000|000O000|008|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 6;
    }
    if (strstr(src,"M_BRAKE_COMMAND_STATE")!=NULL) {
        sprintf(ASV_Buffer,"M004|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_COLD_MVT")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M015|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"INH_STATE")!=NULL && strlen(src)==9 && isBL3) {
        sprintf(ASV_Buffer,"M255|003|001|002R001|001O000|196|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_SDMTYPE")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M020|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|001|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        } else {
            sprintf(ASV_Buffer,"M020|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 1;
        }
    }
    if (strstr(src,"M_SDMSUPSTAT")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M020|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|002|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        } else {
            sprintf(ASV_Buffer,"M020|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 1;
        }

    }
    if (strstr(src,"V_PERM")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M020|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M255|003|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
            return 2;
        } else {
            sprintf(ASV_Buffer,"M020|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 1;
        }
    }
    if (strstr(src,"V_SBI")!=NULL) {
        if (isBL3 && !isVelaro) {
            sprintf(ASV_Buffer,"M020|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005M255|004|000|000O000|198|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 2;
        } else {
            sprintf(ASV_Buffer,"M020|003|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000*005");
            return 1;
        }
    }
    if (strstr(src,"DMI_SYMB_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M021|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"DMI_SOUND_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M022|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"SYSTEM_STATUS_MESSAGE")!=NULL) {
        sprintf(ASV_Buffer,"M023|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_RBCENTRY")!=NULL) {
        sprintf(ASV_Buffer,"M024|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_TEXT_DMI")!=NULL && isBL3 && strlen(src)==10) {
        sprintf(ASV_Buffer,"M255|001|000|000O000|201|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|001|000|000O000|202|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"V_SR")!=NULL) {
        sprintf(ASV_Buffer,"M025|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_SLEEPING")!=NULL) {
        sprintf(ASV_Buffer,"M030|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_PASSIVE_SHUNTING")!=NULL) {
        sprintf(ASV_Buffer,"M031|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_NON_LEADING")!=NULL) {
        sprintf(ASV_Buffer,"M032|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_RB_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M033|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_MSB_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M034|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_ECB_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M035|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_EP_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M036|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_AB_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M037|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_CAB_A_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M038|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Q_CAB_B")!=NULL) {
        sprintf(ASV_Buffer,"M038|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"Z_EXPL")!=NULL) {
        sprintf(ASV_Buffer,"M197|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000M255|001|000|000O000|197|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 2;
    }
    if (strstr(src,"M_CAB_B_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M038|002|000|000O001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_DIRECTION_CONTROLLER")!=NULL) {
        sprintf(ASV_Buffer,"M039|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_TRACTION_STATUS")!=NULL) {
        sprintf(ASV_Buffer,"M040|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_TRAIN_DATA_ENTRY")!=NULL) {
        sprintf(ASV_Buffer,"M041|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_NATIONAL_SYSTEM_ISOLATION")!=NULL) {
        sprintf(ASV_Buffer,"M042|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_TCO_COMMAND_STATE")!=NULL) {
        sprintf(ASV_Buffer,"M043|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"V_LSSMA")!=NULL) {
        sprintf(ASV_Buffer,"M044|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_STMEVENT")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M014|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_DISCSENDER")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M014|002|000|000O001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"M_DISCTYPE")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M014|003|000|000O001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"STM_SYSTEM_STATUS_MESSAGE")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M014|002|000|000O001|001|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_STMPACKET")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M014|002|000|000O001|002|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"NID_OBP_MESSAGE")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M255|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    if (strstr(src,"BLTM_ACTIVE")!=NULL && isBL3) {
        sprintf(ASV_Buffer,"M255|004|000|000O000|204|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000|000");
        return 1;
    }
    return 0;
}

int get_ASV_switch_offset(int count, int pos, int m_version) {
    int i,j, result=0, index, offset, marker, next_index, next_offset, next_marker;
    int switch_clustered_index=-1,switch_clustered_offset=-1;
    int switch_stored_value=-1,switch_application_criteria,switch_application_offset,store_next_index;
    for (i=17;i<=105;i+=8) {
        next_marker=0;
        marker = ASV_Buffer[count*ASV_location_size+i-1];
        index = Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])];
        offset = atoi(&ASV_Buffer[count*ASV_location_size+i+4]);
        if (marker=='|') break;
        if (marker=='O' && abs(index)!=offset) return -1;
        if (marker=='P' && abs(index)==offset) return -1;
        if (marker=='T') {switch_clustered_index=atoi(&ASV_Buffer[count*ASV_location_size+i]); switch_clustered_offset=offset;}
        if (marker=='X') switch_stored_value=offset;
        if (marker=='Y') {switch_application_criteria = atoi(&ASV_Buffer[count*ASV_location_size+i]); switch_application_offset = offset;}
        else if ((marker=='A' && index==0) || (marker=='B' && index==1) || (marker=='C' && index!=0) || (marker=='!' && (index==1 || index==2))) result+=offset;
        else if (marker=='@') {
            if (index!=3) {
                if (m_version>=32) {
                    result++;
                    if (index==2 && Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])]!=0) result++;
                } else result++;
            }
        }
        else if (marker=='K' && index==offset) result++;
        else if (marker=='N') {
            next_marker = ASV_Buffer[count*ASV_location_size+i+7];
            int mem_pos = i;
            while(next_marker>='Q' && next_marker<='Z') {
                next_offset = atoi(&ASV_Buffer[count*ASV_location_size+i+12]);
                for (j=0;j<index;j++) {
                    store_next_index = Message_Details_Storage[pos+result+j*offset+switch_stored_value+atoi(&ASV_Buffer[count*ASV_location_size+mem_pos])];
                    next_index = Message_Details_Storage[pos+result+j*offset+atoi(&ASV_Buffer[count*ASV_location_size+i+8])+atoi(&ASV_Buffer[count*ASV_location_size+mem_pos])];
                    if ((next_marker=='Q' && next_index==0) || (next_marker=='R' && next_index==1) || (next_marker=='S' && next_index!=0) || (next_marker=='@' && next_index==2)) result+=next_offset;
                    if (switch_clustered_index>=0) {
                        next_index = Message_Details_Storage[pos+result+j*offset+switch_clustered_index+atoi(&ASV_Buffer[count*ASV_location_size+mem_pos])];
                        result+=next_index*switch_clustered_offset;
                        if (switch_application_criteria==store_next_index && switch_stored_value>=0) result+=next_index*switch_application_offset;
                    }
                }
                i=i+8;
                if (i>97) break;
                next_marker = ASV_Buffer[count*ASV_location_size+i+7];
            }
            result+=offset*index;
        }
        else if ((marker=='D' && index==0) || (marker=='E' && index==1) || (marker=='F' && index!=0)) {
            result+=offset;
            next_marker = ASV_Buffer[count*ASV_location_size+i+7];
            next_index = Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i+8])];
            next_offset = atoi(&ASV_Buffer[count*ASV_location_size+i+12]);
        }
        if ((next_marker=='G' && index==0) || (next_marker=='H' && index==1) || (next_marker=='I' && index!=0)) {
            result+=next_offset;
        }
        if (next_marker=='J') result+=next_offset*next_index;
    }
    return result;
}

int get_asv_target_iter_offset_before(int count, int pos, int result, int m_version) {
    int i,j, index, offset, marker,switcher=atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*count])-atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*count]);
    int next_marker,next_index, next_offset;
    int mem_pos;
    ASV_Stored_Value=-1;
    ASV_Clustered_inter=0;
    ASV_Clustered_offset=0;
    bool inverter = false;
    bool erase_stored_value = false;
    for (i=17;i<=105;i+=8) {
        marker = ASV_Buffer[count*ASV_location_size+i-1];
        if ((marker<'Q' || marker>'Z') && marker!='L' && marker!='$' && marker!='?') break;
        index = Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])];
        offset = atoi(&ASV_Buffer[count*ASV_location_size+i+4]);
        if (marker=='X' && ASV_Stored_Value==-1) ASV_Stored_Value = index;
        if (marker=='$') {ASV_Clustered_inter=offset; ASV_Clustered_offset=atoi(&ASV_Buffer[count*ASV_location_size+i]);}
        if ((marker=='Z' && index!=offset) || (marker=='L' && index==offset)) inverter = true;
        if (switcher>atoi(&ASV_Buffer[count*ASV_location_size+i])) {
            if ((marker=='Q' && index==0) || (marker=='R' && index==1) || (marker=='S' && index!=0)) result+=offset;
            if (marker=='?') {
                if (index!=3) {
                    if (m_version>=32) {
                        result++;
                        if (index==2 && Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])]!=0) result++;
                    } else result++;
                }
            }
            if (marker=='T') {
                next_marker = ASV_Buffer[count*ASV_location_size+i+7];
                mem_pos = i;
                while(next_marker>='U' && next_marker<='Y') {
                    next_offset = atoi(&ASV_Buffer[count*ASV_location_size+i+12]);
                    for (j=0;j<index;j++) {
                        next_index = Message_Details_Storage[pos+result+j*offset+atoi(&ASV_Buffer[count*ASV_location_size+i+8])+atoi(&ASV_Buffer[count*ASV_location_size+mem_pos])];
                        if ((next_marker=='U' && next_index==0) || (next_marker=='V' && next_index==1) || (next_marker=='W' && next_index!=0)) result+=next_offset;
                        if (next_marker=='Y' && ASV_Stored_Value==atoi(&ASV_Buffer[count*ASV_location_size+i+8])) {result+=next_offset; erase_stored_value = true;}
                    }
                    i=i+8;
                    if (i>97) break;
                    next_marker = ASV_Buffer[count*ASV_location_size+i+7];
                }
                result+=index*offset;
            }
        }
    }
    if (erase_stored_value) ASV_Stored_Value=-1;
    if (inverter) result-=9999999;
    return result;
}

int get_asv_target_iter_offset_after(int count, int pos, int result, int m_version) {
    int i,j,index, offset, marker,switcher=atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*count])-atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*count]);
    int next_marker,next_index, next_offset;
    int mem_pos;
    bool erase_stored_value = false;
    for (i=17;i<=105;i+=8) {
        marker = ASV_Buffer[count*ASV_location_size+i-1];
        if ((marker<'Q' || marker>'Z') && marker!='L' && marker!='$' && marker!='?') break;
        index = Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])];
        offset = atoi(&ASV_Buffer[count*ASV_location_size+i+4]);
        if (marker=='X' && ASV_Stored_Value==-1) ASV_Stored_Value = index;
        if (switcher<=atoi(&ASV_Buffer[count*ASV_location_size+i])) {
            if ((marker=='Q' && index==0) || (marker=='R' && index==1) || (marker=='S' && index!=0)) result+=offset;
            if (marker=='?') {
                if (index!=3) {
                    if (m_version>=32) {
                        result++;
                        if (index==2 && Message_Details_Storage[pos+result+atoi(&ASV_Buffer[count*ASV_location_size+i])]!=0) result++;
                    } else result++;
                }
            }
            if (marker=='T') {
                next_marker = ASV_Buffer[count*ASV_location_size+i+7];
                mem_pos = i;
                while(next_marker>='U' && next_marker<='Y') {
                    next_offset = atoi(&ASV_Buffer[count*ASV_location_size+i+12]);
                    for (j=0;j<index;j++) {
                        next_index = Message_Details_Storage[pos+result+j*offset+atoi(&ASV_Buffer[count*ASV_location_size+i+8])+atoi(&ASV_Buffer[count*ASV_location_size+mem_pos])];
                        if ((next_marker=='U' && next_index==0) || (next_marker=='V' && next_index==1) || (next_marker=='W' && next_index!=0)) result+=next_offset;
                        if (next_marker=='Y' && ASV_Stored_Value==atoi(&ASV_Buffer[count*ASV_location_size+i+8])) result+=next_offset;
                        erase_stored_value = true;
                    }
                    i=i+8;
                    if (i>97) break;
                    next_marker = ASV_Buffer[count*ASV_location_size+i+7];
                }
                result+=index*offset;
            }
        }
    }
    if (erase_stored_value) ASV_Stored_Value=-1;
    return result;
}

void sequence_expand(int pos, int pos_d, HWND TargetWindow) {
    int i,retroactive_detail,m_version;
    for (i=pos-1;i>=0;i--) {
        retroactive_detail = SendMessage(TargetWindow,LB_GETITEMDATA,i,0);
        if (retroactive_detail<0) {
            m_version = Message_Details_Storage[SendMessage(MessageWindow,LB_GETITEMDATA,-retroactive_detail,0)-version_detail_offset];
            break;
        }
    }
    target_window_index=pos+1;
    packet_offset = pos_d%100000000;
    int index = (int)(pos_d/100000000);
    if (index==6 || index==9) D_track_to_train_packet(-Message_Details_Storage[packet_offset-1],TargetWindow,false,m_version);
    else if (index==8) D_train_to_track_packet(-Message_Details_Storage[packet_offset-1],TargetWindow,false,m_version);
}

void sequence_expand_all(HWND TargetWindow) {
    SendMessage(TargetWindow,WM_SETREDRAW,0,0);
    int i,detail,next_detail;
    int count = SendMessage(TargetWindow,LB_GETCOUNT,0,0)-1;
    if (TargetWindow==SequenceListWindow1) ShowWindow(SequenceExportProgressWindow1,SW_NORMAL); else ShowWindow(SequenceExportProgressWindow2,SW_NORMAL);
    for (i=0;i<=count;i++) {
        detail = SendMessage(TargetWindow,LB_GETITEMDATA,i,0);
        if (detail>0) {
            if (i!=count) next_detail = SendMessage(TargetWindow,LB_GETITEMDATA,i+1,0); else next_detail=-1;
            if (next_detail!=0) {
                sequence_expand(i,detail,TargetWindow);
                count = SendMessage(TargetWindow,LB_GETCOUNT,0,0)-1;
            }
        }
        if (TargetWindow==SequenceListWindow1) SendMessage(SequenceExportProgressWindow1,PBM_SETPOS,100*i/count,0);
    }
    if (TargetWindow==SequenceListWindow1) ShowWindow(SequenceExportProgressWindow1,SW_HIDE); else ShowWindow(SequenceExportProgressWindow2,SW_HIDE);
    SendMessage(TargetWindow,WM_SETREDRAW,1,0);
}

void sequence_collapse(int pos, HWND TargetWindow) {
    int i,detail;
    int count = SendMessage(TargetWindow,LB_GETCOUNT,0,0)-1;
    for (i=pos+1;i<=count;i++) {
        detail = SendMessage(TargetWindow,LB_GETITEMDATA,i,0);
        if (detail == 0) {SendMessage(TargetWindow,LB_DELETESTRING,i,0); i=i-1;}
        else break;
    }
}

void sequence_collapse_all(HWND TargetWindow) {
    SendMessage(TargetWindow,WM_SETREDRAW,0,0);
    int i,detail;
    int count = SendMessage(TargetWindow,LB_GETCOUNT,0,0)-1;
    for (i=0;i<=count;i++) {
        detail = SendMessage(TargetWindow,LB_GETITEMDATA,i,0);
        if (detail == 0) {SendMessage(TargetWindow,LB_DELETESTRING,i,0); i=i-1;}
    }
    SendMessage(TargetWindow,WM_SETREDRAW,1,0);
}

void Track_To_Train_message_Name(HWND TargetWindow, int nid_message, int item_data) {
    switch(nid_message) {
        case 2:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SR AUTHORISATION"),item_data);
        break;
        case 3:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"MOVEMENT AUTHORITY"),item_data);
        break;
        case 6:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RECOGNITION OF EXIT FROM TRIP MODE"),item_data);
        break;
        case 8:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ACKNOWLEDGEMENT OF TRAIN DATA"),item_data);
        break;
        case 9:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REQUEST TO SHORTEN MA"),item_data);
        break;
        case 15:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"CONDITIONAL EMERGENCY STOP"),item_data);
        break;
        case 16:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"UNCONDITIONAL EMERGENCY STOP"),item_data);
        break;
        case 18:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REVOCATION OF EMERGENCY STOP"),item_data);
        break;
        case 24:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"GENERAL MESSAGE"),item_data);
        break;
        case 27:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SH REFUSED"),item_data);
        break;
        case 28:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SH AUTHORISED"),item_data);
        break;
        case 32:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RBC/RIU SYSTEM VERSION"),item_data);
        break;
        case 33:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"MA WITH SHIFTED LOCATION REFERENCE"),item_data);
        break;
        case 34:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK AHEAD FREE REQUEST"),item_data);
        break;
        case 37:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INFILL MA"),item_data);
        break;
        case 38:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INITIATION OF A COMMUNICATION SESSION"),item_data);
        break;
        case 39:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ACKNOWLEDGEMENT OF TERMINATION OF A COMMUNICATION SESSION"),item_data);
        break;
        case 40:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRAIN REJECTED"),item_data);
        break;
        case 41:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRAIN ACCEPTED"),item_data);
        break;
        case 43:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SOM POSITION REPORT CONFIRMED BY RBC"),item_data);
        break;
        case 45:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ASSIGNEMENT OF COORDINATE SYSTEM"),item_data);
        break;
        default:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"UNKNOWN"),item_data);
        break;
    }
}

void Train_To_Track_message_Name(HWND TargetWindow, int nid_message, int item_data) {
    switch(nid_message) {
        case 129:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"VALIDATED TRAIN DATA"),item_data);
        break;
        case 130:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REQUEST FOR SHUNTING"),item_data);
        break;
        case 132:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"MA REQUEST"),item_data);
        break;
        case 136:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRAIN POSITION REPORT"),item_data);
        break;
        case 137:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REQUEST TO SHORTEN MA IS GRANTED"),item_data);
        break;
        case 138:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REQUEST TO SHORTEN MA IS REJECTED"),item_data);
        break;
        case 146:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ACKNOWLEDGEMENT"),item_data);
        break;
        case 147:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ACKNOWLEDGEMENT OF EMERGENCY STOP"),item_data);
        break;
        case 149:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK AHEAD FREE GRANTED"),item_data);
        break;
        case 150:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"END OF MISSION"),item_data);
        break;
        case 153:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RADIO INFILL REQUEST"),item_data);
        break;
        case 154:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"NO COMPATIBLE VERSION SUPPORTED"),item_data);
        break;
        case 155:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INITIATION OF A COMMUNICATION SESSION"),item_data);
        break;
        case 156:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TERMINATION OF A COMMUNICATION SESSION"),item_data);
        break;
        case 157:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SOM POSITION REPORT"),item_data);
        break;
        case 158:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TEXT MESSAGE ACKNOWLEDGED BY DRIVER"),item_data);
        break;
        case 159:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SESSION ESTABLISHED"),item_data);
        break;
        default:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"UNKNOWN"),item_data);
        break;
    }
}

void Train_To_Track_Packet_Name(HWND TargetWindow, int nid_packet, int item_data) {
    switch(nid_packet) {
        case 256:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"POSITION REPORT"),item_data);
        break;
        case 1:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"POSITION REPORT BASED ON TWO BALISE GROUPS"),item_data);
        break;
        case 3:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"ONBOARD TELEPHONE NUMBER"),item_data);
        break;
        case 4:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"ERROR REPORTING"),item_data);
        break;
        case 5:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"TRAIN RUNNING NUMBER"),item_data);
        break;
        case 9:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"LEVEL 2/3 TRANSITION INFORMATION"),item_data);
        break;
        case 11:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"VALIDATED TRAIN DATA"),item_data);
        break;
        case 44:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"DATA USED BY APPLICATION OUTSIDE THE ERTMS/ETCS SYSTEM"),item_data);
        break;
        default:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"UNKNOWN"),item_data);
        break;
    }
}

void Track_To_Train_Packet_Name(HWND TargetWindow, int nid_packet, int item_data) {
    switch(nid_packet) {
        case 256:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"VIRTUAL BALISE COVER MARKER"),item_data);
        break;
        case 2:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SYSTEM VERSION ORDER"),item_data);
        break;
        case 3:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"NATIONAL VALUES"),item_data);
        break;
        case 5:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LINKING"),item_data);
        break;
        case 6:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"VIRTUAL BALISE COVER ORDER"),item_data);
        break;
        case 12:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LEVEL 1 MOVEMENT AUTHORITY"),item_data);
        break;
        case 13:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"STAFF RESPONSIBLE DISTANCE INFORMATION FROM LOOP"),item_data);
        break;
        case 15:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LEVEL 2/3 MOVEMENT AUTHORITY"),item_data);
        break;
        case 16:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REPOSITIONING INFORMATION"),item_data);
        break;
        case 21:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"GRADIENT PROFILE"),item_data);
        break;
        case 27:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INTERNATIONAL STATIC SPEED PROFILE"),item_data);
        break;
        case 39:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK CONDITION CHANGE OF TRACTION SYSTEM"),item_data);
        break;
        case 40:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK CONDITION CHANGE OF ALLOWED CURRENT CONSUMPTION"),item_data);
        break;
        case 41:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LEVEL TRANSITION ORDER"),item_data);
        break;
        case 42:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SESSION MANAGEMENT"),item_data);
        break;
        case 44:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"DATA USED BY APPLICATION OUTSIDE THE ERTMS/ETCS SYSTEM"),item_data);
        break;
        case 45:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RADIO NETWORK REGISTRATION"),item_data);
        break;

        case 46:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"CONDITIONAL LEVEL TRANSITION ORDER"),item_data);
        break;
        case 49:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LIST OF BALISES FOR SH AREA"),item_data);
        break;
        case 51:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"AXLE LOAD SPEED PROFILE"),item_data);
        break;
        case 52:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"PERMITTED BRAKING DISTANCE INFORMATION"),item_data);
        break;
        case 57:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"MOVEMENT AUTHORITY REQUEST PARAMETERS"),item_data);
        break;
        case 58:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"POSITION REPORT PARAMATERS"),item_data);
        break;
        case 63:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LIST OF BALISES IN SR AUTHORITY"),item_data);
        break;
        case 64:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INHIBITION OF REVICABLE TSRs FROM BALISES IN L2/3"),item_data);
        break;
        case 65:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TEMPORARY SPEED RESTRICTION"),item_data);
        break;
        case 66:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TEMPORARY SPEED RESTRICTION REVOCATION"),item_data);
        break;
        case 67:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK CONDITION BIG METAL MASSES"),item_data);
        break;
        case 68:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK CONDITION"),item_data);
        break;
        case 69:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK CONDITION STATION PLATFORM"),item_data);
        break;
        case 70:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ROUTE SUITABILITY DATA"),item_data);
        break;
        case 71:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"ADHESION FACTOR"),item_data);
        break;
        case 72:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"PACKET FOR SENDING PLAIN TEXT MESSAGES"),item_data);
        break;
        case 76:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"PACKET FOR SENDING FIXED TEXT MESSAGES"),item_data);
        break;
        case 79:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"GEOGRAPHICAL POSITION INFORMATION"),item_data);
        break;
        case 80:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"MODE PROFILE ASSOCIATED TO AN MA"),item_data);
        break;
        case 88:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LEVEL CROSSING INFORMATION"),item_data);
        break;
        case 90:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRACK AHEAD FREE UP TO LEVEL 2/3 TRANSITION LOCATION"),item_data);
        break;
        case 131:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RBC TRANSITION ORDER"),item_data);
        break;
        case 132:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"DANGER FOR SHUNTING INFORMATION"),item_data);
        break;
        case 133:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"RADIO INFILL AREA INFORMATION"),item_data);
        break;
        case 134:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"EOLM PACKET"),item_data);
        break;
        case 135:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"STOP SHUNTING ON DESK OPENING"),item_data);
        break;
        case 136:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INFILL LOCATION REFERENCE"),item_data);
        break;
        case 137:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"STOP IF IN STAFF RESPONSIBLE"),item_data);
        break;
        case 138:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REVERSING AREA INFORMATION"),item_data);
        break;
        case 139:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"REVERSING SUPERVISION INFORMATION"),item_data);
        break;
        case 140:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"TRAIN RUNNING NUMBER FROM RBC"),item_data);
        break;
        case 141:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"DEFAULT GRADIENT FOR TEMPORARY SPEED RESTRICTION"),item_data);
        break;
        case 143:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"SESSION MANAGEMENT WITH NEIGHBOURING RADIO INFILL UNIT"),item_data);
        break;
        case 145:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"INHIBITION OF BALISE GROUP MESSAGE CONSISTENCY REACTION"),item_data);
        break;
        case 180:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"LSSMA DISPLAY TOGGLE ORDER"),item_data);
        break;
        case 181:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"GENERIC BALISE, LOOP OR RIU INFORMATION"),item_data);
        break;
        case 203:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"NATIONAL VALUES FOR BREAKING CURVES"),item_data);
        break;
        case 254:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"DEFAULT BALISE, LOOP OR RIU INFORMATION"),item_data);
        break;
        default:
            SendMessage(TargetWindow,LB_SETITEMDATA,SendMessage(TargetWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"UNKNOWN"),item_data);
        break;
    }
}

int track_bg_distance(int count,int balise_1,int balise_2) {
    if (balise_1==balise_2) return 0;
    int max = count;
    if (max>Max_Number_Of_Retroactive_Balise) max = Max_Number_Of_Retroactive_Balise;
    int i;
    int distance = 0;
    for (i=1;i<(max/3);i++) {
        if (Inter_Balise_Distance[count-3*i+1]==balise_2) {
            if (Inter_Balise_Distance[count-3*i]==balise_1) {
                return Inter_Balise_Distance[count-3*i+2];
            } else if (Inter_Balise_Distance[count-3*i]==Inter_Balise_Distance[count-3*i+4]) {
                distance=Inter_Balise_Distance[count-3*i+2];
            } else if (Inter_Balise_Distance[count-3*i]!=Inter_Balise_Distance[count-3*i+4]) {
                distance = 0;
            }
        } else if (Inter_Balise_Distance[count-3*i]==balise_1 && distance>0) {
            distance+=Inter_Balise_Distance[count-3*i+2];
            return distance;
        }
    }
    return -1;

}

void merge_linking() {
    int i = 50;
    for (i=0;i<50;i++) {
        Linked_Balise_Storage[i]=New_Linked_Balise_Storage[i];
        New_Linked_Balise_Storage[i]=0;
    }
    Linked_Balise_Count = New_Linked_Balise_Count;
    New_Linked_Balise_Count = 0;
}

void Init_Log() {
    int log_count = SendMessage(LogListWindow,LB_GETCOUNT,0,0);
    int i;
    for (i=0;i<log_count;i++) {
        SendMessage(LogListWindow,LB_SETITEMDATA,i,-1);
    }
}

void Init_Help() {
    ShowWindow(PacketListWindow_1,0);
    ShowWindow(PacketListWindow_2,0);
    ShowWindow(MessageListWindow_1,0);
    ShowWindow(MessageListWindow_2,0);
    ShowWindow(LogListWindow,0);
    ShowWindow(ReportWindow,0);
    ShowWindow(SendReportButtonWindow,0);
    SendMessage(PacketListButtonWindow_1,BM_SETCHECK,0,0);
    SendMessage(PacketListButtonWindow_2,BM_SETCHECK,0,0);
    SendMessage(MessageListButtonWindow_1,BM_SETCHECK,0,0);
    SendMessage(MessageListButtonWindow_2,BM_SETCHECK,0,0);
    SendMessage(LogListButtonWindow,BM_SETCHECK,0,0);
    SendMessage(ReportButtonWindow,BM_SETCHECK,0,0);
    SendMessage(SendReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEND_REPORT_BUTTON);
}

time_t get_time_t (SYSTEMTIME time) {
    struct tm tm_time = {0};
    tm_time.tm_mday = time.wDay;
    tm_time.tm_mon = time.wMonth-1;
    tm_time.tm_year = time.wYear-1900;
    tm_time.tm_hour = time.wHour;
    tm_time.tm_min = time.wMinute;
    tm_time.tm_sec = time.wSecond;
    tm_time.tm_isdst = -1;
    return mktime(&tm_time);
}

void VLC_List_Fill() {
    SendMessage(MediaListWindow,LB_RESETCONTENT,0,0);
    int length = strlen(VLC_Buffer);
    int file_length;
    if (VLC_Buffer[length-1]!='\\') {
        VLC_Buffer[length]='\\';
        length++;
    }
    VLC_Buffer[length]='*';
    VLC_Buffer[length+1]='.';
    VLC_Buffer[length+2]='*';
    VLC_Buffer[length+3]='\0';
    SendMessage(FolderViewWindow,LB_RESETCONTENT,0,0);
    hFind = FindFirstFile(VLC_Buffer, &data);
    if (hFind != INVALID_HANDLE_VALUE) {
    do {
        if (data.cFileName[0]!='.') {
            file_length=strlen(data.cFileName);
            if (file_length<5) continue;
            if (data.cFileName[file_length-1]=='4' && data.cFileName[file_length-2]=='p' && data.cFileName[file_length-3]=='m' && data.cFileName[file_length-4]=='.') SendMessage(MediaListWindow,LB_SETSEL,1,SendMessage(MediaListWindow,LB_ADDSTRING,0,(LPARAM)data.cFileName));
            if (data.cFileName[file_length-1]=='i' && data.cFileName[file_length-2]=='v' && data.cFileName[file_length-3]=='a' && data.cFileName[file_length-4]=='.') SendMessage(MediaListWindow,LB_SETSEL,1,SendMessage(MediaListWindow,LB_ADDSTRING,0,(LPARAM)data.cFileName));
        }
    } while (FindNextFile(hFind, &data));
    FindClose(hFind);
    }
    VLC_Buffer[length]='\0';
}

long power(int degree)
{
    long result = 1;
    long term = 2;
    while (degree)
    {
        if (degree & 1)
            result *= term;
        term *= term;
        degree >>= 1;
    }
    return result;
}

long bindec(int length) {
    int i;
    long result=0;
        for (i=0;i<length;i++) {
            if ((Master_Bluffer[i+General_Position]!=48)) result+=power(length-i-1);
        }
    General_Position+=length;
    treated+=length;
    return result;
}

int get_encoded_size(int c1, int c2, int range) {
    int i,result=0;
    for (i=16;i>0;i--) {
        if (i>8) {
            if ((c2 & 1) && i<=range) result+=power(range-i);
            c2>>=1;
        } else {
            if ((c1 & 1) && i<=range) result+=power(range-i);
            c1>>=1;
        }
    }
    return result;
}

void skip_encode(unsigned long long skip_size, bool bru, FILE* src) {
    truncated_data=true;
    int l_message,length,c1,c2;
    unsigned long long result=0,skip_done=0;
    if (bru) fseek(src,129,SEEK_SET);
    while (skip_done<skip_size+1) {
        result++;
        c1 = fgetc(src);c1 = fgetc(src);c2 = fgetc(src);
        if (isBL3 || isVelaro) l_message = get_encoded_size(c1,c2,11); else l_message = get_encoded_size(c1,c2,10);
        if (isBinaryFile || isBL3) length = 8*l_message; else length = 112*((int)((l_message+1)/14)+1);
        skip_done+=length;
        fseek(src,(bru)?((length/7)-3):((length/8)-3),SEEK_CUR);
    }
    sprintf(Window_Buffer,"%I64u messages omitted",result);
    log_it(LOG_ERROR,"File is too large",Window_Buffer,-1);
}

void appendNumber(int value) {
    long long i;
    for(i=General_Position+7;i>=General_Position;i--){
        Master_Bluffer[i] = (value & 1)+48;
        value >>= 1;
    }
    General_Position += 8;
}

int Message_ID2INDEX(char* ID_TEXT) {
    if (strstr(ID_TEXT,"GENERAL_MESSAGE")!=NULL) return 1;
    if (strstr(ID_TEXT,"DATA_ENTRY_COMPLETED")!=NULL) return 2;
    if (strstr(ID_TEXT,"EMERGENCY_BRAKE")!=NULL) return 3;
    if (strstr(ID_TEXT,"SB_COMMAND_STATE")!=NULL) return 4;
    if (strstr(ID_TEXT,"EVENTS")!=NULL && !isBL3) return 5;
    if (strstr(ID_TEXT,"MESSAGE_TO_RIU")!=NULL && isBL3) return 5;
    if (strstr(ID_TEXT,"MESSAGE_FROM_BALISE")!=NULL) return 6;
    if (strstr(ID_TEXT,"MESSAGE_FROM_LOOP")!=NULL) return 7;
    if (strstr(ID_TEXT,"MESSAGE_FROM_RIU")!=NULL) return 8;
    if (strstr(ID_TEXT,"MESSAGE_FROM_RBC")!=NULL) return 9;
    if (strstr(ID_TEXT,"MESSAGE_TO_RBC")!=NULL) return 10;
    if (strstr(ID_TEXT,"DRIVER_ACTION")!=NULL) return 11;
    if (strstr(ID_TEXT,"BALISE_GROUP_ERROR")!=NULL) return 12;
    if (strstr(ID_TEXT,"RADIO_ERROR")!=NULL) return 13;
    if (strstr(ID_TEXT,"STM_INFORMATION")!=NULL) return 14;
    if (strstr(ID_TEXT,"PLAIN TEXT MESSAGE")!=NULL && !isBL3) return 15;
    if (strstr(ID_TEXT,"COLD_MOVEMENT_DETECTOR_INFO")!=NULL && isBL3) return 15;
    if (strstr(ID_TEXT,"FIXED_TEXT_MESSAGE_START")!=NULL && isBL3) return 16;
    if (strstr(ID_TEXT,"FIXED_TEXT_MESSAGE_STOP")!=NULL && isBL3) return 17;
    if (strstr(ID_TEXT,"PLAIN_TEXT_MESSAGE_START")!=NULL) return 18;
    if (strstr(ID_TEXT,"PLAIN_TEXT_MESSAGE_STOP")!=NULL) return 19;
    if (strstr(ID_TEXT,"SPEED_DISTANCE_MONITORING")!=NULL) return 20;
    if (strstr(ID_TEXT,"DMI_SYMBOL_")!=NULL) return 21;
    if (strstr(ID_TEXT,"DMI_SOUND_")!=NULL) return 22;
    if (strstr(ID_TEXT,"DMI_STATUS")!=NULL) return 23;
    if (strstr(ID_TEXT,"ADDITIONAL_DATA")!=NULL) return 24;
    if (strstr(ID_TEXT,"DRIVER_SR_SPEED_DISTANCE")!=NULL) return 25;
    if (strstr(ID_TEXT,"STM_SELECTED")!=NULL) return 26;
    if (strstr(ID_TEXT,"SAFETY_CRITICAL_FAULT")!=NULL) return 27;
    if (strstr(ID_TEXT,"DRIVER_VBC_SET")!=NULL) return 28;
    if (strstr(ID_TEXT,"DRIVER_VBC_REMOVED")!=NULL) return 29;
    if (strstr(ID_TEXT,"SLEEPING_INPUT")!=NULL) return 30;
    if (strstr(ID_TEXT,"PASSIVE_SHUNTING_INPUT")!=NULL) return 31;
    if (strstr(ID_TEXT,"NON_LEADING_INPUT")!=NULL) return 32;
    if (strstr(ID_TEXT,"REGENERATIVE_BRAKE_STATUS")!=NULL) return 33;
    if (strstr(ID_TEXT,"MAGNETIC_SHOE_BRAKE_STATUS")!=NULL) return 34;
    if (strstr(ID_TEXT,"EDDY_CURRENT_BRAKE_STATUS")!=NULL) return 35;
    if (strstr(ID_TEXT,"EP_BRAKE_STATUS")!=NULL) return 36;
    if (strstr(ID_TEXT,"ADDITIONAL_BRAKE_STATUS")!=NULL) return 37;
    if (strstr(ID_TEXT,"CAB_STATUS")!=NULL) return 38;
    if (strstr(ID_TEXT,"DIRECTION_CONTROLLER_POSITION")!=NULL) return 39;
    if (strstr(ID_TEXT,"TRACTION_STATUS")!=NULL) return 40;
    if (strstr(ID_TEXT,"TRAIN_DATA_TYPE")!=NULL) return 41;
    if (strstr(ID_TEXT,"NATIONAL_SYSTEM_ISOLATION")!=NULL) return 42;
    if (strstr(ID_TEXT,"TRACTION_CUT_OFF_COMMAND_STATE")!=NULL) return 43;
    if (strstr(ID_TEXT,"MA_LOWEST_SUPERVISED_SPEED")!=NULL) return 44;
    if (strstr(ID_TEXT,"Z_EXPL_POSITION")!=NULL) return 197;
    if (strstr(ID_TEXT,"INFO_VITESSES_DISTANCE")!=NULL) return 198;
    if (strstr(ID_TEXT,"CHANGEMENT_DE_MODE")!=NULL) return 199;
    if (strstr(ID_TEXT,"CHANGEMENT_DE_NIVEAU")!=NULL) return 200;
    if (strstr(ID_TEXT,"ETCS_PROPRIETARY_DATA")!=NULL) return 255;
    if (strstr(ID_TEXT,"GAME")!=NULL) return -999;
    return -1;
}

int Mode_ID2INDEX(char* ID_TEXT) {
    if (strstr(ID_TEXT,"Full ")!=NULL) return 0;
    if (strstr(ID_TEXT,"On ")!=NULL) return 1;
    if (strstr(ID_TEXT,"Staff")!=NULL) return 2;
    if (strstr(ID_TEXT,"Shunt")!=NULL) return 3;
    if (strstr(ID_TEXT,"Unfi")!=NULL) return 4;
    if (strstr(ID_TEXT,"Slee")!=NULL) return 5;
    if (strstr(ID_TEXT,"Stand ")!=NULL) return 6;
    if (strstr(ID_TEXT,"Trip")!=NULL) return 7;
    if (strstr(ID_TEXT,"Post ")!=NULL) return 8;
    if (strstr(ID_TEXT,"System ")!=NULL) return 9;
    if (strstr(ID_TEXT,"Isola")!=NULL) return 10;
    if (strstr(ID_TEXT,"Non ")!=NULL) return 11;
    if (strstr(ID_TEXT,"Limited ")!=NULL) return 12;
    if (strstr(ID_TEXT,"National ")!=NULL) return 13;
    if (strstr(ID_TEXT,"Revers")!=NULL) return 14;
    if (strstr(ID_TEXT,"Passive ")!=NULL) return 15;
    return -1;
}

int Level_ID2INDEX(char* ID_TEXT) {
    if (strcmp(ID_TEXT ,"ASFA") == 0) return -1000;
    if (strcmp(ID_TEXT, "ATB") == 0) return -1001;
    if (strcmp(ID_TEXT, "LZB (C)") == 0) return -1002;
    if (strcmp(ID_TEXT, "ASFA AVE") == 0) return -1003;
    if (strcmp(ID_TEXT, "TBL 1") == 0) return -1005;
    if (strcmp(ID_TEXT, "INDUSI") == 0) return -1006;
    if (strcmp(ID_TEXT, "TBL 2/3") == 0) return -1007;
    if (strcmp(ID_TEXT, "KVB") == 0) return -1008;
    if (strcmp(ID_TEXT, "PZB/LZB") == 0) return -1009;
    if (strcmp(ID_TEXT, "LZB") == 0) return -1010;
    if (strcmp(ID_TEXT, "SCMT") == 0) return -1011;
    if (strcmp(ID_TEXT, "MEMOR II+") == 0) return -1012;
    if (strcmp(ID_TEXT, "TVM") == 0) return -1014;
    if (strcmp(ID_TEXT, "BACC") == 0) return -1015;
    if (strcmp(ID_TEXT, "RSDD") == 0) return -1016;
    if (strcmp(ID_TEXT, "EVM") == 0) return -1017;
    if (strcmp(ID_TEXT, "Crocodile") == 0) return -1018;
    if (strcmp(ID_TEXT, "EBICAB 900 TBS") == 0) return -1019;
    if (strcmp(ID_TEXT, "TPWS/AWS") == 0) return -1020;
    if (strcmp(ID_TEXT, "TPWS/AWS (SA)") == 0) return -1021;
    if (strcmp(ID_TEXT, "ATC2") == 0) return -1022;
    if (strcmp(ID_TEXT, "EBICAB 900") == 0) return -1023;
    if (strcmp(ID_TEXT, "EBICAB 900 (PL)") == 0) return -1024;
    if (strcmp(ID_TEXT, "KNR ATS") == 0) return -1025;
    if (strcmp(ID_TEXT, "SHP") == 0) return -1026;
    if (strcmp(ID_TEXT, "INDUSI I 60") == 0) return -1027;
    if (strcmp(ID_TEXT, "TBL 1+") == 0) return -1028;
    if (strcmp(ID_TEXT, "NExTEO") == 0) return -1029;
    if (strcmp(ID_TEXT, "ZUB 123") == 0) return -1030;
    if (strcmp(ID_TEXT, "ZUB 121 / Signum") == 0) return -1031;
    if (strcmp(ID_TEXT, "RPS") == 0) return -1032;
    if (strcmp(ID_TEXT, "LS") == 0) return -1033;
    if (strcmp(ID_TEXT, "EBICAB 700") == 0) return -1034;
    if (strcmp(ID_TEXT, "SELCAB") == 0) return -1035;
    if (strcmp(ID_TEXT, "INDUSI I 60") == 0) return -1036;
    if (strcmp(ID_TEXT, "TBL") == 0) return -1037;
    if (strcmp(ID_TEXT, "ALSN") == 0) return -1039;
    if (strcmp(ID_TEXT, "EBICAB") == 0) return -1040;
    if (strcmp(ID_TEXT, "CTCS-2") == 0) return -1045;
    if (strcmp(ID_TEXT, "EBICAB 700") == 0) return -1046;
    if (strcmp(ID_TEXT, "All") == 0) return -1255;
    if (strcmp(ID_TEXT, "Level 0") == 0) return 0;
    if (strcmp(ID_TEXT, "Level STM") == 0) return 1;
    if (strcmp(ID_TEXT, "Level 1") == 0) return 2;
    if (strcmp(ID_TEXT, "Level 2") == 0) return 3;
    if (strcmp(ID_TEXT, "Level E") == 0) return 4;
    return -1;
}

void Iterations() {
    if (n_iter_i>0) {
        if (n_iter_j>0) {
            sprintf(Iterations_Buffer,"      (%d)(%d) %s",n_iter_i,n_iter_j,Window_Buffer);
        } else sprintf(Iterations_Buffer,"   (%d) %s",n_iter_i,Window_Buffer);
        sprintf(Window_Buffer,"%s",Iterations_Buffer);
    }
}

void String_To_Caps(char* src) {
    int l = strlen(src);
    int i;
    for (i=0;i<l;i++) {
        if (src[i]>=97 && src[i]<=122 ) src[i]-=32;
    }
}

void hexdec(int length) {
    int i = 0;
    int num = 0;
    do {
        int b = ((Master_Bluffer[General_Position+i])=='1'?1:0);
        i++;
        num = (num<<1)|b;
    } while (i<length);
    Hexdec_Buffer[length]='\0';
    sprintf(Hexdec_Buffer,"%X",num);
    if (Hexdec_Buffer[4]=='F') Hexdec_Buffer[4]='\0';
    if (Hexdec_Buffer[5]=='F') Hexdec_Buffer[5]='\0';
    if (Hexdec_Buffer[6]=='F') Hexdec_Buffer[6]='\0';
    if (Hexdec_Buffer[0]>=65) sprintf(Hexdec_Buffer,"NC");
    General_Position+=length;
    treated+=length;
}

void bndtls(int length) {

if (length<0) return ;

int i;
int result=0;
    for (i=0;i<length;i++) {
        if ((Master_Bluffer[i+General_Position]!=48)) result+=power(length-i-1);
    }
    General_Position+=length;
    treated+=length;
    if (result>=0 && length<=24) Message_Details_Storage[Details_Position]=result; else Message_Details_Storage[Details_Position]=0;
    Details_Position++;
}

int bndtls_r(int length) {
int i;
int result=0;
    for (i=0;i<length;i++) {
        if ((Master_Bluffer[i+General_Position]!=48)) result+=power(length-i-1);
    }
    General_Position+=length;
    treated+=length;
    Message_Details_Storage[Details_Position]=result;
    Details_Position++;
    return result;
}

void bru_file_decode(char* src,bool unique) {
    MSG Escape_Message;
    FILE* P;
    int c,i=0,padding_offset;
    unsigned long long bru_length = 0;
    unsigned long long offset = 0;
    P = fopen(src,"rb");
    if (unique) {
        fseek(P,4,SEEK_SET);
        if ((c=fgetc(P))==229 && !isBL3 && !isVelaro) isVelaro=true;
        fseek(P,0,SEEK_END);
        bru_length = ftell(P);
        fseek(P,0,SEEK_SET);
        bru_length = bru_length-129;
        padding_offset = (bru_length%16); bru_length-=padding_offset;
        bru_length=(bru_length*7)+8*(padding_offset>14?14:padding_offset);
        if (bru_length>Master_Bluffer_Size) {
            offset = bru_length-Master_Bluffer_Size+1;
            skip_encode(offset,true,P);
        }
        i = ftell(P);
    }
    while ((c = fgetc(P)) != EOF) {
        i++;
        if (i>129 && ((i-130)%16)<14) {
            if (unique && General_Position%100000==0) {
                PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
                if (Escape_Message.wParam==27) {
                    truncated_data = true;
                    sprintf(Window_Buffer,"Interruption at %02I64u %% completion",100*((unsigned long long)General_Position+offset)/(bru_length));
                    log_it(LOG_WARNING,"Encoding interrupted by user",Window_Buffer,-1);
                    break;
                }
                empty_message_queue(Escape_Message);
                SendMessage(ProgressBarWindow,PBM_SETPOS,100*((unsigned long long)General_Position+offset)/(2*bru_length),0);
                SendMessage(MainBufferSaturationBar,PBM_SETPOS,(100*(unsigned long long)General_Position)/(unsigned long long)Master_Bluffer_Size,0);
            }
            appendNumber(c);
        }
    }
    fclose(P);
}

void bin_file_decode() {
    int c;
    MSG Escape_Message;
    ShowWindow(ProgressBarWindow, 1);
    SendMessage(ProgressBarWindow,PBM_SETBARCOLOR,0,Light_Purple);
    SetWindowText(LineWindow,"Binary Encoding...");

    fseek(BIN_File,0,SEEK_END);
    unsigned long long bin_length = 8*ftell(BIN_File);
    unsigned long long offset = 0;
    fseek(BIN_File,0,SEEK_SET);
    if (bin_length>Master_Bluffer_Size) {
        offset = bin_length-Master_Bluffer_Size+1;
        skip_encode(offset,false,BIN_File);
    }

    while ((c = fgetc(BIN_File))>=0) {

        if (General_Position>=Master_Bluffer_Size-20){
            sprintf(Window_Buffer,"%I64u/%I64u",(unsigned long long)General_Position,(unsigned long long)Master_Bluffer_Size);
            file_log_count++; valid_data=false;
            log_it(LOG_ERROR,"Main Buffer Overflow",Window_Buffer,-1);
            SendMessage(MainBufferSaturationBar,PBM_SETBARCOLOR,0,Orange);
            break;
        }
        if (General_Position%100000==0) {
            PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
            if (Escape_Message.wParam==27) {
                truncated_data = true;
                sprintf(Window_Buffer,"Interruption at %02I64u %% completion",100*((unsigned long long)General_Position+offset)/(bin_length));
                log_it(LOG_WARNING,"Encoding interrupted by user",Window_Buffer,-1);
                break;
            }
            empty_message_queue(Escape_Message);
            SendMessage(ProgressBarWindow,PBM_SETPOS,100*((unsigned long long)General_Position+offset)/(2*bin_length),0);
            SendMessage(MainBufferSaturationBar,PBM_SETPOS,(100*(unsigned long long)General_Position)/(unsigned long long)Master_Bluffer_Size,0);
        }

        appendNumber(c);
    }
    Master_Bluffer[General_Position] = '\0';
    file_length=General_Position;
    sprintf(Window_Buffer,"%02I64d %% Main buffer used",(100*General_Position)/Master_Bluffer_Size);
    log_it(LOG_SUCCESS,"File Encoding End",Window_Buffer,-1);
    General_Position = 0;
    SetWindowText(LineWindow,"BIN Decoding...");
}

void Path_Buffer_Back() {
int i,length = strlen(Path_Buffer);
    for (i=length-2;i>1;i--) {
        if (Path_Buffer[i]=='\\') {
            Path_Buffer[i+1]='\0';
            break;
        }
    }
}

void JRU_filename_deconstruct(char* JRU_filename) {

    if (JRU_filename[19]!='\t') JRU_filename[19]=' ';
    if (JRU_filename[15]=='_') {
        JRU_filename[20]=' ';
        JRU_filename[21]='\t';
    }

    JRU_filename[18]=']';
    JRU_filename[17]=JRU_filename[6];
    JRU_filename[16]=JRU_filename[5];
    JRU_filename[15]='/';
    JRU_filename[14]=JRU_filename[8];
    JRU_filename[13]=JRU_filename[7];
    JRU_filename[12]='/';
    JRU_filename[11]=JRU_filename[10];
    JRU_filename[10]=JRU_filename[9];
    JRU_filename[9]='>';
    JRU_filename[8]='>';
    JRU_filename[7]='[';
    if (JRU_filename[1]=='3') {
        if (JRU_filename[4]=='2') JRU_filename[6]='9'; else JRU_filename[6]='0';
    } else {
        if (JRU_filename[4]=='2') JRU_filename[6]='2'; else JRU_filename[6]='1';
    }
    JRU_filename[5]='M';
    JRU_filename[4]=' ';
}

void Folder_View_Fill() {
    int index;
    int length = strlen(Path_Buffer);
    if (Path_Buffer[length-1]!='\\') {
        Path_Buffer[length]='\\';
        length++;
    }
    Path_Buffer[length]='*';
    Path_Buffer[length+1]='.';
    Path_Buffer[length+2]='*';
    Path_Buffer[length+3]='\0';
    SendMessage(FolderViewWindow,LB_RESETCONTENT,0,0);
    hFind = FindFirstFile(Path_Buffer, &data);
    if (hFind != INVALID_HANDLE_VALUE) {
    do {
        if (data.cFileName[0]!='.' && data.cFileName[0]!='~') {

            unsigned long long DataFileSize = (unsigned long long)(((unsigned long long)(data.nFileSizeHigh * (MAXDWORD+1)) + (unsigned long long)data.nFileSizeLow)/1024)+1;
            if (DataFileSize>0 && !(data.dwFileAttributes&FILE_ATTRIBUTE_DIRECTORY)) sprintf(Window_Buffer,"%s\t  (%I64u KB)",data.cFileName,DataFileSize); else sprintf(Window_Buffer,data.cFileName);
            index = SendMessage(FolderViewWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
            if ((strlen(data.cFileName)==19 && data.cFileName[14]=='U' && data.cFileName[13]=='R' && data.cFileName[12]=='J' && data.cFileName[11]=='_' && data.cFileName[15]=='.' && data.cFileName[16]=='z' && data.cFileName[17]=='i' && data.cFileName[18]=='p') || (strlen(data.cFileName)==21 && data.cFileName[14]=='U' && data.cFileName[13]=='R' && data.cFileName[12]=='J' && data.cFileName[11]=='_' && data.cFileName[15]=='_' && data.cFileName[17]=='.' && data.cFileName[18]=='z' && data.cFileName[19]=='i' && data.cFileName[20]=='p')) {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,FILE_TYPE_JRUZIP);
            } else if ((strlen(data.cFileName)==15 && data.cFileName[14]=='U' && data.cFileName[13]=='R' && data.cFileName[12]=='J' && data.cFileName[11]=='_') || (strlen(data.cFileName)==17 && data.cFileName[15]=='_' && data.cFileName[14]=='U' && data.cFileName[13]=='R' && data.cFileName[12]=='J' && data.cFileName[11]=='_')) {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,FILE_TYPE_JRU);
            } else if (data.cFileName[strlen(data.cFileName)-1]=='u' && data.cFileName[strlen(data.cFileName)-2]=='r' && data.cFileName[strlen(data.cFileName)-3]=='b' && data.cFileName[strlen(data.cFileName)-4]=='.') {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,FILE_TYPE_BRUSOLO);
            } else if (data.cFileName[strlen(data.cFileName)-1]=='u' && data.cFileName[strlen(data.cFileName)-2]=='r' && data.cFileName[strlen(data.cFileName)-3]=='j' && data.cFileName[strlen(data.cFileName)-4]=='.') {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,FILE_TYPE_JRUBL3);
            } else if (data.cFileName[strlen(data.cFileName)-1]=='f' && data.cFileName[strlen(data.cFileName)-2]=='b' && data.cFileName[strlen(data.cFileName)-3]=='t' && data.cFileName[strlen(data.cFileName)-4]=='.') {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,FILE_TYPE_JRUTBF);
            } else {
                SendMessage(FolderViewWindow,LB_SETITEMDATA,index,data.dwFileAttributes);
            }
        }
    } while (FindNextFile(hFind, &data));
    FindClose(hFind);
    }
    Path_Buffer[length]='\0';
    SetWindowText(FolderEditWindow,Path_Buffer);
    SetFocus(FolderViewWindow);
    SendMessage(FolderViewWindow,LB_SETCURSEL,0,0);
}

void bru_file() {
    MSG Escape_Message;
    ShowWindow(ProgressBarWindow, 1);
    path_length = strlen(Path_Buffer);
    int count=0,total=0;
    int max_bru_file_count=0,offset;
    unsigned long long bru_file_size;
    FILE* SAMPLE_FILE;
    General_Position=0;
    DIR *dir;
    SendMessage(ProgressBarWindow,PBM_SETBARCOLOR,0,Light_Purple);
    SetWindowText(LineWindow,"Decoding...");
    struct dirent *ent;
    dir = opendir (Path_Buffer);
    while ((ent = readdir (dir)) != NULL) {
        if (ent->d_name[10]=='.' && strlen(ent->d_name)==14) {
            if (max_bru_file_count==0) {
                SAMPLE_FILE = fopen(strcat(Path_Buffer,ent->d_name),"r");
                Path_Buffer[path_length]='\0';
                fseek(SAMPLE_FILE,0,SEEK_END);
                bru_file_size=ftell(SAMPLE_FILE);
                fclose(SAMPLE_FILE);
                bru_file_size = bru_file_size-129;
                offset = (bru_file_size%16); bru_file_size-=offset;
                bru_file_size=(bru_file_size*7)+8*(offset>14?14:offset);
                max_bru_file_count = (int)(Master_Bluffer_Size/bru_file_size)-1;
            }
            total++;
        }
    }

    if (max_bru_file_count<total) {
        sprintf(Window_Buffer,"Only the first %d bru files will be encoded",max_bru_file_count);
        log_it(LOG_WARNING,"Too many bru files",Window_Buffer,-1);
        truncated_data=true;
        if (max_bru_file_count==0) valid_data=false;
    }

    closedir (dir); dir = opendir (Path_Buffer);
    while ((ent = readdir (dir)) != NULL) {
        if (ent->d_name[10]=='.' && strlen(ent->d_name)==14) {
            count++;
            if (total-count<max_bru_file_count) {
                bru_file_decode(strcat(Path_Buffer,ent->d_name),false);
                Path_Buffer[path_length]='\0';
                SendMessage(ProgressBarWindow,PBM_SETPOS,(100*count)/(2*total),0);
                SendMessage(MainBufferSaturationBar,PBM_SETPOS,(100*(unsigned long long)General_Position)/(unsigned long long)Master_Bluffer_Size,0);
            }
        }
        PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
        if (Escape_Message.wParam==27) {
            truncated_data = true;
            sprintf(Window_Buffer,"Interruption at %02d %% completion",(100*count)/total);
            log_it(LOG_WARNING,"Encoding interrupted by user",Window_Buffer,-1);
            break;
        }
        empty_message_queue(Escape_Message);
    }
    Master_Bluffer[General_Position] = '\0';
    closedir (dir);
    file_length=General_Position;

    sprintf(Window_Buffer,"%02I64d %% Main buffer used",(100*General_Position)/Master_Bluffer_Size);
    log_it(LOG_SUCCESS,"File Encoding End",Window_Buffer,-1);

    General_Position = 0;
}

void jru_file() {
    MSG Escape_Message;
    int c;
    ShowWindow(ProgressBarWindow, 1);
    SendMessage(ProgressBarWindow,PBM_SETBARCOLOR,0,Light_Purple);
    SendMessage(ProgressBarWindow,PBM_SETPOS,0,0);
    SetWindowText(LineWindow,"BL3 Encoding...");
    BL3_File = fopen(Path_Buffer,"rb");

    fseek(BL3_File,0,SEEK_END);
    unsigned long long jru_length = 8*ftell(BL3_File);
    unsigned long long offset = 0;
    fseek(BL3_File,0,SEEK_SET);
    if (jru_length>Master_Bluffer_Size) {
        offset = jru_length-Master_Bluffer_Size+1;
        skip_encode(offset,false,BL3_File);
    }

    while ((c = fgetc(BL3_File))>=0) {
        if (General_Position>=Master_Bluffer_Size-20){
            sprintf(Window_Buffer,"%I64u/%I64u",(unsigned long long)General_Position,(unsigned long long)Master_Bluffer_Size);
            file_log_count++; valid_data=false;
            log_it(LOG_ERROR,"Main Buffer Overflow",Window_Buffer,-1);
            SendMessage(MainBufferSaturationBar,PBM_SETBARCOLOR,0,Orange);
            break;
        }
        if (General_Position%100000==0) {
            PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
            if (Escape_Message.wParam==27) {
                truncated_data = true;
                sprintf(Window_Buffer,"Interruption at %02I64u %% completion",100*((unsigned long long)General_Position+offset)/(jru_length));
                log_it(LOG_WARNING,"Encoding interrupted by user",Window_Buffer,-1);
                break;
            }
            empty_message_queue(Escape_Message);
            SendMessage(ProgressBarWindow,PBM_SETPOS,100*((unsigned long long)General_Position+offset)/(2*jru_length),0);
            SendMessage(MainBufferSaturationBar,PBM_SETPOS,(100*(unsigned long long)General_Position)/(unsigned long long)Master_Bluffer_Size,0);
        }
        appendNumber(c);
    }
    Master_Bluffer[General_Position] = '\0';
    file_length=General_Position;
    fclose(BL3_File);
    sprintf(Window_Buffer,"%02I64d %% Main buffer used",(100*General_Position)/Master_Bluffer_Size);
    log_it(LOG_SUCCESS,"File Encoding End",Window_Buffer,-1);
    General_Position = 0;
    SetWindowText(LineWindow,"BL3 Decoding...");
}

void tbf_file() {
    int c,to_read,i=-3;
    int c1,c2,c3;
    ShowWindow(ProgressBarWindow, 1);
    SetWindowText(LineWindow,"TBF Encoding...");
    BL3_File = fopen(Path_Buffer,"rb");
    fseek(BL3_File,568,SEEK_SET);
    to_read = fgetc(BL3_File);
    while ((c = fgetc(BL3_File))>=0) {
        i++;
        if (i>16) i-=16;
        if (i<0 || !((i%16)<=1)) {
            if (to_read>=0) {appendNumber(c); to_read--; }
            if (to_read==0) {
                while (1) {
                    c1 = fgetc(BL3_File);
                    c2 = fgetc(BL3_File);
                    c3 = fgetc(BL3_File);
                    if (c1<0 || c2<0 || c3<0) break;
                    if (c1==19 && c2==0 && c3==149) break; else fseek(BL3_File,-2,SEEK_CUR);
                    i++;
                    if (i>16) i-=16;
                }
                i+=13;
                if (i>16) i-=16;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                c1 = fgetc(BL3_File); if (c1<0) break;
                to_read = fgetc(BL3_File);
                if (to_read<0) break;
            }
        }
    }
    Master_Bluffer[General_Position] = '\0';
    file_length=General_Position;
    fclose(BL3_File);
    General_Position = 0;
    SetWindowText(LineWindow,"TBF Decoding...");
}

int track_to_train_paquet(int nid_packet,int m_version) {
    if (m_version==-1) {
        sprintf(Window_Buffer,"#%03d",nid_packet);
        log_it(LOG_ERROR,"Packet Version unknown : ",Window_Buffer,message_index+1);
    }
    int i,j,iterations,iterations_bis,switcher,switcher_bis,memory,memory_bis;
    float scale;

    int initial_treated = treated,l_packet=-1;

    switch(nid_packet) {
        case 256:
            bndtls(6);
        break;
        case 2:
            bndtls(2);l_packet=bndtls_r(13);bndtls(7);
        break;
        case 3:
                if (m_version>=32) {
                    bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(10);iterations = bndtls_r(5);
                    for (i=0;i<iterations;i++) {
                        bndtls(10);
                    }
                    bndtls(7);bndtls(7);bndtls(7);bndtls(7);bndtls(7);bndtls(7);bndtls(15);bndtls(1);bndtls(1);bndtls(1);bndtls(1);bndtls(1);
                    bndtls(7);bndtls(7);bndtls(15);bndtls(8);bndtls(15);bndtls(2);bndtls(8);bndtls(1);bndtls(15);bndtls(1);
                    bndtls(6);bndtls(6);bndtls(6);bndtls(6);bndtls(5);bndtls(4);switcher = bndtls_r(1);
                    if (switcher==1) {
                        switcher_bis = bndtls_r(2);
                        if (switcher_bis==1) {
                            bndtls(6);bndtls(6);
                        }
                        bndtls(7);bndtls(7);
                        if (switcher_bis==1) {
                            bndtls(7);
                        }
                        iterations = bndtls_r(5);
                        for (i=0;i<iterations;i++) {
                            bndtls(7);bndtls(7);
                            if (switcher_bis==1) {
                                bndtls(7);
                            }
                        }
                        iterations = bndtls_r(5);
                        for (i=0;i<iterations;i++) {
                            switcher_bis = bndtls_r(2);
                            if (switcher_bis==1) {
                                bndtls(6);bndtls(6);
                            }
                            bndtls(7);bndtls(7);
                            if (switcher_bis==1) {
                                bndtls(7);
                            }
                            iterations_bis = bndtls_r(5);
                            for (j=0;j<iterations_bis;j++) {
                                bndtls(7);bndtls(7);
                                if (switcher_bis==1) {
                                    bndtls(7);
                                }
                            }
                        }
                        bndtls(5);bndtls(5);
                        iterations = bndtls_r(5);
                        for (i=0;i<iterations;i++) {
                            bndtls(5);bndtls(5);
                        }
                        bndtls(5);
                    }
                } else {
                    bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);iterations = bndtls_r(5);
                    for (i=0;i<iterations;i++) {
                        bndtls(10);
                    }
                    bndtls(7);bndtls(7);bndtls(7);bndtls(7);bndtls(7);bndtls(15);bndtls(1);bndtls(1);bndtls(7);bndtls(7);bndtls(15);bndtls(8);bndtls(15);bndtls(2);bndtls(8);bndtls(1);bndtls(15);bndtls(1);
                }
        break;
        case 5:
            if (Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9) {
                Inter_Balise_Distance[3*Inter_Balise_Distance_Count]=Message_Details_Storage[Temporary_Details_Position+6];
                Linked_Balise_NidC = Message_Details_Storage[Temporary_Details_Position+5];
            } else {
                Inter_Balise_Distance[3*Inter_Balise_Distance_Count]=Message_Details_Storage[Temporary_Details_Position+8];
            }
            switcher_bis = bndtls_r(2);
            if ((switcher_bis==q_dlrbg || switcher_bis==2) && start_on_board_linking && (balise_direction || Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9)) {
                new_linking_reference = message_index+1;
                new_linked_balise_seen = 0;
            }
            l_packet=bndtls_r(13);;scale = pow(10,bndtls_r(2)-1);distance=bndtls_r(15)*scale;switcher = bndtls_r(1);
            Inter_Balise_Distance[3*Inter_Balise_Distance_Count+2]=distance;
            if (switcher==1) {
                Linked_Balise_NidC = bndtls_r(10);
            }
            int balise_P5 = bndtls_r(14);
            Inter_Balise_Distance[3*Inter_Balise_Distance_Count+1]=balise_P5;
            if ((switcher_bis==q_dlrbg || switcher_bis==2) && retroactive_d_lrbg>distance && start_on_board_linking && Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9) new_linked_balise_seen=1;
            if ((switcher_bis==q_dlrbg || switcher_bis==2) && start_on_board_linking && (balise_direction || Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9)) New_Linked_Balise_Storage[0] = (balise_P5+100000*Linked_Balise_NidC);
            bndtls(1);bndtls(2);bndtls(6);iterations = bndtls_r(5);
            Inter_Balise_Distance_Count++;
            for (i=0;i<iterations;i++) {
                Inter_Balise_Distance[3*Inter_Balise_Distance_Count]=balise_P5;
                int distance_P5 = (bndtls_r(15)*scale);
                distance+=distance_P5;switcher = bndtls_r(1);
                Inter_Balise_Distance[3*Inter_Balise_Distance_Count+2]=distance_P5;
                if ((switcher_bis==q_dlrbg || switcher_bis==2) && retroactive_d_lrbg>distance && start_on_board_linking && Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9) new_linked_balise_seen++;
                if (switcher==1) {
                    Linked_Balise_NidC = bndtls_r(10);
                }
                balise_P5 = bndtls_r(14);
                Inter_Balise_Distance[3*Inter_Balise_Distance_Count+1]=balise_P5;
                if ((switcher_bis==q_dlrbg || switcher_bis==2) && start_on_board_linking && (balise_direction || Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9)) New_Linked_Balise_Storage[i+1] = (balise_P5+100000*Linked_Balise_NidC);
                bndtls(1);bndtls(2);bndtls(6);
                Inter_Balise_Distance_Count++;
            }
            if ((switcher_bis==q_dlrbg || switcher_bis==2) && start_on_board_linking && (balise_direction || Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9)) New_Linked_Balise_Count = 1+i;

            if ((switcher_bis==q_dlrbg || switcher_bis==2) && start_on_board_linking && Message_Details_Storage[Temporary_Details_Position-id_detail_offset]==9) linking_switcher+=5;
        break;
        case 6:
            bndtls(2);l_packet=bndtls_r(13);switcher = bndtls_r(1);bndtls(6);bndtls(10);
            if (switcher==1) {
                bndtls(8);
            }
        break;
        case 12:
            bndtls(2);l_packet=bndtls_r(13);
            scale = pow(10,bndtls_r(2)-1);
            bndtls(7);
            if (m_level==2 && m_mode!=5 && m_mode!=7 && m_mode!=8) {last_MA = message_index+1; MA_Speed = bndtls_r(7); MA_Distance=0;} else bndtls(7);
            bndtls(10);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                if (m_level==2 && m_mode!=5) MA_Distance+=scale * bndtls_r(15); else bndtls(15);
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);bndtls(15);
                }
            }
            if (m_level==2 && m_mode!=5 && m_mode!=7 && m_mode!=8) MA_Distance+=scale * bndtls_r(15); else bndtls(15);
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);bndtls(15);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);bndtls(15);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(15);bndtls(7);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(15);bndtls(10);bndtls(15);bndtls(7);
            }
            MA_Distance-=retroactive_d_lrbg;
        break;
        case 13:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);
            }
            bndtls(14);
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);
            }
            bndtls(14);bndtls(15);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);
                }
                bndtls(14);bndtls(15);
            }
        break;
        case 15:
            bndtls(2);l_packet=bndtls_r(13);
            scale = pow(10,bndtls_r(2)-1);
            if (m_level==3 && m_mode!=5 && m_mode!=7 && m_mode!=8) {last_MA = message_index+1; MA_Speed = bndtls_r(7); MA_Distance=0;} else bndtls(7);
            bndtls(10);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                if (m_level==3 && m_mode!=5) MA_Distance+=scale * bndtls_r(15); else bndtls(15);
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);bndtls(15);
                }
            }
            if (m_level==3 && m_mode!=5 && m_mode!=7 && m_mode!=8) MA_Distance+=scale * bndtls_r(15); else bndtls(15);
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);bndtls(15);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);bndtls(15);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(15);bndtls(7);
            }
            switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(15);bndtls(10);bndtls(15);bndtls(7);
            }
            MA_Distance-=retroactive_d_lrbg;
        break;
        case 16:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);
        break;
        case 21:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(1);bndtls(8);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                bndtls(15);bndtls(1);bndtls(8);
            }
        break;
        case 27:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(7);bndtls(1);iterations = bndtls_r(5);
            if (m_version>=32) {
                for (i=0;i<iterations;i++) {
                    bndtls(2);bndtls(4);bndtls(7);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(7);bndtls(1);iterations_bis = bndtls_r(5);
                    for (j=0;j<iterations_bis;j++) {
                        bndtls(2);bndtls(4);bndtls(7);
                    }
                }
            } else {
                for (i=0;i<iterations;i++) {
                    bndtls(4);bndtls(7);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(7);bndtls(1);iterations_bis = bndtls_r(5);
                    for (j=0;j<iterations_bis;j++) {
                        bndtls(4);bndtls(7);
                    }
                }
            }
        break;
        case 39:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);
            if (m_version>=32) {
                switcher = bndtls_r(4);
                if (switcher!=0) bndtls(10);
            } else {
                bndtls(8);
            }
        break;
        case 40:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(10);
        break;
        case 41:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
            bndtls(15);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(3);
                if (switcher==1) {
                    bndtls(8);
                }
                bndtls(15);
            }
        break;
        case 42:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);bndtls(10);bndtls(14);bndtls(16);bndtls(16);bndtls(16);bndtls(16);bndtls(1);
        break;
        case 44:
            bndtls(2);l_packet = bndtls_r(13);switcher = bndtls_r(9);
            if (switcher==102) {
                bndtls(8);
                memory_bis=40;
            } else if (switcher==13) {
                bndtls(16);
                memory_bis=48;
            }
            else memory_bis=32;
            if (l_packet!=memory_bis) bndtls(l_packet-memory_bis);
        break;
        case 45:
            bndtls(2);l_packet=bndtls_r(13);bndtls(12);bndtls(12);
        break;
        case 46:
            bndtls(2);l_packet=bndtls_r(13);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
            iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(3);
                if (switcher==1) {
                    bndtls(8);
                }
            }
        break;
        case 49:
            bndtls(2);l_packet=bndtls_r(13);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);
                }
                bndtls(14);
            }
        break;
        case 51:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==0) {
                bndtls(15);bndtls(15);bndtls(1);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(7);bndtls(7);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(15);bndtls(1);iterations_bis = bndtls_r(5);
                    for (j=0;j<iterations_bis;j++) {
                        bndtls(7);bndtls(7);
                    }
                }
            } else {
                bndtls(15);
            }
        break;
        case 52:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==0) {
                bndtls(15);bndtls(1);bndtls(8);bndtls(1);bndtls(15);bndtls(15);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(1);bndtls(8);bndtls(1);bndtls(15);bndtls(15);
                }
            } else {
                bndtls(15);
            }
        break;
        case 57:
            bndtls(2);l_packet=bndtls_r(13);bndtls(8);bndtls(10);bndtls(8);
        break;
        case 58:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(8);bndtls(15);bndtls(3);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                bndtls(15);bndtls(1);
            }
        break;
        case 63:
            bndtls(2);l_packet=bndtls_r(13);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);
                }
                bndtls(14);
            }
        break;
        case 64:
            bndtls(2);l_packet=bndtls_r(13);
        break;
        case 65:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(8);bndtls(15);bndtls(15);bndtls(1);bndtls(7);
        break;
        case 66:
            bndtls(2);l_packet=bndtls_r(13);bndtls(8);
        break;
        case 67:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(15);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                bndtls(15);bndtls(15);
            }
        break;
        case 68:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==0) {
                bndtls(15);bndtls(15);bndtls(4);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(15);bndtls(4);
                }
            } else {
                bndtls(15);
            }
        break;
        case 69:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==0) {
                bndtls(15);bndtls(15);bndtls(4);bndtls(2);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);bndtls(15);bndtls(4);bndtls(2);
                }
            } else {
                bndtls(15);
            }
        break;
        case 70:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==0) {
                bndtls(15);switcher_bis = bndtls_r(2);
                if (switcher_bis==1) {
                    bndtls(7);
                } else if (switcher_bis!=3) {
                    if (m_version>=32 && switcher_bis==2) {
                        memory = bndtls_r(4);
                        if (memory!=0) bndtls(10);
                    } else bndtls(8);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(15);switcher_bis = bndtls_r(2);
                    if (switcher_bis==1) {
                        bndtls(7);
                    } else if (switcher_bis!=3) {
                        if (m_version>=32 && switcher_bis==2) {
                            memory = bndtls_r(4);
                            if (memory!=0) bndtls(10);
                        } else bndtls(8);
                    }
                }
            } else {
                bndtls(15);
            }
        break;
        case 71:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(15);bndtls(1);
        break;
        case 72:
            memory_bis = 92;
            switcher_bis = bndtls_r(2);
            l_packet=bndtls_r(13);bndtls(2);bndtls(2);bndtls(1);bndtls(15);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                memory_bis+=8;
                bndtls(8);
            }
            bndtls(15);bndtls(10);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                memory_bis+=8;
                bndtls(8);
            }
            switcher = bndtls_r(2);
            if (switcher!=0 && m_version>=32) {
                memory_bis+=2;
                bndtls(1);switcher_bis = bndtls_r(1);
                if (switcher_bis==1) {
                    memory_bis+=32;
                    bndtls(8);bndtls(10);bndtls(14);
                }
            }
            if (Balise_Details_Position_72[balise_count-1]<0) Balise_Details_Position_72[balise_count-1]=Details_Position;
            switcher = bndtls_r(8);

            while(memory_bis<l_packet) {
                memory_bis+=8;
                bndtls(8);
            }
            if (switcher_bis==q_dlrbg && balise_decision!=BALISE_DECISION_UNKNOWN && balise_decision!=BALISE_UNEXPECTED) {
                if (Message_Details_Storage[Details_Position-switcher]=='L' || (Message_Details_Storage[Details_Position-switcher]=='D' && Message_Details_Storage[Details_Position-switcher+1]=='B' && Message_Details_Storage[Details_Position-switcher-1]==2)) line_info_number = Details_Position-switcher-1;
                if (Message_Details_Storage[Details_Position-switcher]=='G' && Message_Details_Storage[Details_Position-switcher+1]=='S' && Message_Details_Storage[Details_Position-switcher+2]=='M' && Message_Details_Storage[Details_Position-switcher+3]=='-' && Message_Details_Storage[Details_Position-switcher+4]=='R' && Message_Details_Storage[Details_Position-switcher+5]==' ') {
                    if (Message_Details_Storage[Details_Position-switcher-1]==8 && Message_Details_Storage[Details_Position-switcher+6]=='N' && Message_Details_Storage[Details_Position-switcher+7]=='L') {
                        line_info_number = -(Details_Position-switcher-1);
                    } else if (Message_Details_Storage[Details_Position-switcher-1]==7 && Message_Details_Storage[Details_Position-switcher+6]=='B') {
                        line_info_number = -(Details_Position-switcher-1);
                    }
                }
            } else {
//                if (Message_Details_Storage[Details_Position-switcher]=='L' || (Message_Details_Storage[Details_Position-switcher]=='D' && Message_Details_Storage[Details_Position-switcher+1]=='B' && Message_Details_Storage[Details_Position-switcher-1]==2)) line_info_number = 0;
//                if (Message_Details_Storage[Details_Position-switcher]=='G' && Message_Details_Storage[Details_Position-switcher+1]=='S' && Message_Details_Storage[Details_Position-switcher+2]=='M' && Message_Details_Storage[Details_Position-switcher+3]=='-' && Message_Details_Storage[Details_Position-switcher+4]=='R' && Message_Details_Storage[Details_Position-switcher+5]==' ') line_info_number = 0;
            }
        break;
        case 76:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(2);bndtls(1);bndtls(15);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
            bndtls(15);bndtls(10);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
            switcher = bndtls_r(2);
            if (switcher!=0 && m_version>=32) {
                bndtls(1);switcher_bis = bndtls_r(1);
                if (switcher_bis==1) {
                    bndtls(8);bndtls(10);bndtls(14);
                }
            }
            bndtls(8);
        break;
        case 79:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);
            }
            bndtls(14);bndtls(15);bndtls(1);
            if (Balise_Details_Position_79[balise_count-1]<0) Balise_Details_Position_79[balise_count-1]=Details_Position;
            bndtls(20);
            iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                switcher = bndtls_r(1);
                if (switcher==1) {
                    bndtls(10);
                }
                bndtls(14);bndtls(15);bndtls(1);bndtls(20);
            }
        break;
        case 80:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(2);bndtls(7);bndtls(15);bndtls(15);
            if (m_version>=32) bndtls(1);
            iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                bndtls(15);bndtls(2);bndtls(7);bndtls(15);bndtls(15);
                if (m_version>=32) bndtls(1);
            }
        break;
        case 88:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(8);bndtls(15);bndtls(15);switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(7);switcher_bis = bndtls_r(1);
                if (switcher_bis==1) {
                    bndtls(15);
                }
            }
        break;
        case 90:
            bndtls(2);l_packet=bndtls_r(13);switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(10);
            }
            bndtls(14);
        break;
        case 131:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(10);bndtls(14);bndtls(16);bndtls(16);bndtls(16);bndtls(16);bndtls(1);
        break;
        case 132:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);
        break;
        case 133:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(1);bndtls(10);bndtls(14);bndtls(16);bndtls(16);bndtls(16);bndtls(16);bndtls(15);bndtls(10);bndtls(14);
        break;
        case 134:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(14);bndtls(15);bndtls(15);bndtls(1);bndtls(4);
        break;
        case 135:
            bndtls(2);l_packet=bndtls_r(13);
        break;
        case 136:
            bndtls(2);l_packet=bndtls_r(13);switcher = bndtls_r(1);
            if (switcher==1) {
                switcher_bis = bndtls_r(10);
            } else switcher_bis = Linked_Balise_NidC;
            MA_bg = bndtls_r(14);
            ignore_linking = 100000*switcher_bis+MA_bg;
        break;
        case 137:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);
        break;
        case 138:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(15);
        break;
        case 139:
            bndtls(2);l_packet=bndtls_r(13);bndtls(2);bndtls(15);bndtls(7);
        break;
        case 140:
            bndtls(2);l_packet=bndtls_r(13);bndtls(16);bndtls(16);
        break;
        case 141:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);bndtls(8);
        break;
        case 143:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);bndtls(10);bndtls(14);bndtls(16);bndtls(16);bndtls(16);bndtls(16);
        break;
        case 145:
        case 181:
        case 254:
            bndtls(2);l_packet=bndtls_r(13);
        break;
        case 180:
            bndtls(2);l_packet=bndtls_r(13);switcher = bndtls_r(1);
            if (switcher==1) {
                bndtls(8);
            }
        break;
        case 203:
            bndtls(2);l_packet=bndtls_r(13);bndtls(1);bndtls(1);bndtls(1);bndtls(6);bndtls(6);bndtls(6);bndtls(5);bndtls(4);switcher = bndtls_r(1);
            if (switcher==1) {
                switcher_bis = bndtls_r(2);
                if (switcher_bis==1) {
                    bndtls(6);bndtls(6);
                }
                bndtls(7);bndtls(7);
                if (switcher_bis==1) {
                    bndtls(7);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(7);bndtls(7);
                    if (switcher_bis==1) {
                        bndtls(7);
                    }
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    switcher_bis = bndtls_r(2);
                    if (switcher_bis==1) {
                        bndtls(6);bndtls(6);
                    }
                    bndtls(7);bndtls(7);
                    if (switcher_bis==1) {
                        bndtls(7);
                    }
                    iterations_bis = bndtls_r(5);
                    for (j=0;j<iterations_bis;j++) {
                        bndtls(7);bndtls(7);
                        if (switcher_bis==1) {
                            bndtls(7);
                        }
                    }
                }
                bndtls(5);bndtls(5);
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(5);bndtls(5);
                }
                bndtls(5);
            }
        break;
        default:
            sprintf(Window_Buffer,"#%03d",nid_packet);
            log_it(LOG_ERROR,"Unknown Packet : ",Window_Buffer,message_index+1);
            l_packet=-1;
//            bndtls(2);memory = bndtls_r(13);
//            if (memory>23) {
//                bndtls(memory-23);
//            }
        break;
    }

    if (l_packet!=treated-initial_treated+8 && l_packet>=0) {
        sprintf(Window_Buffer,"P#%03d (%d/%d)",nid_packet,treated-initial_treated+8,l_packet);
        log_it(LOG_ERROR,"Track to Train Packet length inconsistency : ",Window_Buffer,message_index+1);
        valid_data=false;
    }
    return l_packet;
}

int train_to_track_paquet(int nid_packet, int m_version) {
    if (m_version==-1) {
        sprintf(Window_Buffer,"#%03d",nid_packet);
        log_it(LOG_ERROR,"Packet Version unknown : ",Window_Buffer,message_index+1);
    }
    int i,iterations,switcher;

    int initial_treated = treated,l_packet=-1;

    switch(nid_packet) {
        case 256:
            l_packet=bndtls_r(13);bndtls(2);bndtls(10);bndtls(14);bndtls(15);bndtls(2);bndtls(2);bndtls(15);bndtls(15);switcher = bndtls_r(2);
            if (switcher==1 || switcher==2) {
                bndtls(15);
            }
            bndtls(7);bndtls(2);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
        break;
        case 1:
            l_packet=bndtls_r(13);bndtls(2);bndtls(10);bndtls(14);bndtls(10);bndtls(14);bndtls(15);bndtls(2);bndtls(2);bndtls(15);bndtls(15);switcher = bndtls_r(2);
            if (switcher==1 || switcher==2) {
                bndtls(15);
            }
            bndtls(7);bndtls(2);bndtls(4);switcher = bndtls_r(3);
            if (switcher==1) {
                bndtls(8);
            }
        break;
        case 3:
            l_packet = bndtls_r(13);iterations = bndtls_r(5);
            for (i=0;i<iterations;i++) {
                bndtls(16);bndtls(16);bndtls(16);bndtls(16);
            }
        break;
        case 4:
            l_packet=bndtls_r(13);bndtls(8);
        break;
        case 5:
            l_packet=bndtls_r(13);bndtls(16);bndtls(16);
        break;
        case 9:
            l_packet=bndtls_r(13);bndtls(10);bndtls(14);
        break;
        case 11:
            if (m_version>=32) {
                l_packet=bndtls_r(13);bndtls(4);bndtls(15);bndtls(12);bndtls(7);bndtls(8);bndtls(7);bndtls(2);bndtls(10);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    switcher = bndtls_r(4);
                    if (switcher!=0) bndtls(10);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(8);
                }
            } else {
                l_packet=bndtls_r(13);bndtls(16);bndtls(16);bndtls(15);bndtls(12);bndtls(7);bndtls(8);bndtls(7);bndtls(2);iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(8);
                }
                iterations = bndtls_r(5);
                for (i=0;i<iterations;i++) {
                    bndtls(8);
                }
            }
        break;
        case 44:
            l_packet = bndtls_r(13);bndtls(9);
            bndtls(l_packet-22);
        break;
        default:
            sprintf(Window_Buffer,"#%03d",nid_packet);
            log_it(LOG_ERROR,"Unknown Packet : ",Window_Buffer,message_index+1);
            l_packet=-1;
//            bndtls(2);memory = bndtls_r(13);bndtls(memory-23);
        break;
    }

    if (l_packet!=treated-initial_treated+8 && l_packet>=0) {
        sprintf(Window_Buffer,"P#%03d (%d/%d)",nid_packet,treated-initial_treated+8,l_packet);
        log_it(LOG_ERROR,"Train to Track Packet length inconsistency : ",Window_Buffer,message_index+1);
        valid_data=false;
    }
    return l_packet;
}

void track_to_train_message(int nid_message) {
    int initial_treated = treated-8;
    int message_length = bndtls_r(10);
    bndtls(16);bndtls(16);bndtls(1);bndtls(10);
    int balise = bndtls_r(14);
    int distance_M_BG;
    if (balise!=16383 && nid_bg!=16383) distance_M_BG = track_bg_distance(3*Inter_Balise_Distance_Count,balise,nid_bg)+d_lrbg;
    else distance_M_BG = -1;
    switch(nid_message) {
        case 2:
        case 33:
            if (nid_message==33) {
                if (distance_M_BG>=d_lrbg) retroactive_d_lrbg = distance_M_BG; else retroactive_d_lrbg=-INTER_BALISE_DISTANCE_UNKNOWN;
            }
            bndtls(2);bndtls(16);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(track_to_train_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 3:
        case 9:
        case 24:
        case 37:
            if (nid_message==3) {
                if (distance_M_BG>=d_lrbg) retroactive_d_lrbg = distance_M_BG; else retroactive_d_lrbg=-INTER_BALISE_DISTANCE_UNKNOWN;
            }
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(track_to_train_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 8:
        case 27:
            bndtls(16);bndtls(16);
        break;
        case 15:
            bndtls(4);bndtls(2);
//            bndtls(16);
            bndtls(2);bndtls(15);
        break;
        case 16:
        case 18:
            bndtls(4);
        break;
        case 28:
            bndtls(16);bndtls(16);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(track_to_train_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 32:
            last_nid_rbc_version = bndtls_r(7);
        break;
        case 34:
            bndtls(2);bndtls(2);bndtls(15);bndtls(15);
        break;
        case 45:
            bndtls(1);
        break;
        case 6:
        case 38:
        case 39:
        case 40:
        case 41:
        case 43:
        break;
        default:
//            bndtls(message_length-61);
            sprintf(Window_Buffer,"#%03d",nid_message);
            log_it(LOG_ERROR,"Unknown Message : ",Window_Buffer,message_index+1);
            message_length=-1;
            valid_data=false;
        break;
    }

    if ((8*message_length-treated+initial_treated>=8 || 8*message_length-treated+initial_treated<0) && message_length>=0) {
        sprintf(Window_Buffer,"M#%03d (%d/%d)",nid_message,treated-initial_treated,8*message_length);
        log_it(LOG_ERROR,"Track to Train Message length inconsistency : ",Window_Buffer,message_index+1);
        valid_data=false;
    }
}

void train_to_track_message(int nid_message) {
    int initial_treated = treated-8;
    int message_length = bndtls_r(10);
    bndtls(16);bndtls(16);
    if (unknown_file && unknown_vehicle==0) {
        unknown_vehicle = bndtls_r(24);
        D_nid_engine_for_unknown_vehicle(unknown_vehicle,VehicleWindow);
    } else bndtls(24);
    switch(nid_message) {
        case 129:
        case 130:
        case 136:
        case 149:
        case 150:
        case 159:
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 132:
            bndtls(1);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 137:
        case 138:
            bndtls(16);bndtls(16);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 146:
            bndtls(16);bndtls(16);
        break;
        case 147:
            bndtls(4);bndtls(2);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 153:
            bndtls(10);bndtls(14);bndtls(1);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 157:
            bndtls(2);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 158:
            bndtls(8);
            while((treated-initial_treated)<(8*message_length)-8) {
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                if (Message_Details_Storage[Details_Position-1]!=-255) {
                    if(train_to_track_paquet(-Message_Details_Storage[Details_Position-1],last_nid_rbc_version)<0) break;
                }
                else break;
            }
        break;
        case 154:
        case 155:
        case 156:
        break;
        default:
            bndtls(message_length-50);
            sprintf(Window_Buffer,"#%03d",nid_message);
            log_it(LOG_ERROR,"Unknown Message : ",Window_Buffer,message_index+1);
            message_length=-1;
            valid_data=false;
        break;
    }

    if ((8*message_length-treated+initial_treated>=8 || 8*message_length-treated+initial_treated<0) && message_length>=0) {
        sprintf(Window_Buffer,"M#%03d (%d/%d)",nid_message,treated-initial_treated,8*message_length);
        log_it(LOG_ERROR,"Train to Track Message length inconsistency : ",Window_Buffer,message_index+1);
        valid_data=false;
    }

}

void D_d_sr(int d_sr,HWND TargetWindow) {
    if (d_sr>100000) sprintf(Window_Buffer,"D_SR\tSpare (%d)\tStaff Responsible distance",d_sr);
    else sprintf(Window_Buffer,"D_SR\t%d m\tStaff Responsible distance",d_sr);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_sr(int v_sr,HWND TargetWindow) {
    if (v_sr>600) sprintf(Window_Buffer,"V_SR\t(%d) Spare\tStaff Responsible speed",v_sr);
    else sprintf(Window_Buffer,"V_SR\t%d km/h\tStaff Responsible speed",v_sr);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_dir(int q_dir,HWND TargetWindow) {
    if (q_dir==0) sprintf(Window_Buffer,"Q_DIR\t(%d) Reverse\tValidity direction of transmitted data",q_dir);
    if (q_dir==1) sprintf(Window_Buffer,"Q_DIR\t(%d) Nominal\tValidity direction of transmitted data",q_dir);
    if (q_dir==2) sprintf(Window_Buffer,"Q_DIR\t(%d) Both directions\tValidity direction of transmitted data",q_dir);
    if (q_dir==3) sprintf(Window_Buffer,"Q_DIR\t(%d) Spare\tValidity direction of transmitted data",q_dir);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_manuel_auto(int q_manuel_auto,HWND TargetWindow) {
    if (q_manuel_auto==0) sprintf(Window_Buffer,"Q_MANUEL_AUTO\t(%d) Manual (driver)\tTransition Mode",q_manuel_auto);
    if (q_manuel_auto==1) sprintf(Window_Buffer,"Q_MANUEL_AUTO\t(%d) Automatic (system)\tTransition Mode",q_manuel_auto);
    if (q_manuel_auto==2) sprintf(Window_Buffer,"Q_MANUEL_AUTO\t(%d) Spare\tTransition Mode",q_manuel_auto);
    if (q_manuel_auto==3) sprintf(Window_Buffer,"Q_MANUEL_AUTO\t(%d) Spare\tTransition Mode",q_manuel_auto);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_rbcentry(int q_rbcentry,HWND TargetWindow) {
    if (q_rbcentry==0) sprintf(Window_Buffer,"Q_RBCENTRY\t(%d) Contact last known RBC\tQualifier for the RBC contact information",q_rbcentry);
    if (q_rbcentry==1) sprintf(Window_Buffer,"Q_RBCENTRY\t(%d) Use short number\tQualifier for the RBC contact information",q_rbcentry);
    if (q_rbcentry==2) sprintf(Window_Buffer,"Q_RBCENTRY\t(%d) Enter RBC data\tQualifier for the RBC contact information",q_rbcentry);
    if (q_rbcentry==3) sprintf(Window_Buffer,"Q_RBCENTRY\t(%d) Spare\tQualifier for the RBC contact information",q_rbcentry);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_dirlrbg(int q_dirlrbg,HWND TargetWindow) {
    if (q_dirlrbg==0) sprintf(Window_Buffer,"Q_DIRLRBG\tReverse\t(%d) Orientation of the train in relation to the direction of the LRBG",q_dirlrbg);
    if (q_dirlrbg==1) sprintf(Window_Buffer,"Q_DIRLRBG\tNominal\t(%d) Orientation of the train in relation to the direction of the LRBG",q_dirlrbg);
    if (q_dirlrbg==2) sprintf(Window_Buffer,"Q_DIRLRBG\tUnknown\t(%d) Orientation of the train in relation to the direction of the LRBG",q_dirlrbg);
    if (q_dirlrbg==3) sprintf(Window_Buffer,"Q_DIRLRBG\tSpare\t(%d) Orientation of the train in relation to the direction of the LRBG",q_dirlrbg);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_dlrbg(int q_dlrbg,HWND TargetWindow) {
    if (q_dlrbg==0) sprintf(Window_Buffer,"Q_DLRBG\tReverse\t(%d) Qualifier telling on which side of the LRBG the estimated front end is",q_dlrbg);
    if (q_dlrbg==1) sprintf(Window_Buffer,"Q_DLRBG\tNominal\t(%d) Qualifier telling on which side of the LRBG the estimated front end is",q_dlrbg);
    if (q_dlrbg==2) sprintf(Window_Buffer,"Q_DLRBG\tUnknown\t(%d) Qualifier telling on which side of the LRBG the estimated front end is",q_dlrbg);
    if (q_dlrbg==3) sprintf(Window_Buffer,"Q_DLRBG\tSpare\t(%d) Qualifier telling on which side of the LRBG the estimated front end is",q_dlrbg);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_dirtrain(int q_dirtrain,HWND TargetWindow) {
    if (q_dirtrain==0) sprintf(Window_Buffer,"Q_DIRTRAIN\t(%d) Reverse\tDirection of train movement in relation to the LRBG orientation",q_dirtrain);
    if (q_dirtrain==1) sprintf(Window_Buffer,"Q_DIRTRAIN\t(%d) Nominal\tDirection of train movement in relation to the LRBG orientation",q_dirtrain);
    if (q_dirtrain==2) sprintf(Window_Buffer,"Q_DIRTRAIN\t(%d) Unknown\tDirection of train movement in relation to the LRBG orientation",q_dirtrain);
    if (q_dirtrain==3) sprintf(Window_Buffer,"Q_DIRTRAIN\t(%d) Spare\tDirection of train movement in relation to the LRBG orientation",q_dirtrain);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_l_packet(int l_packet,HWND TargetWindow) {
    sprintf(Window_Buffer,"L_PACKET\t%d bit(s)\tPacket length",l_packet);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_obp_message(int nid_obp_message,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) Unknown\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==196) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) NIVEAUX DISPONIBLES\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==197) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) POSITION DU COMMUTATEUR Z-EXPL \tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==198) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) INFO VITESSE DISTANCE\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==199) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) CHANGEMENT DE MODE\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==200) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) CHANGEMENT DE NIVEAU\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==201) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) START DISPLAYING ON-BOARD FIXED TEXT MESSAGE\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==202) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) STOP DISPLAYING ON-BOARD FIXED TEXT MESSAGE\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==203) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) DONNEES TRAIN COMPLEMENTAIRES BASELINE 2\tIdentity of proprietary data message linked",nid_obp_message);
    if (nid_obp_message==204) sprintf(Window_Buffer,"NID_OBP_MESSAGE\t(%d) ERREUR LOOP\tIdentity of proprietary data message linked",nid_obp_message);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_xuser(int nid_xuser,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_XUSER\t(%d) Unknown\tIdentity of user system",nid_xuser);
    if (nid_xuser==1) sprintf(Window_Buffer,"NID_XUSER\t(%d) MMI Direct\tIdentity of user system",nid_xuser);
    if (nid_xuser==2) sprintf(Window_Buffer,"NID_XUSER\t(%d) SBB, Zub 121 migration in Switzerland Siemens\tIdentity of user system",nid_xuser);
    if (nid_xuser==3) sprintf(Window_Buffer,"NID_XUSER\t(%d) For ZSI 127 (train control for narrow gauge application\tIdentity of user system",nid_xuser);
    if (nid_xuser==4) sprintf(Window_Buffer,"NID_XUSER\t(%d) DB AG\tIdentity of user system",nid_xuser);
    if (nid_xuser==5) sprintf(Window_Buffer,"NID_XUSER\t(%d) for pantograph to third rail switching at Rheinbraun Mining Railway\tIdentity of user system",nid_xuser);
    if (nid_xuser==6) sprintf(Window_Buffer,"NID_XUSER\t(%d) RFF Functions\tIdentity of user system",nid_xuser);
    if (nid_xuser==7) sprintf(Window_Buffer,"NID_XUSER\t(%d) Bombardier Transportation Rail Control Solutions\tIdentity of user system",nid_xuser);
    if (nid_xuser==8) sprintf(Window_Buffer,"NID_XUSER\t(%d) PSD session establishment information for ETCS\tIdentity of user system",nid_xuser);
    if (nid_xuser==9) sprintf(Window_Buffer,"NID_XUSER\t(%d) RSBB (UK)\tIdentity of user system",nid_xuser);
    if (nid_xuser==10) sprintf(Window_Buffer,"NID_XUSER\t(%d) MAV (Hungarian State Railways)\tIdentity of user system",nid_xuser);
    if (nid_xuser==11) sprintf(Window_Buffer,"NID_XUSER\t(%d) Train borne fire alarm (Netherlands)\tIdentity of user system",nid_xuser);
    if (nid_xuser==12) sprintf(Window_Buffer,"NID_XUSER\t(%d) RENFE, Used in Zaragoza - Huesca ERTMS TRK-L1,\tIdentity of user system",nid_xuser);
    if (nid_xuser==13) sprintf(Window_Buffer,"NID_XUSER\t(%d) SNCB (projects EURO-TBL 1 & EURO-TBL2)\tIdentity of user system",nid_xuser);
    if (nid_xuser==14) sprintf(Window_Buffer,"NID_XUSER\t(%d) TRAINGUARD MT - Trainstop\tIdentity of user system",nid_xuser);
    if (nid_xuser==15) sprintf(Window_Buffer,"NID_XUSER\t(%d) TRAINGUARD MT - ITC mode\tIdentity of user system",nid_xuser);
    if (nid_xuser==16) sprintf(Window_Buffer,"NID_XUSER\t(%d) Door release function for Marmaray ERTMS project\tIdentity of user system",nid_xuser);
    if (nid_xuser==17) sprintf(Window_Buffer,"NID_XUSER\t(%d) CBTC balise message embedding for Marmaray ERTMS project\tIdentity of user system",nid_xuser);
    if (nid_xuser==18) sprintf(Window_Buffer,"NID_XUSER\t(%d) SZ/RU Functions\tIdentity of user system",nid_xuser);
    if (nid_xuser==20) sprintf(Window_Buffer,"NID_XUSER\t(%d) ÖBB\tIdentity of user system",nid_xuser);
    if (nid_xuser==39) sprintf(Window_Buffer,"NID_XUSER\t(%d) Italian Railway FS, used currently in Pkt44 with\tIdentity of user system",nid_xuser);
    if (nid_xuser==50) sprintf(Window_Buffer,"NID_XUSER\t(%d) Thales ETCS OBS\tIdentity of user system",nid_xuser);
    if (nid_xuser==99) sprintf(Window_Buffer,"NID_XUSER\t(%d) Track conditions for national systems in areas not fitted with \tIdentity of user system",nid_xuser);
    if (nid_xuser==100) sprintf(Window_Buffer,"NID_XUSER\t(%d) Transition Coherence Control\tIdentity of user system",nid_xuser);
    if (nid_xuser==101) sprintf(Window_Buffer,"NID_XUSER\t(%d) SNCF Functions\tIdentity of user system",nid_xuser);
    if (nid_xuser==102) sprintf(Window_Buffer,"NID_XUSER\t(%d) STM Functions\tIdentity of user system",nid_xuser);
    if (nid_xuser==150) sprintf(Window_Buffer,"NID_XUSER\t(%d) Sweden (Banverket)\tIdentity of user system",nid_xuser);
    if (nid_xuser==200) sprintf(Window_Buffer,"NID_XUSER\t(%d) Correct Side Door Enable Function for Auckland Metropolitan Rail Network\tIdentity of user system",nid_xuser);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (nid_xuser==99) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tETCS in Belgium");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (nid_xuser==39) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tdestination = SCMT STM national");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (nid_xuser==12) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tfor the spanish National functions FN-36");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (nid_xuser==8) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tover GPRS (Denmark)");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (nid_xuser==5) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tin Germany (telegram structure according to SRS 5A)");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (nid_xuser==3) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tin Switzerland, Spain), can be on lines with 3rd/4th rail,");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\twhere ETCS equipped train pass");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
}

void D_data_tbl1p(int data_tbl1p,HWND TargetWindow) {

        sprintf(Window_Buffer,"DATA_TBL1+\tUnknown (%.4I64X) Rejected | Unused code\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //0X?
        if (data_tbl1p==3855) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Red – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3857) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Red + White – GS – VNS / near GS VNS Red + White/Closed\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3874) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Yellows – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3900) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Vertical Yellow Green – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3908) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 1 Green – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3930) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Greens – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3945) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Horizontal Yellow Green – GS – VNS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4035) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3976) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==3990) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4005) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //1X?
        if (data_tbl1p==4367) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Red – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4369) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Red + Whites – GS - CVT / near Red + White / closed GS CVT \tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4386) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Yellows – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4412) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Vertical Yellow Green – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4420) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 1 Green – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4442) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Greebs – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4457) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Horizontal Yellow Green – GS – CVT\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4547) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4488) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4502) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==4517) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //2X?
        if (data_tbl1p==8719) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8721) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8738) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Yellows – SAI Balise KVW (VNS & CVT)\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8764) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Vertical Yellow Green – SAI\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8772) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 1 Green – SAI\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8794) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Greens – SAI\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8809) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Horizontal Yellow Green – SAI\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8899) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8840) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8854) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==8869) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Yellows – SA\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //3X?
        if (data_tbl1p==15375) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Red – SAS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15377) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15394) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15420) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 2 Whites askew – PSA\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15428) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) 1 Yellow – SAS\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15450) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15465) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) PM limit sign / 2 horizontal whites – PSA\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15555) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15496) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15510) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==15525) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) PM limit sign / 2 horizontal whites - PSA\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //4X?
        if (data_tbl1p==17476) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Enter zone P44 TBL1+\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==17498) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Exit zone P44 TBL1+ / Invalid combination at LEU Start\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==17513) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) No info from balise (LEU) = Default balise message\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==17603) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //5X?
        if (data_tbl1p==23055) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_NL\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23057) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_GER\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23074) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_FR\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23100) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_LUX\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23108) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) OFF_TBL1+_NL\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23130) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) OFF_TBL1+_GER\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23145) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) OFF_TBL1+_FR\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23235) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) OFF_TBL1+_LUX\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23176) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_NCV\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23190) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) ON_TBL1+_CVR\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==23205) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) OFF_TBL1+_XXX\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //9X?
        if (data_tbl1p==38550) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Message without objet (diagnostic)\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

        //AX?
        if (data_tbl1p==42255) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42257) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42274) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42300) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42308) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42330) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42345) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42435) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42376) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42390) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);
        if (data_tbl1p==42405) sprintf(Window_Buffer,"DATA_TBL1+\t(%.4I64X) Reserved\tTBL 1+ additional data",(unsigned long long int)data_tbl1p);

    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_stm(int nid_stm,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_STM\tUnknown (%d)\tActive STM",nid_stm);
    if (nid_stm==0) sprintf(Window_Buffer,"NID_STM\t(%d) ASFA (Spain)\tActive STM",nid_stm);
    if (nid_stm==1) sprintf(Window_Buffer,"NID_STM\t(%d) ATB (Netherlands)\tActive STM",nid_stm);
    if (nid_stm==2) sprintf(Window_Buffer,"NID_STM\t(%d) LZB (C) (Spain)\tActive STM",nid_stm);
    if (nid_stm==3) sprintf(Window_Buffer,"NID_STM\t(%d) ASFA AVE (Spain)\tActive STM",nid_stm);
    if (nid_stm==5) sprintf(Window_Buffer,"NID_STM\t(%d) TBL 1 (Belgium)\tActive STM",nid_stm);
    if (nid_stm==6) sprintf(Window_Buffer,"NID_STM\t(%d) INDUSI (Germany, Austria)\tActive STM",nid_stm);
    if (nid_stm==7) sprintf(Window_Buffer,"NID_STM\t(%d) TBL 2/3 (Belgium)\tActive STM",nid_stm);
    if (nid_stm==8) sprintf(Window_Buffer,"NID_STM\t(%d) KVB (France)\tActive STM",nid_stm);
    if (nid_stm==9) sprintf(Window_Buffer,"NID_STM\t(%d) PZB/LZB (Germany)\tActive STM",nid_stm);
    if (nid_stm==10) sprintf(Window_Buffer,"NID_STM\t(%d) LZB (Spain)\tActive STM",nid_stm);
    if (nid_stm==11) sprintf(Window_Buffer,"NID_STM\t(%d) SCMT (Italy)\tActive STM",nid_stm);
    if (nid_stm==12) sprintf(Window_Buffer,"NID_STM\t(%d) MEMOR II+ (Luxembourg)\tActive STM",nid_stm);
    if (nid_stm==14) sprintf(Window_Buffer,"NID_STM\t(%d) TVM (France, Belgium, UK, China, Korea)\tActive STM",nid_stm);
    if (nid_stm==15) sprintf(Window_Buffer,"NID_STM\t(%d) BACC (Italy)\tActive STM",nid_stm);
    if (nid_stm==16) sprintf(Window_Buffer,"NID_STM\t(%d) RSDD (Italy)\tActive STM",nid_stm);
    if (nid_stm==17) sprintf(Window_Buffer,"NID_STM\t(%d) EVM (Hungary)\tActive STM",nid_stm);
    if (nid_stm==18) sprintf(Window_Buffer,"NID_STM\t(%d) Crocodile (Belgium)\tActive STM",nid_stm);
    if (nid_stm==19) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB 900 TBS (Spain)\tActive STM",nid_stm);
    if (nid_stm==20) sprintf(Window_Buffer,"NID_STM\t(%d) TPWS/AWS (UK)\tActive STM",nid_stm);
    if (nid_stm==21) sprintf(Window_Buffer,"NID_STM\t(%d) TPWS/AWS (SA) (UK)\tActive STM",nid_stm);
    if (nid_stm==22) sprintf(Window_Buffer,"NID_STM\t(%d) ATC2 (Norway, Sweden)\tActive STM",nid_stm);
    if (nid_stm==23) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB 900 (Finland)\tActive STM",nid_stm);
    if (nid_stm==24) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB 900 (PL) (Poland)\tActive STM",nid_stm);
    if (nid_stm==25) sprintf(Window_Buffer,"NID_STM\t(%d) KNR ATS (Korea)\tActive STM",nid_stm);
    if (nid_stm==26) sprintf(Window_Buffer,"NID_STM\t(%d) SHP (Poland)\tActive STM",nid_stm);
    if (nid_stm==27) sprintf(Window_Buffer,"NID_STM\t(%d) INDUSI I 60 (Croatia and others)\tActive STM",nid_stm);
    if (nid_stm==28) sprintf(Window_Buffer,"NID_STM\t(%d) TBL 1+ (Belgium)\tActive STM",nid_stm);
    if (nid_stm==29) sprintf(Window_Buffer,"NID_STM\t(%d) NExTEO (France)\tActive STM",nid_stm);
    if (nid_stm==30) sprintf(Window_Buffer,"NID_STM\t(%d) ZUB 123 (Denmark)\tActive STM",nid_stm);
    if (nid_stm==31) sprintf(Window_Buffer,"NID_STM\t(%d) ZUB 121 / Signum (Switzerland)\tActive STM",nid_stm);
    if (nid_stm==32) sprintf(Window_Buffer,"NID_STM\t(%d) RPS (France)\tActive STM",nid_stm);
    if (nid_stm==33) sprintf(Window_Buffer,"NID_STM\t(%d) LS (Czech Republic, Slovakia)\tActive STM",nid_stm);
    if (nid_stm==34) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB 700 (P) (Portugal)\tActive STM",nid_stm);
    if (nid_stm==35) sprintf(Window_Buffer,"NID_STM\t(%d) SELCAB (UK)\tActive STM",nid_stm);
    if (nid_stm==36) sprintf(Window_Buffer,"NID_STM\t(%d) INDUSI I 60 (Romania and others)\tActive STM",nid_stm);
    if (nid_stm==37) sprintf(Window_Buffer,"NID_STM\t(%d) TBL (UK)\tActive STM",nid_stm);
    if (nid_stm==39) sprintf(Window_Buffer,"NID_STM\t(%d) ALSN (Baltic)\tActive STM",nid_stm);
    if (nid_stm==40) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB (Bulgaria)\tActive STM",nid_stm);
    if (nid_stm==45) sprintf(Window_Buffer,"NID_STM\t(%d) CTCS-2 (China)\tActive STM",nid_stm);
    if (nid_stm==46) sprintf(Window_Buffer,"NID_STM\t(%d) EBICAB 700 (Malaysia)\tActive STM",nid_stm);
    if (nid_stm==255) sprintf(Window_Buffer,"NID_STM\t(%d) All (Reserved for multicast)\tActive STM",nid_stm);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_other_data(int other_data,HWND TargetWindow) {
    sprintf(Window_Buffer,"Other Data\t%d\tUnknown",other_data);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_text_dmi(int q_text_dmi,HWND TargetWindow) {
    sprintf(Window_Buffer,"Q_TEXT_DMI\t(%d) Unknown\tPredefined message",q_text_dmi);
    if (q_text_dmi==0) sprintf(Window_Buffer,"Q_TEXT_DMI\t(0) <Parameter>\tPredefined message");
    if (q_text_dmi==8) sprintf(Window_Buffer,"Q_TEXT_DMI\t(8) German STM transition announcement\tPredefined message");
    if (q_text_dmi==10) sprintf(Window_Buffer,"Q_TEXT_DMI\t(10) ERTMS N1 transition announcement\tPredefined message");
    if (q_text_dmi==11) sprintf(Window_Buffer,"Q_TEXT_DMI\t(11) ERTMS N2 transition announcement\tPredefined message");
    if (q_text_dmi==12) sprintf(Window_Buffer,"Q_TEXT_DMI\t(12) France STM transition announcement\tPredefined message");
    if (q_text_dmi==13) sprintf(Window_Buffer,"Q_TEXT_DMI\t(13) ERTMS N0 transition announcement\tPredefined message");
    if (q_text_dmi==14) sprintf(Window_Buffer,"Q_TEXT_DMI\t(14) Forbidden level transition announcement\tPredefined message");
    if (q_text_dmi==15) sprintf(Window_Buffer,"Q_TEXT_DMI\t(15) Forbidden level transition execution\tPredefined message");
    if (q_text_dmi==18) sprintf(Window_Buffer,"Q_TEXT_DMI\t(18) No RBC answer on request for PT mode acknowledgement\tPredefined message");
    if (q_text_dmi==19) sprintf(Window_Buffer,"Q_TEXT_DMI\t(19) RBC not connected on request for PT mode acknowledgement\tPredefined message");
    if (q_text_dmi==20) sprintf(Window_Buffer,"Q_TEXT_DMI\t(20) SOL has exceeded the max number of allowed TSRs\tPredefined message");
    if (q_text_dmi==29) sprintf(Window_Buffer,"Q_TEXT_DMI\t(29) New SOL profiles received do not cover the MA\tPredefined message");
    if (q_text_dmi==38) sprintf(Window_Buffer,"Q_TEXT_DMI\t(38) RBC connexion failed (after too many tries)\tPredefined message");
    if (q_text_dmi==44) sprintf(Window_Buffer,"Q_TEXT_DMI\t(44) No RBC allocation received after end of SoM\tPredefined message");
    if (q_text_dmi==50) sprintf(Window_Buffer,"Q_TEXT_DMI\t(50) Train movement during ""data view""\tPredefined message");
    if (q_text_dmi==51) sprintf(Window_Buffer,"Q_TEXT_DMI\t(51) MA shortened on balise or radio fault\tPredefined message");
    if (q_text_dmi==52) sprintf(Window_Buffer,"Q_TEXT_DMI\t(52) MA shortened on section temporisation end\tPredefined message");
    if (q_text_dmi==53) sprintf(Window_Buffer,"Q_TEXT_DMI\t(53) MA shortened on ""end section"" temporisation end\tPredefined message");
    if (q_text_dmi==93) sprintf(Window_Buffer,"Q_TEXT_DMI\t(93) ETCS radio fault\tPredefined message");
    if (q_text_dmi==94) sprintf(Window_Buffer,"Q_TEXT_DMI\t(94) Tachometry fault\tPredefined message");
    if (q_text_dmi==95) sprintf(Window_Buffer,"Q_TEXT_DMI\t(95) BTM fault\tPredefined message");
    if (q_text_dmi==96) sprintf(Window_Buffer,"Q_TEXT_DMI\t(96) TVM fault\tPredefined message");
    if (q_text_dmi==97) sprintf(Window_Buffer,"Q_TEXT_DMI\t(97) TIU fault\tPredefined message");
    if (q_text_dmi==98) sprintf(Window_Buffer,"Q_TEXT_DMI\t(98) DMI fault\tPredefined message");
    if (q_text_dmi==99) sprintf(Window_Buffer,"Q_TEXT_DMI\t(99) JDx fault\tPredefined message");
    if (q_text_dmi==100) sprintf(Window_Buffer,"Q_TEXT_DMI\t(100) EVC internal fault\tPredefined message");
    if (q_text_dmi==101) sprintf(Window_Buffer,"Q_TEXT_DMI\t(101) Train data not acknowledged by RBC during SoM\tPredefined message");
    if (q_text_dmi==102) sprintf(Window_Buffer,"Q_TEXT_DMI\t(102) Train data not acknowledged by RBC during N2 entry or RBC/RBC handover\tPredefined message");
    if (q_text_dmi==103) sprintf(Window_Buffer,"Q_TEXT_DMI\t(103) Train data not acknowledged by RBC as they were changed during mission\tPredefined message");
    if (q_text_dmi==110) sprintf(Window_Buffer,"Q_TEXT_DMI\t(110) Catenary consistency check fault at transition\tPredefined message");
    if (q_text_dmi==115) sprintf(Window_Buffer,"Q_TEXT_DMI\t(115) Proofreading discrepancy between MTORE_A and MTORE_B input of the Z-EXPL switch\tPredefined message");
    if (q_text_dmi==116) sprintf(Window_Buffer,"Q_TEXT_DMI\t(116) Proofreading discrepancy between MTORE_A and MTRORE_B input of the E-BG(IS)\tPredefined message");
    if (q_text_dmi==117) sprintf(Window_Buffer,"Q_TEXT_DMI\t(117) Proofreading discrepancy between the determined value for Z-BG(IS) and its value determined via the MTORE\tPredefined message");
    if (q_text_dmi==118) sprintf(Window_Buffer,"Q_TEXT_DMI\t(118) Selection discrepancy of the mission start level (relative to Z(SEL)UL or previous level)\tPredefined message");
    if (q_text_dmi==122) sprintf(Window_Buffer,"Q_TEXT_DMI\t(122) Nominal disconnection requested by RBC but not expected\tPredefined message");
    if (q_text_dmi==125) sprintf(Window_Buffer,"Q_TEXT_DMI\t(125) Confirm selectiion : France STM\tPredefined message");
    if (q_text_dmi==126) sprintf(Window_Buffer,"Q_TEXT_DMI\t(126) Confirm selectiion : Germany STM\tPredefined message");
    if (q_text_dmi==128) sprintf(Window_Buffer,"Q_TEXT_DMI\t(128) Confirm selection : STM TBL\tPredefined message");
    if (q_text_dmi==129) sprintf(Window_Buffer,"Q_TEXT_DMI\t(129) Confirm selection : STM ATB\tPredefined message");
    if (q_text_dmi==130) sprintf(Window_Buffer,"Q_TEXT_DMI\t(130) Confirm selection : ERTMS level 0\tPredefined message");
    if (q_text_dmi==131) sprintf(Window_Buffer,"Q_TEXT_DMI\t(131) Confirm selection : ERTMS level 1\tPredefined message");
    if (q_text_dmi==132) sprintf(Window_Buffer,"Q_TEXT_DMI\t(132) Confirm selection : ERTMS level 2\tPredefined message");
    if (q_text_dmi==140) sprintf(Window_Buffer,"Q_TEXT_DMI\t(140) Confirmer track free in front\tPredefined message");
    if (q_text_dmi==142) sprintf(Window_Buffer,"Q_TEXT_DMI\t(142) Overspeed\tPredefined message");
    if (q_text_dmi==158) sprintf(Window_Buffer,"Q_TEXT_DMI\t(158) TVM maintenance test canceled\tPredefined message");
    if (q_text_dmi==159) sprintf(Window_Buffer,"Q_TEXT_DMI\t(159) TVM maintenance test not correct\tPredefined message");
    if (q_text_dmi==160) sprintf(Window_Buffer,"Q_TEXT_DMI\t(160) TVM maintenance test without fault\tPredefined message");
    if (q_text_dmi==161) sprintf(Window_Buffer,"Q_TEXT_DMI\t(161) Fatal fault chain <parameter>\tPredefined message");
    if (q_text_dmi==162) sprintf(Window_Buffer,"Q_TEXT_DMI\t(162) ZESCAB switch fault chain <parameter>\tPredefined message");
    if (q_text_dmi==163) sprintf(Window_Buffer,"Q_TEXT_DMI\t(163) CRNB bandpass filter clearance test fault chain <parameter>\tPredefined message");
    if (q_text_dmi==164) sprintf(Window_Buffer,"Q_TEXT_DMI\t(164) 1/p continuous transmission test fault chain <parameter>\tPredefined message");
    if (q_text_dmi==165) sprintf(Window_Buffer,"Q_TEXT_DMI\t(165) n/p continuous transmission test fault chain <parameter>\tPredefined message");
    if (q_text_dmi==166) sprintf(Window_Buffer,"Q_TEXT_DMI\t(166) Non fatal fault chain <parameter>\tPredefined message");
    if (q_text_dmi==167) sprintf(Window_Buffer,"Q_TEXT_DMI\t(167) 1/p intermittent transmission test fault chain <parameter>\tPredefined message");
    if (q_text_dmi==168) sprintf(Window_Buffer,"Q_TEXT_DMI\t(168) n/p intermittent transmission test fault chain <parameter>\tPredefined message");
    if (q_text_dmi==169) sprintf(Window_Buffer,"Q_TEXT_DMI\t(169) Sensors switching fault chain <parameter>\tPredefined message");
    if (q_text_dmi==170) sprintf(Window_Buffer,"Q_TEXT_DMI\t(170) Transmission fault\tPredefined message");
    if (q_text_dmi==171) sprintf(Window_Buffer,"Q_TEXT_DMI\t(171) SOS TVM VYCV\tPredefined message");
    if (q_text_dmi==172) sprintf(Window_Buffer,"Q_TEXT_DMI\t(172) SOS TVM arming control fault\tPredefined message");
    if (q_text_dmi==173) sprintf(Window_Buffer,"Q_TEXT_DMI\t(173) SOS TVM general fault\tPredefined message");
    if (q_text_dmi==174) sprintf(Window_Buffer,"Q_TEXT_DMI\t(174) KVB standby fault\tPredefined message");
    if (q_text_dmi==175) sprintf(Window_Buffer,"Q_TEXT_DMI\t(175) KVB active fault\tPredefined message");
    if (q_text_dmi==176) sprintf(Window_Buffer,"Q_TEXT_DMI\t(176) Inactive LZB/PZB fault (LZB80/16)\tPredefined message");
    if (q_text_dmi==177) sprintf(Window_Buffer,"Q_TEXT_DMI\t(177) Active LZB/PZB fault (LZB80/16)\tPredefined message");
    if (q_text_dmi==178) sprintf(Window_Buffer,"Q_TEXT_DMI\t(178) Unpossible selection received from DMI\tPredefined message");
    if (q_text_dmi==179) sprintf(Window_Buffer,"Q_TEXT_DMI\t(179) FU proofreading test pending\tPredefined message");
    if (q_text_dmi==182) sprintf(Window_Buffer,"Q_TEXT_DMI\t(182) ZBGIS emergency\tPredefined message");
    if (q_text_dmi==183) sprintf(Window_Buffer,"Q_TEXT_DMI\t(183) ETCS zone fault\tPredefined message");
    if (q_text_dmi==184) sprintf(Window_Buffer,"Q_TEXT_DMI\t(184) Train technical functions fault\tPredefined message");
    if (q_text_dmi==185) sprintf(Window_Buffer,"Q_TEXT_DMI\t(185) Inactive TVM fault\tPredefined message");
    if (q_text_dmi==186) sprintf(Window_Buffer,"Q_TEXT_DMI\t(186) TVM not armed fault\tPredefined message");
    if (q_text_dmi==187) sprintf(Window_Buffer,"Q_TEXT_DMI\t(187) Passive sleep TVM fault\tPredefined message");
    if (q_text_dmi==192) sprintf(Window_Buffer,"Q_TEXT_DMI\t(192) Transition to STM TBL1 announcement\tPredefined message");
    if (q_text_dmi==193) sprintf(Window_Buffer,"Q_TEXT_DMI\t(193) Transition to STM TBL2 announcement\tPredefined message");
    if (q_text_dmi==194) sprintf(Window_Buffer,"Q_TEXT_DMI\t(194) Transition to STM ATB announcement\tPredefined message");
    if (q_text_dmi==195) sprintf(Window_Buffer,"Q_TEXT_DMI\t(195) DMI-ATBL link fault\tPredefined message");
    if (q_text_dmi==196) sprintf(Window_Buffer,"Q_TEXT_DMI\t(196) DMI-PZB/LZB link fault\tPredefined message");
    if (q_text_dmi==197) sprintf(Window_Buffer,"Q_TEXT_DMI\t(197) MVB fault\tPredefined message");
    if (q_text_dmi==229) sprintf(Window_Buffer,"Q_TEXT_DMI\t(229) Lower pantograph catch-up\tPredefined message");
    if (q_text_dmi==230) sprintf(Window_Buffer,"Q_TEXT_DMI\t(230) Power cut catch-up\tPredefined message");
    if (q_text_dmi==231) sprintf(Window_Buffer,"Q_TEXT_DMI\t(231) Active diagnostic state\tPredefined message");
    if (q_text_dmi==234) sprintf(Window_Buffer,"Q_TEXT_DMI\t(234) LZB/PZB fault (LZB80E)\tPredefined message");
    if (q_text_dmi==235) sprintf(Window_Buffer,"Q_TEXT_DMI\t(235) BTM/Euro-antenna switching fault\tPredefined message");
    if (q_text_dmi==240) sprintf(Window_Buffer,"Q_TEXT_DMI\t(240) SOL has exceeded the max number of allowed non-TSR information\tPredefined message");

    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_vbcmk(int nid_vbcmk,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_VBCMK\t%d\tMarker for Virtual balise cover",nid_vbcmk);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_cold_mvt(int m_cold_event,HWND TargetWindow) {
    if (m_cold_event==0) sprintf(Window_Buffer,"M_COLD_EVENT\t(%d) No cold movement occured\tCold movement detector information",m_cold_event);
    if (m_cold_event==1) sprintf(Window_Buffer,"M_COLD_EVENT\t(%d) Cold movement detected\tCold movement detector information",m_cold_event);
    if (m_cold_event==2) sprintf(Window_Buffer,"M_COLD_EVENT\t(%d) No cold movement information available\tCold movement detector information",m_cold_event);
    if (m_cold_event==3) sprintf(Window_Buffer,"M_COLD_EVENT\t(%d) Spare\tCold movement detector information",m_cold_event);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_z_expl(int z_expl,HWND TargetWindow) {
    if (z_expl==1) sprintf(Window_Buffer,"Z_EXPL\t(%d) ERTMS/STM\tExploitation mode",z_expl);
    else if (z_expl==2) sprintf(Window_Buffer,"Z_EXPL\t(%d) STM\tExploitation mode",z_expl);
    else sprintf(Window_Buffer,"Z_EXPL\t(%d) Free\tExploitation mode",z_expl);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_version(int m_version,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_VERSION\t(%d) Previous version\tVersion of ETCS system",m_version);
    if (m_version==16) sprintf(Window_Buffer,"M_VERSION\t(%d) Version 1.0\tVersion of ETCS system",m_version);
    if (m_version==17) sprintf(Window_Buffer,"M_VERSION\t(%d) Version 1.1\tVersion of ETCS system",m_version);
    if (m_version>=18 && m_version<=31) sprintf(Window_Buffer,"M_VERSION\t(%d) Not Valid\tVersion of ETCS system",m_version);
    if (m_version==32) sprintf(Window_Buffer,"M_VERSION\t(%d) Version 2.0\tVersion of ETCS system",m_version);
    if (m_version>32) sprintf(Window_Buffer,"M_VERSION\t(%d) Reserved for future use\tVersion of ETCS system",m_version);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_scale(float q_scale,HWND TargetWindow) {
    sprintf(Window_Buffer,"Q_SCALE\t%.1f m\tEchelle",q_scale);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_d_g(float q_scale, int d, char* tete, char* queue,char* error,HWND TargetWindow) {
    if (d==32767 && error!=NULL) sprintf(Window_Buffer,"%s\t%s\t%s",tete,error,queue);
    else sprintf(Window_Buffer,"%s\t%d m\t%s",tete,(int)(q_scale*d),queue);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_d_bg(int d,HWND TargetWindow) {
    if (d<0) sprintf(Window_Buffer,"D_NID_BG\t(%d) Distance is unknown\tDistance to above NID_BG",d);
    else sprintf(Window_Buffer,"D_NID_BG\t%d m\tDistance to above NID_BG",d);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_n_iter(int n_iter,HWND TargetWindow) {
    sprintf(Window_Buffer,"N_ITER\t%d iteration(s)\tIteration(s) count",n_iter);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_c(int nid_c,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_C\tUnknown (%d)\tCountry or region identity number", nid_c);
    if (nid_c==1) sprintf(Window_Buffer,"NID_C\t(%d) UK : Cambrian line\tCountry or region identity number", nid_c);
    if (nid_c==2) sprintf(Window_Buffer,"NID_C\t(%d) UK : Thameslink\tCountry or region identity number", nid_c);
    if (nid_c>=3 && nid_c<=26) sprintf(Window_Buffer,"NID_C\t(%d) UK : Reserved\tCountry or region identity number", nid_c);
    if (nid_c>=56 && nid_c<=58) sprintf(Window_Buffer,"NID_C\t(%d) Luxembourg\tCountry or region identity number", nid_c);
    if (nid_c>=59 && nid_c<=61) sprintf(Window_Buffer,"NID_C\t(%d) Luxembourg : Reserved (CFL)\tCountry or region identity number", nid_c);
    if (nid_c==62) sprintf(Window_Buffer,"NID_C\t(%d) Luxembourg\tCountry or region identity number", nid_c);
    if (nid_c==63) sprintf(Window_Buffer,"NID_C\t(%d) Luxembourg : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==64) sprintf(Window_Buffer,"NID_C\t(%d) Germany : Pilot line(SBAR)DB, JH-L\tCountry or region identity number", nid_c);
    if ((nid_c>=65 && nid_c<=104) || (nid_c>=106 && nid_c<=127)) sprintf(Window_Buffer,"NID_C\t(%d) Germany : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==105) sprintf(Window_Buffer,"NID_C\t(%d) Germany : S-Bahn Berlin\tCountry or region identity number", nid_c);
    if (nid_c==128) sprintf(Window_Buffer,"NID_C\t(%d) France : RFF - HSL East\tCountry or region identity number", nid_c);
    if (nid_c>=129 && nid_c<=191) sprintf(Window_Buffer,"NID_C\t(%d) France : RFF\tCountry or region identity number", nid_c);
    if (nid_c==253 || nid_c==255) sprintf(Window_Buffer,"NID_C\t(%d) Belgium : Infrabel conventional lines\tCountry or region identity number", nid_c);
    if (nid_c==254) sprintf(Window_Buffer,"NID_C\t(%d) Belgium : Infrabel high speed lines\tCountry or region identity number", nid_c);
    if (nid_c==256) sprintf(Window_Buffer,"NID_C\t(%d) Italy : RFI network (both SCMT and ERTMS)\tCountry or region identity number", nid_c);
    if (nid_c==257) sprintf(Window_Buffer,"NID_C\t(%d) Italy : RFI network\tCountry or region identity number", nid_c);
    if (nid_c>=258 && nid_c<=288) sprintf(Window_Buffer,"NID_C\t(%d) Italy : Requested for SCMT\tCountry or region identity number", nid_c);
    if (nid_c==289) sprintf(Window_Buffer,"NID_C\t(%d) Italy : RFT (Rete Ferroviaria Toscana)\tCountry or region identity number", nid_c);
    if (nid_c==290) sprintf(Window_Buffer,"NID_C\t(%d) Italy : STA (Strutture Trasporto Alto Adige)\tCountry or region identity number", nid_c);
    if (nid_c>=322 && nid_c<=335) sprintf(Window_Buffer,"NID_C\t(%d) Finland : Finnish Transport Agency Lines (Liikennevirasto)\tCountry or region identity number", nid_c);
    if (nid_c==336) sprintf(Window_Buffer,"NID_C\t(%d) Romania\tCountry or region identity number", nid_c);
    if (nid_c==337) sprintf(Window_Buffer,"NID_C\t(%d) Romania : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==338) sprintf(Window_Buffer,"NID_C\t(%d) Republic of Macedonia : Corridor VIII - line section : Kumanovo - Beljakovce\tCountry or region identity number", nid_c);
    if (nid_c==339) sprintf(Window_Buffer,"NID_C\t(%d) Poland : Pomeranian Metropolitan Railway\tCountry or region identity number", nid_c);
    if (nid_c>=340 && nid_c<=343) sprintf(Window_Buffer,"NID_C\t(%d) Poland : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==344) sprintf(Window_Buffer,"NID_C\t(%d) Denmark : Fjernbane Infrastructure System West\tCountry or region identity number", nid_c);
    if (nid_c==345) sprintf(Window_Buffer,"NID_C\t(%d) Denmark : Fjernbane Infrastructure System East\tCountry or region identity number", nid_c);
    if (nid_c>=346 && nid_c<=350) sprintf(Window_Buffer,"NID_C\t(%d) Denmark : Private railway lines\tCountry or region identity number", nid_c);
    if (nid_c==351) sprintf(Window_Buffer,"NID_C\t(%d) Spain/France : Perpignan-Figueras mixed traffic line\tCountry or region identity number", nid_c);
    if (nid_c==352) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Madrid - Zaragoza - Barcelona - French Border\tCountry or region identity number", nid_c);
    if (nid_c==353) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Zaragoza - Huesca and Barcelona - Figueres\tCountry or region identity number", nid_c);
    if (nid_c==354) sprintf(Window_Buffer,"NID_C\t(%d) Spain : La sagra - Toledo\tCountry or region identity number", nid_c);
    if (nid_c==355) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Córdoba - Málaga\tCountry or region identity number", nid_c);
    if (nid_c==357) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Madrid - Valladolid\tCountry or region identity number", nid_c);
    if (nid_c==358) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Orense - Santiago\tCountry or region identity number", nid_c);
    if (nid_c == 356 || (nid_c>=359 && nid_c<=360) || (nid_c>=362 && nid_c<=363) || (nid_c>=365 && nid_c<=366) || (nid_c>=368 && nid_c<=369) || (nid_c>=371 && nid_c<=383)) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==361) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Madrid - Valencia\tCountry or region identity number", nid_c);
    if (nid_c==364) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Madrid Cercanías\tCountry or region identity number", nid_c);
    if (nid_c==367) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Ferrocarriles Generalitat (P44)\tCountry or region identity number", nid_c);
    if (nid_c==370) sprintf(Window_Buffer,"NID_C\t(%d) Spain : Pilot Line Albacete - Villar de Chincilla\tCountry or region identity number", nid_c);
    if (nid_c==384) sprintf(Window_Buffer,"NID_C\t(%d) Austria : Wien - Nickelsdor\tCountry or region identity number", nid_c);
    if (nid_c==385) sprintf(Window_Buffer,"NID_C\t(%d) Austria\tCountry or region identity number", nid_c);
    if (nid_c>=386 && nid_c<=390) sprintf(Window_Buffer,"NID_C\t(%d) Austria : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==392) sprintf(Window_Buffer,"NID_C\t(%d) Bulgaria : Plovdid - Svilengrad, Danube-Bridge 2 Vidin-Calafat ETCS L1 projects\tCountry or region identity number", nid_c);
    if (nid_c==400) sprintf(Window_Buffer,"NID_C\t(%d) Serbia-Montenegro : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==409) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Eskisehir (Ecluding) - Balikesir Line\tCountry or region identity number", nid_c);
    if (nid_c==410) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Ankara - Istanbul High Speed Line\tCountry or region identity number", nid_c);
    if (nid_c==411) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Marmaray ERTMS project\tCountry or region identity number", nid_c);
    if (nid_c==412) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Mersin - Toprakkale ETCS L1 project\tCountry or region identity number", nid_c);
    if (nid_c==413) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Bogasköprü - Yenice ETCS L1 project\tCountry or region identity number", nid_c);
    if (nid_c==414) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==415) sprintf(Window_Buffer,"NID_C\t(%d) Turkey : Ankara Konya High Speed line\tCountry or region identity number", nid_c);
    if (nid_c==416) sprintf(Window_Buffer,"NID_C\t(%d) Hungary : Budapest - Kelenföld (excl.) - Hegyeshalom (Austrian border) line ERTMS_ETCS L1\tCountry or region identity number", nid_c);
    if (nid_c==417) sprintf(Window_Buffer,"NID_C\t(%d) Hungary : West-Hungary (Trandanubian part)", nid_c);
    if (nid_c==418) sprintf(Window_Buffer,"NID_C\t(%d) Hungary : East-Hungary", nid_c);
    if (nid_c==419) sprintf(Window_Buffer,"NID_C\t(%d) Hungary : Budapest Area", nid_c);
    if (nid_c==420) sprintf(Window_Buffer,"NID_C\t(%d) Slovakia : Reserved", nid_c);
    if (nid_c>=424 && nid_c<=426) sprintf(Window_Buffer,"NID_C\t(%d) Netherlands : Various projects\tCountry or region identity number", nid_c);
    if (nid_c==427) sprintf(Window_Buffer,"NID_C\t(%d) Netherlands : HSL-Zuid\tCountry or region identity number", nid_c);
    if (nid_c==428) sprintf(Window_Buffer,"NID_C\t(%d) Netherlands : ProRail connecting line to HSL-Zuid\tCountry or region identity number", nid_c);
    if (nid_c>=429 && nid_c<=431) sprintf(Window_Buffer,"NID_C\t(%d) Netherlands : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==448) sprintf(Window_Buffer,"NID_C\t(%d) Switzerland : SBB, NBS, LBL all Level 2\tCountry or region identity number", nid_c);
    if (nid_c>=449 && nid_c<=452) sprintf(Window_Buffer,"NID_C\t(%d) Switzerland\tCountry or region identity number", nid_c);
    if (nid_c>=453 && nid_c<=454) sprintf(Window_Buffer,"NID_C\t(%d) Switzerland : Lötschberg, level 0 (packet 44)\tCountry or region identity number", nid_c);
    if (nid_c==455) sprintf(Window_Buffer,"NID_C\t(%d) Switzerland : level 0 (packet 44)\tCountry or region identity number", nid_c);
    if (nid_c==472) sprintf(Window_Buffer,"NID_C\t(%d) Greece : Athens Suburban Railways lines (ASR)\tCountry or region identity number", nid_c);
    if (nid_c==473) sprintf(Window_Buffer,"NID_C\t(%d) Greece : Athens Suburban Railway line Ska - Kyato project\tCountry or region identity number", nid_c);
    if (nid_c==474) sprintf(Window_Buffer,"NID_C\t(%d) Greece : Pireaus - Athens - Three Bridges\tCountry or region identity number", nid_c);
    if (nid_c==475) sprintf(Window_Buffer,"NID_C\t(%d) Greece : Athens - Thessaloniki - Bulgaria Level 1 corridor\tCountry or region identity number", nid_c);
    if ((nid_c>=476 && nid_c<=478) || (nid_c>=480 && nid_c<=489)) sprintf(Window_Buffer,"NID_C\t(%d) Slovenia : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==479) sprintf(Window_Buffer,"NID_C\t(%d) Slovenia : State border-SEZANA/KOPER-HODOS-State border (Corridor D)\tCountry or region identity number", nid_c);
    if (nid_c==501) sprintf(Window_Buffer,"NID_C\t(%d) Croatia : Vinkovci - Tovarnik - state border Okunaci - Novska\tCountry or region identity number", nid_c);
    if (nid_c>=502 && nid_c<=503) sprintf(Window_Buffer,"NID_C\t(%d) Croatia : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==510) sprintf(Window_Buffer,"NID_C\t(%d) Kazakhstan : Kazakhstan State Railway lines\tCountry or region identity number", nid_c);
    if (nid_c==511) sprintf(Window_Buffer,"NID_C\t(%d) Kazakhstan : Kandyagash - Nikeltau\tCountry or region identity number", nid_c);
    if (nid_c==512) sprintf(Window_Buffer,"NID_C\t(%d) Czech Republic : VUZ\tCountry or region identity number", nid_c);
    if (nid_c==513) sprintf(Window_Buffer,"NID_C\t(%d) Czech Republic : SZDC\tCountry or region identity number", nid_c);
    if (nid_c==514) sprintf(Window_Buffer,"NID_C\t(%d) Czech Republic\tCountry or region identity number", nid_c);
    if (nid_c>=515 && nid_c<=519) sprintf(Window_Buffer,"NID_C\t(%d) Czech Republic\tCountry or region identity number", nid_c);
    if (nid_c>=520 && nid_c<=529) sprintf(Window_Buffer,"NID_C\t(%d) Norway : Reserved\tCountry or region identity number", nid_c);
    if (nid_c>=530 && nid_c<=531) sprintf(Window_Buffer,"NID_C\t(%d) Sweden : Swedish Transport Administration lines (Trafikverket)\tCountry or region identity number", nid_c);
    if (nid_c>=532 && nid_c<=535) sprintf(Window_Buffer,"NID_C\t(%d) Sweden : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==540) sprintf(Window_Buffer,"NID_C\t(%d) Australia : New South Wales network ETCS Level 1\tCountry or region identity number", nid_c);
    if ((nid_c>=541 && nid_c<=545) || (nid_c>=548 && nid_c<=549)) sprintf(Window_Buffer,"NID_C\t(%d) Australia : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==546) sprintf(Window_Buffer,"NID_C\t(%d) Australia : Seaford line, Belair line and Gwaler line\tCountry or region identity number", nid_c);
    if (nid_c==547) sprintf(Window_Buffer,"NID_C\t(%d) Australia : Qld North Coast Line L1\tCountry or region identity number", nid_c);
    if (nid_c==550) sprintf(Window_Buffer,"NID_C\t(%d) Kazakhstan : Zhetygen - Korgas line ETCS Level 1\tCountry or region identity number", nid_c);
    if (nid_c>=551 && nid_c<=553) sprintf(Window_Buffer,"NID_C\t(%d) Kazakhstan : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==554) sprintf(Window_Buffer,"NID_C\t(%d) China : HS line Zhengzhou - Xi'an Railway Passenger Dedicated Line (ETCS Level 2)\tCountry or region identity number", nid_c);
    if (nid_c==555) sprintf(Window_Buffer,"NID_C\t(%d) Mongolia : Trans-Mongolian railway corridor\tCountry or region identity number", nid_c);
    if (nid_c==570) sprintf(Window_Buffer,"NID_C\t(%d) Russia : ITARUS project, ATC TRIAL SITE Khosta - Matsesta, ETCS level 2\tCountry or region identity number", nid_c);
    if (nid_c>=571 && nid_c<=573) sprintf(Window_Buffer,"NID_C\t(%d) Russia : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==600) sprintf(Window_Buffer,"NID_C\t(%d) New Zealand : ETCS Level 1 system for Auckland Metropolitan Rail Network\tCountry or region identity number", nid_c);
    if (nid_c==700) sprintf(Window_Buffer,"NID_C\t(%d) Libya : Coastal line ETCS level 1 and level 2\tCountry or region identity number", nid_c);
    if (nid_c==701) sprintf(Window_Buffer,"NID_C\t(%d) Libya : South Line ETCS level 2\tCountry or region identity number", nid_c);
    if (nid_c>=702 && nid_c<=703) sprintf(Window_Buffer,"NID_C\t(%d) Libya : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==800) sprintf(Window_Buffer,"NID_C\t(%d) Algeria : Rocade Nord\tCountry or region identity number", nid_c);
    if (nid_c>=801 && nid_c<=804) sprintf(Window_Buffer,"NID_C\t(%d) Algeria : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==810) sprintf(Window_Buffer,"NID_C\t(%d) Morocco : ETCS level 1 line Rabat - Casablanca\tCountry or region identity number", nid_c);
    if (nid_c>=811 && nid_c<=819) sprintf(Window_Buffer,"NID_C\t(%d) Morocco : Reserved\tCountry or region identity number", nid_c);
    if (nid_c>=820 && nid_c<=821) sprintf(Window_Buffer,"NID_C\t(%d) South Africa : Gauteng region\tCountry or region identity number", nid_c);
    if (nid_c==822) sprintf(Window_Buffer,"NID_C\t(%d) South Africa : Kwa-Zulu natal region\tCountry or region identity number", nid_c);
    if (nid_c==823) sprintf(Window_Buffer,"NID_C\t(%d) South Africa : Western cape region\tCountry or region identity number", nid_c);
    if (nid_c==880) sprintf(Window_Buffer,"NID_C\t(%d) Saudi Arabia : Makkah - Madinah, Haramain High Speed Railway\tCountry or region identity number", nid_c);
    if (nid_c==882) sprintf(Window_Buffer,"NID_C\t(%d) UAE : Network of up to 1,200 km stretching across the Emirates\tCountry or region identity number", nid_c);
    if (nid_c>=883 && nid_c<=884) sprintf(Window_Buffer,"NID_C\t(%d) Saudi Arabia : NSR\tCountry or region identity number", nid_c);
    if (nid_c==885) sprintf(Window_Buffer,"NID_C\t(%d) Saudi Arabia : Dammam - Riyadh\tCountry or region identity number", nid_c);
    if (nid_c==886) sprintf(Window_Buffer,"NID_C\t(%d) Taiwan : Taiwan Railway Administration\tCountry or region identity number", nid_c);
    if (nid_c==887) sprintf(Window_Buffer,"NID_C\t(%d) Korea : Korean National Railroad KNR\tCountry or region identity number", nid_c);
    if (nid_c==888) sprintf(Window_Buffer,"NID_C\t(%d) China : Reserved\tCountry or region identity number", nid_c);
    if (nid_c==889) sprintf(Window_Buffer,"NID_C\t(%d) China : Line Wuhan - Guangzhou\tCountry or region identity number", nid_c);
    if (nid_c==900) sprintf(Window_Buffer,"NID_C\t(%d) India : Indian Railways\tCountry or region identity number", nid_c);
    if (nid_c==901) sprintf(Window_Buffer,"NID_C\t(%d) Malaysia : Malaysian Railways\tCountry or region identity number", nid_c);
    if (nid_c==921) sprintf(Window_Buffer,"NID_C\t(%d) Mexico : Transit line Buenavista - Cuautitlán\tCountry or region identity number", nid_c);
    if (nid_c==922) sprintf(Window_Buffer,"NID_C\t(%d) Chile : Line Santiago - Rancagua\tCountry or region identity number", nid_c);
    if (nid_c>=930 && nid_c<=935) sprintf(Window_Buffer,"NID_C\t(%d) Brazil : Project \"Supervia\" to equip the rail commuter network of Rio de Janeiro with ERTMS\tCountry or region identity number", nid_c);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_ctraction(int nid_ctraction, HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Unknown\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==1) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Netherlands, 1.5kVDC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==2) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Netherlands, conventional lines, 25kV AC 50Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==3) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Netherlands, high speed lines, 25kV AC 50Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==4) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1320/1450 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==5) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1450/1600 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==6) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1950 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==7) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1320/1450/1600 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==8) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1450/1600/1950 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==9) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Switzerland, 15kV AC 16.7Hz, 1320/1450/1600/1950 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==10) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Italy, 3kV DC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==11) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Italy, 25kV AC 50Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==12) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) France, conventional lines, 25kV AC 50Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==13) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) France, high speed lines, 25kV AC 50Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==14) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) France, 1.5kV DC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==15) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Spain, conventional lines 220 km/h, 3kV DC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==16) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Spain, conventional lines 160 km/h, 3kV DC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==17) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Spain, high speed lines, 25kV AC 50Hz, 1600/1950 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==18) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Spain, high speed lines, 25kV AC 50Hz, 1600 mm\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==19) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Germany, 15kV AC 16.7Hz, 600 A\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==20) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Germany, 15kV AC 16.7Hz, 780 A\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==21) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Germany, 15kV AC 16.7Hz, 900 A\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==22) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Germany, 15kV AC 16.7Hz, 1500 A\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==23) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Slovenia, 3kV DC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==24) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Denmark, conventional lines 160/200 km/h, 25kV AC 50 Hz\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==27) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Finland, 25kV AC\tCountry identifier of the traction system", nid_ctraction);
    if (nid_ctraction==28) sprintf(Window_Buffer,"NID_CTRACTION\t(%d) Italy, conventional lines, 25 kV AC 50 Hz, 1950mm\tCountry identifier of the traction system", nid_ctraction);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}


void D_v_g(int v,char* tete, char* queue,int resolution,HWND TargetWindow) {
    if (v==1023) sprintf(Window_Buffer,"%s\tNone\t%s",tete,queue);
    else if (v>=601) sprintf(Window_Buffer,"%s\tSpare(%d)\t%s",tete,v,queue);
    else sprintf(Window_Buffer,"%s\t%d km/h\t%s",tete,v*resolution,queue);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_g(int value,char* tete, char* queue,HWND TargetWindow) {
    sprintf(Window_Buffer,"%s\t%d\t%s",tete,value,queue);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_g_u(int value,char* tete, char* queue, char* prefix, char* suffix,HWND TargetWindow) {
    sprintf(Window_Buffer,"%s\t%s%d%s\t%s",tete,prefix,value,suffix,queue);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_nvsbtsmperm(int q_nvsbtsmperm,HWND TargetWindow) {
    if (q_nvsbtsmperm==1) sprintf(Window_Buffer,"Q_NVSBTSMPERM\tYes\t(%d) Permission to use service brake in target speed",q_nvsbtsmperm); else sprintf(Window_Buffer,"Q_NVSBTSMPERM\tNo\t(%d) Permission to use service brake in target speed",q_nvsbtsmperm);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tmonitoring");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_q_nvemrrls(int q_nvemrrls,HWND TargetWindow) {
    if (q_nvemrrls==1) sprintf(Window_Buffer,"Q_NVEMRRLS\t(%d) Revoke emergency brake command when permitted\tQualifier emergency brake release",q_nvemrrls);
    else sprintf(Window_Buffer,"Q_NVEMRRLS\t(%d) Revoke emergency brake command at standstill\tQualifier emergency brake release",q_nvemrrls);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (q_nvemrrls==1) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tspeed supervision limit is no longer exceeded");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
}

void D_t_g(int t, char* tete, char* queue,HWND TargetWindow) {
    sprintf(Window_Buffer,"%s\t%d s\t%s",tete,t,queue);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nvcontact(int m_nvcontact,HWND TargetWindow) {
    if (m_nvcontact==0) sprintf(Window_Buffer,"M_NVCONTACT\t(%d) Train trip\tT_NVCONTACT reaction",m_nvcontact);
    if (m_nvcontact==1) sprintf(Window_Buffer,"M_NVCONTACT\t(%d) Apply service brake\tT_NVCONTACT reaction",m_nvcontact);
    if (m_nvcontact==2) sprintf(Window_Buffer,"M_NVCONTACT\t(%d) No Reaction\tT_NVCONTACT reaction",m_nvcontact);
    if (m_nvcontact==3) sprintf(Window_Buffer,"M_NVCONTACT\t(%d) Spare\tT_NVCONTACT reaction",m_nvcontact);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_nvcontact(int t_nvcontact,HWND TargetWindow) {
    sprintf(Window_Buffer,"T_NVCONTACT\t%d s\tMaximum time without new \"safe\" message",t_nvcontact);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nvderun(int m_nvderun,HWND TargetWindow) {
    if (m_nvderun==1) sprintf(Window_Buffer,"M_NVDERUN\t(%d) Yes\tEntry of Driver ID permitted while running",m_nvderun); else sprintf(Window_Buffer,"M_NVDERUN\t(%d) No\tEntry of Driver ID permitted while running",m_nvderun);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_nvdriver_adhes(int q_nvdriver_adhes,HWND TargetWindow) {
    if (q_nvdriver_adhes==1) sprintf(Window_Buffer,"Q_NVDRIVER_ADHES\t(1) Allowed\tQualifier for the modification of trackside adhesion factor"); else sprintf(Window_Buffer,"Q_NVDRIVER_ADHES\t(0) Not allowed\tQualifier for the modification of trackside adhesion factor");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tby driver");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_q_newcountry(int q_newcountry,HWND TargetWindow) {
    if (q_newcountry==1) sprintf(Window_Buffer,"Q_NEWCOUNTRY\t(1) Not the same country / railway administration, NID_C follows\tNew Country Qualifier"); else sprintf(Window_Buffer,"Q_NEWCOUNTRY\t(0) Same country / railway administration, no NID_C follows\tNew Country Qualifier");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_bg(int nid_bg,HWND TargetWindow) {
    if (nid_bg==16383) sprintf(Window_Buffer,"NID_BG\t(16383) Identity is unknown\tIdentity number of the balise group"); else sprintf(Window_Buffer,"NID_BG\t%d\tIdentity number of the balise group",nid_bg);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_linkorientation(int q_linkorientation,HWND TargetWindow) {
    if (q_linkorientation==1) sprintf(Window_Buffer,"Q_LINKORIENTATION\t(1) The balise group is seen by the train in nominal direction\tQualifier for the direction of the linked balise group"); else sprintf(Window_Buffer,"Q_LINKORIENTATION\t(0) The balise group is seen by the train in reverse direction\tQualifier for the direction of the linked balise group");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_linkreaction(int q_linkreaction,HWND TargetWindow) {
    if (q_linkreaction==0) sprintf(Window_Buffer,"Q_LINKREACTION\t(0) Train trip\tLinking reaction");
    if (q_linkreaction==1) sprintf(Window_Buffer,"Q_LINKREACTION\t(1) Apply service brake\tLinking reaction");
    if (q_linkreaction==2) sprintf(Window_Buffer,"Q_LINKREACTION\t(2) No Reaction\tLinking reaction");
    if (q_linkreaction==3) sprintf(Window_Buffer,"Q_LINKREACTION\t(3) Spare\tLinking reaction");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_vbco(int q_vbco,HWND TargetWindow) {
    if (q_vbco==1) sprintf(Window_Buffer,"Q_VBCO\t(1) Set the Virtual Balise Cover\tQualifier for Virtual Balise Cover order"); else sprintf(Window_Buffer,"Q_VBCO\t(0) Remove the Virtual Balise Cover\tQualifier for Virtual Balise Cover order");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_vbc(int t_vbc,HWND TargetWindow) {
    if (t_vbc==1) sprintf(Window_Buffer,"T_VBC\t1 day\tVBC validity period");
    else sprintf(Window_Buffer,"T_VBC\t%d days\tVBC validity period",t_vbc);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_main(int v_main,HWND TargetWindow) {
    if (v_main==0) sprintf(Window_Buffer,"V_MAIN\t(0) Trip order\tSignalling related speed restriction");
    else sprintf(Window_Buffer,"V_MAIN\t%d km/h\tSignalling related speed restriction",5*v_main);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_loa(int t_loa,HWND TargetWindow) {
    if (t_loa==1023) sprintf(Window_Buffer,"T_LOA\t(1023) Infinite\tValidity time for the target speed at the LOA");
    else sprintf(Window_Buffer,"T_LOA\t%d s\tValidity time for the target speed at the LOA",t_loa);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_g(int q,char* tete,char* queue,char* yes, char* no,HWND TargetWindow) {
    if (q==1) sprintf(Window_Buffer,"%s\t%s\t%s",tete,yes,queue);
    else sprintf(Window_Buffer,"%s\t%s\t%s",tete,no,queue);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_sectiontimer(int t_sectiontimer,HWND TargetWindow) {
    if (t_sectiontimer==1023) sprintf(Window_Buffer,"T_SECTIONTIMER\t(1023) Infinite\tValidity time of a section in the MA");
    else sprintf(Window_Buffer,"T_SECTIONTIMER\t%d s\tValidity time of a section in the MA",t_sectiontimer);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_releasedp(int v_releasedp,HWND TargetWindow) {
    if (v_releasedp==126) sprintf(Window_Buffer,"V_RELEASEDP\t(126) Use onboard calculated release speed\tRelease speed associated with the danger point");
    else if (v_releasedp==127) sprintf(Window_Buffer,"V_RELEASEDP\t(127) Use national value\tRelease speed associated with the danger point");
    else sprintf(Window_Buffer,"V_RELEASEDP\t%d km/h\tRelease speed associated with the danger point",5*v_releasedp);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_releaseol(int v_releaseol,HWND TargetWindow) {
    if (v_releaseol==126) sprintf(Window_Buffer,"V_RELEASEOL\t(126) Use onboard calculated release speed\tRelease speed associated with the overlap");
    else if (v_releaseol==127) sprintf(Window_Buffer,"V_RELEASEOL\t(127) Use national value\tRelease speed associated with the overlap");
    else sprintf(Window_Buffer,"V_RELEASEOL\t%d km/h\tRelease speed associated with the overlap",5*v_releaseol);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_ol(int t_ol,HWND TargetWindow) {
    if (t_ol==1023) sprintf(Window_Buffer,"T_OL\t(1023) Infinite\tOverlap validity time");
    else sprintf(Window_Buffer,"T_OL\t%d s\tOverlap validity time",t_ol);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_g_a(int g_a,HWND TargetWindow) {
    if (g_a==255) sprintf(Window_Buffer,"G_A\t(255) Current description ends\tSafe gradient");
    else sprintf(Window_Buffer,"G_A\t%d‰\tSafe gradient",g_a);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_static(int v_static,HWND TargetWindow) {
    if (v_static==127) sprintf(Window_Buffer,"V_STATIC\t(127) Static speed profile description ends\tBasic static speed profile");
    else sprintf(Window_Buffer,"V_STATIC\t%d km/h\tBasic static speed profile",5*v_static);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_diff(int q_diff,HWND TargetWindow) {
    if (q_diff==0) sprintf(Window_Buffer,"Q_DIFF\t(0) Cant Deficiency specific category\tQualifier for specific SSP categories");
    if (q_diff==1) sprintf(Window_Buffer,"Q_DIFF\t(1) Other specific category, replaces the Cant Deficiency SSP\tQualifier for specific SSP categories");
    if (q_diff==2) sprintf(Window_Buffer,"Q_DIFF\t(2) Other specific category, does not replace the Cant Deficiency SSP\tQualifier for specific SSP categories");
    if (q_diff==3) sprintf(Window_Buffer,"Q_DIFF\t(3) Spare\tQualifier for specific SSP categories");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nc_cddiff(int nc_cddiff,HWND TargetWindow) {
    sprintf(Window_Buffer,"NC_CDDIFF\tSpecific SSP applicable to Cant Deficiency Unknown (%d) mm\tCant Deficiency SSP category",nc_cddiff);
    if (nc_cddiff==0) sprintf(Window_Buffer,"NC_CDDIFF\t(0) Specific SSP applicable to Cant Deficiency 80 mm\tCant Deficiency SSP category");
    if (nc_cddiff==1) sprintf(Window_Buffer,"NC_CDDIFF\t(1) Specific SSP applicable to Cant Deficiency 100 mm\tCant Deficiency SSP category");
    if (nc_cddiff==2) sprintf(Window_Buffer,"NC_CDDIFF\t(2) Specific SSP applicable to Cant Deficiency 130 mm\tCant Deficiency SSP category");
    if (nc_cddiff==3) sprintf(Window_Buffer,"NC_CDDIFF\t(3) Specific SSP applicable to Cant Deficiency 150 mm\tCant Deficiency SSP category");
    if (nc_cddiff==4) sprintf(Window_Buffer,"NC_CDDIFF\t(4) Specific SSP applicable to Cant Deficiency 165 mm\tCant Deficiency SSP category");
    if (nc_cddiff==5) sprintf(Window_Buffer,"NC_CDDIFF\t(5) Specific SSP applicable to Cant Deficiency 180 mm\tCant Deficiency SSP category");
    if (nc_cddiff==6) sprintf(Window_Buffer,"NC_CDDIFF\t(6) Specific SSP applicable to Cant Deficiency 210 mm\tCant Deficiency SSP category");
    if (nc_cddiff==7) sprintf(Window_Buffer,"NC_CDDIFF\t(7) Specific SSP applicable to Cant Deficiency 225 mm\tCant Deficiency SSP category");
    if (nc_cddiff==8) sprintf(Window_Buffer,"NC_CDDIFF\t(8) Specific SSP applicable to Cant Deficiency 245 mm\tCant Deficiency SSP category");
    if (nc_cddiff==9) sprintf(Window_Buffer,"NC_CDDIFF\t(9) Specific SSP applicable to Cant Deficiency 275 mm\tCant Deficiency SSP category");
    if (nc_cddiff==10) sprintf(Window_Buffer,"NC_CDDIFF\t(10) Specific SSP applicable to Cant Deficiency 300 mm\tCant Deficiency SSP category");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nc_diff(int nc_diff,HWND TargetWindow) {
    sprintf(Window_Buffer,"NC_DIFF\t(%d) Unknown\tOther specific SSP category",nc_diff);
    if (nc_diff==0) sprintf(Window_Buffer,"NC_DIFF\t(0) Specific SSP applicable to Freight train braked in \"P\" position\tOther specific SSP category");
    if (nc_diff==1) sprintf(Window_Buffer,"NC_DIFF\t(1) Specific SSP applicable to Freight train braked in \"G\" position\tOther specific SSP category");
    if (nc_diff==2) sprintf(Window_Buffer,"NC_DIFF\t(2) Specific SSP applicable to Passenger train\tOther specific SSP category");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_voltage(int m_voltage,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_VOLTAGE\t(%d) Unknown\tTraction system voltage",m_voltage);
    if (m_voltage==0) sprintf(Window_Buffer,"M_VOLTAGE\tLine not fitted with traction system\tTraction system voltage");
    else if (m_voltage==1) sprintf(Window_Buffer,"M_VOLTAGE\t(%d) AC 25 kV 50 Hz\tTraction system voltage",m_voltage);
    else if (m_voltage==2) sprintf(Window_Buffer,"M_VOLTAGE\t(%d) AC 15 kV 16.7 Hz\tTraction system voltage",m_voltage);
    else if (m_voltage==3) sprintf(Window_Buffer,"M_VOLTAGE\t(%d) DC 3 kV\tTraction system voltage",m_voltage);
    else if (m_voltage==4) sprintf(Window_Buffer,"M_VOLTAGE\t(%d) DC 1.5 kV\tTraction system voltage",m_voltage);
    else if (m_voltage==5) sprintf(Window_Buffer,"M_VOLTAGE\t(%d) DC 600/750 V\tTraction system voltage",m_voltage);
    else sprintf(Window_Buffer,"M_VOLTAGE\t(%d) Free\tTraction system voltage",m_voltage);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_current(int m_current,HWND TargetWindow) {
    if(m_current==1023) sprintf(Window_Buffer,"M_CURRENT\t(1023) No restriction for current consumption\tAllowed current consumption");
    else sprintf(Window_Buffer,"M_CURRENT\t%d A\tAllowed current consumption",10*m_current);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_leveltr(int m_leveltr,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_LEVELTR\t(%d) Unknown\tRequired level",m_leveltr);
    if (m_leveltr==0) sprintf(Window_Buffer,"M_LEVELTR\t(0) Level 0\tRequired level");
    if (m_leveltr==1) sprintf(Window_Buffer,"M_LEVELTR\t(1) Level NTC specified by NID_NTC\tRequired level");
    if (m_leveltr==2) sprintf(Window_Buffer,"M_LEVELTR\t(2) Level 1\tRequired level");
    if (m_leveltr==3) sprintf(Window_Buffer,"M_LEVELTR\t(3) Level 2\tRequired level");
    if (m_leveltr==4) sprintf(Window_Buffer,"M_LEVELTR\t(4) Level 3\tRequired level");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_rbc(int nid_rbc,HWND TargetWindow) {
    if(nid_rbc==16383) sprintf(Window_Buffer,"NID_RBC\t(16383) Contact last known RBC\tRBC ETCS identity number");
    else sprintf(Window_Buffer,"NID_RBC\t%d\tRBC ETCS identity number",nid_rbc);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_riu(int nid_riu,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_RIU\t%d\tRIU ETCS identity number",nid_riu);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_mn(int nid_mn_1,int nid_mn_2,HWND TargetWindow) {
    unsigned long long nid_mn = ((unsigned long long)(4096)*(unsigned long long)(nid_mn_1)+(unsigned long long)(nid_mn_2));
    sprintf(Window_Buffer,"NID_MN\t%I64X\tIdentity of radio network",nid_mn);
    if (nid_mn==2130255 || nid_mn==133140) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R France\tIdentity of radio network",nid_mn);
    if (nid_mn==2498831 || nid_mn==156176) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Germany\tIdentity of radio network",nid_mn);
    if (nid_mn==2237199 || nid_mn==139824) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Italy\tIdentity of radio network",nid_mn);
    if (nid_mn==2261103 || nid_mn==141318) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Switzerland\tIdentity of radio network",nid_mn);
    if (nid_mn==2114079 || nid_mn==132129) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Netherlands\tIdentity of radio network",nid_mn);
    if (nid_mn==2121775 || nid_mn==132610) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Belgium\tIdentity of radio network",nid_mn);
    if (nid_mn==2359839 || nid_mn==147489) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Sweden\tIdentity of radio network",nid_mn);
    if (nid_mn==2180383 || nid_mn==136273) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Spain\tIdentity of radio network",nid_mn);
    if (nid_mn==2310463 || nid_mn==144403) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R United Kingdom\tIdentity of radio network",nid_mn);
    if (nid_mn==10066335 || nid_mn==629145) sprintf(Window_Buffer,"NID_MN\t%I64X GSM-R Test\tIdentity of radio network",nid_mn);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_axleload(int m_axleload,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_AXLELOAD\t%d t\tAxle load",m_axleload);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_g_pbdsr(int g_pbdsr,HWND TargetWindow) {
    sprintf(Window_Buffer,"G_PBDSR\t%d/1000\tDefault gradient for PBD Speed restriction",g_pbdsr);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_mar(int t_mar,HWND TargetWindow) {
    if (t_mar==255) sprintf(Window_Buffer,"T_MAR\t(255) No MA request triggering with regards to this function\tTime before pre-indication location for EOA/LOA");
    else sprintf(Window_Buffer,"T_MAR\t%d s\tTime before pre-indication location for EOA/LOA",t_mar);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_timeoutrqst(int t_timeoutrqst,HWND TargetWindow) {
    if (t_timeoutrqst==1023) sprintf(Window_Buffer,"T_TIMEOUTRQST\t(1023) No MA request triggering with regards to this function\tTime before any section timer expires or the LOA speed timer");
    else sprintf(Window_Buffer,"T_TIMEOUTRQST\t%d s\tTime before any section timer expires or the LOA speed timer expires",t_timeoutrqst);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\texpires");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_t_cycrqst(int t_cycrqst,HWND TargetWindow) {
    if (t_cycrqst==255) sprintf(Window_Buffer,"T_CYCRQST\t(255) No repetition\tTime between two cyclic requests for a movement authority");
    else sprintf(Window_Buffer,"T_CYCRQST\t%d s\tTime between two cyclic requests for a movement authority",t_cycrqst);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_cycloc(int t_cycloc,HWND TargetWindow) {
    if (t_cycloc==255) sprintf(Window_Buffer,"T_CYCLOC\t(255) Infinite\tTime interval between two position report sent by the train");
    else sprintf(Window_Buffer,"T_CYCLOC\t%d s\tTime interval between two position report sent by the train",t_cycloc);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_loc(int m_loc,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_LOC\tUnknown (%d)\tSpecial location/moment where the train has to report its",m_loc);
    if (m_loc==0) sprintf(Window_Buffer,"M_LOC\t(0) Now (The position report is sent upon receipt of the order)\tSpecial location/moment where the train has to report its");
    if (m_loc==1) sprintf(Window_Buffer,"M_LOC\t(1) Every LRBG compliant balise group\tSpecial location/moment where the train has to report its");
    if (m_loc==2) sprintf(Window_Buffer,"M_LOC\t(2) Do not send position report on passage of LRBG compliant balise group\tSpecial location/moment where the train has to report its");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tposition");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_nid_tsr(int nid_tsr,HWND TargetWindow) {
    if (nid_tsr==255) sprintf(Window_Buffer,"NID_TSR\t(255) Non-revocable speed restriction (applicable for all transmision media)\tIdentity number of Temporary Speed Restriction");
    else if (nid_tsr<=127) sprintf(Window_Buffer,"NID_TSR\t%d non RBC transmission (balise, loop or radio infill)\tIdentity number of Temporary Speed Restriction",nid_tsr);
    else sprintf(Window_Buffer,"NID_TSR\t%d RBC transmission\tIdentity number of Temporary Speed Restriction",nid_tsr);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_trackcond(int m_trackcond,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Unknown\tType of track description",m_trackcond);
    if (m_trackcond==0) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Non stopping area. Initial state : stopping permitted\tType of track description",m_trackcond);
    if (m_trackcond==1) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Tunnel stopping area. Initial state : no tunnel stopping area\tType of track description",m_trackcond);
    if (m_trackcond==2) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Sound horn. Initial state : no request for sound horn\tType of track description",m_trackcond);
    if (m_trackcond==3) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Powerless section - lower pantograph. Initial state :\tType of track description",m_trackcond);
    if (m_trackcond==4) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Radio hole (stop supervising T_NVCONTACT). Initial state :\tType of track description",m_trackcond);
    if (m_trackcond==5) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Air tightness. Initial state : no request for air tightness\tType of track description",m_trackcond);
    if (m_trackcond==6) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Switch off regenerative brake. Initial state : regenerative\tType of track description",m_trackcond);
    if (m_trackcond==7) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Switch off eddy current brake for service brake. Initial\tType of track description",m_trackcond);
    if (m_trackcond==8) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Switch off magentic shoe brake. Initial state : magnetic\tType of track description",m_trackcond);
    if (m_trackcond==9) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Powerless section - switch off the main power switch.\tType of track description",m_trackcond);
    if (m_trackcond==10) sprintf(Window_Buffer,"M_TRACKCOND\t(%d) Switch off eddy current brake for emergency brake.\tType of track description",m_trackcond);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (m_trackcond==3) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tnot powerless section");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==4) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tsupervise T_NVCONTACT");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==6) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tbrake on");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==7) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tstate : eddy current brake for service brake on");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==8) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tshoe brake on");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==9) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tInitial state : not powerless section");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
    if (m_trackcond==10) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tInitial state : eddy current brake for emergency brake on");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        if (target_window_index>0) target_window_index++;
    }
}

void D_m_platform(int m_platform,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_PLATFORM\t(%d) Unknown\tType of platform",m_platform);
    if (m_platform==0) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 200 mm\tType of platform",m_platform);
    if (m_platform==1) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 300-380 mm\tType of platform",m_platform);
    if (m_platform==2) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 550 mm\tType of platform",m_platform);
    if (m_platform==3) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 580 mm\tType of platform",m_platform);
    if (m_platform==4) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 680 mm\tType of platform",m_platform);
    if (m_platform==5) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 685 mm\tType of platform",m_platform);
    if (m_platform==6) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 730 mm\tType of platform",m_platform);
    if (m_platform==7) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 760 mm\tType of platform",m_platform);
    if (m_platform==8) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 840 mm\tType of platform",m_platform);
    if (m_platform==9) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 900 mm\tType of platform",m_platform);
    if (m_platform==10) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 915 mm\tType of platform",m_platform);
    if (m_platform==11) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 920 mm\tType of platform",m_platform);
    if (m_platform==12) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 960 mm\tType of platform",m_platform);
    if (m_platform==13) sprintf(Window_Buffer,"M_PLATFORM\t(%d) 1100 mm\tType of platform",m_platform);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_platform(int q_platform,HWND TargetWindow) {
    if (q_platform==0) sprintf(Window_Buffer,"Q_PLATFORM\t(0) Platform on left side\tPlatform position (relative to direction of authorised movement)");
    if (q_platform==1) sprintf(Window_Buffer,"Q_PLATFORM\t(1) Platform on right side\tPlatform position (relative to direction of authorised movement)");
    if (q_platform==2) sprintf(Window_Buffer,"Q_PLATFORM\t(2) Platform on both side\tPlatform position (relative to direction of authorised movement)");
    if (q_platform==3) sprintf(Window_Buffer,"Q_PLATFORM\t(3) Unknown\tPlatform position (relative to direction of authorised movement)");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_suitability(int q_suitability,HWND TargetWindow) {
    if (q_suitability==0) sprintf(Window_Buffer,"Q_SUITABILITY\t(0) Loading gauge\tType of route suitability data");
    if (q_suitability==1) sprintf(Window_Buffer,"Q_SUITABILITY\t(1) Max axle load\tType of route suitability data");
    if (q_suitability==2) sprintf(Window_Buffer,"Q_SUITABILITY\t(2) Traction system\tType of route suitability data");
    if (q_suitability==3) sprintf(Window_Buffer,"Q_SUITABILITY\t(3) Unknown\tType of route suitability data");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_linegauge(int m_linegauge,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_LINEGAUGE\t(%d) Unknown\tLine gauge",m_linegauge);
    if (m_linegauge==1) sprintf(Window_Buffer,"M_LINEGAUGE\t(1) G1\tLine gauge");
    if (m_linegauge==2) sprintf(Window_Buffer,"M_LINEGAUGE\t(2) GA\tLine gauge");
    if (m_linegauge==4) sprintf(Window_Buffer,"M_LINEGAUGE\t(3) GB\tLine gauge");
    if (m_linegauge==8) sprintf(Window_Buffer,"M_LINEGAUGE\t(4) GC\tLine gauge");
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_traction(int m_traction,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_TRACTION\t(%d) Unknown\tIdentifier of the traction system",m_traction);
    if (m_traction==6) sprintf(Window_Buffer,"M_TRACTION\t(%d) Netherlands, 1.5 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==7) sprintf(Window_Buffer,"M_TRACTION\t(%d) Netherlands, conventional lines, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==8) sprintf(Window_Buffer,"M_TRACTION\t(%d) Netherlands, high speed lines, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==2) sprintf(Window_Buffer,"M_TRACTION\t(%d) France, conventional lines, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==3) sprintf(Window_Buffer,"M_TRACTION\t(%d) France, high speed lines, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==4) sprintf(Window_Buffer,"M_TRACTION\t(%d) Eurotunnel, 25 kV AC 50 Hz Eurotunnel\tIdentifier of the traction system",m_traction);
    if (m_traction==5) sprintf(Window_Buffer,"M_TRACTION\t(%d) France, 1.5 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==1) sprintf(Window_Buffer,"M_TRACTION\t(%d) France, 1.5 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==0) sprintf(Window_Buffer,"M_TRACTION\t(%d) All, Non electrical traction\tIdentifier of the traction system",m_traction);
    if (m_traction==11) sprintf(Window_Buffer,"M_TRACTION\t(%d) Germany, 15 kV AC 16 2/3 Hz, 600 A\tIdentifier of the traction system",m_traction);
    if (m_traction==12) sprintf(Window_Buffer,"M_TRACTION\t(%d) Germany, 15 kV AC 16 2/3 Hz, 900 A\tIdentifier of the traction system",m_traction);
    if (m_traction==13) sprintf(Window_Buffer,"M_TRACTION\t(%d) Germany, 15 kV AC 16 2/3 Hz, 1000 A\tIdentifier of the traction system",m_traction);
    if (m_traction==14) sprintf(Window_Buffer,"M_TRACTION\t(%d) Germany, 15 kV AC 16 2/3 Hz, 1200 A\tIdentifier of the traction system",m_traction);
    if (m_traction==15) sprintf(Window_Buffer,"M_TRACTION\t(%d) Germany, 15 kV AC 16 2/3 Hz, 1500 A\tIdentifier of the traction system",m_traction);
    if (m_traction==16) sprintf(Window_Buffer,"M_TRACTION\t(%d) Belgium, 3 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==17) sprintf(Window_Buffer,"M_TRACTION\t(%d) Belgium, 25 kV 50 Hz L1\tIdentifier of the traction system",m_traction);
    if (m_traction==18) sprintf(Window_Buffer,"M_TRACTION\t(%d) Belgium, 25 kV 50 Hz L2,L3,L4\tIdentifier of the traction system",m_traction);
    if (m_traction==19) sprintf(Window_Buffer,"M_TRACTION\t(%d) Belgium, 25 kV 50 Hz CR\tIdentifier of the traction system",m_traction);
    if (m_traction==21) sprintf(Window_Buffer,"M_TRACTION\t(%d) Luxemburg, 25 kV 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==26) sprintf(Window_Buffer,"M_TRACTION\t(%d) Italy, 25 kV 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==31) sprintf(Window_Buffer,"M_TRACTION\t(%d) Spain, 25 kV AC 50 Hz High Speed Lines 1600 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==32) sprintf(Window_Buffer,"M_TRACTION\t(%d) Spain, 3 kV DC conventional lines 220 km/h max. line speed\tIdentifier of the traction system",m_traction);
    if (m_traction==33) sprintf(Window_Buffer,"M_TRACTION\t(%d) Spain, 3 kV DC conventional lines 160 km/h max. line speed\tIdentifier of the traction system",m_traction);
    if (m_traction==34) sprintf(Window_Buffer,"M_TRACTION\t(%d) Spain, 25 kV AC 50 Hz high speed lines 1600/1950 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==41) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1320/1450 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==42) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1450/1600 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==43) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1950 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==44) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1320/1450/1600 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==45) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1450/1600/1950 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==46) sprintf(Window_Buffer,"M_TRACTION\t(%d) Switzerland, 15 kV AC 16 2/3 Hz, 1320/1450/1600/1950 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==51) sprintf(Window_Buffer,"M_TRACTION\t(%d) Austria, 15 kV 16 2/3 Hz 1950 mm\tIdentifier of the traction system",m_traction);
    if (m_traction==53) sprintf(Window_Buffer,"M_TRACTION\t(%d) Austria, 25 kV 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==61) sprintf(Window_Buffer,"M_TRACTION\t(%d) Sweden, 15 kV AC 16 2/3 Hz, max. 900 A\tIdentifier of the traction system",m_traction);
    if (m_traction==66) sprintf(Window_Buffer,"M_TRACTION\t(%d) Slovakia, 3 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==67) sprintf(Window_Buffer,"M_TRACTION\t(%d) Slovakia, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==71) sprintf(Window_Buffer,"M_TRACTION\t(%d) Croatia, 3 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==72) sprintf(Window_Buffer,"M_TRACTION\t(%d) Croatia, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==129) sprintf(Window_Buffer,"M_TRACTION\t(%d) Czech Republic, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==130) sprintf(Window_Buffer,"M_TRACTION\t(%d) Czech Republic, 3 kV DC\tIdentifier of the traction system",m_traction);
    if (m_traction==131) sprintf(Window_Buffer,"M_TRACTION\t(%d) Czech Republic, 15 kV AC 16 2/3 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==201) sprintf(Window_Buffer,"M_TRACTION\t(%d) New Zealand, 25 kV AC 50 Hz\tIdentifier of the traction system",m_traction);
    if (m_traction==202) sprintf(Window_Buffer,"M_TRACTION\t(%d) New Zealand, 1.5 kV DC\tIdentifier of the traction system",m_traction);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_adhesion(int m_adhesion,HWND TargetWindow) {
    if (m_adhesion==0) sprintf(Window_Buffer,"M_ADHESION\t(0) Slippery rail\tAdhesion factor");
    if (m_adhesion==1) sprintf(Window_Buffer,"M_ADHESION\t(1) Non slippery rail\tAdhesion factor");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_textclass(int q_textclass,HWND TargetWindow) {
    sprintf(Window_Buffer,"Q_TEXTCLASS\tUnknown (%d)\tClass of message to be displayed",q_textclass);
    if (q_textclass==0) sprintf(Window_Buffer,"Q_TEXTCLASS\t(0) Auxiliary information\tClass of message to be displayed");
    if (q_textclass==1) sprintf(Window_Buffer,"Q_TEXTCLASS\t(1) Important information\tClass of message to be displayed");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_modetextdisplay(int m_modetextdisplay,HWND TargetWindow) {
    if (m_modetextdisplay==0) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Full Supervision\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==1) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) On Sight\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==2) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Staff Responsible\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==3)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Spare\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==4)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Unfitted\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==5)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Spare\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==6)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Stand By\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==7)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Trip\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==8)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Post Trip\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==9)  sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Spare\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==10) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Spare\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==11) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Non Leading\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==12) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Limited Supervision\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==13) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Spare\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==14) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) Reversing\tOnboard operating mode for text display",m_modetextdisplay);
    if (m_modetextdisplay==15) sprintf(Window_Buffer,"M_MODETEXTDISPLAY\t(%d) The display of the text shall not be limited by the mode\tOnboard operating mode for text display",m_modetextdisplay);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_mode(int m_mode,HWND TargetWindow) {
    if (m_mode==0) sprintf(Window_Buffer,"M_MODE\t(%d) (FS) Full Supervision\tSelected Mode",m_mode);
    if (m_mode==1) sprintf(Window_Buffer,"M_MODE\t(%d) (OS) On Sight\tSelected Modet",m_mode);
    if (m_mode==2) sprintf(Window_Buffer,"M_MODE\t(%d) (SR) Staff Responsible\tSelected Mode",m_mode);
    if (m_mode==3)  sprintf(Window_Buffer,"M_MODE\t(%d) (SH) Shunting\tSelected Mode",m_mode);
    if (m_mode==4)  sprintf(Window_Buffer,"M_MODE\t(%d) (UN) Unfitted\tSelected Mode",m_mode);
    if (m_mode==5)  sprintf(Window_Buffer,"M_MODE\t(%d) (SL) Sleeping\tSelected Mode",m_mode);
    if (m_mode==6)  sprintf(Window_Buffer,"M_MODE\t(%d) (SB) Stand By\tSelected Mode",m_mode);
    if (m_mode==7)  sprintf(Window_Buffer,"M_MODE\t(%d) (TR) Trip\tSelected Mode",m_mode);
    if (m_mode==8)  sprintf(Window_Buffer,"M_MODE\t(%d) (PT) Post Trip\tSelected Mode",m_mode);
    if (m_mode==9)  sprintf(Window_Buffer,"M_MODE\t(%d) (SF) System Failure\tSelected Mode",m_mode);
    if (m_mode==10) sprintf(Window_Buffer,"M_MODE\t(%d) (IS) Isolation\tSelected Mode",m_mode);
    if (m_mode==11) sprintf(Window_Buffer,"M_MODE\t(%d) (NL) Non Leading\tSelected Mode",m_mode);
    if (m_mode==12) sprintf(Window_Buffer,"M_MODE\t(%d) (LS) Limited Supervision\tSelected Mode",m_mode);
    if (m_mode==13) sprintf(Window_Buffer,"M_MODE\t(%d) (SN) National System\tSelected Mode",m_mode);
    if (m_mode==14) sprintf(Window_Buffer,"M_MODE\t(%d) (RV) Reversing\tSelected Mode",m_mode);
    if (m_mode==15) sprintf(Window_Buffer,"M_MODE\t(%d) (PS) Passive Shunting\tSelected Mode",m_mode);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_mode_text(int m_mode, char* dest) {
    if (m_mode==0) sprintf(dest,"Full Supervision");
    if (m_mode==1) sprintf(dest,"On Sightt");
    if (m_mode==2) sprintf(dest,"Staff Responsible");
    if (m_mode==3)  sprintf(dest,"Shunting");
    if (m_mode==4)  sprintf(dest,"Unfitted");
    if (m_mode==5)  sprintf(dest,"Sleeping");
    if (m_mode==6)  sprintf(dest,"Stand By");
    if (m_mode==7)  sprintf(dest,"Trip");
    if (m_mode==8)  sprintf(dest,"Post Trip");
    if (m_mode==9)  sprintf(dest,"System Failure");
    if (m_mode==10) sprintf(dest,"Isolation");
    if (m_mode==11) sprintf(dest,"Non Leading");
    if (m_mode==12) sprintf(dest,"Limited Supervision");
    if (m_mode==13) sprintf(dest,"National System");
    if (m_mode==14) sprintf(dest,"Reversing");
    if (m_mode==15) sprintf(dest,"Passive Shunting");
}

void D_m_level(int m_level,HWND TargetWindow) {
    if (m_level==0) sprintf(Window_Buffer,"M_LEVEL\t(0) Level 0\tSelected level");
    if (m_level==1) sprintf(Window_Buffer,"M_LEVEL\t(1) Level STM\tSelected level");
    if (m_level==2) sprintf(Window_Buffer,"M_LEVEL\t(2) Level 1\tSelected level");
    if (m_level==3) sprintf(Window_Buffer,"M_LEVEL\t(3) Level 2\tSelected level");
    if (m_level==4) sprintf(Window_Buffer,"M_LEVEL\t(4) Level 3\tSelected level");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_level_text(int m_level,char* dest) {
    if (m_level==0) sprintf(dest,"Level 0");
    if (m_level==1) sprintf(dest,"Level STM");
    if (m_level==2) sprintf(dest,"Level 1");
    if (m_level==3) sprintf(dest,"Level 2");
    if (m_level==4) sprintf(dest,"Level 3");
}

void D_m_leveltextdisplay(int m_leveltextdisplay,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(%d) Unknown\tOnboard operating level for text display",m_leveltextdisplay);
    if (m_leveltextdisplay==0) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(0) Level 0\tOnboard operating level for text display");
    if (m_leveltextdisplay==1) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(1) Level NTC specified by NID_NTC\tOnboard operating level for text display");
    if (m_leveltextdisplay==2) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(2) Level 1\tOnboard operating level for text display");
    if (m_leveltextdisplay==3) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(3) Level 2\tOnboard operating level for text display");
    if (m_leveltextdisplay==4) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(4) Level 3\tOnboard operating level for text display");
    if (m_leveltextdisplay==5) sprintf(Window_Buffer,"M_LEVELTEXTDISPLAY\t(5) The display of the text shall not be limited by the level\tOnboard operating level for text display");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_textdisplay(int t_textdisplay,HWND TargetWindow) {
    if (t_textdisplay==1023) sprintf(Window_Buffer,"T_TEXTDISPLAY\t(1023) Display of text not limited by time\tDuration for which a text shall be displayed");
    else sprintf(Window_Buffer,"T_TEXTDISPLAY\t%d s\tDuration for which a text shall be displayed",t_textdisplay);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_textconfirm(int q_textconfirm,HWND TargetWindow) {
    if (q_textconfirm==0) sprintf(Window_Buffer,"Q_TEXTCONFIRM\t(0) No confirmation required\tQualifier for text confirmation");
    if (q_textconfirm==1) sprintf(Window_Buffer,"Q_TEXTCONFIRM\t(1) Confirmation required\tQualifier for text confirmation");
    if (q_textconfirm==2) sprintf(Window_Buffer,"Q_TEXTCONFIRM\t(2) Confirmation required : SB on ACK fail\tQualifier for text confirmation");
    if (q_textconfirm==2) sprintf(Window_Buffer,"Q_TEXTCONFIRM\t(3) Confirmation required : EB on ACK fail\tQualifier for text confirmation");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_l_text(int l_text,HWND TargetWindow) {
    sprintf(Window_Buffer,"L_TEXT\t%d bit(s)\tLength of text string",l_text);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_text(int q_text,HWND TargetWindow) {
    sprintf(Window_Buffer,"Q_TEXT\tUnknown (%d)\tFixes message to be displayed",q_text);
    if (q_text==0) sprintf(Window_Buffer,"Q_TEXT\t(0) Level crossing not protected\tFixes message to be displayed");
    if (q_text==1) sprintf(Window_Buffer,"Q_TEXT\t(1) Acknowledgement\tFixes message to be displayed");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_loadinggauge(int m_loadinggauge,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_LOADINGGAUGE\tLibre (%d)\tLoading gauge profile",m_loadinggauge);
    if (isBL3 && !isVelaro) {
        if (m_loadinggauge==0) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) The train does not fit to any of the interoperable loading gauge profiles\tLoading gauge profile",m_loadinggauge);
        if (m_loadinggauge==1) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) G1\tLoading gauge profile",m_loadinggauge);
        if (m_loadinggauge==2) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GA\tLoading gauge profile",m_loadinggauge);
        if (m_loadinggauge==3) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GB\tLoading gauge profile",m_loadinggauge);
        if (m_loadinggauge==4) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GC\tLoading gauge profile",m_loadinggauge);
    } else {
        if (m_loadinggauge & 1) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GC\tLoading gauge profile",m_loadinggauge);
        m_loadinggauge>>=1;
        if (m_loadinggauge & 1) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GB+\tLoading gauge profile",m_loadinggauge);
        m_loadinggauge>>=1;
        if (m_loadinggauge & 1) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GB\tLoading gauge profile",m_loadinggauge);
        m_loadinggauge>>=1;
        if (m_loadinggauge & 1) sprintf(Window_Buffer,"M_LOADINGGAUGE\t(%d) GA\tLoading gauge profile",m_loadinggauge);
    }
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_position(int m_position,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_POSITION\t(%d) Unknown\tTrack kilometer reference value",m_position);
    if (m_position<10000000) sprintf(Window_Buffer,"M_POSITION\t%d m\tTrack kilometer reference value",m_position);
    if (m_position==16777215) sprintf(Window_Buffer,"M_POSITION\t(%d) No more geographical position calculation after this reference location\tTrack kilometer reference value",m_position);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_mamode(int m_mamode,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_MAMODE\tUnknown (%d)\tRequired mode for a part of the MA",m_mamode);
    if (m_mamode==0) sprintf(Window_Buffer,"M_MAMODE\t(0) On Sight\tRequired mode for a part of the MA");
    if (m_mamode==1) sprintf(Window_Buffer,"M_MAMODE\t(1) Shunting\tRequired mode for a part of the MA");
    if (m_mamode==2) sprintf(Window_Buffer,"M_MAMODE\t(2) Limited Supervision\tRequired mode for a part of the MA");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_v_mamode(int v_mamode,HWND TargetWindow) {
    if (v_mamode==127) sprintf(Window_Buffer,"V_MAMODE\t(127) Use the national value of the required mode\tRequired mode related speed");
    else sprintf(Window_Buffer,"V_MAMODE\t%d km/h\tRequired mode related speed",5*v_mamode);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_sscode(int q_sscode,HWND TargetWindow) {
    if (q_sscode==15) sprintf(Window_Buffer,"Q_SSCODE\t(15) Code reserved for test purposes\tSpread Spectrum Code for Euroloop");
    else sprintf(Window_Buffer,"Q_SSCODE\t%d\tSpread Spectrum Code for Euroloop",q_sscode);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_operational(int nid_oprational_1, int nid_operational_2,HWND TargetWindow) {
    unsigned long long nid_operational = (unsigned long long)((unsigned long long)nid_oprational_1*65536)+(unsigned long long)((unsigned long long)nid_operational_2);
    sprintf(Hexdec_Buffer,"%I64x",(nid_operational));
    if (Hexdec_Buffer[4]=='f') Hexdec_Buffer[4]='\0';
    if (Hexdec_Buffer[5]=='f') Hexdec_Buffer[5]='\0';
    if (Hexdec_Buffer[6]=='f') Hexdec_Buffer[6]='\0';
    if (Hexdec_Buffer[7]=='f') Hexdec_Buffer[7]='\0';
    init_offset+=2;
    sprintf(Window_Buffer,"NID_OPERATIONAL\t%s\tTrain running number",Hexdec_Buffer);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    if (target_window_index>0) target_window_index++;
}

void D_g_tsr(int g_tsr,HWND TargetWindow) {
    sprintf(Window_Buffer,"G_TSR\t%d/1000\tDefault gradient for TSR supervision",g_tsr);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_l_message(int l_message,HWND TargetWindow) {
    sprintf(Window_Buffer,"L_MESSAGE\t%d bit(s)\tMessage length",l_message*8);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_train(int t_train_1, int t_train_2,HWND TargetWindow) {
    unsigned long t_train = (unsigned long)((unsigned long)t_train_1*65536)+(unsigned long)((unsigned long)t_train_2);
    sprintf(Window_Buffer,"T_TRAIN\t%.2f s\tTrainborne clock",(float)(0.01*t_train));
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_d_ref(float q_scale,int d_ref,HWND TargetWindow) {
    if (d_ref<=32767) sprintf(Window_Buffer,"D_REF\t%d m\tReference distance",(int)(q_scale*d_ref));
    else if (d_ref<=65535) sprintf(Window_Buffer,"D_REF\t%d m\tReference distance",(int)(q_scale*(d_ref-65536)));
    else sprintf(Window_Buffer,"D_REF\t(%d) libre\tReference distance",d_ref);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_length(int q_length,HWND TargetWindow) {
    if (q_length==0) sprintf(Window_Buffer,"Q_LENGTH\t(0) No train integrity information available\tQualifier for train integrity status");
    if (q_length==1) sprintf(Window_Buffer,"Q_LENGTH\t(1) Train integrity confirmed by integrity monitoring device\tQualifier for train integrity status");
    if (q_length==2) sprintf(Window_Buffer,"Q_LENGTH\t(2) Train integrity confirmed by driver\tQualifier for train integrity status");
    if (q_length==3) sprintf(Window_Buffer,"Q_LENGTH\t(3) Train integrity lost\tQualifier for train integrity status");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_error(int m_error,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_ERROR\t(%d) Unknown\tIdentity of the type of error",m_error);
    if (m_error==0) sprintf(Window_Buffer,"M_ERROR\t(0) Balise group : linking consistency error\tIdentity of the type of error");
    if (m_error==1) sprintf(Window_Buffer,"M_ERROR\t(1) Linked balise group: message consistency error\tIdentity of the type of error");
    if (m_error==2) sprintf(Window_Buffer,"M_ERROR\t(2) Uninked balise group: message consistency error\tIdentity of the type of error");
    if (m_error==3) sprintf(Window_Buffer,"M_ERROR\t(3) Radio: message consistency error (ref. 3.16.3.1.1a,c)\tIdentity of the type of error");
    if (m_error==4) sprintf(Window_Buffer,"M_ERROR\t(4) Radio: sequence error (ref. 3.16.3.1.1b)\tIdentity of the type of error");
    if (m_error==5) sprintf(Window_Buffer,"M_ERROR\t(5) Radio: safe radio connection error\tIdentity of the type of error");
    if (m_error==6) sprintf(Window_Buffer,"M_ERROR\t(6) Safety critical failure (ref. 4.4.6.1.6 , 4.4.15.1.5)\tIdentity of the type of error");
    if (m_error==7) sprintf(Window_Buffer,"M_ERROR\t(7) Double linking error (ref. 3.16.2.7.1)\tIdentity of the type of error");
    if (m_error==8) sprintf(Window_Buffer,"M_ERROR\t(8) Double repositioning error (ref. 3.16.2.7.2)\tIdentity of the type of error");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
    if (m_error==0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t(ref. 3.16.2.3)");
        if (target_window_index>0) target_window_index++;
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
    if (m_error==1) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t(ref. 3.16.2.4.1/4)");
        if (target_window_index>0) target_window_index++;
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
    if (m_error==2) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t(ref. 3.16.2.5)");
        if (target_window_index>0) target_window_index++;
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
    if (m_error==5) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t(ref. 3.16.3.4, to be sent when communication links re-established)");
        if (target_window_index>0) target_window_index++;
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_nc_train_old(int nc_train,HWND TargetWindow) {
        int nc_train_index = 1;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 275 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 80 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 100 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 130 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 150 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 165 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 180 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 225 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 300 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Freight Train braked in \"P\" position\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Freight Train braked in \"G\" position\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Passenger Train\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 245 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Permissible cant deficiency : 210 mm\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        nc_train>>=1;
        nc_train_index++;
        if (nc_train & 1) {
            sprintf(Window_Buffer,"NC_TRAIN\t(%d) Forbidden value (1xx xxxx xxxx xxxx)\tOther International Train Category",nc_train_index);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
        }
        packet_offset++;

}

void D_m_airtight(int m_airtight,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_AIRTIGHT\t(%d) Unknown\tAirtight system presence",m_airtight);
    if (m_airtight==0) sprintf(Window_Buffer,"M_AIRTIGHT\t(0) Unfitted\tAirtight system presence");
    if (m_airtight==1) sprintf(Window_Buffer,"M_AIRTIGHT\t(1) Fitted\tAirtight system presence");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nid_engine_for_unknown_vehicle(int nid_engine,HWND TargetWindow) {
    sprintf(Window_Buffer,"Unknown (%d)",nid_engine);
    if (nid_engine>=0 && nid_engine<=1023) sprintf(Window_Buffer,"Bombardier RCS");
    if (nid_engine>=1024 && nid_engine<=1199) sprintf(Window_Buffer,"FS: Reserved");
    if (nid_engine>=1200 && nid_engine<=1399) sprintf(Window_Buffer,"FS / Assigned Ansaldo");
    if (nid_engine>=1400 && nid_engine<=3024) sprintf(Window_Buffer,"FS: Reserved");
    if (nid_engine>=3025 && nid_engine<=3042) sprintf(Window_Buffer,"Renfe / Assigned: Alstom – S-100");
    if (nid_engine>=3043 && nid_engine<=3060) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3061 && nid_engine<=3072) sprintf(Window_Buffer,"Renfe / Assigned: Alstom – S-100");
    if (nid_engine>=3073 && nid_engine<=3099) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3100 && nid_engine<=3131) sprintf(Window_Buffer,"Renfe / Assigned: Siemens – S-102");
    if (nid_engine>=3132 && nid_engine<=3199) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3200 && nid_engine<=3259) sprintf(Window_Buffer,"Renfe / Assigned: Siemens – S-112");
    if (nid_engine>=3260 && nid_engine<=3299) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3300 && nid_engine<=3331) sprintf(Window_Buffer,"Renfe / Assigned: Siemens – S-103");
    if (nid_engine>=3332 && nid_engine<=3351) sprintf(Window_Buffer,"Renfe / Assigned: Siemens – S-103");
    if (nid_engine>=3352 && nid_engine<=3399) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3400 && nid_engine<=3411) sprintf(Window_Buffer,"Renfe / Assigned: Ansaldo – S-120");
    if (nid_engine>=3412 && nid_engine<=3449) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3450 && nid_engine<=3465) sprintf(Window_Buffer,"Renfe / Assigned: Ansaldo – S-120.050");
    if (nid_engine>=3466 && nid_engine<=3499) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3500 && nid_engine<=3539) sprintf(Window_Buffer,"Renfe / Assigned: Alstom - S-104");
    if (nid_engine>=3540 && nid_engine<=3599) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3600 && nid_engine<=3625) sprintf(Window_Buffer,"Renfe / Assigned: Alstom - S-114");
    if (nid_engine>=3626 && nid_engine<=3699) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3700 && nid_engine<=3728) sprintf(Window_Buffer,"Renfe / Assigned: Ansaldo - S-121");
    if (nid_engine>=3729 && nid_engine<=3799) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=3800 && nid_engine<=3889) sprintf(Window_Buffer,"Renfe / Assigned: Bombardier - S-130 / S-730 (12 of 6 S130 train with Siemens equipment)");
    if (nid_engine>=3890 && nid_engine<=4999) sprintf(Window_Buffer,"Renfe / Reserved");
    if (nid_engine>=5000 && nid_engine<=6999) sprintf(Window_Buffer,"Alstom");
    if (nid_engine>=7000 && nid_engine<=11999) sprintf(Window_Buffer,"Switzerland : SBB");
    if (nid_engine>=12000 && nid_engine<=12199) sprintf(Window_Buffer,"Lloyd's Register Rail Europe B.V. for Class'66 and G1206 loco's retrofitting");
    if (nid_engine>=12200 && nid_engine<=12699) sprintf(Window_Buffer,"Hitachi");
    if (nid_engine>=12700 && nid_engine<=12719) sprintf(Window_Buffer,"ADIF ETCS trains");
    if (nid_engine>=12720 && nid_engine<=12919) sprintf(Window_Buffer,"Hitachi - India");
    if (nid_engine>=12966 && nid_engine<=12999) sprintf(Window_Buffer,"Eurostar E320 %d",nid_engine-8965);
    if (nid_engine>=13000 && nid_engine<=14999) sprintf(Window_Buffer,"Alstom: Reserved");
    if (nid_engine>=15000 && nid_engine<=15999) sprintf(Window_Buffer,"UK");
    if (nid_engine>=16000 && nid_engine<=16120) sprintf(Window_Buffer,"Ansaldo Breda: Reserved");
    if (nid_engine>=16121 && nid_engine<=16999) sprintf(Window_Buffer,"Slovenia");
    if (nid_engine>=17000 && nid_engine<=17050) sprintf(Window_Buffer,"NV Infrabel: Reserved");
    if (nid_engine>=17051 && nid_engine<=20550) sprintf(Window_Buffer,"Bombardier");
    if (nid_engine>=20551 && nid_engine<=20566) sprintf(Window_Buffer,"Austrian Private Railways");
    if (nid_engine>=20567 && nid_engine<=20568) sprintf(Window_Buffer,"Vossloh Locomotives / Trainguard 200");
    if (nid_engine>=20569 && nid_engine<=20570) sprintf(Window_Buffer,"Skoda locomotive 109 E – ZSR locomotive 381 (Slovak railway)");
    if (nid_engine>=20580 && nid_engine<=20585) sprintf(Window_Buffer,"CFR Locomotives 477 / Trainguard 200");
    if (nid_engine>=20600 && nid_engine<=20699) sprintf(Window_Buffer,"Bombardier reserved values for “EFE project “ (Santiago de Chile, Chile)");
    if (nid_engine>=20700 && nid_engine<=20949) sprintf(Window_Buffer,"UK DesiroCity ETCS / Trainguard 200");
    if (nid_engine>=20950 && nid_engine<=20989) sprintf(Window_Buffer,"ETR610 (ED250) Pendolino");
    if (nid_engine>=21000 && nid_engine<=21499) sprintf(Window_Buffer,"Bombardier reserved values for “Supervia project” (Rio de Janeiro, Brazil)");
    if (nid_engine>=21500 && nid_engine<=21999) sprintf(Window_Buffer,"Euroloco PH37ACi project. (Belgium, Luxembourg, Netherlands, Germany)");
    if (nid_engine>=30001 && nid_engine<=32000) sprintf(Window_Buffer,"Project AM08 (305 engines) Migration to ETCS for 450 existing engines");
    if (nid_engine>=32001 && nid_engine<=32500) sprintf(Window_Buffer,"Siemens Vectron Locomotives / Trainguard 200: Reserved");
    if (nid_engine>=32501 && nid_engine<=32550) sprintf(Window_Buffer,"Eurosprinter Locomotives ES64U4 / Trainguard 200");
    if (nid_engine>=32551 && nid_engine<=32565) sprintf(Window_Buffer,"Stadler FLIRT NRH / Trainguard 200");
    if (nid_engine>=32566 && nid_engine<=32625) sprintf(Window_Buffer,"PESA 43WE « Dart » (ED161) PKP-IC Poland|PESA 218Mc (SA133) PKM|PESA 219M (SA136) PKM");
    if (nid_engine>=33000 && nid_engine<=33999) sprintf(Window_Buffer,"Auriga OBS");
    if (nid_engine>=90000 && nid_engine<=90999) sprintf(Window_Buffer,"Ankara- High Speed Line Project");
    if (nid_engine>=91000 && nid_engine<=91049) sprintf(Window_Buffer,"Cumaovasi-Tepekoy vehicles – Trainguard 200");
    if (nid_engine>=91050 && nid_engine<=91099) sprintf(Window_Buffer,"Bandirma vehicles / Trainguard Futur 3000");
    if (nid_engine>=91100 && nid_engine<=91119) sprintf(Window_Buffer,"Marmaray Auxiliary vehicles – Trainguard Futur 3000");
    if (nid_engine>=91120 && nid_engine<=91149) sprintf(Window_Buffer,"Samsun-Kalin vehicles – Trainguard 100");
    if (nid_engine>=1048576 && nid_engine<=1048592) sprintf(Window_Buffer,"ČD : Reserved");
    if (nid_engine>=1048593 && nid_engine<=1048596) sprintf(Window_Buffer,"ČD");
    if (nid_engine>=1048597 && nid_engine<=1050624) sprintf(Window_Buffer,"ČD : Reserved");
    if (nid_engine>=1116001 && nid_engine<=1116999) sprintf(Window_Buffer,"ÖBB");
    if (nid_engine>=1117000 && nid_engine<=1117499) sprintf(Window_Buffer,"Croatia, Ministry of Sea, Transport and Infrastructure");
    if (nid_engine==1186816) sprintf(Window_Buffer,"DB/Siemens");
    if (nid_engine>=1186817 && nid_engine<=1186879) sprintf(Window_Buffer,"DB");
    if (nid_engine>=1186880 && nid_engine<=1186884) sprintf(Window_Buffer,"DB/Siemens");
    if (nid_engine>=1186885 && nid_engine<=1188799) sprintf(Window_Buffer,"DB");
    if (nid_engine>=1188800 && nid_engine<=1188801) sprintf(Window_Buffer,"DB/Siemens");
    if (nid_engine>=1188802 && nid_engine<=1188863) sprintf(Window_Buffer,"DB");
    if (nid_engine>=1216001 && nid_engine<=1216999) sprintf(Window_Buffer,"ÖBB");
    if (nid_engine>=1217000 && nid_engine<=1217100) sprintf(Window_Buffer,"Project KISS – WESTBahn ET4010 and ET4110");
    if (nid_engine>=1217101 && nid_engine<=1217150) sprintf(Window_Buffer,"MRCE Dispolok – ES64U2 / Trainguard 200");
    if (nid_engine>=1269760 && nid_engine<=1270783) sprintf(Window_Buffer,"DB");
    if (nid_engine>=2097152 && nid_engine<=2162687) {
        sprintf(Window_Buffer,"SNCF");
        if (nid_engine==2154896) sprintf(Window_Buffer,"SNCF 2N2-3UA 4701 M1 (310001)");
        if (nid_engine==2154897) sprintf(Window_Buffer,"SNCF 2N2-3UA 4701 M2 (310002)");
        if (nid_engine==2154898) sprintf(Window_Buffer,"SNCF 2N2-3UA 4702 M1 (310003)");
        if (nid_engine==2154899) sprintf(Window_Buffer,"SNCF 2N2-3UA 4702 M2 (310004)");
        if (nid_engine==2154900) sprintf(Window_Buffer,"SNCF 2N2-3UA 4703 M1 (310005)");
        if (nid_engine==2154901) sprintf(Window_Buffer,"SNCF 2N2-3UA 4703 M2 (310006)");
        if (nid_engine==2154902) sprintf(Window_Buffer,"SNCF 2N2-3UA 4704 M1 (310007)");
        if (nid_engine==2154903) sprintf(Window_Buffer,"SNCF 2N2-3UA 4704 M2 (310008)");
        if (nid_engine==2154904) sprintf(Window_Buffer,"SNCF 2N2-3UA 4705 M1 (310009)");
        if (nid_engine==2154905) sprintf(Window_Buffer,"SNCF 2N2-3UA 4705 M2 (310010)");
        if (nid_engine==2154906) sprintf(Window_Buffer,"SNCF 2N2-3UA 4706 M1 (310011)");
        if (nid_engine==2154907) sprintf(Window_Buffer,"SNCF 2N2-3UA 4706 M2 (310012)");
        if (nid_engine==2154908) sprintf(Window_Buffer,"SNCF 2N2-3UA 4707 M1 (310013)");
        if (nid_engine==2154909) sprintf(Window_Buffer,"SNCF 2N2-3UA 4707 M2 (310014)");
        if (nid_engine==2154910) sprintf(Window_Buffer,"SNCF 2N2-3UA 4708 M1 (310015)");
        if (nid_engine==2154911) sprintf(Window_Buffer,"SNCF 2N2-3UA 4708 M2 (310016)");
        if (nid_engine==2154912) sprintf(Window_Buffer,"SNCF 2N2-3UA 4709 M1 (310017)");
        if (nid_engine==2154913) sprintf(Window_Buffer,"SNCF 2N2-3UA 4709 M2 (310018)");
        if (nid_engine==2154914) sprintf(Window_Buffer,"SNCF 2N2-3UA 4710 M1 (310019)");
        if (nid_engine==2154915) sprintf(Window_Buffer,"SNCF 2N2-3UA 4710 M2 (310020)");
        if (nid_engine==2154916) sprintf(Window_Buffer,"SNCF 2N2-3UA 4711 M1 (310021)");
        if (nid_engine==2154917) sprintf(Window_Buffer,"SNCF 2N2-3UA 4711 M2 (310022)");
        if (nid_engine==2154918) sprintf(Window_Buffer,"SNCF 2N2-3UA 4712 M1 (310023)");
        if (nid_engine==2154919) sprintf(Window_Buffer,"SNCF 2N2-3UA 4712 M2 (310024)");
        if (nid_engine==2154920) sprintf(Window_Buffer,"SNCF 2N2-3UA 4713 M1 (310025)");
        if (nid_engine==2154921) sprintf(Window_Buffer,"SNCF 2N2-3UA 4713 M2 (310026)");
        if (nid_engine==2154922) sprintf(Window_Buffer,"SNCF 2N2-3UA 4714 M1 (310027)");
        if (nid_engine==2154923) sprintf(Window_Buffer,"SNCF 2N2-3UA 4714 M2 (310028)");
        if (nid_engine==2154924) sprintf(Window_Buffer,"SNCF 2N2-3UA 4715 M1 (310029)");
        if (nid_engine==2154925) sprintf(Window_Buffer,"SNCF 2N2-3UA 4715 M2 (310030)");
        if (nid_engine==2154926) sprintf(Window_Buffer,"SNCF 2N2-3UA 4716 M1 (310031)");
        if (nid_engine==2154927) sprintf(Window_Buffer,"SNCF 2N2-3UA 4716 M2 (310032)");
        if (nid_engine==2154928) sprintf(Window_Buffer,"SNCF 2N2-3UA 4717 M1 (310033)");
        if (nid_engine==2154929) sprintf(Window_Buffer,"SNCF 2N2-3UA 4717 M2 (310034)");
        if (nid_engine==2154930) sprintf(Window_Buffer,"SNCF 2N2-3UA 4718 M1 (310035)");
        if (nid_engine==2154931) sprintf(Window_Buffer,"SNCF 2N2-3UA 4718 M2 (310036)");
        if (nid_engine==2154932) sprintf(Window_Buffer,"SNCF 2N2-3UA 4719 M1 (310037)");
        if (nid_engine==2154933) sprintf(Window_Buffer,"SNCF 2N2-3UA 4719 M2 (310038)");
        if (nid_engine==2154934) sprintf(Window_Buffer,"SNCF 2N2-3UA 4720 M1 (310039)");
        if (nid_engine==2154935) sprintf(Window_Buffer,"SNCF 2N2-3UA 4720 M2 (310040)");
        if (nid_engine==2154936) sprintf(Window_Buffer,"SNCF 2N2-3UA 4721 M1 (310041)");
        if (nid_engine==2154937) sprintf(Window_Buffer,"SNCF 2N2-3UA 4721 M2 (310042)");
        if (nid_engine==2154938) sprintf(Window_Buffer,"SNCF 2N2-3UA 4722 M1 (310043)");
        if (nid_engine==2154939) sprintf(Window_Buffer,"SNCF 2N2-3UA 4722 M2 (310044)");
        if (nid_engine==2154940) sprintf(Window_Buffer,"SNCF 2N2-3UA 4723 M1 (310045)");
        if (nid_engine==2154941) sprintf(Window_Buffer,"SNCF 2N2-3UA 4723 M2 (310046)");
        if (nid_engine==2154942) sprintf(Window_Buffer,"SNCF 2N2-3UA 4724 M1 (310047)");
        if (nid_engine==2154943) sprintf(Window_Buffer,"SNCF 2N2-3UA 4724 M2 (310048)");
        if (nid_engine==2154944) sprintf(Window_Buffer,"SNCF 2N2-3UA 4725 M1 (310049)");
        if (nid_engine==2154945) sprintf(Window_Buffer,"SNCF 2N2-3UA 4725 M2 (310050)");
        if (nid_engine==2154946) sprintf(Window_Buffer,"SNCF 2N2-3UA 4726 M1 (310051)");
        if (nid_engine==2154947) sprintf(Window_Buffer,"SNCF 2N2-3UA 4726 M2 (310052)");
        if (nid_engine==2154948) sprintf(Window_Buffer,"SNCF 2N2-3UA 4727 M1 (310053)");
        if (nid_engine==2154949) sprintf(Window_Buffer,"SNCF 2N2-3UA 4727 M2 (310054)");
        if (nid_engine==2154950) sprintf(Window_Buffer,"SNCF 2N2-3UA 4728 M1 (310055)");
        if (nid_engine==2154951) sprintf(Window_Buffer,"SNCF 2N2-3UA 4728 M2 (310056)");
        if (nid_engine==2154952) sprintf(Window_Buffer,"SNCF 2N2-3UA 4729 M1 (310057)");
        if (nid_engine==2154953) sprintf(Window_Buffer,"SNCF 2N2-3UA 4729 M2 (310058)");
        if (nid_engine==2154954) sprintf(Window_Buffer,"SNCF 2N2-3UA 4730 M1 (310059)");
        if (nid_engine==2154955) sprintf(Window_Buffer,"SNCF 2N2-3UA 4730 M2 (310060)");
        if (nid_engine==2154996) sprintf(Window_Buffer,"SNCF 2N2-3UH 801 M1 (310201)");
        if (nid_engine==2154997) sprintf(Window_Buffer,"SNCF 2N2-3UH 801 M2 (310202)");
        if (nid_engine==2154998) sprintf(Window_Buffer,"SNCF 2N2-3UH 802 M1 (310203)");
        if (nid_engine==2154999) sprintf(Window_Buffer,"SNCF 2N2-3UH 802 M2 (310204)");
        if (nid_engine==2155000) sprintf(Window_Buffer,"SNCF 2N2-3UH 803 M1 (310205)");
        if (nid_engine==2155001) sprintf(Window_Buffer,"SNCF 2N2-3UH 803 M2 (310206)");
        if (nid_engine==2155002) sprintf(Window_Buffer,"SNCF 2N2-3UH 804 M1 (310207)");
        if (nid_engine==2155003) sprintf(Window_Buffer,"SNCF 2N2-3UH 804 M2 (310208)");
        if (nid_engine==2155004) sprintf(Window_Buffer,"SNCF 2N2-3UH 805 M1 (310209)");
        if (nid_engine==2155005) sprintf(Window_Buffer,"SNCF 2N2-3UH 805 M2 (310210)");
        if (nid_engine==2155006) sprintf(Window_Buffer,"SNCF 2N2-3UH 806 M1 (310211)");
        if (nid_engine==2155007) sprintf(Window_Buffer,"SNCF 2N2-3UH 806 M2 (310212)");
        if (nid_engine==2155008) sprintf(Window_Buffer,"SNCF 2N2-3UH 807 M1 (310213)");
        if (nid_engine==2155009) sprintf(Window_Buffer,"SNCF 2N2-3UH 807 M2 (310214)");
        if (nid_engine==2155010) sprintf(Window_Buffer,"SNCF 2N2-3UH 808 M1 (310215)");
        if (nid_engine==2155011) sprintf(Window_Buffer,"SNCF 2N2-3UH 808 M2 (310216)");
        if (nid_engine==2155012) sprintf(Window_Buffer,"SNCF 2N2-3UH 809 M1 (310217)");
        if (nid_engine==2155013) sprintf(Window_Buffer,"SNCF 2N2-3UH 809 M2 (310218)");
        if (nid_engine==2155014) sprintf(Window_Buffer,"SNCF 2N2-3UH 810 M1 (310219)");
        if (nid_engine==2155015) sprintf(Window_Buffer,"SNCF 2N2-3UH 810 M2 (310220)");
        if (nid_engine==2155026) sprintf(Window_Buffer,"SNCF 2N2-3UF 811 M1 (310221)");
        if (nid_engine==2155027) sprintf(Window_Buffer,"SNCF 2N2-3UF 811 M2 (310222)");
        if (nid_engine==2155028) sprintf(Window_Buffer,"SNCF 2N2-3UF 812 M1 (310223)");
        if (nid_engine==2155029) sprintf(Window_Buffer,"SNCF 2N2-3UF 812 M2 (310224)");
        if (nid_engine==2155030) sprintf(Window_Buffer,"SNCF 2N2-3UF 813 M1 (310225)");
        if (nid_engine==2155031) sprintf(Window_Buffer,"SNCF 2N2-3UF 813 M2 (310226)");
        if (nid_engine==2155032) sprintf(Window_Buffer,"SNCF 2N2-3UF 814 M1 (310227)");
        if (nid_engine==2155033) sprintf(Window_Buffer,"SNCF 2N2-3UF 814 M2 (310228)");
        if (nid_engine==2155034) sprintf(Window_Buffer,"SNCF 2N2-3UF 815 M1 (310229)");
        if (nid_engine==2155035) sprintf(Window_Buffer,"SNCF 2N2-3UF 815 M2 (310230)");
        if (nid_engine==2155036) sprintf(Window_Buffer,"SNCF 2N2-3UF 816 M1 (310231)");
        if (nid_engine==2155037) sprintf(Window_Buffer,"SNCF 2N2-3UF 816 M2 (310232)");
        if (nid_engine==2155038) sprintf(Window_Buffer,"SNCF 2N2-3UF 817 M1 (310233)");
        if (nid_engine==2155039) sprintf(Window_Buffer,"SNCF 2N2-3UF 817 M2 (310234)");
        if (nid_engine==2155040) sprintf(Window_Buffer,"SNCF 2N2-3UF 818 M1 (310235)");
        if (nid_engine==2155041) sprintf(Window_Buffer,"SNCF 2N2-3UF 818 M2 (310236)");
        if (nid_engine==2155042) sprintf(Window_Buffer,"SNCF 2N2-3UF 819 M1 (310237)");
        if (nid_engine==2155043) sprintf(Window_Buffer,"SNCF 2N2-3UF 819 M2 (310238)");
        if (nid_engine==2155044) sprintf(Window_Buffer,"SNCF 2N2-3UF 820 M1 (310239)");
        if (nid_engine==2155045) sprintf(Window_Buffer,"SNCF 2N2-3UF 820 M2 (310240)");
        if (nid_engine==2155046) sprintf(Window_Buffer,"SNCF 2N2-3UF 821 M1 (310241)");
        if (nid_engine==2155047) sprintf(Window_Buffer,"SNCF 2N2-3UF 821 M2 (310242)");
        if (nid_engine==2155048) sprintf(Window_Buffer,"SNCF 2N2-3UF 822 M1 (310243)");
        if (nid_engine==2155049) sprintf(Window_Buffer,"SNCF 2N2-3UF 822 M2 (310244)");
        if (nid_engine==2155050) sprintf(Window_Buffer,"SNCF 2N2-3UF 823 M1 (310245)");
        if (nid_engine==2155051) sprintf(Window_Buffer,"SNCF 2N2-3UF 823 M2 (310246)");
        if (nid_engine==2155052) sprintf(Window_Buffer,"SNCF 2N2-3UF 824 M1 (310247)");
        if (nid_engine==2155053) sprintf(Window_Buffer,"SNCF 2N2-3UF 824 M2 (310248)");
        if (nid_engine==2155054) sprintf(Window_Buffer,"SNCF 2N2-3UF 825 M1 (310249)");
        if (nid_engine==2155055) sprintf(Window_Buffer,"SNCF 2N2-3UF 825 M2 (310250)");
        if (nid_engine==2154497) sprintf(Window_Buffer,"SNCF POS 4401 M1 (384001)");
        if (nid_engine==2154498) sprintf(Window_Buffer,"SNCF POS 4401 M2 (384002)");
        if (nid_engine==2154499) sprintf(Window_Buffer,"SNCF POS 4402 M1 (384003)");
        if (nid_engine==2154500) sprintf(Window_Buffer,"SNCF POS 4402 M2 (384004)");
        if (nid_engine==2154501) sprintf(Window_Buffer,"SNCF POS 4403 M1 (384005)");
        if (nid_engine==2154502) sprintf(Window_Buffer,"SNCF POS 4403 M2 (384006)");
        if (nid_engine==2154503) sprintf(Window_Buffer,"SNCF POS 4404 M1 (384007)");
        if (nid_engine==2154504) sprintf(Window_Buffer,"SNCF POS 4404 M2 (384008)");
        if (nid_engine==2154505) sprintf(Window_Buffer,"SNCF POS 4405 M1 (384009)");
        if (nid_engine==2154506) sprintf(Window_Buffer,"SNCF POS 4405 M2 (384010)");
        if (nid_engine==2154507) sprintf(Window_Buffer,"SNCF POS 4406 M1 (384011)");
        if (nid_engine==2154508) sprintf(Window_Buffer,"SNCF POS 4406 M2 (384012)");
        if (nid_engine==2154509) sprintf(Window_Buffer,"SNCF POS 4407 M1 (384013)");
        if (nid_engine==2154510) sprintf(Window_Buffer,"SNCF POS 4407 M2 (384014)");
        if (nid_engine==2154511) sprintf(Window_Buffer,"SNCF POS 4408 M1 (384015)");
        if (nid_engine==2154512) sprintf(Window_Buffer,"SNCF POS 4408 M2 (384016)");
        if (nid_engine==2154513) sprintf(Window_Buffer,"SNCF POS 4409 M1 (384017)");
        if (nid_engine==2154514) sprintf(Window_Buffer,"SNCF POS 4409 M2 (384018)");
        if (nid_engine==2154515) sprintf(Window_Buffer,"SNCF POS 4410 M1 (384019)");
        if (nid_engine==2154516) sprintf(Window_Buffer,"SNCF POS 4410 M2 (384020)");
        if (nid_engine==2154517) sprintf(Window_Buffer,"SNCF POS 4411 M1 (384021)");
        if (nid_engine==2154518) sprintf(Window_Buffer,"SNCF POS 4411 M2 (384022)");
        if (nid_engine==2154519) sprintf(Window_Buffer,"SNCF POS 4412 M1 (384023)");
        if (nid_engine==2154520) sprintf(Window_Buffer,"SNCF POS 4412 M2 (384024)");
        if (nid_engine==2154521) sprintf(Window_Buffer,"SNCF POS 4413 M1 (384025)");
        if (nid_engine==2154522) sprintf(Window_Buffer,"SNCF POS 4413 M2 (384026)");
        if (nid_engine==2154523) sprintf(Window_Buffer,"SNCF POS 4414 M1 (384027)");
        if (nid_engine==2154524) sprintf(Window_Buffer,"SNCF POS 4414 M2 (384028)");
        if (nid_engine==2154525) sprintf(Window_Buffer,"SNCF POS 4415 M1 (384029)");
        if (nid_engine==2154526) sprintf(Window_Buffer,"SNCF POS 4415 M2 (384030)");
        if (nid_engine==2154527) sprintf(Window_Buffer,"SNCF POS 4416 M1 (384031)");
        if (nid_engine==2154528) sprintf(Window_Buffer,"SNCF POS 4416 M2 (384032)");
        if (nid_engine==2154529) sprintf(Window_Buffer,"SNCF POS 4417 M1 (384033)");
        if (nid_engine==2154530) sprintf(Window_Buffer,"SNCF POS 4417 M2 (384034)");
        if (nid_engine==2154531) sprintf(Window_Buffer,"SNCF POS 4418 M1 (384035)");
        if (nid_engine==2154532) sprintf(Window_Buffer,"SNCF POS 4418 M2 (384036)");
        if (nid_engine==2154533) sprintf(Window_Buffer,"SNCF POS 4419 M1 (384037)");
        if (nid_engine==2154534) sprintf(Window_Buffer,"SNCF POS 4419 M2 (384038)");
        if (nid_engine==2154705) sprintf(Window_Buffer,"SNCF DASYE 701 M1 (29701)");
        if (nid_engine==2154706) sprintf(Window_Buffer,"SNCF DASYE 701 M2 (29702)");
        if (nid_engine==2154707) sprintf(Window_Buffer,"SNCF DASYE 702 M1 (29703)");
        if (nid_engine==2154708) sprintf(Window_Buffer,"SNCF DASYE 702 M2 (29704)");
        if (nid_engine==2154709) sprintf(Window_Buffer,"SNCF DASYE 703 M1 (29705)");
        if (nid_engine==2154710) sprintf(Window_Buffer,"SNCF DASYE 703 M2 (29706)");
        if (nid_engine==2154711) sprintf(Window_Buffer,"SNCF DASYE 704 M1 (29707)");
        if (nid_engine==2154712) sprintf(Window_Buffer,"SNCF DASYE 704 M2 (29708)");
        if (nid_engine==2154713) sprintf(Window_Buffer,"SNCF DASYE 705 M1 (29709)");
        if (nid_engine==2154714) sprintf(Window_Buffer,"SNCF DASYE 705 M2 (29710)");
        if (nid_engine==2154715) sprintf(Window_Buffer,"SNCF DASYE 706 M1 (29711)");
        if (nid_engine==2154716) sprintf(Window_Buffer,"SNCF DASYE 706 M2 (29712)");
        if (nid_engine==2154717) sprintf(Window_Buffer,"SNCF DASYE 707 M1 (29713)");
        if (nid_engine==2154718) sprintf(Window_Buffer,"SNCF DASYE 707 M2 (29714)");
        if (nid_engine==2154719) sprintf(Window_Buffer,"SNCF DASYE 708 M1 (29715)");
        if (nid_engine==2154720) sprintf(Window_Buffer,"SNCF DASYE 708 M2 (29716)");
        if (nid_engine==2154721) sprintf(Window_Buffer,"SNCF DASYE 709 M1 (29717)");
        if (nid_engine==2154722) sprintf(Window_Buffer,"SNCF DASYE 709 M2 (29718)");
        if (nid_engine==2154723) sprintf(Window_Buffer,"SNCF DASYE 710 M1 (29719)");
        if (nid_engine==2154724) sprintf(Window_Buffer,"SNCF DASYE 710 M2 (29720)");
        if (nid_engine==2154725) sprintf(Window_Buffer,"SNCF DASYE 711 M1 (29721)");
        if (nid_engine==2154726) sprintf(Window_Buffer,"SNCF DASYE 711 M2 (29722)");
        if (nid_engine==2154727) sprintf(Window_Buffer,"SNCF DASYE 712 M1 (29723)");
        if (nid_engine==2154728) sprintf(Window_Buffer,"SNCF DASYE 712 M2 (29724)");
        if (nid_engine==2154729) sprintf(Window_Buffer,"SNCF DASYE 713 M1 (29725)");
        if (nid_engine==2154730) sprintf(Window_Buffer,"SNCF DASYE 713 M2 (29726)");
        if (nid_engine==2154731) sprintf(Window_Buffer,"SNCF DASYE 714 M1 (29727)");
        if (nid_engine==2154732) sprintf(Window_Buffer,"SNCF DASYE 714 M2 (29728)");
        if (nid_engine==2154733) sprintf(Window_Buffer,"SNCF DASYE 715 M1 (29729)");
        if (nid_engine==2154734) sprintf(Window_Buffer,"SNCF DASYE 715 M2 (29730)");
        if (nid_engine==2154735) sprintf(Window_Buffer,"SNCF DASYE 716 M1 (29731)");
        if (nid_engine==2154736) sprintf(Window_Buffer,"SNCF DASYE 716 M2 (29732)");
        if (nid_engine==2154737) sprintf(Window_Buffer,"SNCF DASYE 717 M1 (29733)");
        if (nid_engine==2154738) sprintf(Window_Buffer,"SNCF DASYE 717 M2 (29734)");
        if (nid_engine==2154739) sprintf(Window_Buffer,"SNCF DASYE 718 M1 (29735)");
        if (nid_engine==2154740) sprintf(Window_Buffer,"SNCF DASYE 718 M2 (29736)");
        if (nid_engine==2154741) sprintf(Window_Buffer,"SNCF DASYE 719 M1 (29737)");
        if (nid_engine==2154742) sprintf(Window_Buffer,"SNCF DASYE 719 M2 (29738)");
        if (nid_engine==2154743) sprintf(Window_Buffer,"SNCF DASYE 720 M1 (29739)");
        if (nid_engine==2154744) sprintf(Window_Buffer,"SNCF DASYE 720 M2 (29740)");
        if (nid_engine==2154745) sprintf(Window_Buffer,"SNCF DASYE 721 M1 (29741)");
        if (nid_engine==2154746) sprintf(Window_Buffer,"SNCF DASYE 721 M2 (29742)");
        if (nid_engine==2154747) sprintf(Window_Buffer,"SNCF DASYE 722 M1 (29743)");
        if (nid_engine==2154748) sprintf(Window_Buffer,"SNCF DASYE 722 M2 (29744)");
        if (nid_engine==2154749) sprintf(Window_Buffer,"SNCF DASYE 723 M1 (29745)");
        if (nid_engine==2154750) sprintf(Window_Buffer,"SNCF DASYE 723 M2 (29746)");
        if (nid_engine==2154751) sprintf(Window_Buffer,"SNCF DASYE 724 M1 (29747)");
        if (nid_engine==2154752) sprintf(Window_Buffer,"SNCF DASYE 724 M2 (29748)");
        if (nid_engine==2154753) sprintf(Window_Buffer,"SNCF DASYE 725 M1 (29749)");
        if (nid_engine==2154754) sprintf(Window_Buffer,"SNCF DASYE 725 M2 (29750)");
        if (nid_engine==2154755) sprintf(Window_Buffer,"SNCF DASYE 726 M1 (29751)");
        if (nid_engine==2154756) sprintf(Window_Buffer,"SNCF DASYE 726 M2 (29752)");
        if (nid_engine==2154757) sprintf(Window_Buffer,"SNCF DASYE 727 M1 (29753)");
        if (nid_engine==2154758) sprintf(Window_Buffer,"SNCF DASYE 727 M2 (29754)");
        if (nid_engine==2154759) sprintf(Window_Buffer,"SNCF DASYE 728 M1 (29755)");
        if (nid_engine==2154760) sprintf(Window_Buffer,"SNCF DASYE 728 M2 (29756)");
        if (nid_engine==2154761) sprintf(Window_Buffer,"SNCF DASYE 729 M1 (29757)");
        if (nid_engine==2154762) sprintf(Window_Buffer,"SNCF DASYE 729 M2 (29758)");
        if (nid_engine==2154763) sprintf(Window_Buffer,"SNCF DASYE 730 M1 (29759)");
        if (nid_engine==2154764) sprintf(Window_Buffer,"SNCF DASYE 730 M2 (29760)");
        if (nid_engine==2154765) sprintf(Window_Buffer,"SNCF DASYE 731 M1 (29761)");
        if (nid_engine==2154766) sprintf(Window_Buffer,"SNCF DASYE 731 M2 (29762)");
        if (nid_engine==2154803) sprintf(Window_Buffer,"SNCF DASYE 750 M1 (29799)");
        if (nid_engine==2154804) sprintf(Window_Buffer,"SNCF DASYE 750 M2 (29800)");
        if (nid_engine==2154823) sprintf(Window_Buffer,"SNCF DASYE 760 M1 (29819)");
        if (nid_engine==2154824) sprintf(Window_Buffer,"SNCF DASYE 760 M2 (29820)");
        if (nid_engine==2154825) sprintf(Window_Buffer,"SNCF DASYE 761 M1 (29821)");
        if (nid_engine==2154826) sprintf(Window_Buffer,"SNCF DASYE 761 M2 (29822)");
        if (nid_engine==2154827) sprintf(Window_Buffer,"SNCF DASYE 762 M1 (29823)");
        if (nid_engine==2154828) sprintf(Window_Buffer,"SNCF DASYE 762 M2 (29824)");
        if (nid_engine==2154829) sprintf(Window_Buffer,"SNCF DASYE 763 M1 (29825)");
        if (nid_engine==2154830) sprintf(Window_Buffer,"SNCF DASYE 763 M2 (29826)");
        if (nid_engine==2154767) sprintf(Window_Buffer,"SNCF DASYE-F 732 M1 (29763)");
        if (nid_engine==2154768) sprintf(Window_Buffer,"SNCF DASYE-F 732 M2 (29764)");
        if (nid_engine==2154769) sprintf(Window_Buffer,"SNCF DASYE-F 733 M1 (29765)");
        if (nid_engine==2154770) sprintf(Window_Buffer,"SNCF DASYE-F 733 M2 (29766)");
        if (nid_engine==2154771) sprintf(Window_Buffer,"SNCF DASYE-F 734 M1 (29767)");
        if (nid_engine==2154772) sprintf(Window_Buffer,"SNCF DASYE-F 734 M2 (29768)");
        if (nid_engine==2154773) sprintf(Window_Buffer,"SNCF DASYE-F 735 M1 (29769)");
        if (nid_engine==2154774) sprintf(Window_Buffer,"SNCF DASYE-F 735 M2 (29770)");
        if (nid_engine==2154775) sprintf(Window_Buffer,"SNCF DASYE-F 736 M1 (29771)");
        if (nid_engine==2154776) sprintf(Window_Buffer,"SNCF DASYE-F 736 M2 (29772)");
        if (nid_engine==2154777) sprintf(Window_Buffer,"SNCF DASYE-F 737 M1 (29773)");
        if (nid_engine==2154778) sprintf(Window_Buffer,"SNCF DASYE-F 737 M2 (29774)");
        if (nid_engine==2154779) sprintf(Window_Buffer,"SNCF DASYE-F 738 M1 (29775)");
        if (nid_engine==2154780) sprintf(Window_Buffer,"SNCF DASYE-F 738 M2 (29776)");
        if (nid_engine==2154781) sprintf(Window_Buffer,"SNCF DASYE-F 739 M1 (29777)");
        if (nid_engine==2154782) sprintf(Window_Buffer,"SNCF DASYE-F 739 M2 (29778)");
        if (nid_engine==2154783) sprintf(Window_Buffer,"SNCF DASYE-F 740 M1 (29779)");
        if (nid_engine==2154784) sprintf(Window_Buffer,"SNCF DASYE-F 740 M2 (29780)");
        if (nid_engine==2154785) sprintf(Window_Buffer,"SNCF DASYE-F 741 M1 (29781)");
        if (nid_engine==2154786) sprintf(Window_Buffer,"SNCF DASYE-F 741 M2 (29782)");
        if (nid_engine==2154787) sprintf(Window_Buffer,"SNCF DASYE-F 742 M1 (29783)");
        if (nid_engine==2154788) sprintf(Window_Buffer,"SNCF DASYE-F 742 M2 (29784)");
        if (nid_engine==2154789) sprintf(Window_Buffer,"SNCF DASYE-F 743 M1 (29785)");
        if (nid_engine==2154790) sprintf(Window_Buffer,"SNCF DASYE-F 743 M2 (29786)");
        if (nid_engine==2154791) sprintf(Window_Buffer,"SNCF DASYE-F 744 M1 (29787)");
        if (nid_engine==2154792) sprintf(Window_Buffer,"SNCF DASYE-F 744 M2 (29788)");
        if (nid_engine==2154793) sprintf(Window_Buffer,"SNCF DASYE-F 745 M1 (29789)");
        if (nid_engine==2154794) sprintf(Window_Buffer,"SNCF DASYE-F 745 M2 (29790)");
        if (nid_engine==2154795) sprintf(Window_Buffer,"SNCF DASYE-F 746 M1 (29791)");
        if (nid_engine==2154796) sprintf(Window_Buffer,"SNCF DASYE-F 746 M2 (29792)");
        if (nid_engine==2154797) sprintf(Window_Buffer,"SNCF DASYE-F 747 M1 (29793)");
        if (nid_engine==2154798) sprintf(Window_Buffer,"SNCF DASYE-F 747 M2 (29794)");
        if (nid_engine==2154799) sprintf(Window_Buffer,"SNCF DASYE-F 748 M1 (29795)");
        if (nid_engine==2154800) sprintf(Window_Buffer,"SNCF DASYE-F 748 M2 (29796)");
        if (nid_engine==2154801) sprintf(Window_Buffer,"SNCF DASYE-F 749 M1 (29797)");
        if (nid_engine==2154802) sprintf(Window_Buffer,"SNCF DASYE-F 750 M2 (29797)");
    }
    if (nid_engine==2162688) sprintf(Window_Buffer,"SNCF: Reserved");
    if (nid_engine>=5767683 && nid_engine<=5767711) sprintf(Window_Buffer,"Siemens");
    if (nid_engine>=7409016 && nid_engine<=7409662) sprintf(Window_Buffer,"Siemens");
    if (nid_engine>=8840000 && nid_engine<=8849999) sprintf(Window_Buffer,"Thales");
    if (nid_engine>=8850000 && nid_engine<=8859999) sprintf(Window_Buffer,"ETCS onboard units for Saudi Arabia Dammam- Riyadh line");
    if (nid_engine>=16776192 && nid_engine<=16777215) sprintf(Window_Buffer,"DB: for testing only");
    if (nid_engine == 2154547) sprintf(Window_Buffer,"PBA 4532 Motrice 1");
    if (nid_engine == 2154548) sprintf(Window_Buffer,"PBA 4532 Motrice 2");
    if (nid_engine == 2154549) sprintf(Window_Buffer,"PBA 4533 Motrice 1");
    if (nid_engine == 2154550) sprintf(Window_Buffer,"PBA 4533 Motrice 2");
    if (nid_engine == 2154551) sprintf(Window_Buffer,"PBA 4534 Motrice 1");
    if (nid_engine == 2154552) sprintf(Window_Buffer,"PBA 4534 Motrice 2");
    if (nid_engine == 2154553) sprintf(Window_Buffer,"PBA 4535 Motrice 1");
    if (nid_engine == 2154554) sprintf(Window_Buffer,"PBA 4535 Motrice 2");
    if (nid_engine == 2154555) sprintf(Window_Buffer,"PBA 4536 Motrice 1");
    if (nid_engine == 2154556) sprintf(Window_Buffer,"PBA 4536 Motrice 2");
    if (nid_engine == 2154557) sprintf(Window_Buffer,"PBA 4537 Motrice 1");
    if (nid_engine == 2154558) sprintf(Window_Buffer,"PBA 4537 Motrice 2");
    if (nid_engine == 2154559) sprintf(Window_Buffer,"PBA 4538 Motrice 1");
    if (nid_engine == 2154560) sprintf(Window_Buffer,"PBA 4538 Motrice 2");
    if (nid_engine == 2154561) sprintf(Window_Buffer,"PBA 4539 Motrice 1");
    if (nid_engine == 2154562) sprintf(Window_Buffer,"PBA 4539 Motrice 2");
    if (nid_engine == 2154563) sprintf(Window_Buffer,"PBA 4540 Motrice 1");
    if (nid_engine == 2154564) sprintf(Window_Buffer,"PBA 4540 Motrice 2");

    if (nid_engine == 2154593) sprintf(Window_Buffer,"PBKA 4301 Motrice 0");
    if (nid_engine == 2154594) sprintf(Window_Buffer,"PBKA 4301 Motrice 9");
    if (nid_engine == 2154595) sprintf(Window_Buffer,"PBKA 4302 Motrice 0");
    if (nid_engine == 2154596) sprintf(Window_Buffer,"PBKA 4302 Motrice 9");
    if (nid_engine == 2154597) sprintf(Window_Buffer,"PBKA 4303 Motrice 0");
    if (nid_engine == 2154598) sprintf(Window_Buffer,"PBKA 4303 Motrice 9");
    if (nid_engine == 2154599) sprintf(Window_Buffer,"PBKA 4304 Motrice 0");
    if (nid_engine == 2154600) sprintf(Window_Buffer,"PBKA 4304 Motrice 9");
    if (nid_engine == 2154601) sprintf(Window_Buffer,"PBKA 4305 Motrice 0");
    if (nid_engine == 2154602) sprintf(Window_Buffer,"PBKA 4305 Motrice 9");
    if (nid_engine == 2154603) sprintf(Window_Buffer,"PBKA 4306 Motrice 0");
    if (nid_engine == 2154604) sprintf(Window_Buffer,"PBKA 4306 Motrice 9");
    if (nid_engine == 2154605) sprintf(Window_Buffer,"PBKA 4307 Motrice 0");
    if (nid_engine == 2154606) sprintf(Window_Buffer,"PBKA 4307 Motrice 9");
    if (nid_engine == 2154609) sprintf(Window_Buffer,"PBKA 4321 Motrice 0");
    if (nid_engine == 2154610) sprintf(Window_Buffer,"PBKA 4321 Motrice 9");
    if (nid_engine == 2154611) sprintf(Window_Buffer,"PBKA 4322 Motrice 0");
    if (nid_engine == 2154612) sprintf(Window_Buffer,"PBKA 4322 Motrice 9");
    if (nid_engine == 2154617) sprintf(Window_Buffer,"PBKA 4331 Motrice 0");
    if (nid_engine == 2154618) sprintf(Window_Buffer,"PBKA 4331 Motrice 9");
    if (nid_engine == 2154619) sprintf(Window_Buffer,"PBKA 4332 Motrice 0");
    if (nid_engine == 2154620) sprintf(Window_Buffer,"PBKA 4332 Motrice 9");
    if (nid_engine == 2154577) sprintf(Window_Buffer,"PBKA 4341 Motrice 0");
    if (nid_engine == 2154578) sprintf(Window_Buffer,"PBKA 4341 Motrice 9");
    if (nid_engine == 2154579) sprintf(Window_Buffer,"PBKA 4342 Motrice 0");
    if (nid_engine == 2154580) sprintf(Window_Buffer,"PBKA 4342 Motrice 9");
    if (nid_engine == 2154581) sprintf(Window_Buffer,"PBKA 4343 Motrice 0");
    if (nid_engine == 2154582) sprintf(Window_Buffer,"PBKA 4343 Motrice 9");
    if (nid_engine == 2154583) sprintf(Window_Buffer,"PBKA 4344 Motrice 0");
    if (nid_engine == 2154584) sprintf(Window_Buffer,"PBKA 4344 Motrice 9");
    if (nid_engine == 2154585) sprintf(Window_Buffer,"PBKA 4345 Motrice 0");
    if (nid_engine == 2154586) sprintf(Window_Buffer,"PBKA 4345 Motrice 9");
    if (nid_engine == 2154587) sprintf(Window_Buffer,"PBKA 4346 Motrice 0");
    if (nid_engine == 2154588) sprintf(Window_Buffer,"PBKA 4346 Motrice 9");

    if (nid_engine == 12300001) sprintf(Window_Buffer,"SNCF DASYE-F 750 M2 (29797)");
    if (nid_engine == 12300002) sprintf(Window_Buffer,"SNCF DASYE-F 751 M3 (29798)");
    if (nid_engine == 12300003) sprintf(Window_Buffer,"SNCF DASYE-F 752 M4 (29799)");
    if (nid_engine == 12300004) sprintf(Window_Buffer,"SNCF DASYE-F 753 M5 (29800)");
    if (nid_engine == 12300005) sprintf(Window_Buffer,"SNCF DASYE-F 750 M2 (29797)");

    SetWindowText(VehicleWindow,Window_Buffer);
    if (target_window_index>0) target_window_index++;
}

void D_nid_engine(int nid_engine,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_ENGINE\t(%d) Unknown\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=0 && nid_engine<=1023) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Bombardier RCS\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1024 && nid_engine<=1199) sprintf(Window_Buffer,"NID_ENGINE\t(%d) FS: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1200 && nid_engine<=1399) sprintf(Window_Buffer,"NID_ENGINE\t(%d) FS / Assigned Ansaldo\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1400 && nid_engine<=3024) sprintf(Window_Buffer,"NID_ENGINE\t(%d) FS: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3025 && nid_engine<=3042) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Alstom – S-100\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3043 && nid_engine<=3060) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3061 && nid_engine<=3072) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Alstom – S-100\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3073 && nid_engine<=3099) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3100 && nid_engine<=3131) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Siemens – S-102\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3132 && nid_engine<=3199) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3200 && nid_engine<=3259) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Siemens – S-112\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3260 && nid_engine<=3299) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3300 && nid_engine<=3331) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Siemens – S-103\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3332 && nid_engine<=3351) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Siemens – S-103\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3352 && nid_engine<=3399) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3400 && nid_engine<=3411) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Ansaldo – S-120\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3412 && nid_engine<=3449) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3450 && nid_engine<=3465) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Ansaldo – S-120.050\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3466 && nid_engine<=3499) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3500 && nid_engine<=3539) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Alstom - S-104\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3540 && nid_engine<=3599) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3600 && nid_engine<=3625) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Alstom - S-114\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3626 && nid_engine<=3699) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3700 && nid_engine<=3728) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Ansaldo - S-121\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3729 && nid_engine<=3799) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3800 && nid_engine<=3889) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Assigned: Bombardier - S-130 / S-730 (12 of 6 S130 train with Siemens equipment)\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=3890 && nid_engine<=4999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Renfe / Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=5000 && nid_engine<=6999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Alstom\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=7000 && nid_engine<=11999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Switzerland : SBB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=12000 && nid_engine<=12199) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Lloyd's Register Rail Europe B.V. for Class'66 and G1206 loco's retrofitting\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=12200 && nid_engine<=12699) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Hitachi\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=12700 && nid_engine<=12719) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ADIF ETCS trains\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=12720 && nid_engine<=12919) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Hitachi - India\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=12966 && nid_engine<=12999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Eurostar E320 %d\tOnboard ETCS identity",nid_engine,nid_engine-8965);
    if (nid_engine>=13000 && nid_engine<=14999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Alstom: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=15000 && nid_engine<=15999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) UK\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=16000 && nid_engine<=16120) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Ansaldo Breda: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=16121 && nid_engine<=16999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Slovenia\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=17000 && nid_engine<=17050) sprintf(Window_Buffer,"NID_ENGINE\t(%d) NV Infrabel: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=17051 && nid_engine<=20550) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Bombardier\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20551 && nid_engine<=20566) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Austrian Private Railways\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20567 && nid_engine<=20568) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Vossloh Locomotives / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20569 && nid_engine<=20570) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Skoda locomotive 109 E – ZSR locomotive 381 (Slovak railway)\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20580 && nid_engine<=20585) sprintf(Window_Buffer,"NID_ENGINE\t(%d) CFR Locomotives 477 / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20600 && nid_engine<=20699) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Bombardier reserved values for “EFE project “ (Santiago de Chile, Chile)\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20700 && nid_engine<=20949) sprintf(Window_Buffer,"NID_ENGINE\t(%d) UK DesiroCity ETCS / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=20950 && nid_engine<=20989) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ETR610 (ED250) Pendolino\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=21000 && nid_engine<=21499) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Bombardier reserved values for “Supervia project” (Rio de Janeiro, Brazil)\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=21500 && nid_engine<=21999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Euroloco PH37ACi project. (Belgium, Luxembourg, Netherlands, Germany)\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=30001 && nid_engine<=32000) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Project AM08 (305 engines) Migration to ETCS for 450 existing engines\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=32001 && nid_engine<=32500) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Siemens Vectron Locomotives / Trainguard 200: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=32501 && nid_engine<=32550) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Eurosprinter Locomotives ES64U4 / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=32551 && nid_engine<=32565) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Stadler FLIRT NRH / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=32566 && nid_engine<=32625) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PESA 43WE « Dart » (ED161) PKP-IC Poland|PESA 218Mc (SA133) PKM|PESA 219M (SA136) PKM\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=33000 && nid_engine<=33999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Auriga OBS\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=90000 && nid_engine<=90999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Ankara- High Speed Line Project\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=91000 && nid_engine<=91049) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Cumaovasi-Tepekoy vehicles – Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=91050 && nid_engine<=91099) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Bandirma vehicles / Trainguard Futur 3000\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=91100 && nid_engine<=91119) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Marmaray Auxiliary vehicles – Trainguard Futur 3000\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=91120 && nid_engine<=91149) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Samsun-Kalin vehicles – Trainguard 100\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1048576 && nid_engine<=1048592) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ČD : Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1048593 && nid_engine<=1048596) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ČD\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1048597 && nid_engine<=1050624) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ČD : Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1116001 && nid_engine<=1116999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ÖBB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1117000 && nid_engine<=1117499) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Croatia, Ministry of Sea, Transport and Infrastructure\tOnboard ETCS identity",nid_engine);
    if (nid_engine==1186816) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB/Siemens\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1186817 && nid_engine<=1186879) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1186880 && nid_engine<=1186884) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB/Siemens\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1186885 && nid_engine<=1188799) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1188800 && nid_engine<=1188801) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB/Siemens\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1188802 && nid_engine<=1188863) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1216001 && nid_engine<=1216999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ÖBB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1217000 && nid_engine<=1217100) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Project KISS – WESTBahn ET4010 and ET4110\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1217101 && nid_engine<=1217150) sprintf(Window_Buffer,"NID_ENGINE\t(%d) MRCE Dispolok – ES64U2 / Trainguard 200\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=1269760 && nid_engine<=1270783) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=2097152 && nid_engine<=2162687) sprintf(Window_Buffer,"NID_ENGINE\t(%d) SNCF\tOnboard ETCS identity",nid_engine);
    if (nid_engine==2162688) sprintf(Window_Buffer,"NID_ENGINE\t(%d) SNCF: Reserved\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=5767683 && nid_engine<=5767711) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Siemens\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=7409016 && nid_engine<=7409662) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Siemens\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=8840000 && nid_engine<=8849999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) Thales\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=8850000 && nid_engine<=8859999) sprintf(Window_Buffer,"NID_ENGINE\t(%d) ETCS onboard units for Saudi Arabia Dammam- Riyadh line\tOnboard ETCS identity",nid_engine);
    if (nid_engine>=16776192 && nid_engine<=16777215) sprintf(Window_Buffer,"NID_ENGINE\t(%d) DB: for testing only\tOnboard ETCS identity",nid_engine);

    if (nid_engine == 2154547) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4532 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154548) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4532 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154549) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4533 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154550) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4533 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154551) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4534 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154552) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4534 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154553) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4535 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154554) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4535 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154555) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4536 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154556) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4536 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154557) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4537 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154558) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4537 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154559) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4538 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154560) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4538 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154561) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4539 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154562) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4539 Motrice 2\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154563) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4540 Motrice 1\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154564) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBA 4540 Motrice 2\tOnboard ETCS identity",nid_engine);

    if (nid_engine == 2154593) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4301 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154594) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4301 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154595) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4302 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154596) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4302 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154597) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4303 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154598) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4303 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154599) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4304 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154600) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4304 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154601) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4305 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154602) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4305 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154603) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4306 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154604) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4306 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154605) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4307 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154606) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4307 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154609) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4321 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154610) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4321 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154611) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4322 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154612) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4322 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154617) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4331 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154618) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4331 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154619) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4332 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154620) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4332 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154577) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4341 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154578) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4341 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154579) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4342 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154580) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4342 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154581) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4343 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154582) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4343 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154583) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4344 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154584) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4344 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154585) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4345 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154586) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4345 Motrice 9\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154587) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4346 Motrice 0\tOnboard ETCS identity",nid_engine);
    if (nid_engine == 2154588) sprintf(Window_Buffer,"NID_ENGINE\t(%d) PBKA 4346 Motrice 9\tOnboard ETCS identity",nid_engine);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_marqstreason(int q_marqstreason,HWND TargetWindow) {
    sprintf(Window_Buffer,"Q_MARQSTREASON\t(%d) Unknown\tReason for MA request sending",q_marqstreason);
    if (q_marqstreason==1) sprintf(Window_Buffer,"Q_MARQSTREASON\t(1) Start selected by driver\tReason for MA request sending");
    else if (q_marqstreason<=3) sprintf(Window_Buffer,"Q_MARQSTREASON\t(2) Time before pre-indication location for EOA/LOA reached\tReason for MA request sending");
    else if (q_marqstreason<=8) sprintf(Window_Buffer,"Q_MARQSTREASON\t(4) Time before a section timer/LOA speed timer expires reached\tReason for MA request sending");
    else if (q_marqstreason<=15) sprintf(Window_Buffer,"Q_MARQSTREASON\t(8) Track description deleted\tReason for MA request sending");
    else sprintf(Window_Buffer,"Q_MARQSTREASON\t(16) TAF up to level 2/3 transition location\tReason for MA request sending");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_emergencystop(int q_emergencystop,HWND TargetWindow) {
    if (q_emergencystop==0) sprintf(Window_Buffer,"Q_EMERGENCYSTOP\t(0) Conditional Emergency Stop accepted, with update of EOA (ref. 3.10.2.2)\tQualifier for emergency stop acknowledgement");
    if (q_emergencystop==1) sprintf(Window_Buffer,"Q_EMERGENCYSTOP\t(1) Conditional Emergency Stop accepted, with no update of EOA (ref. 3.10.2.2)\tQualifier for emergency stop acknowledgement");
    if (q_emergencystop==2) sprintf(Window_Buffer,"Q_EMERGENCYSTOP\t(2) Not Relevant (Unconditional Emergency Stop) (ref. 3.10.2.3)\tQualifier for emergency stop acknowledgement");
    if (q_emergencystop==3) sprintf(Window_Buffer,"Q_EMERGENCYSTOP\t(3) Conditional Emergency Stop rejected because train has passed the emergency stop location (ref. 3.10.2.2)\tQualifier for emergency stop acknowledgement");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_q_status(int q_status,HWND TargetWindow) {
    if (q_status==0) sprintf(Window_Buffer,"Q_STATUS\t(0) Invalid\tStatus of SoM position report");
    if (q_status==1) sprintf(Window_Buffer,"Q_STATUS\t(1) Valid\tStatus of SoM position report");
    if (q_status==2) sprintf(Window_Buffer,"Q_STATUS\t(2) Unknown\tStatus of SoM position report");
    if (q_status==3) sprintf(Window_Buffer,"Q_STATUS\t(3) Spare\tStatus of SoM position report");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}


void D_nid_radio (int nid_radio_1,int nid_radio_2,int nid_radio_3,int nid_radio_4,HWND TargetWindow) {
    unsigned long long nid_radio= (unsigned long long)((unsigned long long)nid_radio_1*65536*65536*65536)+(unsigned long long)((unsigned long long)nid_radio_2*65536*65536)+(unsigned long long)((unsigned long long)nid_radio_3*65536)+(unsigned long long)((unsigned long long)nid_radio_4);
    sprintf(Hexdec_Buffer,"%I64x",(nid_radio));
    if (Hexdec_Buffer[9]=='f') Hexdec_Buffer[9]='\0';
    if (Hexdec_Buffer[10]=='f') Hexdec_Buffer[10]='\0';
    if (Hexdec_Buffer[11]=='f') Hexdec_Buffer[11]='\0';
    if (Hexdec_Buffer[12]=='f') Hexdec_Buffer[12]='\0';
    sprintf(Window_Buffer,"NID_RADIO\t+%s\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765734399) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°1)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765738495) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°2)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765742591) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°3)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765746687) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°4)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765750783) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°5)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765754879) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°6)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765758975) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°7)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765763071) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°8)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765767167) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°9)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917765795839) sprintf(Window_Buffer,"NID_RADIO\t+%s (France HSL East RBC n°10)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==13937445901963263) sprintf(Window_Buffer,"NID_RADIO\t+%s (Netherlands HSL Zuid RBC n°1001)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==13937445901967359) sprintf(Window_Buffer,"NID_RADIO\t+%s (Netherlands HSL Noord RBC n°1)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14150819876192255) sprintf(Window_Buffer,"NID_RADIO\t+%s (Belgium L3 RBC n°3)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14150819876196351) sprintf(Window_Buffer,"NID_RADIO\t+%s (Belgium L4 RBC n°4)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917775761407) sprintf(Window_Buffer,"NID_RADIO\t+%s (France Valenciennes RBC n°1)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14470917775765503) sprintf(Window_Buffer,"NID_RADIO\t+%s (France Valenciennes RBC n°2)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192329727) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL RBC n°1)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192333823) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL RBC n°2)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192337919) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL RBC n°3)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192342015) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL RBC n°4)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192276479) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°1)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192280575) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°2)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192284671) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°3)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192288767) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°4)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192292863) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°5)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192296959) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°6)\tRadio subscriber number",Hexdec_Buffer);
    if (nid_radio==14468028192301055) sprintf(Window_Buffer,"NID_RADIO\t+%s (France BPL HSL SEA n°7)\tRadio subscriber number",Hexdec_Buffer);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    if (target_window_index>0) target_window_index++;
}

void Display_Nid_Radio(char* source,int nid_radio_1,int nid_radio_2,int nid_radio_3,int nid_radio_4,HWND TargetWindow) {
    unsigned long long nid_radio= (unsigned long long)((unsigned long long)nid_radio_1*65536*65536*65536)+(unsigned long long)((unsigned long long)nid_radio_2*65536*65536)+(unsigned long long)((unsigned long long)nid_radio_3*65536)+(unsigned long long)((unsigned long long)nid_radio_4);
    sprintf(source,"+%I64x",(nid_radio));
    if (source[9]=='f') source[9]='\0';
    if (source[10]=='f') source[10]='\0';
    if (source[11]=='f') source[11]='\0';
    if (source[12]=='f') source[12]='\0';
}

void D_a_nvmaxredadh(int index, int a_nvmaxredadh,HWND TargetWindow) {
    if (a_nvmaxredadh==61) sprintf(Window_Buffer,"A_NVMAXREDADH%d\t(61) No maximum deceleration, display target information in CSM\tMaximum deceleration under reduced",index);
    else if (a_nvmaxredadh==62) sprintf(Window_Buffer,"A_NVMAXREDADH%d\t(62) No maximum deceleration, display time information in CSM\tMaximum deceleration under reduced",index);
    else if (a_nvmaxredadh==63) sprintf(Window_Buffer,"A_NVMAXREDADH%d\t(63) No maximum deceleration, no additional display\tMaximum deceleration under reduced",index);
    else sprintf(Window_Buffer,"A_NVMAXREDADH%d\t%.2f m/s²\tMaximum deceleration under reduced",index,a_nvmaxredadh*0.05);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    if (target_window_index>0) target_window_index++;
    sprintf(Window_Buffer,"\t\tadhesion conditions (%d)",index);
    packet_offset++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
}

void D_m_nvavadh(int m_nvavadh,HWND TargetWindow) {
    if (m_nvavadh>20) sprintf(Window_Buffer,"M_NVAVADH\t(%.2f) Unknown\tWeighting factor for available wheel/rail adhesion",m_nvavadh*0.05);
    else sprintf(Window_Buffer,"M_NVAVADH\t%.2f\tWeighting factor for available wheel/rail adhesion",m_nvavadh*0.05);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nvebcl(int m_nvebcl,HWND TargetWindow) {
    if (m_nvebcl==0) sprintf(Window_Buffer,"M_NVEBCL\t(0) 50 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==1) sprintf(Window_Buffer,"M_NVEBCL\t(1) 90 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==2) sprintf(Window_Buffer,"M_NVEBCL\t(2) 99 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==3) sprintf(Window_Buffer,"M_NVEBCL\t(3) 99.9 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==4) sprintf(Window_Buffer,"M_NVEBCL\t(4) 99.99 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==5) sprintf(Window_Buffer,"M_NVEBCL\t(5) 99.999 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==6) sprintf(Window_Buffer,"M_NVEBCL\t(6) 99.9999 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==7) sprintf(Window_Buffer,"M_NVEBCL\t(7) 99.99999 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==8) sprintf(Window_Buffer,"M_NVEBCL\t(8) 99.999999 %%\tConfidence level for emergency brake safe deceleration");
    else if (m_nvebcl==9) sprintf(Window_Buffer,"M_NVEBCL\t(9) 99.9999999 %%\tConfidence level for emergency brake safe deceleration");
    else sprintf(Window_Buffer,"M_NVEBCL\t(%d) Spare\tConfidence level for emergency brake safe deceleration",m_nvebcl);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\ton dry rails");
    packet_offset++;
    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    if (target_window_index>0) target_window_index++;
}

void D_q_nvkvintset(int q_nvkvintset,HWND TargetWindow) {
    if (q_nvkvintset==0) sprintf(Window_Buffer,"Q_NVKVINTSET\t(0) Freight Trains\tType of Kv_int set");
    else if (q_nvkvintset==1) sprintf(Window_Buffer,"Q_NVKVINTSET\t(1) Conventional Passenger trains\tType of Kv_int set");
    else sprintf(Window_Buffer,"Q_NVKVINTSET\tUnknown (%d)\tType of Kv_int set",q_nvkvintset);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_a_g(char* tete, char* queue,int a,HWND TargetWindow) {
    sprintf(Window_Buffer,"%s\t%.2f m/s²\t%s",tete,a*0.05,queue);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nvkvint(int m_nvkvint,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_NVKVINT\t%.2f\tIntegrated correction factor Kv",m_nvkvint*0.02);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_l_nvkrint(int l_nvkrint,HWND TargetWindow) {
    if (l_nvkrint<=4) sprintf(Window_Buffer,"L_NVKRINT\t%d m\tTrain length step used to define the integrated correction",l_nvkrint*25);
    else if (l_nvkrint<=6) sprintf(Window_Buffer,"L_NVKRINT\t%d m\tTrain length step used to define the integrated correction",(l_nvkrint-4)*50+100);
    else sprintf(Window_Buffer,"L_NVKRINT\t%d m\tTrain length step used to define the integrated correction",(l_nvkrint-6)*100+200);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index<0) {
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kr");
        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
    }
    if (target_window_index>0) target_window_index++;
}

void D_m_nvkrint(int m_nvkrint,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_NVKRINT\t%.2f\tIntegrated correction factor Kr",m_nvkrint*0.05);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nvktint(int m_nvktint,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_NVKTINT\t%.2f\tIntegrated correction factor Kt",m_nvktint*0.05);
    Iterations();
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_sdmtype(int m_sdmtype,HWND TargetWindow) {
    if (m_sdmtype==0) sprintf(Window_Buffer,"M_SDMTYPE\t(0) Ceiling speed monitoring (CSM)\tSpeed and distance monitoring type");
    if (m_sdmtype==1) sprintf(Window_Buffer,"M_SDMTYPE\t(1) Pre indication monitoring (PIM)\tSpeed and distance monitoring type");
    if (m_sdmtype==2) sprintf(Window_Buffer,"M_SDMTYPE\t(2) Target speed monitoring (TSM)\tSpeed and distance monitoring type");
    if (m_sdmtype==3) sprintf(Window_Buffer,"M_SDMTYPE\t(3) Release speed monitoring (RSM)\tSpeed and distance monitoring type");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_sdmsupstat(int m_sdmsupstat,HWND TargetWindow) {
    sprintf(Window_Buffer,"M_SDMSUPSTAT\tSpare\tSpeed and distance monitoring supervision status.");
    if (m_sdmsupstat==0) sprintf(Window_Buffer,"M_SDMSUPSTAT\t(0) Normal Status\tSpeed and distance monitoring supervision status.");
    if (m_sdmsupstat==1) sprintf(Window_Buffer,"M_SDMSUPSTAT\t(1) Indication Status\tSpeed and distance monitoring supervision status.");
    if (m_sdmsupstat==2) sprintf(Window_Buffer,"M_SDMSUPSTAT\t(2) Overspeed Status\tSpeed and distance monitoring supervision status.");
    if (m_sdmsupstat==3) sprintf(Window_Buffer,"M_SDMSUPSTAT\t(3) Warning Status\tSpeed and distance monitoring supervision status.");
    if (m_sdmsupstat==4) sprintf(Window_Buffer,"M_SDMSUPSTAT\t(4) Intervention Status\tSpeed and distance monitoring supervision status.");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_direction_controller(int m_direction_controller,HWND TargetWindow) {
    if (m_direction_controller==0) sprintf(Window_Buffer,"M_DIRECTION_CONTROLLER\t(0) Neutral\tDirection controller state");
    if (m_direction_controller==1) sprintf(Window_Buffer,"M_DIRECTION_CONTROLLER\t(1) Backward\tDirection controller state");
    if (m_direction_controller==2) sprintf(Window_Buffer,"M_DIRECTION_CONTROLLER\t(2) Forward\tDirection controller state");
    if (m_direction_controller==3) sprintf(Window_Buffer,"M_DIRECTION_CONTROLLER\t(3) Spare\tDirection controller state");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_dmi_symb_status(int dmi_symb_status_1,int dmi_symb_status_2,int dmi_symb_status_3,int dmi_symb_status_4,int dmi_symb_status_5,int dmi_symb_status_6,HWND TargetWindow) {

    int i,j=0,bmp_height=21,dmi_symb_status;
    char title[3];
    char description[100];
    sprintf(title,"LE");
    for (i=1;i<=87;i++) {

        if (i==1) dmi_symb_status = dmi_symb_status_6;
        else if (i==8) dmi_symb_status = dmi_symb_status_5;
        else if (i==24) dmi_symb_status = dmi_symb_status_4;
        else if (i==40) dmi_symb_status = dmi_symb_status_3;
        else if (i==56) dmi_symb_status = dmi_symb_status_2;
        else if (i==72) dmi_symb_status = dmi_symb_status_1;

        if (i==16) bmp_height=32;
        if (i==25) bmp_height=46;
        if (i==26) bmp_height=32;
        if (i==38) bmp_height=21;
        if (i==42) bmp_height=20;
        if (i==43) bmp_height=32;
        if (i==82) bmp_height=46;
        if (i==83) bmp_height=32;
        if (i==87) bmp_height=50;
        if (i==1) sprintf(description,"Level 0");
        if (i==2) sprintf(description,"Level STM");
        if (i==3) sprintf(description,"Level 1 Intermittent transmission");
        if (i==4) sprintf(description,"Level 2 Continuous transmission");
        if (i==5) sprintf(description,"Level 3 Continuous transmission");
        if (i==6) sprintf(description,"Level 0 announcement (grey)");
        if (i==7) sprintf(description,"Level 0 announcement (yellow)");
        if (i==8) sprintf(description,"Level STM announcement (grey)");
        if (i==9) sprintf(description,"Level STM announcement (yellow)");
        if (i==10) sprintf(description,"Level 1 announcement Intermittent transmission (grey)");
        if (i==11) sprintf(description,"Level 1 announcement Intermittent transmission (yellow)");
        if (i==12) sprintf(description,"Level 2 announcement Continuous transmission (grey)");
        if (i==13) sprintf(description,"Level 2 announcement Continuous transmission (yellow)");
        if (i==14) sprintf(description,"Level 3 announcement Continuous transmission (grey)");
        if (i==15) sprintf(description,"Level 3 announcement Continuous transmission (yellow)");
        if (i==16) sprintf(description,"Shunting");
        if (i==17) sprintf(description,"Acknowledgement for Shunting");
        if (i==18) sprintf(description,"Override EOA is active");
        if (i==19) sprintf(description,"Trip");
        if (i==20) sprintf(description,"Acknowledgement for Trip");
        if (i==21) sprintf(description,"Post trip");
        if (i==22) sprintf(description,"On Sight");
        if (i==23) sprintf(description,"Acknowledgement for On Sight");
        if (i==24) sprintf(description,"Staff Responsible");
        if (i==25) sprintf(description,"Acknowledgement for Staff Responsible");
        if (i==26) sprintf(description,"Full Supervision");
        if (i==27) sprintf(description,"Non-leading");
        if (i==28) sprintf(description,"Stand By");
        if (i==29) sprintf(description,"Reversing");
        if (i==30) sprintf(description,"Acknowledgement for Reversing");
        if (i==31) sprintf(description,"Unfitted");
        if (i==32) sprintf(description,"Acknowledgement for Unfitted");
        if (i==33) sprintf(description,"System failure");
        if (i==34) sprintf(description,"National System");
        if (i==35) sprintf(description,"Acknowledgement for National System");
        if (i==36) sprintf(description,"Limited Supervision");
        if (i==37) sprintf(description,"Acknowledgement for Limited Supervision");
        if (i==38) sprintf(description,"SB or EB intervention");
        if (i==39) sprintf(description,"Adhesion factor ""slippery rail""");
        if (i==40) sprintf(description,"Safe radio connection ""Connection Up""");
        if (i==41) sprintf(description,"Safe radio connection ""Connection Lost/Set Up Failed""");
        if (i==42) sprintf(description,"Hour glass");
        if (i==43) sprintf(description,"Reversing permitted");
        if (i==44) sprintf(description,"Pantograph lowered");
        if (i==45) sprintf(description,"Lower pantograph (grey)");
        if (i==46) sprintf(description,"Lower pantograph (yellow)");
        if (i==47) sprintf(description,"Raise pantograph (grey)");
        if (i==48) sprintf(description,"Raise pantograph (yellow)");
        if (i==49) sprintf(description,"Neutral section (grey)");
        if (i==50) sprintf(description,"Neutral section (yellow)");
        if (i==51) sprintf(description,"End of neutral section (grey)");
        if (i==52) sprintf(description,"End of neutral section (yellow)");
        if (i==53) sprintf(description,"Non stopping area");
        if (i==54) sprintf(description,"Non stopping area announcement");
        if (i==55) sprintf(description,"Radio hole");
        if (i==56) sprintf(description,"Inhibition of magnetic brake");
        if (i==57) sprintf(description,"Inhibition of magnetic brake announcement");
        if (i==58) sprintf(description,"Inhibition of eddy current brake");
        if (i==59) sprintf(description,"Inhibition of eddy current brake announcement");
        if (i==60) sprintf(description,"Inhibition of regenerative brake");
        if (i==61) sprintf(description,"Inhibition of regenerative brake announcement");
        if (i==62) sprintf(description,"Air conditioning intake closed");
        if (i==63) sprintf(description,"Open air conditioning intake (grey)");
        if (i==64) sprintf(description,"Close air conditioning intake announcement");
        if (i==65) sprintf(description,"Open air conditioning intake (yellow)");
        if (i==66) sprintf(description,"New Traction system");
        if (i==67) sprintf(description,"Change of Traction announcement");
        if (i==68) sprintf(description,"New Traction system (AC 25 kV 50 Hz)");
        if (i==69) sprintf(description,"Change of Traction system announcement (AC 25 kV 50 Hz)");
        if (i==70) sprintf(description,"New Traction system (AC 15 kV 16.7 Hz)");
        if (i==71) sprintf(description,"Change of Traction system announcement (AC 15 kV 16.7 Hz)");
        if (i==72) sprintf(description,"New Traction system (DC 3 kV)");
        if (i==73) sprintf(description,"Change of Traction system announcement (DC 3 kV)");
        if (i==74) sprintf(description,"New Traction system (DC 1.5 kV)");
        if (i==75) sprintf(description,"Change of Traction system announcement (DC 1.5 kV)");
        if (i==76) sprintf(description,"New Traction system (DC 600/750 V)");
        if (i==77) sprintf(description,"Change of Traction system announcement (DC 600/750 V)");
        if (i==78) sprintf(description,"Sound horn");
        if (i==79) sprintf(description,"Tunnel stopping area");
        if (i==80) sprintf(description,"Tunnel stopping area announcement");
        if (i==81) sprintf(description,"Toggling function for speed/distance information");
        if (i==82) sprintf(description,"Track Ahead Free");
        if (i==83) sprintf(description,"Geographical Position");
        if (i==84) sprintf(description,"Acknowledgement");
        if (i==85) sprintf(description,"Toggling function for tunnel stopping area");
        if (i==86) sprintf(description,"LX not protected");
        if (i==87) sprintf(description,"Limited Supervision frame");
        j++;
        if (i==16) {sprintf(title,"MO"); j=i-15;}
        if (i==38) {sprintf(title,"ST"); j=i-37;}
        if (i==44) {sprintf(title,"TC"); j=i-43;}
        if (i==81) {sprintf(title,"DR"); j=i-80;}
        if (i==86) {sprintf(title,"LX"); j=i-85;}
        if (i==87) {sprintf(title,"LS"); j=i-86;}
        if (dmi_symb_status&1) {
            if (TargetWindow==DetailsWindow) sprintf(Window_Buffer,"DMI_SYMB_STATUS\t\t%s%02d : %s",title,j,description);
            else sprintf(Window_Buffer,"DMI_SYMB_STATUS\t%s%02d\t%s%02d : %s",title,j,title,j,description);
            int index = SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (TargetWindow==DetailsWindow) SendMessage(TargetWindow,LB_SETITEMHEIGHT,index,bmp_height+4);
            if (target_window_index>0) target_window_index++;
        }
        dmi_symb_status>>=1;
    }
    packet_offset++;
}

void D_dmi_sound_status(int dmi_sound_status,HWND TargetWindow) {
    if (dmi_sound_status==0) {
        sprintf(Window_Buffer,"DMI_SOUND_STATUS\t(0) No sound\tStatus of the audible information played to the driver");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
        packet_offset++;
        return;
    }
    if (dmi_sound_status&1) {
        sprintf(Window_Buffer,"DMI_SOUND_STATUS\t(%d) Sound info : Information on DMI\tStatus of the audible information played to the driver",dmi_sound_status);
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    dmi_sound_status>>=1;
    if (dmi_sound_status&1) {
        sprintf(Window_Buffer,"DMI_SOUND_STATUS\t(%d) Sound S1 : Over-Speed\tStatus of the audible information played to the driver",dmi_sound_status);
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    dmi_sound_status>>=1;
    if (dmi_sound_status&1) {
        sprintf(Window_Buffer,"DMI_SOUND_STATUS\t(%d) Sound S2 : Warning\tStatus of the audible information played to the driver",dmi_sound_status);
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    packet_offset++;
}

void D_system_status_message(int system_status_message,HWND TargetWindow) {
    int i;
    for (i=1;i<=23;i++) {
        if (system_status_message&1) {
            if (i==1) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Balise read error\tSystem status message displayed to the driver",system_status_message);
            if (i==2) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Trackside malfunction\tSystem status message displayed to the driver",system_status_message);
            if (i==3) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Communication error\tSystem status message displayed to the driver",system_status_message);
            if (i==4) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Entering FS\tSystem status message displayed to the driver",system_status_message);
            if (i==5) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Entering OS\tSystem status message displayed to the driver",system_status_message);
            if (i==6) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Runaway movement\tSystem status message displayed to the driver",system_status_message);
            if (i==7) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) SH refused\tSystem status message displayed to the driver",system_status_message);
            if (i==8) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) SH request failed\tSystem status message displayed to the driver",system_status_message);
            if (i==9) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Trackside not compatible\tSystem status message displayed to the driver",system_status_message);
            if (i==10) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Train data changed\tSystem status message displayed to the driver",system_status_message);
            if (i==11) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Train is rejected\tSystem status message displayed to the driver",system_status_message);
            if (i==12) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Unauthorized passing of EOA/LOA\tSystem status message displayed to the driver",system_status_message);
            if (i==13) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) No MA received at level transition\tSystem status message displayed to the driver",system_status_message);
            if (i==14) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) SR distance exceeded\tSystem status message displayed to the driver",system_status_message);
            if (i==15) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) SH stop order\tSystem status message displayed to the driver",system_status_message);
            if (i==16) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) SR stop order\tSystem status message displayed to the driver",system_status_message);
            if (i==17) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Emergency stop\tSystem status message displayed to the driver",system_status_message);
            if (i==18) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) RV distance exceeded\tSystem status message displayed to the driver",system_status_message);
            if (i==19) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) No track description\tSystem status message displayed to the driver",system_status_message);
            if (i==20) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Route unsuitable - axle load category\tSystem status message displayed to the driver",system_status_message);
            if (i==21) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Route unsuitable - loading gauge\tSystem status message displayed to the driver",system_status_message);
            if (i==22) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Route unsuitable - traction system\tSystem status message displayed to the driver",system_status_message);
            if (i==23) sprintf(Window_Buffer,"SYSTEM_STATUS_MESSAGE\t(%d) Radio network registration failed\tSystem status message displayed to the driver",system_status_message);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            if (target_window_index>0) target_window_index++;
        }
        system_status_message>>=1;
    }
    packet_offset++;
}

void D_m_train_data_entry(int m_train_data_entry,HWND TargetWindow) {
    if (m_train_data_entry==0) sprintf(Window_Buffer,"M_TRAIN_DATA_ENTRY\t(0) Fixed\tType of train data entry");
    if (m_train_data_entry==1) sprintf(Window_Buffer,"M_TRAIN_DATA_ENTRY\t(1) Flexible\tType of train data entry");
    if (m_train_data_entry==2) sprintf(Window_Buffer,"M_TRAIN_DATA_ENTRY\t(2) Switchable\tType of train data entry");
    if (m_train_data_entry==3) sprintf(Window_Buffer,"M_TRAIN_DATA_ENTRY\t(3) Spare\tType of train data entry");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nc_cdtrain(int nc_cdtrain,HWND TargetWindow) {
    sprintf(Window_Buffer,"NC_CDTRAIN\t(%d) Spare\tCant Deficiency Train Category",nc_cdtrain);
    if (nc_cdtrain==0) sprintf(Window_Buffer,"NC_CDTRAIN\t(0) Cant Deficiency 80 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==1) sprintf(Window_Buffer,"NC_CDTRAIN\t(1) Cant Deficiency 100 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==2) sprintf(Window_Buffer,"NC_CDTRAIN\t(2) Cant Deficiency 130 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==3) sprintf(Window_Buffer,"NC_CDTRAIN\t(3) Cant Deficiency 150 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==4) sprintf(Window_Buffer,"NC_CDTRAIN\t(4) Cant Deficiency 165 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==5) sprintf(Window_Buffer,"NC_CDTRAIN\t(5) Cant Deficiency 180 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==6) sprintf(Window_Buffer,"NC_CDTRAIN\t(6) Cant Deficiency 210 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==7) sprintf(Window_Buffer,"NC_CDTRAIN\t(7) Cant Deficiency 225 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==8) sprintf(Window_Buffer,"NC_CDTRAIN\t(8) Cant Deficiency 245 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==9) sprintf(Window_Buffer,"NC_CDTRAIN\t(9) Cant Deficiency 275 mm\tCant Deficiency Train Category");
    if (nc_cdtrain==10) sprintf(Window_Buffer,"NC_CDTRAIN\t(10) Cant Deficiency 300 mm\tCant Deficiency Train Category");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_nc_train(int nc_train,HWND TargetWindow) {
    int count=0;
    int i;
    if (nc_train==0) {
        sprintf(Window_Buffer,"NC_TRAIN\t(0) Train does not belong to any category\tOther International Train Category");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        packet_offset++;
        if (target_window_index>0) target_window_index++;
    } else {
        for (i=1;i<=14;i++) {
            if (nc_train&1) {
                if (i==1) sprintf(Window_Buffer,"NC_TRAIN\t(%d) Freight train braked in P position\tOther International Train Category",nc_train);
                else if (i==2) sprintf(Window_Buffer,"NC_TRAIN\t(%d) Freight train braked in G position\tOther International Train Category",nc_train);
                else if (i==3) sprintf(Window_Buffer,"NC_TRAIN\t(%d) Passenger Train\tOther International Train Category",nc_train);
                else sprintf(Window_Buffer,"NC_TRAIN\t(%d) Spare\tOther International Train Category",nc_train);
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
                packet_offset++;
                if (target_window_index>0) target_window_index++;
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index && count>=1) ASV_increment++;
                count++;
            }
            nc_train>>=1;
        }
    }
}

void D_t_traction_cut_off(int t_traction_cut_off,HWND TargetWindow) {
    sprintf(Window_Buffer,"T_TRACTION_CUT_OFF\t%.2f s\tTime to cut-off traction",0.01*t_traction_cut_off);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_brake_position(int m_brake_position,HWND TargetWindow) {
    if (m_brake_position==0) sprintf(Window_Buffer,"M_BRAKE_POSITION\t(0) Passenger train in P\tBrake position");
    if (m_brake_position==1) sprintf(Window_Buffer,"M_BRAKE_POSITION\t(1) Freight train in P\tBrake position");
    if (m_brake_position==2) sprintf(Window_Buffer,"M_BRAKE_POSITION\t(2) Freight train in G\tBrake position");
    if (m_brake_position==3) sprintf(Window_Buffer,"M_BRAKE_POSITION\t(3) Spare\tBrake position");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_nom_rot_mass(int m_nom_rot_mass,HWND TargetWindow) {
    if (m_nom_rot_mass>=17) sprintf(Window_Buffer,"M_NON_ROT_MASS\t(%d) Spare\tNominal rotating mass of the train",m_nom_rot_mass);
    else sprintf(Window_Buffer,"M_NON_ROT_MASS\t%d %%\tNominal rotating mass of the train",m_nom_rot_mass);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_regenerativebrake(int m_regenerativebrake,HWND TargetWindow) {
    if (m_regenerativebrake==0) sprintf(Window_Buffer,"M_REGENERATIVEBRAKE\t(0) No interface \tRegenerative brake interface");
    if (m_regenerativebrake==1) sprintf(Window_Buffer,"M_REGENERATIVEBRAKE\t(1) Interface exists and affects only EB\tRegenerative brake interface");
    if (m_regenerativebrake==2) sprintf(Window_Buffer,"M_REGENERATIVEBRAKE\t(2) Interface exists and affects only SB\tRegenerative brake interface");
    if (m_regenerativebrake==3) sprintf(Window_Buffer,"M_REGENERATIVEBRAKE\t(3) Interface exists and affects EB and SB\tRegenerative brake interface");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_eddycurrentbrake(int m_eddycurrentbrake,HWND TargetWindow) {
    if (m_eddycurrentbrake==0) sprintf(Window_Buffer,"M_EDDYCURRENTBRAKE\t(0) No interface \tEddy Current brake interface");
    if (m_eddycurrentbrake==1) sprintf(Window_Buffer,"M_EDDYCURRENTBRAKE\t(1) Interface exists and affects only EB\tEddy Current brake interface");
    if (m_eddycurrentbrake==2) sprintf(Window_Buffer,"M_EDDYCURRENTBRAKE\t(2) Interface exists and affects only SB\tEddy Current brake interface");
    if (m_eddycurrentbrake==3) sprintf(Window_Buffer,"M_EDDYCURRENTBRAKE\t(3) Interface exists and affects EB and SB\tEddy Current brake interface");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_magneticshoebrake(int m_magneticshoebrake,HWND TargetWindow) {
    if (m_magneticshoebrake==0) sprintf(Window_Buffer,"M_MAGNETICSHOEBRAKE\t(0) No interface \tMagnetic Shoe brake interface");
    if (m_magneticshoebrake==1) sprintf(Window_Buffer,"M_MAGNETICSHOEBRAKE\t(1) Interface exists and affects only EB\tMagnetic Shoe brake interface");
    if (m_magneticshoebrake==2) sprintf(Window_Buffer,"M_MAGNETICSHOEBRAKE\t(2) Spare\tMagnetic Shoe brake interface");
    if (m_magneticshoebrake==3) sprintf(Window_Buffer,"M_MAGNETICSHOEBRAKE\t(3) Spare\tMagnetic Shoe brake interface");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_electropneumaticbrake(int m_electropneumaticbrake,HWND TargetWindow) {
    if (m_electropneumaticbrake==0) sprintf(Window_Buffer,"M_ELECTROPNEUMATICBRAKE\t(0) No interface \tElectro pneumatic brake interface");
    if (m_electropneumaticbrake==1) sprintf(Window_Buffer,"M_ELECTROPNEUMATICBRAKE\t(1) Interface exists and affects only SB\tElectro pneumatic brake interface");
    if (m_electropneumaticbrake==2) sprintf(Window_Buffer,"M_ELECTROPNEUMATICBRAKE\t(2) Interface exists and affects EB and SB\tElectro pneumatic brake interface");
    if (m_electropneumaticbrake==3) sprintf(Window_Buffer,"M_ELECTROPNEUMATICBRAKE\t(3) Spare\tElectro pneumatic brake interface");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_brake_percentage(int m_brake_percentage,HWND TargetWindow) {
    if (m_brake_percentage>=251) sprintf(Window_Buffer,"M_BRAKE_PERCENTAGE\t(%d) Spare\tBrake percentage value",m_brake_percentage);
    else sprintf(Window_Buffer,"M_BRAKE_PERCENTAGE\t%d %%\tBrake percentage value",m_brake_percentage);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_brake_lambda_conf(int m_brake_lambda_conf,HWND TargetWindow) {
    if (m_brake_lambda_conf==0) {
        sprintf(Window_Buffer,"M_BRAKE_LAMBDA_CONF\t(0) No interface to special brakes exists or all status are inactive\tSpecific special brakes configuration for lambda train");
        Iterations();
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
        packet_offset++;
        return;
    }
    if (m_brake_lambda_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_LAMBDA_CONF\t(%d) Regenerative brake interface exists and status is active\tSpecific special brakes configuration for lambda train",m_brake_lambda_conf);
        Iterations();
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    m_brake_lambda_conf>>=1;
    if (m_brake_lambda_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_LAMBDA_CONF\t(%d) Eddy current brake interface exists and status is active\tSpecific special brakes configuration for lambda train",m_brake_lambda_conf);
        Iterations();
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    m_brake_lambda_conf>>=1;
    if (m_brake_lambda_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_LAMBDA_CONF\t(%d) Ep brake interface exists and status is active\tSpecific special brakes configuration for lambda train",m_brake_lambda_conf);
        Iterations();
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    packet_offset++;
}

void D_m_brake_gamma_conf(int m_brake_gamma_conf,HWND TargetWindow) {
    if (m_brake_gamma_conf==0) {
        sprintf(Window_Buffer,"M_BRAKE_GAMMA_CONF\tNo interface to special brakes exists or all status are inactive\tSpecific special brakes configuration for gamma train");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
        packet_offset++;
        return;
    }
    if (m_brake_gamma_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_GAMMA_CONF\tRegenerative brake interface exists and status is active\tSpecific special brakes configuration for gamma train");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    m_brake_gamma_conf>>=1;
    if (m_brake_gamma_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_GAMMA_CONF\tEddy current brake interface exists and status is active\tSpecific special brakes configuration for gamma train");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    m_brake_gamma_conf>>=1;
    if (m_brake_gamma_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_GAMMA_CONF\tMagnetic shoe brake interface exists and status is active\tSpecific special brakes configuration for gamma train");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    m_brake_gamma_conf>>=1;
    if (m_brake_gamma_conf&1) {
        sprintf(Window_Buffer,"M_BRAKE_GAMMA_CONF\tEp brake interface exists and status is active\tSpecific special brakes configuration for gamma train");
        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
        if (target_window_index>0) target_window_index++;
    }
    Iterations();
    packet_offset++;
}

void D_t_brake_service(int t_brake_service,HWND TargetWindow) {
    sprintf(Window_Buffer,"T_BRAKE_SERVICE\t%.2f s\tService brake delay time",0.05*t_brake_service);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_t_brake_emergency(int t_brake_emergency,HWND TargetWindow) {
    sprintf(Window_Buffer,"T_BRAKE_EMERGENCY\t%.2f\tEmergency brake delay time",0.05*t_brake_emergency);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_n_brake_sections(int n_brake_sections,HWND TargetWindow) {
    if (n_brake_sections==0) sprintf(Window_Buffer,"N_BRAKE_SECTIONS\t(0) Spare\tNumber of braking curve sections");
    else sprintf(Window_Buffer,"N_BRAKE_SECTIONS\t%d\tNumber of braking curve sections",n_brake_sections);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_a_brake_emergency_comp(int a_brake_emergency_comp,HWND TargetWindow) {
    sprintf(Window_Buffer,"A_BRAKE_EMERGENCY_COMP\t%.2f m/s²\tEmergency brake deceleration component",0.01*a_brake_emergency_comp);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_a_brake_service_comp(int a_brake_service_comp,HWND TargetWindow) {
    sprintf(Window_Buffer,"A_BRAKE_SERVICE_COMP\t%.2f m/s²\tService brake deceleration component",0.01*a_brake_service_comp);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_kdry_rst(int m_kdry_rst, int index, HWND TargetWindow) {
    sprintf(Window_Buffer,"M_KDRY_RST(%d)\t%.2f\tRolling stock correction factor on dry rails",index,0.05*m_kdry_rst);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_kwet_rst(int m_kwet_rst, HWND TargetWindow) {
    sprintf(Window_Buffer,"M_KWET_RST\t%.2f\tRolling stock correction factor on wet rails",0.05*m_kwet_rst);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    Iterations();
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_n_axle(int n_axle, HWND TargetWindow) {
    sprintf(Window_Buffer,"N_AXLE\t%d axles\tAxle number of the engine",n_axle);
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_axleloadcat(int m_axleloadcat, HWND TargetWindow) {
    sprintf(Window_Buffer,"M_AXLELOADCAT\t(%d) Spare\tAxle load category",m_axleloadcat);
    if (m_axleloadcat==0) sprintf(Window_Buffer,"M_AXLELOADCAT\t(0) A\tAxle load category");
    if (m_axleloadcat==1) sprintf(Window_Buffer,"M_AXLELOADCAT\t(1) HS17\tAxle load category");
    if (m_axleloadcat==2) sprintf(Window_Buffer,"M_AXLELOADCAT\t(2) B1\tAxle load category");
    if (m_axleloadcat==3) sprintf(Window_Buffer,"M_AXLELOADCAT\t(3) B2\tAxle load category");
    if (m_axleloadcat==4) sprintf(Window_Buffer,"M_AXLELOADCAT\t(4) C2\tAxle load category");
    if (m_axleloadcat==5) sprintf(Window_Buffer,"M_AXLELOADCAT\t(5) C3\tAxle load category");
    if (m_axleloadcat==6) sprintf(Window_Buffer,"M_AXLELOADCAT\t(6) C4\tAxle load category");
    if (m_axleloadcat==7) sprintf(Window_Buffer,"M_AXLELOADCAT\t(7) D2\tAxle load category");
    if (m_axleloadcat==8) sprintf(Window_Buffer,"M_AXLELOADCAT\t(8) D3\tAxle load category");
    if (m_axleloadcat==9) sprintf(Window_Buffer,"M_AXLELOADCAT\t(9) D4\tAxle load category");
    if (m_axleloadcat==10) sprintf(Window_Buffer,"M_AXLELOADCAT\t(10) D4XL\tAxle load category");
    if (m_axleloadcat==11) sprintf(Window_Buffer,"M_AXLELOADCAT\t(11) E4\tAxle load category");
    if (m_axleloadcat==12) sprintf(Window_Buffer,"M_AXLELOADCAT\t(12) E5\tAxle load category");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_discsender(int m_discsender,HWND TargetWindow) {
    if (m_discsender==0) sprintf(Window_Buffer,"M_DISCSENDER\t(0) Disconnect request sent from STM\tSender of disconnect request");
    if (m_discsender==1) sprintf(Window_Buffer,"M_DISCSENDER\t(1) Disconnect request sent from STM Control Function\tSender of disconnect request");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_m_disctype(int m_disctype,HWND TargetWindow) {
    if (m_disctype==0) sprintf(Window_Buffer,"M_DISCTYPE\t(0) Final disconnection\tType of disconnection");
    if (m_disctype==1) sprintf(Window_Buffer,"M_DISCTYPE\t(1) Non final disconnection\tType of disconnection");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void D_stm_system_status_message(int stm_system_status_message,HWND TargetWindow) {
    int i;
    for (i=1;i<=4;i++) {
        if (stm_system_status_message&1) {
            if (i==1) sprintf(Window_Buffer,"STM_SYSTEM_STATUS_MESSAGE\t(%d) NTC brake demand\tSystem status message displayed to the driver",stm_system_status_message);
            if (i==2) sprintf(Window_Buffer,"STM_SYSTEM_STATUS_MESSAGE\t(%d) NTC needs data\tSystem status message displayed to the driver",stm_system_status_message);
            if (i==3) sprintf(Window_Buffer,"STM_SYSTEM_STATUS_MESSAGE\t(%d) NTC failed\tSystem status message displayed to the driver",stm_system_status_message);
            if (i==4) sprintf(Window_Buffer,"STM_SYSTEM_STATUS_MESSAGE\t(%d) NTC is not available\tSystem status message displayed to the driver",stm_system_status_message);
            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            packet_offset++;
            if (target_window_index>0) target_window_index++;
        }
        stm_system_status_message>>=1;
    }
}

void D_nid_stmevent(int nid_stmevent,HWND TargetWindow) {
    sprintf(Window_Buffer,"NID_STMEVENT\t(%d) Unknown\tSTM Event type",nid_stmevent);
    if (nid_stmevent==0) sprintf(Window_Buffer,"NID_STMEVENT\t(0) Disconnection\tSTM Event type");
    if (nid_stmevent==1) sprintf(Window_Buffer,"NID_STMEVENT\t(1) Display of system status message\tSTM Event type");
    if (nid_stmevent==2) sprintf(Window_Buffer,"NID_STMEVENT\t(2) Reception/sending of STM packet\tSTM Event type");
    if (nid_stmevent==3) sprintf(Window_Buffer,"NID_STMEVENT\t(3) Spare\tSTM Event type");
    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
    packet_offset++;
    if (target_window_index>0) target_window_index++;
}

void compile_file_read() {

    if (isVelaro) {
        SELECTED_TRAIN = EUROSTAR; SELECTED_TRAIN_R = EUROSTAR_R;
    } else {
        SELECTED_TRAIN = THALYS; SELECTED_TRAIN_R = THALYS_R;
    }

    bool nid_engine_injected = false;
    last_nid_rbc_version = -1;
    SDTRACK_ZOOM = 100000;
    Inter_Balise_Distance_Count=0;
    unknown_vehicle=0;
    MSG Escape_Message;
    start_on_board_linking = false;
    last_valid_linking  = -2;
    last_valid_linking_distance = 0;
    line_info_number=0;
    int previous_train = -2;
    int i,j;
    first_confidence_balise_index = -1;
    if (isBinaryFile) path_length = strlen(Path_Buffer);
    SendMessage(ProgressBarWindow,PBM_SETBARCOLOR,0,Cyan);

    int reference_tts,delta_tts,v_train=0,longueur_texte;
    char* Id_Name_Buffer = malloc(35*sizeof(char)); if (Id_Name_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"Id_Name_Buffer","",-1); return;}
    char* List_Buffer = malloc(Message_Buffer_Size*sizeof(char)); if (List_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"List_Buffer","",-1); return;}
    char* Q_DIR_Buffer = malloc(10*sizeof(char)); if (Q_DIR_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"Q_DIR_Buffer","",-1); return;}
    char* Q_DLRBG_Buffer = malloc(10*sizeof(char)); if (Q_DLRBG_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"Q_DLRBG_Buffer","",-1); return;}
    char* Driver_Id_Buffer = malloc(20*sizeof(char)); if (Driver_Id_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"Driver_Id_Buffer","",-1); return;}
    char* M_LEVEL_Buffer = malloc(10*sizeof(char)); if (M_LEVEL_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"M_LEVEL_Buffer","",-1); return;}
    char* M_MODE_Buffer = malloc(18*sizeof(char)); if (M_MODE_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"M_MODE_Buffer","",-1); return;}
    char* M_VERSION_Buffer = malloc(18*sizeof(char)); if (M_VERSION_Buffer==NULL) {file_log_count++; log_it(LOG_ERROR,"M_VERSION_Buffer","",-1); return;}
    double q_scale;
    unsigned long long delta_time = 0,time_increment = 0;
    int VTrack_nid_c=0,new_final_MA=-1,new_final_MA_distance,new_final_MA_speed;
    struct tm reference_timestamp = {0};
    struct tm current_timestamp = {0};
    reference_timestamp.tm_isdst=-1;
    current_timestamp.tm_isdst=-1;

    delta_distance=0;

    time_start.tm_mday=0;

    balise_direction=true;
    int length,balise=-1,next_balise=0,balise_pig,error_nid_c,error_nid_bg,error_nid_rbc;

    int memory_lines = 10000000;

    Details_Position = 0;
    Temporary_Details_Position = 0;
    balise_count=0;

    int system_version,message_version=-1;

    General_Position=0;

    while(SendMessage(MessageWindow,LB_INITSTORAGE,(WPARAM)memory_lines,(WPARAM)150*memory_lines)==LB_ERRSPACE) {
        memory_lines=(int)(memory_lines*0.99);
        if (memory_lines<10) break;
    }

    sprintf(Window_Buffer,"%I64u lines initialized",(unsigned long long)memory_lines);
    log_count++;
    log_it(LOG_INFO,"Memory initialized",Window_Buffer,-1);

    SendMessage(SequenceListWindow1,LB_INITSTORAGE,(WPARAM)memory_lines,(WPARAM)150*memory_lines);
    SendMessage(SequenceListWindow2,LB_INITSTORAGE,(WPARAM)memory_lines,(WPARAM)150*memory_lines);
    SendMessage(MessageWindow,WM_SETREDRAW,0,0);

    sprintf(Window_Buffer,"ISBL3 : %d | ISVELARO : %d\n",isBL3,isVelaro);
    log_it(LOG_INFO,"Parameters applied for decoding",Window_Buffer,-1);

    unsigned long long skip_count = 0;

    if (retry>0) {
        skip_count = ((100-retry) * (unsigned long long)(file_length))/((unsigned long long)MEAN_MESSAGE_LENGTH*100);
        skip_count=(skip_count*RETRY_MARGIN)/100;
        file_log_count++; truncated_data=true;
        sprintf(Window_Buffer,"Omitting %I64u messages",skip_count);
        log_it(LOG_ERROR,"Retrying",Window_Buffer,-1);
    }

    int l_message,tts,q_scale_read,q_dir,l_doubtover,l_doubtunder,id_driver,switcher,switcher_bis,iterations,iterations_bis,linked,last_valid_linking_details_position,linking_distance,balise_id,linking_iterations,unknown_length;
    float scale;

    while (General_Position<file_length) {

        if (message_index>Mean_Message_Number_Count-2) {
            sprintf(Window_Buffer,"%I64u/%I64u",(unsigned long long)message_index,(unsigned long long)Mean_Message_Number_Count);
            file_log_count++;
            if (retry==0) {
                truncated_data=true;
                log_it(LOG_ERROR,"Too many messages - Retrying",Window_Buffer,-1);
                retry = (unsigned long long)(100*General_Position/file_length);
            } else {
                valid_data=false;
                SendMessage(MessageSaturationBar,PBM_SETBARCOLOR,0,Orange);
                log_it(LOG_ERROR,"Too many messages - No retry",Window_Buffer,-1);
            }
            break;
        }
        if (Details_Position>Mean_Details_Number-100) {
            sprintf(Window_Buffer,"%I64u/%I64u",(unsigned long long)Details_Position,(unsigned long long)Mean_Details_Number);
            file_log_count++;
            if (retry==0) {
                truncated_data=true;
                log_it(LOG_ERROR,"Too many details - Retrying",Window_Buffer,-1);
                retry = (unsigned long long)(100*General_Position/file_length);
            } else {
                valid_data=false;
                SendMessage(DetailsSaturationBar,PBM_SETBARCOLOR,0,Orange);
                log_it(LOG_ERROR,"Too many details - No retry",Window_Buffer,-1);
            }
            break;
        }

        if (skip_count>0) {
            if (bindec(8)!=255) skip_count--; else {General_Position+=104; continue;}
            if (isBL3 || isVelaro) l_message = bindec(11); else l_message = bindec(10);
            if (isBinaryFile || isBL3) length = 8*l_message; else length = 112*((int)((l_message+1)/14)+1);
            if (isBL3 || isVelaro) General_Position+=(length-19); else General_Position+=(length-18);
            continue;
        }

        retroactive_d_lrbg=0;
        MA_bg=-1;
        treated=0;
        id = bndtls_r(8);

        if (id==255) {
            PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
            if (Escape_Message.wParam==27) {
                truncated_data = true;
                sprintf(Window_Buffer,"Interruption at %02I64d %% completion",(100*General_Position)/file_length);
                log_it(LOG_WARNING,"Decoding interrupted by user",Window_Buffer,-1);
                break;
            }
            empty_message_queue(Escape_Message);
            if (!isBL3) {
                General_Position+=104;
                Details_Position--;
                continue;
            }
            SendMessage(ProgressBarWindow,PBM_SETPOS,(int)(50*General_Position/file_length)+50,0);
            SendMessage(MessageSaturationBar,PBM_SETPOS,(100*(unsigned long long)message_index)/(unsigned long long)Mean_Message_Number_Count,0);
            SendMessage(DetailsSaturationBar,PBM_SETPOS,(100*(unsigned long long)Details_Position)/(unsigned long long)Mean_Details_Number,0);
        } else if (message_index%20000==0) {
            PeekMessage(&Escape_Message,NULL,256,256,PM_REMOVE);
            if (Escape_Message.wParam==27) {
                truncated_data = true;
                sprintf(Window_Buffer,"Interruption at %02I64d %% completion",(100*General_Position)/file_length);
                log_it(LOG_WARNING,"Decoding interrupted by user",Window_Buffer,-1);
                break;
            }
            empty_message_queue(Escape_Message);
            SendMessage(ProgressBarWindow,PBM_SETPOS,(int)(50*General_Position/file_length)+50,0);
            SendMessage(MessageSaturationBar,PBM_SETPOS,(100*(unsigned long long)message_index)/(unsigned long long)Mean_Message_Number_Count,0);
            SendMessage(DetailsSaturationBar,PBM_SETPOS,(100*(unsigned long long)Details_Position)/(unsigned long long)Mean_Details_Number,0);
        }

        if (isBL3 || isVelaro) l_message = bindec(11); else l_message = bindec(10);
        if (isBinaryFile || isBL3) length = 8*l_message; else length = 112*((int)((l_message+1)/14)+1);

        switch(id) {
            case 1:
                sprintf(Id_Name_Buffer,"GENERAL_MESSAGE");
            break;
            case 2:
                sprintf(Id_Name_Buffer,"DATA_ENTRY_COMPLETED");
            break;
            case 3:
                sprintf(Id_Name_Buffer,"EMERGENCY_BRAKE_STATE");
            break;
            case 4:
                sprintf(Id_Name_Buffer,"SB_COMMAND_STATE");
            break;
            case 5:
                if (!isBL3 || isVelaro) sprintf(Id_Name_Buffer,"EVENTS");
                else sprintf(Id_Name_Buffer,"MESSAGE_TO_RIU");
            break;
            case 6:
            break;
            case 7:
                sprintf(Id_Name_Buffer,"MESSAGE_FROM_LOOP");
            break;
            case 8:
                sprintf(Id_Name_Buffer,"MESSAGE_FROM_RIU");
            break;
            case 9:
                sprintf(Id_Name_Buffer,"MESSAGE_FROM_RBC");
            break;
            case 10:
                sprintf(Id_Name_Buffer,"MESSAGE_TO_RBC");
            break;
            case 11:
                sprintf(Id_Name_Buffer,"DRIVER_ACTIONS");
            break;
            case 12:
                sprintf(Id_Name_Buffer,"BALISE_GROUP_ERROR");
            break;
            case 13:
                sprintf(Id_Name_Buffer,"RADIO_ERROR");
            break;
            case 14:
                sprintf(Id_Name_Buffer,"STM_INFORMATION");
            break;
            case 15:
                if (!isBL3) sprintf(Id_Name_Buffer,"PLAIN TEXT MESSAGE");
                else sprintf(Id_Name_Buffer,"COLD_MOVEMENT_DETECTOR_INFO");
            break;
            case 16:
                sprintf(Id_Name_Buffer,"FIXED_TEXT_MESSAGE_START");
            break;
            case 17:
                sprintf(Id_Name_Buffer,"FIXED_TEXT_MESSAGE_STOP");
            break;
            case 18:
                sprintf(Id_Name_Buffer,"PLAIN_TEXT_MESSAGE_START");
            break;
            case 19:
                sprintf(Id_Name_Buffer,"PLAIN_TEXT_MESSAGE_STOP");
            break;
            case 20:
                sprintf(Id_Name_Buffer,"SPEED_DISTANCE_MONITORING");
            break;
            case 21:
                sprintf(Id_Name_Buffer,"DMI_SYMBOL_STATUS");
            break;
            case 22:
                sprintf(Id_Name_Buffer,"DMI_SOUND_STATUS");
            break;
            case 23:
                sprintf(Id_Name_Buffer,"DMI_SYSTEM_STATUS_MESSAGE");
            break;
            case 24:
                sprintf(Id_Name_Buffer,"ADDITIONAL_DATA");
            break;
            case 25:
                sprintf(Id_Name_Buffer,"DRIVER_SR_SPEED_DISTANCE");
            break;
            case 26:
                sprintf(Id_Name_Buffer,"STM_SELECTED");
            break;
            case 27:
                sprintf(Id_Name_Buffer,"SAFETY_CRITICAL_FAULT");
            break;
            case 28:
                sprintf(Id_Name_Buffer,"DRIVER_VBC_SET");
            break;
            case 29:
                sprintf(Id_Name_Buffer,"DRIVER_VBC_REMOVED");
            break;
            case 30:
                sprintf(Id_Name_Buffer,"SLEEPING_INPUT");
            break;
            case 31:
                sprintf(Id_Name_Buffer,"PASSIVE_SHUNTING_INPUT");
            break;
            case 32:
                sprintf(Id_Name_Buffer,"NON_LEADING_INPUT");
            break;
            case 33:
                sprintf(Id_Name_Buffer,"REGENERATIVE_BRAKE_STATUS");
            break;
            case 34:
                sprintf(Id_Name_Buffer,"MAGNETIC_SHOE_BRAKE_STATUS");
            break;
            case 35:
                sprintf(Id_Name_Buffer,"EDDY_CURRENT_BRAKE_STATUS");
            break;
            case 36:
                sprintf(Id_Name_Buffer,"EP_BRAKE_STATUS");
            break;
            case 38:
                sprintf(Id_Name_Buffer,"CAB_STATUS");
            break;
            case 39:
                sprintf(Id_Name_Buffer,"DIRECTION_CONTROLLER_POSITION");
            break;
            case 40:
                sprintf(Id_Name_Buffer,"TRACTION_STATUS");
            break;
            case 41:
                sprintf(Id_Name_Buffer,"TRAIN_DATA_TYPE");
            break;
            case 42:
                sprintf(Id_Name_Buffer,"NATIONAL_SYSTEM_ISOLATION");
            break;
            case 43:
                sprintf(Id_Name_Buffer,"TRACTION_CUT_OFF_COMMAND_STATE");
            break;
            case 44:
                sprintf(Id_Name_Buffer,"MA_LOWEST_SUPERVISED_SPEED");
            break;
            case 196:
                sprintf(Id_Name_Buffer,"Z_BGIS_POSITION");
            break;
            case 197:
                sprintf(Id_Name_Buffer,"Z_EXPL_POSITION");
            break;
            case 198:
                sprintf(Id_Name_Buffer,"INFO_VITESSES_DISTANCE");
            break;
            case 199:
                sprintf(Id_Name_Buffer,"CHANGEMENT_DE_MODE");
            break;
            case 200:
                sprintf(Id_Name_Buffer,"CHANGEMENT_DE_NIVEAU");
            break;
            case 255:
                sprintf(Id_Name_Buffer,"ETCS_PROPRIETARY_DATA");
            break;
            default:
                sprintf(Id_Name_Buffer,"[%d]",id);
                file_log_count++;
                log_it(LOG_ERROR,"UNKNOWN_MESSAGE",Id_Name_Buffer,message_index+1);
                Message_Details_Storage[Details_Position-1]=1000+id;
            break;
        }

        current_timestamp.tm_year = bndtls_r(7)+100;
        current_timestamp.tm_mon = bndtls_r(4)-1;
        current_timestamp.tm_mday = bndtls_r(5);
        current_timestamp.tm_hour = bindec(5);
        current_timestamp.tm_min = bindec(6);
        current_timestamp.tm_sec = bindec(6);
        tts = 50*bindec(5);
        if (time_start.tm_mday==0) {
            time_start=current_timestamp;
            initial_tts_1 = tts;
            initial_tts_2 = tts;
        }
        delta_tts=tts-reference_tts;

        time_increment = (unsigned long long)(1000*(unsigned long long)difftime(mktime(&current_timestamp),mktime(&reference_timestamp)))+(unsigned long long)(delta_tts);

        if (current_timestamp.tm_year != 172) {
            delta_time += time_increment;
            reference_timestamp = current_timestamp;
            reference_tts=tts;
        }
        if (message_index==-1) delta_time = 0;

        q_scale_read = bindec(2);
        if (q_scale_read==1) q_scale = 1.0;
        if (q_scale_read==0) q_scale = 0.1;
        if (q_scale_read==2) q_scale = 10.0;
        nid_c = bindec(10);
        next_nid_bg = bindec(14);
        next_d_lrbg = bindec(15)*q_scale;

        if (nid_c!=1023 && message_index!=-1 && next_nid_bg==nid_bg && next_d_lrbg>d_lrbg) delta_distance += (unsigned long long)((next_d_lrbg-d_lrbg)*3600); else delta_distance+=(time_increment*v_train);
        nid_bg = next_nid_bg;
        d_lrbg = next_d_lrbg;

        Message_Details_Storage[Details_Position]=d_lrbg;
        Details_Position++;

        if (message_index>=0) {
            if (current_timestamp.tm_year == 172) {
                Distance_Storage[message_index+1] = Distance_Storage[message_index];
                delta_distance = Distance_Storage[message_index+1];
                Time_Storage[message_index+1] = Time_Storage[message_index];
            } else {
                Distance_Storage[message_index+1] = delta_distance;
                Time_Storage[message_index+1] = delta_time;
            }
        }

        q_dir = bindec(2);
        switch(q_dir) {
            case 0:
                sprintf(Q_DIR_Buffer,"Reverse");
            break;
            case 1:
                sprintf(Q_DIR_Buffer,"Nominal");
            break;
            case 2:
                sprintf(Q_DIR_Buffer,"Both");
            break;
        }
        q_dlrbg = bindec(2);
        switch(q_dlrbg) {
            case 0:
                sprintf(Q_DLRBG_Buffer,"Reverse");
            break;
            case 1:
                sprintf(Q_DLRBG_Buffer,"Nominal");
            break;
            case 2:
                sprintf(Q_DLRBG_Buffer,"Both");
            break;
        }
        l_doubtover = q_scale*bindec(15);
        l_doubtunder = q_scale*bindec(15);

        if (isBL3 && !isVelaro)
            v_train = bindec(10);
        else
            v_train = 5*bindec(7);

        Message_Details_Storage[Details_Position]=v_train;
        Details_Position++;
        if (isBL3 && !isVelaro) {
            sprintf(Driver_Id_Buffer,"%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c%c",(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8),(char)bindec(8));
            if (Driver_Id_Buffer[0]==-1 && Driver_Id_Buffer[15]==-1) sprintf(Driver_Id_Buffer,"NC");
            if (Driver_Id_Buffer[0]=='\0') sprintf(Driver_Id_Buffer,"NC");
            if (strstr(Driver_Id_Buffer,"????????????????")!=NULL || strstr(Driver_Id_Buffer,"0000000000000000")!=NULL) sprintf(Driver_Id_Buffer,"NC");
            if (!nid_engine_injected) {
                D_nid_engine_for_unknown_vehicle(bindec(24),VehicleWindow);
                nid_engine_injected = true;
            } else bindec(24);
            system_version = bindec(7);
            sprintf(M_VERSION_Buffer,"Previous");
            if (system_version==16) sprintf(M_VERSION_Buffer,"1.0");
            if (system_version==17) sprintf(M_VERSION_Buffer,"1.1");
            if (system_version>=18 && system_version<=31) sprintf(M_VERSION_Buffer,"Invalid");
            if (system_version==32) sprintf(M_VERSION_Buffer,"2.0");
            if (system_version>32) sprintf(M_VERSION_Buffer,"Future");
            Message_Details_Storage[Details_Position]=-1;
        } else {
            if (isVelaro) id_driver = bindec(64); else id_driver = bindec(32);
            if (id_driver > 999999 && id_driver < 10000000) sprintf(Driver_Id_Buffer,"%dX",id_driver); else if (id_driver==-1) sprintf(Driver_Id_Buffer,"NC"); else sprintf(Driver_Id_Buffer,"%d",id_driver);
            if (id_driver==65535) sprintf(Driver_Id_Buffer,"NC");
            hexdec(28);
            General_Position+=4;
            treated+=4;
            Message_Details_Storage[Details_Position]=atoi(Hexdec_Buffer);
            if (Message_Details_Storage[Details_Position]!=previous_train && Message_Details_Storage[Details_Position]>6) {
                previous_train = Message_Details_Storage[Details_Position];
                sprintf(Error_Buffer,"%d\t%02d/%02d/%02d %02d:%02d",previous_train,current_timestamp.tm_mday,current_timestamp.tm_mon+1,current_timestamp.tm_year+1900,current_timestamp.tm_hour,current_timestamp.tm_min);
                SendMessage(TrainListWindow,LB_SETITEMDATA,SendMessage(TrainListWindow,LB_ADDSTRING,0,(LPARAM)Error_Buffer),message_index+1);
            }
        }

        Driver_Id_Buffer[10]='\0';

        Details_Position++;
        m_level = bndtls_r(3);
        switch(m_level) {
            case 0:
                sprintf(M_LEVEL_Buffer,"Level 0");
            break;
            case 1:
                if (stm_detail==-1) sprintf(M_LEVEL_Buffer,"Level STM");
                else {
                    if (stm_detail==0) sprintf(M_LEVEL_Buffer,"ASFA");
                    if (stm_detail==1) sprintf(M_LEVEL_Buffer,"ATB");
                    if (stm_detail==2) sprintf(M_LEVEL_Buffer,"LZB (C)");
                    if (stm_detail==3) sprintf(M_LEVEL_Buffer,"ASFA AVE");
                    if (stm_detail==5) sprintf(M_LEVEL_Buffer,"TBL 1");
                    if (stm_detail==6) sprintf(M_LEVEL_Buffer,"INDUSI");
                    if (stm_detail==7) sprintf(M_LEVEL_Buffer,"TBL 2/3");
                    if (stm_detail==8) sprintf(M_LEVEL_Buffer,"KVB");
                    if (stm_detail==9) sprintf(M_LEVEL_Buffer,"PZB/LZB");
                    if (stm_detail==10) sprintf(M_LEVEL_Buffer,"LZB");
                    if (stm_detail==11) sprintf(M_LEVEL_Buffer,"SCMT");
                    if (stm_detail==12) sprintf(M_LEVEL_Buffer,"MEMOR II+");
                    if (stm_detail==14) sprintf(M_LEVEL_Buffer,"TVM");
                    if (stm_detail==15) sprintf(M_LEVEL_Buffer,"BACC");
                    if (stm_detail==16) sprintf(M_LEVEL_Buffer,"RSDD");
                    if (stm_detail==17) sprintf(M_LEVEL_Buffer,"EVM");
                    if (stm_detail==18) sprintf(M_LEVEL_Buffer,"Crocodile");
                    if (stm_detail==19) sprintf(M_LEVEL_Buffer,"EBICAB 900 TBS");
                    if (stm_detail==20) sprintf(M_LEVEL_Buffer,"TPWS/AWS");
                    if (stm_detail==21) sprintf(M_LEVEL_Buffer,"TPWS/AWS (SA)");
                    if (stm_detail==22) sprintf(M_LEVEL_Buffer,"ATC2");
                    if (stm_detail==23) sprintf(M_LEVEL_Buffer,"EBICAB 900");
                    if (stm_detail==24) sprintf(M_LEVEL_Buffer,"EBICAB 900 (PL)");
                    if (stm_detail==25) sprintf(M_LEVEL_Buffer,"KNR ATS");
                    if (stm_detail==26) sprintf(M_LEVEL_Buffer,"SHP");
                    if (stm_detail==27) sprintf(M_LEVEL_Buffer,"INDUSI I 60");
                    if (stm_detail==28) sprintf(M_LEVEL_Buffer,"TBL 1+");
                    if (stm_detail==29) sprintf(M_LEVEL_Buffer,"NExTEO");
                    if (stm_detail==30) sprintf(M_LEVEL_Buffer,"ZUB 123");
                    if (stm_detail==31) sprintf(M_LEVEL_Buffer,"ZUB 121 / Signum");
                    if (stm_detail==32) sprintf(M_LEVEL_Buffer,"RPS");
                    if (stm_detail==33) sprintf(M_LEVEL_Buffer,"LS");
                    if (stm_detail==34) sprintf(M_LEVEL_Buffer,"EBICAB 700");
                    if (stm_detail==35) sprintf(M_LEVEL_Buffer,"SELCAB");
                    if (stm_detail==36) sprintf(M_LEVEL_Buffer,"INDUSI I 60");
                    if (stm_detail==37) sprintf(M_LEVEL_Buffer,"TBL");
                    if (stm_detail==39) sprintf(M_LEVEL_Buffer,"ALSN");
                    if (stm_detail==40) sprintf(M_LEVEL_Buffer,"EBICAB");
                    if (stm_detail==45) sprintf(M_LEVEL_Buffer,"CTCS-2");
                    if (stm_detail==46) sprintf(M_LEVEL_Buffer,"EBICAB 700");
                    if (stm_detail==255) sprintf(M_LEVEL_Buffer,"All)");
                    Message_Details_Storage[Details_Position-1]=-stm_detail-1000;
                }
            break;
            case 2:
                sprintf(M_LEVEL_Buffer,"Level 1");
            break;
            case 3:
                sprintf(M_LEVEL_Buffer,"Level 2");
            break;
            case 4:
                sprintf(M_LEVEL_Buffer,"Level 3");
            break;
            default:
                sprintf(M_LEVEL_Buffer,"NC");
            break;
        }
        m_mode = bndtls_r(4);
        switch(m_mode) {
            case 0:
                sprintf(M_MODE_Buffer,"Full Supervision");
            break;
            case 1:
                sprintf(M_MODE_Buffer,"On Sight");
            break;
            case 2:
                sprintf(M_MODE_Buffer,"Staff Responsible");
            break;
            case 3:
                sprintf(M_MODE_Buffer,"Shunting");
            break;
            case 4:
                sprintf(M_MODE_Buffer,"Unfitted");
            break;
            case 5:
                sprintf(M_MODE_Buffer,"Sleeping");
            break;
            case 6:
                if (!start_on_board_linking) {
                    start_on_board_linking = true;
                    first_confidence_balise_index = message_index+1;
                } else if (Linked_Balise_Count>0) {
                    for (i=0;i<Linked_Balise_Count;i++) {
                        Linked_Balise_Storage[i]=0;
                    }
                    Linked_Balise_Count=0;
                    Linked_Balise_Seen=0;
                }
                last_valid_linking=-1;
                balise = -1;
                sprintf(M_MODE_Buffer,"Stand By");
            break;
            case 7:
                sprintf(M_MODE_Buffer,"Trip");
            break;
            case 8:
                sprintf(M_MODE_Buffer,"Post Trip");
            break;
            case 9:
                sprintf(M_MODE_Buffer,"System Failure");
            break;
            case 10:
                sprintf(M_MODE_Buffer,"Isolation");
            break;
            case 11:
                sprintf(M_MODE_Buffer,"Non Leading");
            break;
            case 12:
                sprintf(M_MODE_Buffer,"Limited Supervision");
            break;
            case 13:
                sprintf(M_MODE_Buffer,"National System");
            break;
            case 14:
                sprintf(M_MODE_Buffer,"Reversing");
            break;
            case 15:
                sprintf(M_MODE_Buffer,"Passive Shunting");
            break;
        }

        Details_Position+=max_details_offset-max_generic_details_offset;

        Temporary_Details_Position=Details_Position;

        Message_Details_Storage[Temporary_Details_Position-version_detail_offset]=-1;

        switch(id) {
            case 2:
                if (isBL3 && !isVelaro) {
                    bndtls(7);bndtls(4);bndtls(15);bndtls(12);bndtls(12);bndtls(2);bndtls(5);bndtls(2);bndtls(2);bndtls(2);bndtls(2);bndtls(1);
                    bndtls(1);bndtls(1);
                    switcher=bndtls_r(1);
                    if (switcher==0) {
                        bndtls(8);
                        iterations = bndtls_r(4);
                        for (i=0;i<iterations;i++) {
                            bndtls(3);bndtls(12);
                        }
                    } else {
                        iterations = bndtls_r(4);
                        for (i=0;i<iterations;i++) {
                            bndtls(4);bndtls(12);
                            iterations_bis = bndtls_r(3);
                            for (j=0;j<iterations_bis;j++) {
                                bndtls(10);bndtls(8);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);bndtls(5);
                            }
                            bndtls(12);
                            iterations_bis = bndtls_r(3);
                            for (j=0;j<iterations_bis;j++) {
                                bndtls(10);bndtls(8);
                            }
                        }
                    }
                    bndtls(8);bndtls(10);bndtls(7);iterations = bndtls_r(5);
                    for (i=0;i<iterations;i++) {
                        bndtls(4);bndtls(10);
                    }
                    iterations = bndtls_r(5);
                    for (i=0;i<iterations;i++) {
                        bndtls(8);
                    }
                    bndtls(2);
                } else {
                    bndtls(7);bndtls(15);bndtls(12);
                    switcher = bndtls_r(3);
                    if (!isVelaro) switcher=7;
                    for (i=0;i<switcher;i++) {
                        bndtls(10);
                        if (isVelaro) bndtls(8); else bndtls(13);
                    }
                    switcher = bndtls_r(3);
                    if (!isVelaro) switcher=7;
                    for (i=0;i<switcher;i++) {
                        bndtls(10);
                        if (isVelaro) bndtls(8); else bndtls(13);
                    }
                    bndtls(12);bndtls(12);bndtls(12);

                    bndtls(8);bndtls(7);

                    if (isVelaro) {
                        iterations = bndtls_r(5);
                        for (i=0;i<iterations;i++) {
                            bndtls(8);
                        }
                    } else {
                        bndtls(8);bndtls(8);
                    }
                    bndtls(2);bndtls(1);
                    if (isVelaro) {bndtls(12);bndtls(12);bndtls(14);}
                    else {
                        bndtls(10);bndtls(14);
                    }
                    bndtls(16);bndtls(16);bndtls(16);bndtls(16);
                }
            break;
            case 3:
                if (bndtls_r(1) && v_train>0) {
                    sprintf(List_Buffer,"V = %d km/h train %s in %s and %s ",v_train,Hexdec_Buffer,M_MODE_Buffer,M_LEVEL_Buffer);
                    file_log_count++; log_it(LOG_ERROR,"In-Operation Emergency Brake",List_Buffer,message_index+1);
                }
            break;
            case 4:
                bndtls(1);
            break;
            case 5:
                if (!isBL3 || isVelaro) bndtls(8);
                else {
                    bndtls(10); bndtls(14);
                    Message_Details_Storage[Details_Position]=-bindec(8);
                    if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                    Details_Position++;
                    train_to_track_message(-Message_Details_Storage[Details_Position-1]);
                }
            break;
            case 6:
                linking_switcher=0;
                bndtls(1);message_version = bndtls_r(7);bndtls(1);balise_pig=bndtls_r(3);bndtls(3);bndtls(2);bndtls(8);VTrack_nid_c = bndtls_r(10);
                next_balise = bndtls_r(14); linked = bndtls_r(1);

                Message_Details_Storage[Temporary_Details_Position-version_detail_offset]=message_version;

                Linked_Balise_NidC = VTrack_nid_c;
                if (balise_count==0) {
                    Balise_Storage[0]=Temporary_Details_Position;
                    Balise_Details_Position_72[0]=-1;
                    Balise_Details_Position_79[0]=-1;
                    balise_count++;
                }
                else if (balise!=next_balise) {
                    Balise_Storage[balise_count]=Temporary_Details_Position;
                    Balise_Details_Position_72[balise_count]=-1;
                    Balise_Details_Position_79[balise_count]=-1;
                    balise_count++;
                }

                if (balise!=next_balise) {
                    if (balise_pig==0) balise_direction = true; else balise_direction = false;
                    balise_decision=BALISE_GRANTED_UNLINKED;
                }
                if (linked==1 && !start_on_board_linking) balise_decision = BALISE_DECISION_UNKNOWN;
                if (linked==1 && start_on_board_linking && balise!=next_balise) {
                    if (Linked_Balise_Storage[Linked_Balise_Seen]==100000*VTrack_nid_c+next_balise || Linked_Balise_Storage[Linked_Balise_Seen]==16383) {
                        Linked_Balise_Seen++;
                        balise_decision=BALISE_GRANTED_EXPECTED;
                    } else {
                        if (Linked_Balise_Seen<Linked_Balise_Count) balise_decision=BALISE_UNEXPECTED; else balise_decision=BALISE_GRANTED_VOID;
                    }
                }

                Message_Details_Storage[Details_Position]=balise_decision;
                Details_Position++;

                balise=next_balise;

                while((Message_Details_Storage[Details_Position]=-bindec(8))!=-255) {
                if (treated>=length) {
                    Message_Details_Storage[Details_Position]=-255;
                    Details_Position++;
                    break;
                }
                    if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                    if (Message_Details_Storage[Details_Position]==-5 && balise_direction && start_on_board_linking) {
                        linking_switcher+=5;
                    }
                    if (Message_Details_Storage[Details_Position]==-136 && balise_direction && start_on_board_linking) {
                        linking_switcher+=136;
                    }
                    Details_Position++;
                    track_to_train_paquet(-Message_Details_Storage[Details_Position-1],message_version);

                }
                Details_Position++;

                if (linking_switcher==141) new_linking_application_bg=ignore_linking;
                ignore_linking=-1;

                if ((linking_switcher==5 || new_linking_application_bg == 100000*VTrack_nid_c+next_balise) && New_Linked_Balise_Count>0 && start_on_board_linking && balise_decision!=BALISE_UNEXPECTED && balise_decision!=BALISE_DECISION_UNKNOWN) {
                    last_valid_linking = new_linking_reference;
                    merge_linking();
                    last_valid_linking_distance = (Distance_Storage[message_index+1]-Distance_Storage[new_linking_reference])/3600;
                    new_linking_application_bg=0;
                    Linked_Balise_Seen = 0;
                }
            break;
            case 7:
                bndtls(1);message_version = bndtls_r(7);bndtls(1);bndtls(10);bndtls(14);

                while((Message_Details_Storage[Details_Position]=-bindec(8))!=-255) {
                    if (treated>=length) {
                        Message_Details_Storage[Details_Position]=-255;
                        Details_Position++;
                        break;
                    }
                    if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                    if (Message_Details_Storage[Details_Position]==-5 && balise_direction && start_on_board_linking) {
                        linking_switcher+=5;
                    }
                    if (Message_Details_Storage[Details_Position]==-136 && balise_direction && start_on_board_linking) {
                        linking_switcher+=136;
                    }
                    Details_Position++;
                    track_to_train_paquet(-Message_Details_Storage[Details_Position-1],message_version);
                }
            break;
            case 8:
                if (isBL3 && !isVelaro) {bndtls(10); bndtls(14);}
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                track_to_train_message(-Message_Details_Storage[Details_Position-1]);
            break;
            case 9:
                if (isBL3 && !isVelaro) {bndtls(10); bndtls(14);}
                linking_switcher=0;
                retroactive_d_lrbg=0;
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                track_to_train_message(-Message_Details_Storage[Details_Position-1]);
                if (linking_switcher==5) {
                    last_valid_linking = new_linking_reference;
                    merge_linking();
                    last_valid_linking_distance = (Distance_Storage[message_index+1]-Distance_Storage[new_linking_reference])/3600;
                    last_valid_linking_distance-=(retroactive_d_lrbg);
                    if (Message_Details_Storage[Temporary_Details_Position]==-33) {
                        float q_scale = pow(10,Message_Details_Storage[Temporary_Details_Position+7]-1);
                        if (Message_Details_Storage[Temporary_Details_Position+8]<=32767) last_valid_linking_distance += (int)(q_scale*(Message_Details_Storage[Temporary_Details_Position+8]));
                        else if (Message_Details_Storage[Temporary_Details_Position+8]<=65535) last_valid_linking_distance += (int)(q_scale*(Message_Details_Storage[Temporary_Details_Position+8]-65536));
                    }
                    new_linking_application_bg=0;
                    Linked_Balise_Seen = new_linked_balise_seen;
                }
                Message_Details_Storage[Temporary_Details_Position-version_detail_offset]=last_nid_rbc_version;
            break;
            case 10:
                if (isBL3 && !isVelaro) {bndtls(10); bndtls(14);}
                Message_Details_Storage[Details_Position]=-bindec(8);
                if (Message_Details_Storage[Details_Position]==0) Message_Details_Storage[Details_Position]=-256;
                Details_Position++;
                train_to_track_message(-Message_Details_Storage[Details_Position-1]);
                Message_Details_Storage[Temporary_Details_Position-version_detail_offset]=last_nid_rbc_version;
            break;
            case 11:
                bndtls(8);
            break;
            case 12:
                error_nid_c = bndtls_r(10);
                error_nid_bg = bndtls_r(14);
                sprintf(List_Buffer,"BG %d-%d train %s in %s and %s",error_nid_c,error_nid_bg,Hexdec_Buffer,M_MODE_Buffer,M_LEVEL_Buffer);
                file_log_count++; log_it(LOG_WARNING,"BG Error",List_Buffer,message_index+1);
                bndtls(8);
            break;
            case 13:
                error_nid_c = bndtls_r(10);
                error_nid_rbc = bndtls_r(14);
                sprintf(List_Buffer,"RBC %d-%d train %s in %s and %s",error_nid_c,error_nid_rbc,Hexdec_Buffer,M_MODE_Buffer,M_LEVEL_Buffer);
                file_log_count++; log_it(LOG_WARNING,"RBC Error",List_Buffer,message_index+1);
                bndtls(8);
            break;
            case 14:
                bndtls(8);switcher = bndtls_r(2);
                if (switcher==0) {
                    bndtls(1);bndtls(1);
                } else if (switcher==1) bndtls(3);
                else if (switcher==2) {
                    bindec(8);bindec(13);
                }
            break;
            case 15:
                if (!isBL3) {
                    longueur_texte = bndtls_r(8);
                    for (i=0;i<longueur_texte;i++) {
                        bndtls(8);
                    }
                } else {
                    bndtls(2);
                }
            break;
            case 16:
            case 17:
                bndtls(8);
            break;
            case 18:
            case 19:
                longueur_texte = bndtls_r(8);
                for (i=0;i<longueur_texte;i++) {
                    bndtls(8);
                }
            break;
            case 20:
                bndtls(2);bndtls(3);bndtls(10);bndtls(10);bndtls(10);bndtls(15);bndtls(10);
            break;
            case 21:
                bndtls(16);
                bndtls(16);
                bndtls(16);
                bndtls(16);
                bndtls(16);
                bndtls(7);
            break;
            case 22:
                bndtls(3);
            break;
            case 23:
                bndtls(23);
            break;
            case 24:
                bndtls(1);bndtls(12);bndtls(12);switcher = bndtls_r(2);
                if (switcher==2) {
                    bndtls(10);bndtls(14);bndtls(16);bndtls(16);bndtls(16);bndtls(16);
                }
                bndtls(16);bndtls(16);
            break;
            case 25:
                bndtls(17);bndtls(10);
            break;
            case 26:
                bndtls(8);
            break;
            case 28:
                bndtls(6);bndtls(10);bndtls(8);
            break;
            case 29:
                bndtls(10);bndtls(6);
            break;
            case 30:
            case 31:
            case 32:
            case 33:
            case 34:
            case 35:
            case 36:
            case 37:
            case 40:
            case 43:
                bndtls(1);
            break;
            case 38:
                bndtls(1);switcher = bndtls_r(1);
                if (switcher==1) bndtls(1);
            break;
            case 39:
                bndtls(2);
            break;
            case 41:
                bndtls(2);
            break;
            case 42:
                bndtls(8);bndtls(1);
            break;
            case 44:
                bndtls(10);
            break;
            case 196:
                bndtls(16);
                bndtls(3);
            break;
            case 197:
                bndtls(3);
            break;
            case 198:
                bndtls(10);bndtls(15);bndtls(2);bndtls(10);bndtls(10);
            break;
            case 199:
                bndtls(4);bndtls(2);
            break;
            case 200:
                if (bndtls_r(3)==1) {
                    stm_detail = bndtls_r(8);
                    if (stm_detail==0) sprintf(M_LEVEL_Buffer,"ASFA");
                    if (stm_detail==1) sprintf(M_LEVEL_Buffer,"ATB");
                    if (stm_detail==2) sprintf(M_LEVEL_Buffer,"LZB (C)");
                    if (stm_detail==3) sprintf(M_LEVEL_Buffer,"ASFA AVE");
                    if (stm_detail==5) sprintf(M_LEVEL_Buffer,"TBL 1");
                    if (stm_detail==6) sprintf(M_LEVEL_Buffer,"INDUSI");
                    if (stm_detail==7) sprintf(M_LEVEL_Buffer,"TBL 2/3");
                    if (stm_detail==8) sprintf(M_LEVEL_Buffer,"KVB");
                    if (stm_detail==9) sprintf(M_LEVEL_Buffer,"PZB/LZB");
                    if (stm_detail==10) sprintf(M_LEVEL_Buffer,"LZB");
                    if (stm_detail==11) sprintf(M_LEVEL_Buffer,"SCMT");
                    if (stm_detail==12) sprintf(M_LEVEL_Buffer,"MEMOR II+");
                    if (stm_detail==14) sprintf(M_LEVEL_Buffer,"TVM");
                    if (stm_detail==15) sprintf(M_LEVEL_Buffer,"BACC");
                    if (stm_detail==16) sprintf(M_LEVEL_Buffer,"RSDD");
                    if (stm_detail==17) sprintf(M_LEVEL_Buffer,"EVM");
                    if (stm_detail==18) sprintf(M_LEVEL_Buffer,"Crocodile");
                    if (stm_detail==19) sprintf(M_LEVEL_Buffer,"EBICAB 900 TBS");
                    if (stm_detail==20) sprintf(M_LEVEL_Buffer,"TPWS/AWS");
                    if (stm_detail==21) sprintf(M_LEVEL_Buffer,"TPWS/AWS (SA)");
                    if (stm_detail==22) sprintf(M_LEVEL_Buffer,"ATC2");
                    if (stm_detail==23) sprintf(M_LEVEL_Buffer,"EBICAB 900");
                    if (stm_detail==24) sprintf(M_LEVEL_Buffer,"EBICAB 900 (PL)");
                    if (stm_detail==25) sprintf(M_LEVEL_Buffer,"KNR ATS");
                    if (stm_detail==26) sprintf(M_LEVEL_Buffer,"SHP");
                    if (stm_detail==27) sprintf(M_LEVEL_Buffer,"INDUSI I 60");
                    if (stm_detail==28) sprintf(M_LEVEL_Buffer,"TBL 1+");
                    if (stm_detail==29) sprintf(M_LEVEL_Buffer,"NExTEO");
                    if (stm_detail==30) sprintf(M_LEVEL_Buffer,"ZUB 123");
                    if (stm_detail==31) sprintf(M_LEVEL_Buffer,"ZUB 121 / Signum");
                    if (stm_detail==32) sprintf(M_LEVEL_Buffer,"RPS");
                    if (stm_detail==33) sprintf(M_LEVEL_Buffer,"LS");
                    if (stm_detail==34) sprintf(M_LEVEL_Buffer,"EBICAB 700");
                    if (stm_detail==35) sprintf(M_LEVEL_Buffer,"SELCAB");
                    if (stm_detail==36) sprintf(M_LEVEL_Buffer,"INDUSI I 60");
                    if (stm_detail==37) sprintf(M_LEVEL_Buffer,"TBL");
                    if (stm_detail==39) sprintf(M_LEVEL_Buffer,"ALSN");
                    if (stm_detail==40) sprintf(M_LEVEL_Buffer,"EBICAB");
                    if (stm_detail==45) sprintf(M_LEVEL_Buffer,"CTCS-2");
                    if (stm_detail==46) sprintf(M_LEVEL_Buffer,"EBICAB 700");
                    if (stm_detail==255) sprintf(M_LEVEL_Buffer,"All)");
                    Message_Details_Storage[Details_Position-16]=-1000-stm_detail;
                }
                else {
                    stm_detail = -1;
                    bndtls(8);
                }
                bndtls(2);
            break;
            case 255:
                switcher = bndtls_r(8);
                if (switcher==196) {
                    iterations = bndtls_r(5);
                    for (i=0;i<iterations;i++) {
                        switcher_bis = bndtls_r(3);
                        if (switcher_bis==1) bndtls(8);
                        bndtls(1);
                    }
                } else if (switcher==197) {
                    bndtls(3);
                } else if (switcher==198) {
                    bndtls(2);bndtls(3);bndtls(10);bndtls(10);bndtls(10);bndtls(15);bndtls(10);
                } else if (switcher==199) {
                    bndtls(4);bndtls(2);
                } else if (switcher==200) {
                    bndtls(3);bndtls(8);bndtls(2);
                } else if (switcher==201 || switcher==202) {
                    bndtls(8);
                } else if (switcher==203) {
                    bndtls(3);
                    for (i=1;i<=7;i++) {
                        bndtls(10);bndtls(8);
                    }
                    bndtls(3);
                    for (i=1;i<=7;i++) {
                        bndtls(10);bndtls(8);
                    }
                } else if (switcher==204) {
                    bndtls(10);
                    bndtls(14);
                    bndtls(8);
                    bndtls(1);
                }
                bndtls(length-treated);
            break;
            case 1:
            break;
            default:
                bndtls(length-treated);
            break;
        }

        Message_Details_Storage[Temporary_Details_Position-balise_storage_index]=balise_count-1;

        if (id==6) {
            if (balise_decision==BALISE_UNEXPECTED) sprintf(Id_Name_Buffer,"-MESSAGE_FROM_BALISE:%d(%d)",balise,balise_pig+1);
            else if (balise_decision==BALISE_DECISION_UNKNOWN) sprintf(Id_Name_Buffer,"|MESSAGE_FROM_BALISE:%d(%d)",balise,balise_pig+1);
            else sprintf(Id_Name_Buffer,"+MESSAGE_FROM_BALISE:%d(%d)",balise,balise_pig+1);
        }
        if (balise>=0) {
            Message_Details_Storage[Temporary_Details_Position-last_balise_offset]=balise;
            if (balise_direction) Message_Details_Storage[Temporary_Details_Position-last_balise_direction_offset]=1; else Message_Details_Storage[Temporary_Details_Position-last_balise_direction_offset]=-1;
        } else {
            if (balise_count>0) Message_Details_Storage[Temporary_Details_Position-last_balise_offset]=Message_Details_Storage[Balise_Storage[balise_count-1]+8];
            else Message_Details_Storage[Temporary_Details_Position-last_balise_offset]=-1;
            Message_Details_Storage[Temporary_Details_Position-last_balise_direction_offset]=1;
        }

        Message_Details_Storage[Temporary_Details_Position-last_nid_c_offset]=VTrack_nid_c;
        Message_Details_Storage[Temporary_Details_Position-last_valid_linking_offset]=last_valid_linking;
        if (last_valid_linking>=0) Message_Details_Storage[Temporary_Details_Position-last_valid_linking_offset]+=Linked_Balise_Seen*linking_data_delimiter;
        if (retroactive_d_lrbg>=0) Message_Details_Storage[Temporary_Details_Position-last_valid_linking_distance_offset]=last_valid_linking_distance;
        else Message_Details_Storage[Temporary_Details_Position-last_valid_linking_distance_offset]=-INTER_BALISE_DISTANCE_UNKNOWN;
        if (nid_c==255) {
            if (nid_bg==3) line_info_number = line_info_L1;
            if (nid_bg==5) line_info_number = line_info_B;
        }
        if (nid_c==128) {
            line_info_number = line_info_LGV_EST;
        }
        Message_Details_Storage[Temporary_Details_Position-line_information_offset]=line_info_number;
        if (MA_bg>=0) {
            if (last_valid_linking>=0) {
                last_valid_linking = (last_valid_linking%linking_data_delimiter);
                last_valid_linking_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,last_valid_linking,0);
                while (Message_Details_Storage[last_valid_linking_details_position]!=-5) last_valid_linking_details_position++;
                last_valid_linking_details_position++;
                scale = pow(10,Message_Details_Storage[last_valid_linking_details_position+2]-1);
                linking_distance = (int)(scale*Message_Details_Storage[last_valid_linking_details_position+3]);
                if (Message_Details_Storage[last_valid_linking_details_position+4]==1) {
                    last_valid_linking_details_position+=1;
                }
                balise_id = Message_Details_Storage[last_valid_linking_details_position+5];
                if (balise_id == MA_bg) {
                    MA_Distance+=linking_distance;
                } else {
                    linking_iterations = Message_Details_Storage[last_valid_linking_details_position+9];
                    for (i=0;i<linking_iterations;i++) {
                        linking_distance += (int)(scale*Message_Details_Storage[last_valid_linking_details_position+10+6*i]);
                        if (Message_Details_Storage[last_valid_linking_details_position+11+6*i]==1) {
                            last_valid_linking_details_position+=1;
                        }
                        balise_id = Message_Details_Storage[last_valid_linking_details_position+12+6*i];
                        if (balise_id == MA_bg) {
                            MA_Distance+=linking_distance; break;
                        }
                    }
                }
            }
            MA_Distance -= (Distance_Storage[message_index+1]-Distance_Storage[last_valid_linking])/3600;
        }

        if (balise_decision!=BALISE_UNEXPECTED && balise_decision!=BALISE_DECISION_UNKNOWN) {
            new_final_MA = last_MA;
            new_final_MA_distance = MA_Distance;
            new_final_MA_speed = MA_Speed;
        }
        Message_Details_Storage[Temporary_Details_Position-message_index_offset]=message_index+1;
        Message_Details_Storage[Temporary_Details_Position-MA_offset]=new_final_MA_speed*10000000+new_final_MA_distance;
        Message_Details_Storage[Temporary_Details_Position-MA_index_offset]=new_final_MA;
        Message_Details_Storage[Temporary_Details_Position-Inter_Balise_Offset]=3*Inter_Balise_Distance_Count;

        if (Hexdec_Buffer[1]=='F') Hexdec_Buffer[1]='\0';

        if (isBL3 && !isVelaro) sprintf(Hexdec_Buffer,"NC");

        if (nid_c==1023) sprintf(List_Buffer,"%s\t%02d/%02d/%02d  %02d:%02d:%02d:%03d    %.1f\tNC\tNC\tNC\tNC/NC\tNC/NC\t%03d km/h\t%s\t%s\t%s\t%s\t%c",Id_Name_Buffer,current_timestamp.tm_mday,current_timestamp.tm_mon+1,current_timestamp.tm_year-100,current_timestamp.tm_hour,current_timestamp.tm_min,current_timestamp.tm_sec,tts,q_scale,v_train,Driver_Id_Buffer,Hexdec_Buffer,M_LEVEL_Buffer,M_MODE_Buffer,7);
        else sprintf(List_Buffer,"%s\t%02d/%02d/%02d  %02d:%02d:%02d:%03d    %.1f\t%d\t%d\t%d m\t%s/%s\t%d/%d\t%03d km/h\t%s\t%s\t%s\t%s\t%c",Id_Name_Buffer,current_timestamp.tm_mday,current_timestamp.tm_mon+1,current_timestamp.tm_year-100,current_timestamp.tm_hour,current_timestamp.tm_min,current_timestamp.tm_sec,tts,q_scale,nid_c,nid_bg,d_lrbg,Q_DIR_Buffer,Q_DLRBG_Buffer,l_doubtunder,l_doubtover,v_train,Driver_Id_Buffer,Hexdec_Buffer,M_LEVEL_Buffer,M_MODE_Buffer,7);

        message_index = SendMessage(MessageWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)List_Buffer);

        if (message_index==LB_ERRSPACE) {
            file_log_count++;
            sprintf(Window_Buffer,"Only %02I64d %% of the file was decoded)",(100*General_Position)/file_length);
            if (retry==0) {
                retry = (unsigned long long)(100*General_Position/file_length); retry-=2;
                log_it(LOG_ERROR,"Main List Error : LB_ERRSPACE - Retrying",Window_Buffer,-1);
                truncated_data=true;
            } else {
                log_it(LOG_ERROR,"Main List Error : LB_ERRSPACE - No retry",Window_Buffer,-1);
                valid_data=false;
            }
            break;
        } else if (message_index==LB_ERR) {
            file_log_count++; valid_data=false;
            sprintf(Window_Buffer,"Only %02I64d %% of the file was decoded",(100*General_Position)/file_length);
            log_it(LOG_ERROR,"Main List Error : LB_ERR",Window_Buffer,-1);
            break;
        } else retry = 0;

        SendMessage(MessageWindow,LB_SETITEMDATA,message_index,Temporary_Details_Position);

        UpdateWindow(ProgressBarWindow);

        General_Position+=length-treated;
    }

    if (retry==0) SendMessage(MessageWindow,WM_SETREDRAW,1,0);

    Balise_Count = balise_count-1;

    End_Details_Position = Details_Position;

    free(Id_Name_Buffer);
    free(List_Buffer);
    free(Q_DIR_Buffer);
    free(Q_DLRBG_Buffer);
    free(Driver_Id_Buffer);
    free(M_LEVEL_Buffer);
    free(M_MODE_Buffer);
    free(M_VERSION_Buffer);

    General_Position=0;
    ShowWindow(ProgressBarWindow, 0);

    if (unknown_file && !isBL3) {
        if (unknown_vehicle>0) D_nid_engine_for_unknown_vehicle(unknown_vehicle,DetailsWindow);
        unknown_length = strlen(Window_Buffer);
        if (unknown_length==19) {
            if (Window_Buffer[18]=='9') sprintf(&Window_Buffer[19],"\n%c%c%c%c%d%02d%02d%02d_JRU",Window_Buffer[5],Window_Buffer[6],Window_Buffer[7],Window_Buffer[8],2,current_timestamp.tm_year-100,current_timestamp.tm_mon+1,current_timestamp.tm_mday);
            else sprintf(&Window_Buffer[19],"%c%c%c%c%d%02d%02d%02d_JRU",Window_Buffer[5],Window_Buffer[6],Window_Buffer[7],Window_Buffer[8],1,current_timestamp.tm_year-100,current_timestamp.tm_mon+1,current_timestamp.tm_mday);
        } else {
            sprintf(&Window_Buffer[18],"\n%c%c%c%c%c%02d%02d%02d_JRU",Window_Buffer[4],Window_Buffer[5],Window_Buffer[6],Window_Buffer[7],Window_Buffer[17],current_timestamp.tm_year-100,current_timestamp.tm_mon+1,current_timestamp.tm_mday);
        }
    }
    sprintf(current_file_buffer,"%s",Path_Buffer);
    if (!isBL3) {
        if (isBinaryFile) sprintf(&current_file_buffer[strlen(current_file_buffer)],"Lecture_24H.bin"); else current_file_buffer[strlen(current_file_buffer)-1]='\0';
    }
    isBinaryFile=false;

}

void D_train_to_track_message(int message_details_position, HWND TargetWindow) {
    D_l_message(Message_Details_Storage[message_details_position+1],TargetWindow);
    D_t_train(Message_Details_Storage[message_details_position+2],Message_Details_Storage[message_details_position+3],TargetWindow);
    D_nid_engine(Message_Details_Storage[message_details_position+4],TargetWindow);
    switch(-Message_Details_Storage[message_details_position]) {
        case 129:

        break;
        case 132:
            D_q_marqstreason(Message_Details_Storage[message_details_position+5],TargetWindow);
        break;
        case 136:

        break;
        case 137:
        case 138:
        case 146:
            D_t_train(Message_Details_Storage[message_details_position+5],Message_Details_Storage[message_details_position+6],TargetWindow);
        break;
        case 147:
            D_g(Message_Details_Storage[message_details_position+5],"NID_EM","Emergency message identity",TargetWindow);
            D_q_emergencystop(Message_Details_Storage[message_details_position+6],TargetWindow);
        break;
        case 153:
            D_nid_c(Message_Details_Storage[message_details_position+5],TargetWindow);
            D_nid_bg(Message_Details_Storage[message_details_position+6],TargetWindow);
            D_q_g(Message_Details_Storage[message_details_position+7],"Q_INFILL","Qualifier to indicate whether a train is entering or exiting the radio infill area","Exit","Enter",TargetWindow);
        break;
        case 155:

        break;
        case 157:
            D_q_status(Message_Details_Storage[message_details_position+5],TargetWindow);
        break;
        case 158:
            D_g(Message_Details_Storage[message_details_position+5],"NID_TEXTMESSAGE","Message identifier",TargetWindow);
        break;
        case 159:

        break;
        default:
            D_other_data(Message_Details_Storage[message_details_position+5],TargetWindow);
        break;
    }
}

void D_track_to_train_message(int message_details_position, HWND TargetWindow) {
    float q_scale;
    D_l_message(Message_Details_Storage[message_details_position+1],TargetWindow);
    D_t_train(Message_Details_Storage[message_details_position+2],Message_Details_Storage[message_details_position+3],TargetWindow);
    D_q_g(Message_Details_Storage[message_details_position+4],"M_ACK","Qualifier for acknowledgement request","Acknowledgement required","No acknowledgement required",TargetWindow);
    D_nid_c(Message_Details_Storage[message_details_position+5],TargetWindow);
    D_nid_bg(Message_Details_Storage[message_details_position+6],TargetWindow);
    switch(-Message_Details_Storage[message_details_position]) {
        case 2:
            q_scale = pow(10,Message_Details_Storage[message_details_position+7]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[message_details_position+8],"D_SR","Distance in SR mode","Infinite",TargetWindow);
        break;
        case 3:

        break;
        case 8:
            D_t_train(Message_Details_Storage[message_details_position+7],Message_Details_Storage[message_details_position+8],TargetWindow);
        break;
        case 15:
            D_g(Message_Details_Storage[message_details_position+7],"NID_EM","Emergency message identity",TargetWindow);
            q_scale = pow(10,Message_Details_Storage[message_details_position+8]-1);
            D_q_scale(q_scale,TargetWindow);
//            D_d_ref(q_scale,Message_Details_Storage[message_details_position+9],TargetWindow);
            D_q_dir(Message_Details_Storage[message_details_position+9],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[message_details_position+10],"D_EMERGENCYSTOP","Distance to emergency stop location","",TargetWindow);
        break;
        case 16:
        case 18:
            D_g(Message_Details_Storage[message_details_position+7],"NID_EM","Emergency message identity",TargetWindow);
        break;
        case 24:

        break;
        case 27:
        case 28:
            D_t_train(Message_Details_Storage[message_details_position+7],Message_Details_Storage[message_details_position+8],TargetWindow);
        break;
        case 32:
            D_m_version(Message_Details_Storage[message_details_position+7],TargetWindow);
        break;
        case 33:
            q_scale = pow(10,Message_Details_Storage[message_details_position+7]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_ref(q_scale,Message_Details_Storage[message_details_position+8],TargetWindow);
        break;
        case 34:
            q_scale = pow(10,Message_Details_Storage[message_details_position+7]-1);
            D_q_scale(q_scale,TargetWindow);
            D_q_dir(Message_Details_Storage[message_details_position+8],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[message_details_position+9],"D_TAFDISPLAY","Distance from where on a track ahead free request shall be displayed",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[message_details_position+10],"L_TAFDISPLAY","Length on which a track ahead free request shall be displayed",NULL,TargetWindow);
        break;
        case 45:
            D_q_g(Message_Details_Storage[message_details_position+7],"Q_ORIENTATION","Co-ordinate system assigned to a single balise group","The balise group has been passed by the train in nominal direction","The balise group has been passed by the train in reverse direction",TargetWindow);
        break;
        case 136:

        break;
        default:
            D_other_data(Message_Details_Storage[message_details_position+7],TargetWindow);
        break;
    }
}

void D_track_to_train_packet(int nid_packet, HWND TargetWindow, bool title,int m_version) {
float q_scale;
int i,j,iterations,iterations_bis,switcher,switcher_bis;
init_offset=packet_offset;

    if (TargetWindow==DetailsWindow) target_window_index=-1;

    if (title) Track_To_Train_Packet_Name(TargetWindow,nid_packet,-1);

    if (nid_packet<256) {
        D_q_dir(Message_Details_Storage[packet_offset],TargetWindow);
        D_l_packet(Message_Details_Storage[packet_offset],TargetWindow);
        if (Message_Details_Storage[packet_offset-1]==0) return;
    } else {
        D_nid_vbcmk(Message_Details_Storage[packet_offset],TargetWindow);
        return;
    }

    switch(nid_packet) {
        case 2:
            D_m_version(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 3:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_VALIDNV","Distance to start of validity of national values","Now",TargetWindow);
            if (m_version>=32) D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(Message_Details_Storage[packet_offset],TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
            D_v_g(Message_Details_Storage[packet_offset],"V_NVSHUNT","Shunting mode speed limit",5,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_NVSTFF","Staff responsible mode speed limit",5,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_NVONSIGHT","On sight mode speed limit",5,TargetWindow);
            if (m_version>=32) D_v_g(Message_Details_Storage[packet_offset],"V_NVLIMSUPERV","Limited Supervision mode speed limit",5,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_NVUNFIT","Unfitted mode speed limit",5,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_NVREL","Release speed",5,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_NVROLL","Roll away distance limit","Infinite",TargetWindow);
            D_q_nvsbtsmperm(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_nvemrrls(Message_Details_Storage[packet_offset],TargetWindow);
            if (m_version>=32) {
                D_q_g(Message_Details_Storage[packet_offset],"Q_NVGUIPERM","Permission to use the guidance curve","Yes","No",TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_NVSBFBPERM","Permission to use the service brake feedback","Yes","No",TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_NVINHSMICPERM","Permission to inhibit the compensation of the speed measurement inaccuracy","Yes","No",TargetWindow);
            }
            D_v_g(Message_Details_Storage[packet_offset],"V_NVALLOWOVTRP","Speed limit allowing the driver to select the \"Override\"",5,TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfunction");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            D_v_g(Message_Details_Storage[packet_offset],"V_NVSUPOVTRP","Override speed limit to be supervised when the \"override\"",5,TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfunction is active");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_NVOVTRP","Maximum value for overriding the train trip",NULL,TargetWindow);
            D_t_g(Message_Details_Storage[packet_offset],"T_NVOVTRP","Maximum time for overriding the train trip",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_NVPOTRP","Maximum distance for reversing in Post-Trip mode",NULL,TargetWindow);
            D_m_nvcontact(Message_Details_Storage[packet_offset],TargetWindow);
            D_t_nvcontact(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_nvderun(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_NVSTFF","Maximum distance for running in Staff Responsible mode","Infinite",TargetWindow);
            D_q_nvdriver_adhes(Message_Details_Storage[packet_offset],TargetWindow);
            if (m_version>=32) {
                D_a_nvmaxredadh(1,Message_Details_Storage[packet_offset],TargetWindow);
                D_a_nvmaxredadh(2,Message_Details_Storage[packet_offset],TargetWindow);
                D_a_nvmaxredadh(3,Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(1.0,Message_Details_Storage[packet_offset],"Q_NVLOCACC","Default accuracy of the balise location (absolute value)","63 m",TargetWindow);
                D_m_nvavadh(Message_Details_Storage[packet_offset],TargetWindow);
                D_m_nvebcl(Message_Details_Storage[packet_offset],TargetWindow);
                switcher = Message_Details_Storage[packet_offset];
                D_q_g(switcher,"Q_NVKINT","Qualifier for integrated correction factors","Integrated correction factors follow","No integrated correction factors follow",TargetWindow);
                if (switcher==1) {
                    switcher_bis = Message_Details_Storage[packet_offset];
                    D_q_nvkvintset(switcher_bis,TargetWindow);
                    if (switcher_bis==1) {
                        D_a_g("A_NVP12","Lower deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                        D_a_g("A_NVP23","Upper deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                    }
                    D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                    if (target_window_index<0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    }
                    D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    if (switcher_bis==1) {
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    iterations = Message_Details_Storage[packet_offset];
                    D_n_iter(iterations,TargetWindow);
                    for (i=0;i<iterations;i++) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                        n_iter_i=i+1;
                        D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        if (switcher_bis==1) {
                            D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        }
                    }
                    n_iter_i=0;
                    if (iterations>0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                    }
                    iterations = Message_Details_Storage[packet_offset];
                    D_n_iter(iterations,TargetWindow);
                    for (i=0;i<iterations;i++) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                        n_iter_i=i+1;
                        switcher_bis = Message_Details_Storage[packet_offset];
                        D_q_nvkvintset(switcher_bis,TargetWindow);
                        if (switcher_bis==1) {
                            D_a_g("A_NVP12","Lower deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                            if (target_window_index<0) {
                                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                            }
                            D_a_g("A_NVP23","Upper deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                            if (target_window_index<0) {
                                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                            }
                        }
                        D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        if (switcher_bis==1) {
                            D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        }
                        iterations_bis = Message_Details_Storage[packet_offset];
                        D_n_iter(iterations_bis,TargetWindow);
                        for (j=0;j<iterations_bis;j++) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                            if (target_window_index>0) target_window_index++;
                            n_iter_j=j+1;
                            D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                            if (target_window_index<0) {
                                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                            }
                            D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                            if (switcher_bis==1) {
                                D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                            }
                        }
                        n_iter_j=0;
                        if (iterations_bis>0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                            if (target_window_index>0) target_window_index++;
                        }
                    }
                    n_iter_i=0;
                    if (iterations>0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                    }
                    D_l_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                    D_m_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                    iterations = Message_Details_Storage[packet_offset];
                    D_n_iter(iterations,TargetWindow);
                    for (i=0;i<iterations;i++) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                        n_iter_i=i+1;
                        D_l_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                        D_m_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    n_iter_i=0;
                    if (iterations>0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                    }
                    D_m_nvktint(Message_Details_Storage[packet_offset],TargetWindow);
                }
            }
        break;
        case 5:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LINK","Incremental linking distance to next linked balise group","",TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_newcountry(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_linkorientation(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_linkreaction(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(1.0,Message_Details_Storage[packet_offset],"Q_LOCACC","Accuracy of the balise location",NULL,TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LINK","Incremental linking distance to next linked balise group","",TargetWindow);
                switcher = Message_Details_Storage[packet_offset];
                D_q_newcountry(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
                D_q_linkorientation(Message_Details_Storage[packet_offset],TargetWindow);
                D_q_linkreaction(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(1.0,Message_Details_Storage[packet_offset],"Q_LOCACC","Accuracy of the balise location",NULL,TargetWindow);
            }
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
            n_iter_i=0;
        break;
        case 6:
            switcher = Message_Details_Storage[packet_offset];
            D_q_vbco(switcher,TargetWindow);
            D_nid_vbcmk(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            if (switcher==1) {
                D_t_vbc(Message_Details_Storage[packet_offset],TargetWindow);
            }
        break;
        case 12:
        case 15:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            if (nid_packet==12) {
                D_v_main(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_v_g(Message_Details_Storage[packet_offset],"V_LOA","Permitted speed at the limit of authority",5,TargetWindow);
            D_t_loa(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_SECTION","Length of section in the MA",NULL,TargetWindow);
                switcher = Message_Details_Storage[packet_offset];
                D_q_g(switcher,"Q_SECTIONTIMER","Qualifier to indicate whether there is a Section Time-Out","Section timer information to follow","No section timer information",TargetWindow);
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\trelated to the section");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                if (switcher==1) {
                    D_t_sectiontimer(Message_Details_Storage[packet_offset],TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SECTIONTIMERSTOPLOC","Distance from beginning of section to the Section Time-Out",NULL,TargetWindow);
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tstop location");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ENDSECTION","Length of section in the MA",NULL,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_SECTIONTIMER","Qualifier to indicate whether there is a Section Time-Out","Section timer information to follow","No section timer information",TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\trelated to the section");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            if (switcher==1) {
                D_t_sectiontimer(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SECTIONTIMERSTOPLOC","Distance from beginning of section to the Section Time-Out",NULL,TargetWindow);
                if (target_window_index<0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tstop location");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                }
            }
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_ENDTIMER","Qualifier to indicate whether end section timer information","End section timer information to follow","No End section timer information",TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\texists for the End section in the MA");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            if (switcher==1) {
                D_t_g(Message_Details_Storage[packet_offset],"T_ENDTIMER","Validity time for the End section in the MA",TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_ENDTIMERSTARTLOC","Distance from End section timer start location to",NULL,TargetWindow);
                if (target_window_index<0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tEnd of Authority");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                }
            }
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_DANGERPOINT","Qualifier for danger point description","Danger point information to follow","No danger point information",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_DP","Distance from the End of Authority to danger point",NULL,TargetWindow);
                D_v_releasedp(Message_Details_Storage[packet_offset],TargetWindow);
            }
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_OVERLAP","Qualifier to tell whether there is an overlap","Overlap information to follow","No overlap information",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_STARTOL","Distance from overlap timer start location to End of Authority",NULL,TargetWindow);
                D_t_ol(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_OL","The distance from the End of Authority to the end of overlap",NULL,TargetWindow);
                D_v_releaseol(Message_Details_Storage[packet_offset],TargetWindow);
            }
        break;
        case 13:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_newcountry(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_newcountry(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SR","Distance in SR mode","Infinite",TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                switcher = Message_Details_Storage[packet_offset];
                D_q_newcountry(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SR","Distance in SR mode","Infinite",TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 16:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_SECTION","Length of section in the MA",NULL,TargetWindow);
        break;
        case 21:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_GRADIENT","Incremental distance to next change of gradient",NULL,TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_GDIR","Qualifier for gradient slope","Uphill","Downhill",TargetWindow);
            D_g_a(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_GRADIENT","Incremental distance to next change of gradient",NULL,TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_GDIR","Qualifier for gradient slope","Uphill","Downhill",TargetWindow);
                D_g_a(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 27:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_STATIC","Incremental distance to next continuity in an international","",TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tSSP profile");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            D_v_static(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_FRONT","Qualifier for validity end point of profile element","No train length delay on validity end point of profile element","Train length delay on validity end point of profile element",TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                if (m_version>=32) {
                    switcher = Message_Details_Storage[packet_offset];
                    D_q_diff(switcher,TargetWindow);
                }
                if (m_version<32) D_nc_diff(Message_Details_Storage[packet_offset],TargetWindow);
                else {
                    if (switcher==0) D_nc_cddiff(Message_Details_Storage[packet_offset],TargetWindow); else D_nc_diff(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_v_g(Message_Details_Storage[packet_offset],"V_DIFF","Absolute Positive Speed associated to a train category",5,TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_STATIC","Incremental distance to next continuity in an international","",TargetWindow);
                if (target_window_index<0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tSSP profile");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                }
                D_v_static(Message_Details_Storage[packet_offset],TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_FRONT","Qualifier for validity end point of profile element","No train length delay on validity end point of profile element","Train length delay on validity end point of profile element",TargetWindow);
                iterations_bis = Message_Details_Storage[packet_offset];
                D_n_iter(iterations_bis,TargetWindow);
                for (j=0;j<iterations_bis;j++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_j=j+1;
                    if (m_version>=32) {
                        switcher = Message_Details_Storage[packet_offset];
                        D_q_diff(switcher,TargetWindow);
                    }
                    if (m_version<32) D_nc_diff(Message_Details_Storage[packet_offset],TargetWindow);
                    else {
                        if (switcher==0) D_nc_cddiff(Message_Details_Storage[packet_offset],TargetWindow); else D_nc_diff(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    D_v_g(Message_Details_Storage[packet_offset],"V_DIFF","Absolute Positive Speed associated to a train category",5,TargetWindow);
                }
                n_iter_j=0;
                if (iterations_bis>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
        break;
        case 39:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACTION","Distance to change of traction",NULL,TargetWindow);
            if (m_version>=32) {
                switcher = Message_Details_Storage[packet_offset];
                D_m_voltage(switcher,TargetWindow);
                if (switcher!=0) D_nid_ctraction(Message_Details_Storage[packet_offset],TargetWindow);
            } else {
                D_m_traction(Message_Details_Storage[packet_offset],TargetWindow);
            }
        break;
        case 40:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_CURRENT","Distance to change of allowed current consumption",NULL,TargetWindow);
            D_m_current(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 41:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LEVELTR","Distance to level transition","Now",TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_m_leveltr(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ACKLEVELTR","Length of the acknowledgment area in rear of the required",NULL,TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                switcher = Message_Details_Storage[packet_offset];
                D_m_leveltr(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ACKLEVELTR","Length of the acknowledgment area in rear of the required",NULL,TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
        break;
        case 42:
            D_q_g(Message_Details_Storage[packet_offset],"Q_RBC","Qualifier for communication session order","Establish communication session","Terminate communication session",TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_rbc(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_radio(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],Message_Details_Storage[packet_offset+2],Message_Details_Storage[packet_offset+3],TargetWindow);
            packet_offset+=4;
            D_q_g(Message_Details_Storage[packet_offset],"Q_SLEEPSESSION","Session management for sleeping equipment","Execute session establishment order","Ignore session establishment order",TargetWindow);
        break;
        case 44:
            switcher = Message_Details_Storage[packet_offset];
            D_nid_xuser(switcher,TargetWindow);
            if (switcher==102) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            if (switcher==13) {
                D_data_tbl1p(Message_Details_Storage[packet_offset],TargetWindow);
            }
            if (Message_Details_Storage[packet_offset]>0) D_other_data(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 45:
            D_nid_mn(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],TargetWindow);
        break;
        case 46:
            switcher = Message_Details_Storage[packet_offset];
            D_m_leveltr(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                switcher = Message_Details_Storage[packet_offset];
                D_m_leveltr(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
                }
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 49:
        case 63:
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                switcher = Message_Details_Storage[packet_offset];
                D_q_newcountry(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 51:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_TRACKINIT","Qualifier for resuming the initial states of the related track","Empty profile, initial states to be resumed","No initial states to be resumed, profile to follow",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKINIT","Distance to start of empty profile",NULL,TargetWindow);
            } else {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_AXLELOAD","Incremental distance to the start of the next Axle load speed profile",NULL,TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_AXLELOAD","Length of speed restriction due to Axle load",NULL,TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_FRONT","Qualifier for validity end point of profile element","No train length delay on validity end point of profile element","Train length delay on validity end point of profile element",TargetWindow);
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_m_axleload(Message_Details_Storage[packet_offset],TargetWindow);
                    D_v_g(Message_Details_Storage[packet_offset],"V_AXLELOAD","Speed restriction related to axle load",5,TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_AXLELOAD","Incremental distance to the start of the next Axle load speed profile",NULL,TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_AXLELOAD","Length of speed restriction due to Axle load",NULL,TargetWindow);
                    D_q_g(Message_Details_Storage[packet_offset],"Q_FRONT","Qualifier for validity end point of profile element","No train length delay on validity end point of profile element","Train length delay on validity end point of profile element",TargetWindow);
                    iterations_bis = Message_Details_Storage[packet_offset];
                    D_n_iter(iterations_bis,TargetWindow);
                    for (j=0;j<iterations_bis;j++) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                        n_iter_j=j+1;
                        D_m_axleload(Message_Details_Storage[packet_offset],TargetWindow);
                        D_v_g(Message_Details_Storage[packet_offset],"V_AXLELOAD","Speed restriction related to axle load",5,TargetWindow);
                    }
                    n_iter_j=0;
                    if (iterations_bis>0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                    }
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tdescription of the packet");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
        break;
        case 52:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_TRACKINIT","Qualifier for resuming the initial states of the related track description of the packet","Empty profile, initial states to be resumes","No initial states to be resumed, profile to follow",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKINIT","Distance to start of empty profile",NULL,TargetWindow);
            } else {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_PBD","Permitted braking distance",NULL,TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_GDIR","Qualifier for gradient slope","Uphill","Downhill",TargetWindow);
                D_g_pbdsr(Message_Details_Storage[packet_offset],TargetWindow);
                D_q_g(Message_Details_Storage[packet_offset],"Q_PBDSR","Qualifier for Permitted Braking Distance","SB intervention requested","EB intervention requested",TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_PBDSR","Incremental distance to the start of the next speed restriction to ensure permitted braking distance",NULL,TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_PBDSR","Length of speed restriction to ensure permitted braking distance",NULL,TargetWindow);
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_PBD","Permitted braking distance",NULL,TargetWindow);
                    D_q_g(Message_Details_Storage[packet_offset],"Q_GDIR","Qualifier for gradient slope","Uphill","Downhill",TargetWindow);
                    D_g_pbdsr(Message_Details_Storage[packet_offset],TargetWindow);
                    D_q_g(Message_Details_Storage[packet_offset],"Q_PBDSR","Qualifier for Permitted Braking Distance","SB intervention requested","EB intervention requested",TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_PBDSR","Incremental distance to the start of the next speed restriction to ensure permitted braking distance",NULL,TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_PBDSR","Length of speed restriction to ensure permitted braking distance",NULL,TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
        break;
        case 57:
                D_t_mar(Message_Details_Storage[packet_offset],TargetWindow);
                D_t_timeoutrqst(Message_Details_Storage[packet_offset],TargetWindow);
                D_t_cycrqst(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 58:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_t_cycloc(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_CYCLOC","Distance between two position reports from the train","The train has not to report cyclically its position",TargetWindow);
            D_m_loc(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LOC","Incremental distance between locations where to train has to report its position",NULL,TargetWindow);
                    D_q_g(Message_Details_Storage[packet_offset],"Q_LGTLOC","Qualifier for the specified report location","Max safe front end","Min safe front end",TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
        break;
        case 64:

        break;
        case 65:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_nid_tsr(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TSR","Distance to beginning of temporary speed restriction",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TSR","Length of the temporary speed restriction",NULL,TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_FRONT","Qualifier for validity end point of profile element","No train length delay on validity end point of profile element","Train length delay on validity end point of profile element",TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_TSR","permitted speed for the temporary speed restriction",5,TargetWindow);
        break;
        case 66:
            D_nid_tsr(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 67:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 68:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_TRACKINIT","Qualifier for resuming the initial states of the related track description of the packet","Empty profile, initial states to be resumes","No initial states to be resumed, profile to follow",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKINIT","Distance to start of empty profile",NULL,TargetWindow);
            } else {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
                D_m_trackcond(Message_Details_Storage[packet_offset],TargetWindow);
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
                    D_m_trackcond(Message_Details_Storage[packet_offset],TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
        break;
        case 69:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_TRACKINIT","Qualifier for resuming the initial states of the related track description of the packet","Empty profile, initial states to be resumes","No initial states to be resumed, profile to follow",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKINIT","Distance to start of empty profile",NULL,TargetWindow);
            } else {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
                D_m_platform(Message_Details_Storage[packet_offset],TargetWindow);
                D_q_platform(Message_Details_Storage[packet_offset],TargetWindow);
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKCOND","Track condition distance",NULL,TargetWindow);
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TRACKCOND","Length for which the defined track condition is valid",NULL,TargetWindow);
                    D_m_platform(Message_Details_Storage[packet_offset],TargetWindow);
                    D_q_platform(Message_Details_Storage[packet_offset],TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
        break;
        case 70:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_TRACKINIT","Qualifier for resuming the initial states of the related track description of the packet","Empty profile, initial states to be resumes","No initial states to be resumed, profile to follow",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TRACKINIT","Distance to start of empty profile",NULL,TargetWindow);
            } else {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SUITABILITY","Distance to change in route suitability",NULL,TargetWindow);
                switcher = Message_Details_Storage[packet_offset];
                D_q_suitability(switcher,TargetWindow);
                if (switcher==0) {
                    D_m_linegauge(Message_Details_Storage[packet_offset],TargetWindow);
                }
                if (switcher==1) {
                    D_m_axleload(Message_Details_Storage[packet_offset],TargetWindow);
                }
                if (switcher==2) {
                    if (m_version>=32) {
                        switcher = Message_Details_Storage[packet_offset];
                        D_m_voltage(switcher,TargetWindow);
                        if (switcher!=0) D_nid_ctraction(Message_Details_Storage[packet_offset],TargetWindow);
                    } else D_m_traction(Message_Details_Storage[packet_offset],TargetWindow);
                }
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_SUITABILITY","Distance to change in route suitability",NULL,TargetWindow);
                    switcher = Message_Details_Storage[packet_offset];
                    D_q_suitability(switcher,TargetWindow);
                    if (switcher==0) {
                        D_m_linegauge(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    if (switcher==1) {
                        D_m_axleload(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    if (switcher==2) {
                        if (m_version>=32) {
                            switcher = Message_Details_Storage[packet_offset];
                            D_m_voltage(switcher,TargetWindow);
                            if (switcher!=0) D_nid_ctraction(Message_Details_Storage[packet_offset],TargetWindow);
                        } else D_m_traction(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
            }
        break;
        case 71:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_ADHESION","Distance to start of area with reduced adhesion factor",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ADHESION","Length of reduced adhesion",NULL,TargetWindow);
            D_m_adhesion(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 72:
        case 76:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_q_textclass(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_TEXTDISPLAY","Qualifier for the combination of text message events","Yes, display as soon as/until all events are fulfilled","No, display as soon as/until one of the events is fulfilled",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_TEXTDISPLAY","Distance from where on a text shall be displayed","The display of the text shall not be distance limited",TargetWindow);
            D_m_modetextdisplay(Message_Details_Storage[packet_offset],TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_m_leveltextdisplay(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_TEXTDISPLAY","Length on which a text shall be displayed","The display of the text shall not be distance limited",TargetWindow);
            D_t_textdisplay(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_modetextdisplay(Message_Details_Storage[packet_offset],TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_m_leveltextdisplay(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            switcher = Message_Details_Storage[packet_offset];
            D_q_textconfirm(switcher,TargetWindow);
            if (switcher!=0 && m_version>=32) {
                D_q_g(Message_Details_Storage[packet_offset],"Q_CONFTEXTDISPLAY","Qualifier for text confirmation versus end of text display","Driver acknowledgement is an additional condition to end the display","Driver acknowledgement always ends the display",TargetWindow);
                switcher_bis = Message_Details_Storage[packet_offset];
                D_q_g(switcher_bis,"Q_TEXTREPORT","Qualifier for reporting acknowledgement of text by driver","Yes, display as soon as / until all events are fulfilled","No, display as soon as / until one of the events is fulfilled",TargetWindow);
                if (switcher_bis==1) {
                    D_g(Message_Details_Storage[packet_offset],"NID_TEXTMESSAGE","Text message identifier",TargetWindow);;
                    D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                    D_nid_rbc(Message_Details_Storage[packet_offset],TargetWindow);
                }
            }
            if (nid_packet==72) {
                switcher = Message_Details_Storage[packet_offset];
                D_l_text(switcher,TargetWindow);
                char* text_buffer = malloc((switcher+1)*sizeof(char)); if (text_buffer==NULL) return;
                for (i=0;i<switcher;i++) {
                    text_buffer[i]=(char)Message_Details_Storage[packet_offset];
                    packet_offset++;
                }
                text_buffer[switcher]='\0';
                sprintf(Window_Buffer,"X_TEXT\t%s\tText string element",text_buffer);
                free(text_buffer);
                if (target_window_index<0) SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Window_Buffer);
            } else {
                D_q_text(Message_Details_Storage[packet_offset],TargetWindow);
            }
        break;
        case 79:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_newcountry(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_POSOFF","Offset from the location reference of the geographical position reference balise group to the related track kilometer reference",NULL,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_MPOSITION","Qualifier for track kilometer direction","Same (couting upwards if passed in nominal direction or","Opposite (couting downwards if passed in nominal direction or",TargetWindow);
            if (switcher==1) SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tcounting downwards if passed in reverse direction)"); else SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tcounting upwards if passed in reverse direction)");
            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            if (target_window_index>0) target_window_index++;
            D_m_position(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                switcher = Message_Details_Storage[packet_offset];
                D_q_newcountry(switcher,TargetWindow);
                if (switcher==1) {
                    D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                }
                D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_POSOFF","Offset from the location reference of the geographical position reference balise group to the related track kilometer reference",NULL,TargetWindow);
                switcher = Message_Details_Storage[packet_offset];
                D_q_g(switcher,"Q_MPOSITION","Qualifier for track kilometer direction","Same (couting upwards if passed in nominal direction or","Opposite (couting downwards if passed in nominal direction or",TargetWindow);
                if (switcher==1) SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tcounting downwards if passed in reverse direction)"); else SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\tcounting upwards if passed in reverse direction)");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                D_m_position(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 80:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_MAMODE","Incremental distance to the start of the next Mode Profile",NULL,TargetWindow);
            D_m_mamode(Message_Details_Storage[packet_offset],TargetWindow);
            D_v_mamode(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_MAMODE","Length of the area of the required mode","Infinite length",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ACKMAMODE","Length of the acknowledgement area in rear of the start of the",NULL,TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\trequired mode");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            if (m_version>=32) D_q_g(Message_Details_Storage[packet_offset],"Q_MAMODE","Qualifier to indicate the supervision of the beginning of the mode profile","as both the EOA and SvL (instead of the EOA and SvL given by the MA)","as the EOA (keeping the SvL given by the MA)",TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_MAMODE","Incremental distance to the start of the next Mode Profile",NULL,TargetWindow);
                D_m_mamode(Message_Details_Storage[packet_offset],TargetWindow);
                D_v_mamode(Message_Details_Storage[packet_offset],TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_MAMODE","Length of the area of the required mode","Infinite length",TargetWindow);
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_ACKMAMODE","Length of the acknowledgement area in rear of the start of the",NULL,TargetWindow);
                if (target_window_index<0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\trequired mode");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                }
                if (m_version>=32) D_q_g(Message_Details_Storage[packet_offset],"Q_MAMODE","Qualifier to indicate the supervision of the beginning of the mode profile","as both the EOA and SvL (instead of the EOA and SvL given by the MA)","as the EOA (keeping the SvL given by the MA)",TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 88:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_g(Message_Details_Storage[packet_offset],"NID_LX","Identity number of the Level Crossing",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LX","Distance to LX start location",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_LX","Length of the LX area",NULL,TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_LDXSTATUS","LX protection status","LX is not protected","LX is protected",TargetWindow);
            if (switcher==1) {
                D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_STOPLX","Length of the stopping area in rear of the start location of the LX area",NULL,TargetWindow);
            }
        break;
        case 90:
        case 136:
            switcher = Message_Details_Storage[packet_offset];
            D_q_newcountry(switcher,TargetWindow);
            if (switcher==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 131:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_RBCTR","Distance to RBC transition",NULL,TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_rbc(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_radio(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],Message_Details_Storage[packet_offset+2],Message_Details_Storage[packet_offset+3],TargetWindow);
            packet_offset+=4;
            D_q_g(Message_Details_Storage[packet_offset],"Q_SLEEPSESSION","Session management for sleeping equipment","Execute session establishment order","Ignore session establishment order",TargetWindow);
        break;
        case 132:
            D_q_g(Message_Details_Storage[packet_offset],"Q_ASPECT","Aspect of \"danger for shunting\" signal","Go if in SH mode","Stop if in SH mode",TargetWindow);
        break;
        case 133:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_RIU","Qualifier for communication session order","Establish communication session","",TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_g(Message_Details_Storage[packet_offset],"NID_RIU","Identity of radio infill unit",TargetWindow);
            D_nid_radio(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],Message_Details_Storage[packet_offset+2],Message_Details_Storage[packet_offset+3],TargetWindow);
            packet_offset+=4;
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_INFILL","Distance to location where to connect/disconnect to a radio infill unit",NULL,TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 134:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_g(Message_Details_Storage[packet_offset],"NID_LOOP","Identity number of the loop",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LOOP","Distance between EOLM and start of loop","Distance not known",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_LOOP","Length of loop","Length not known",TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_LOOPDIR","Qualifier to indicate the direction of the loop","Same","Opposite",TargetWindow);
            D_q_sscode(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 135:

        break;
        case 137:
            D_q_g(Message_Details_Storage[packet_offset],"Q_SRSTOP","\"Stop if in Staff Responsible\" information","Go if in SR mode","Stop if in SR mode",TargetWindow);
        break;
        case 138:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_STARTREVERSE","Distance to start of reversing permitted area",NULL,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_STARTREVERSE","Length of the reversing permitted area",NULL,TargetWindow);
        break;
        case 139:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_STARTREVERSE","Distance to start of reversing permitted area",NULL,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_REVERSE","Reversing mode speed limit",5,TargetWindow);
        break;
        case 140:
            D_nid_operational(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],TargetWindow);
            packet_offset+=2;
        break;
        case 141:
            D_q_g(Message_Details_Storage[packet_offset],"Q_GDIR","Qualifier for gradient slope","Uphill","Downhill",TargetWindow);
            D_g_tsr(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 143:
            D_q_g(Message_Details_Storage[packet_offset],"Q_RIU","Qualifier for communication session order","Establish communication session","",TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_g(Message_Details_Storage[packet_offset],"NID_RIU","Identity of radio infill unit",TargetWindow);
            D_nid_radio(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],Message_Details_Storage[packet_offset+2],Message_Details_Storage[packet_offset+3],TargetWindow);
            packet_offset+=4;
        break;
        case 145:
        break;
        case 180:
            D_q_g(Message_Details_Storage[packet_offset],"Q_LSSMA","Qualifier for the LSSMA display","Toggle on","Toggle off",TargetWindow);
            D_t_g(Message_Details_Storage[packet_offset],"T_LSSMA","Delay to toggle on the LSSMA display",TargetWindow);
        break;
        case 181:

        break;
        case 203:
            D_q_g(Message_Details_Storage[packet_offset],"Q_NVGUIPERM","Permission to use the guidance curve","Yes","No",TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_NVSBFBPERM","Permission to use the service brake feedback","Yes","No",TargetWindow);
            D_q_g(Message_Details_Storage[packet_offset],"Q_NVINHSMICPERM","Permission to inhibit the compensation of the speed","Yes","No",TargetWindow);
            if (target_window_index<0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tmeasurement inaccuracy");
                if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
            }
            D_a_nvmaxredadh(1,Message_Details_Storage[packet_offset],TargetWindow);
            D_a_nvmaxredadh(2,Message_Details_Storage[packet_offset],TargetWindow);
            D_a_nvmaxredadh(3,Message_Details_Storage[packet_offset],TargetWindow);
            D_m_nvavadh(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_nvebcl(Message_Details_Storage[packet_offset],TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_g(switcher,"Q_NVKINT","Qualifier for integrated correction factors","Integrated correction factors follow","No integrated correction factors follow",TargetWindow);
            if (switcher==1) {
                switcher_bis = Message_Details_Storage[packet_offset];
                D_q_nvkvintset(switcher_bis,TargetWindow);
                if (switcher_bis==1) {
                    D_a_g("A_NVP12","Lower deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                    if (target_window_index<0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    }
                    D_a_g("A_NVP23","Upper deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                    if (target_window_index<0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    }
                }
                D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                if (target_window_index<0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                    if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                }
                D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                if (switcher_bis==1) {
                    D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                }
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                    if (target_window_index<0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    }
                    D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    if (switcher_bis==1) {
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    switcher_bis = Message_Details_Storage[packet_offset];
                    D_q_nvkvintset(switcher_bis,TargetWindow);
                    if (switcher_bis==1) {
                        D_a_g("A_NVP12","Lower deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                        D_a_g("A_NVP23","Upper deceleration limit to determine the set of Kv",Message_Details_Storage[packet_offset],TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tto be used");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                    }
                    D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                    if (target_window_index<0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                        if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    }
                    D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    if (switcher_bis==1) {
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                    }
                    iterations_bis = Message_Details_Storage[packet_offset];
                    D_n_iter(iterations_bis,TargetWindow);
                    for (j=0;j<iterations_bis;j++) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                        n_iter_j=j+1;
                        D_v_g(Message_Details_Storage[packet_offset],"V_NVKVINT","Speed step used to define the integrated correction",5,TargetWindow);
                        if (target_window_index<0) {
                            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"\t\tfactor Kv");
                            if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        }
                        D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        if (switcher_bis==1) {
                            D_m_nvkvint(Message_Details_Storage[packet_offset],TargetWindow);
                        }
                    }
                    n_iter_j=0;
                    if (iterations_bis>0) {
                        SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                        if (target_window_index>0) target_window_index++;
                    }
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
                D_l_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                D_m_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                iterations = Message_Details_Storage[packet_offset];
                D_n_iter(iterations,TargetWindow);
                for (i=0;i<iterations;i++) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                    n_iter_i=i+1;
                    D_l_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                    D_m_nvkrint(Message_Details_Storage[packet_offset],TargetWindow);
                }
                n_iter_i=0;
                if (iterations>0) {
                    SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                    if (target_window_index>0) target_window_index++;
                }
                D_m_nvktint(Message_Details_Storage[packet_offset],TargetWindow);
            }
        break;
        case 254:

        break;
        default:
//            D_other_data(Message_Details_Storage[packet_offset],TargetWindow);
//            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"This packet version could not be identified and was therefore not decoded.");
//            if (target_window_index>0) target_window_index++;
        break;
    }
    if (ASV_Search_Index>=0) SendMessage(DetailsWindow,LB_SETCURSEL,ASV_Search_Index+ASV_increment,0);
}

void D_train_to_track_packet(int nid_packet, HWND TargetWindow, bool title, int m_version) {

float q_scale;
int i,iterations,switcher;
init_offset = packet_offset;

    if (TargetWindow==DetailsWindow) target_window_index=-1;

    if (title) Train_To_Track_Packet_Name(TargetWindow,nid_packet,-1);

    D_l_packet(Message_Details_Storage[packet_offset],TargetWindow);

    if (Message_Details_Storage[packet_offset-1]==0) return;

    switch(nid_packet) {
        case 256:
        case 1:
            q_scale = pow(10,Message_Details_Storage[packet_offset]-1);
            D_q_scale(q_scale,TargetWindow);
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            if (nid_packet==1) {
                D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
                D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"D_LRBG","Distance between the last relevant balise group and the estimated front end of the train (the side of the active cab)","Unknown",TargetWindow);
            D_q_dirlrbg(Message_Details_Storage[packet_offset],TargetWindow);
            D_q_dlrbg(Message_Details_Storage[packet_offset],TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_DOUBTOVER","Over-reading amount plus the Q_LOCACC of the LRBG","Unknown",TargetWindow);
            D_d_g(q_scale,Message_Details_Storage[packet_offset],"L_DOUBTUNDER","Under-reading amount plus the Q_LOCACC of the LRBG","Unknown",TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_q_length(switcher,TargetWindow);
            if (switcher==1 || switcher==2) {
                D_d_g(1.0,Message_Details_Storage[packet_offset],"L_TRAININT","Safe train length",NULL,TargetWindow);
            }
            D_v_g(Message_Details_Storage[packet_offset],"V_TRAIN","Train speed",5,TargetWindow);
            D_q_dirtrain(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_mode(Message_Details_Storage[packet_offset],TargetWindow);
            switcher = Message_Details_Storage[packet_offset];
            D_m_level(switcher,TargetWindow);
            if (switcher==1) D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 3:
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-3*i-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_nid_radio(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],Message_Details_Storage[packet_offset+2],Message_Details_Storage[packet_offset+3],TargetWindow);
                packet_offset+=4;
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-3*i-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 4:
            D_m_error(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 5:
            D_nid_operational(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],TargetWindow);
            packet_offset+=2;
        break;
        case 9:
            D_nid_c(Message_Details_Storage[packet_offset],TargetWindow);
            D_nid_bg(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        case 11:
            if (m_version>=32) {
                D_nc_cdtrain(Message_Details_Storage[packet_offset],TargetWindow);
                D_nc_train(Message_Details_Storage[packet_offset],TargetWindow);
            } else {
                D_nid_operational(Message_Details_Storage[packet_offset],Message_Details_Storage[packet_offset+1],TargetWindow);
                packet_offset+=2;
                D_nc_train_old(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_d_g(1.0,Message_Details_Storage[packet_offset],"L_TRAIN","Train length",NULL,TargetWindow);
            D_v_g(Message_Details_Storage[packet_offset],"V_MAXTRAIN","Maximum train speed",5,TargetWindow);
            D_m_loadinggauge(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_axleload(Message_Details_Storage[packet_offset],TargetWindow);
            D_m_airtight(Message_Details_Storage[packet_offset],TargetWindow);
            if (m_version>=32) D_n_axle(Message_Details_Storage[packet_offset],TargetWindow);
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                if (m_version>=32) {
                    switcher = Message_Details_Storage[packet_offset];
                    D_m_voltage(switcher,TargetWindow);
                    if (switcher!=0) D_nid_ctraction(Message_Details_Storage[packet_offset],TargetWindow);
                } else D_m_traction(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
            iterations = Message_Details_Storage[packet_offset];
            D_n_iter(iterations,TargetWindow);
            for (i=0;i<iterations;i++) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
                n_iter_i=i+1;
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            n_iter_i=0;
            if (iterations>0) {
                SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer); if (ASV_Search_Index>=0 && packet_offset-init_offset<ASV_Search_Index) ASV_increment++;
                if (target_window_index>0) target_window_index++;
            }
        break;
        case 44:
            switcher = Message_Details_Storage[packet_offset];
            D_nid_xuser(switcher,TargetWindow);
            if (switcher==102) {
                D_nid_stm(Message_Details_Storage[packet_offset],TargetWindow);
            }
            D_other_data(Message_Details_Storage[packet_offset],TargetWindow);
        break;
        default:
//            D_other_data(Message_Details_Storage[packet_offset],TargetWindow);
//            SendMessage(TargetWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)"This packet version could not be identified and was therefore not decoded.");
//            if (target_window_index>0) target_window_index++;
        break;
    }
    if (ASV_Search_Index>=0) SendMessage(DetailsWindow,LB_SETCURSEL,ASV_Search_Index+ASV_increment,0);
}

LRESULT CALLBACK WndProc(HWND hwndm, UINT msg, WPARAM wParam, LPARAM lParam) {
    int index;

    switch(msg)
    {
        HDC hdc ;
        PAINTSTRUCT ps ;
        PMEASUREITEMSTRUCT pmis;
        LPDRAWITEMSTRUCT Item;
        RECT rect ;
        case WM_CLOSE:
            if (hwndm==TTXWindow) {
                if (!M_MZ) PostMessage(MainWindow,MAIN_QUIT_RQST,0,0);
                return 0;
            }
            if (hwndm==MainFolderWindow) {
                ShowWindow(MainFolderWindow,0);
                SetFocus(DecodeButtonWindow);
                return 0;
            } else if (hwndm==MainCSVSettingsWindow) {
                ShowWindow(MainCSVSettingsWindow,0);
                if (Last_Message>=1) SetFocus(MessageWindow); else SetFocus(DecodeButtonWindow);
                return 0;
            } else if (hwndm==MediaSelectionWindow) {
                ShowWindow(MediaSelectionWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==MediaWindow_1) {
                ShowWindow(MediaWindow_1,0);
                if (!IsWindowVisible(MediaWindow_2)) {
                    ShowWindow(MediaInfoWindow,0);
                    ShowWindow(PlayButtonWindow,0);
                    ShowWindow(StopButtonWindow,0);
                    ShowWindow(CenterButtonWindow,0);
                    ShowWindow(ResetButtonWindow,0);
                }

//                libvlc_media_player_stop_async(my_player_1);
                media_duration_1 = 0;
                run_media=false;
                file_log_count++; log_it(LOG_ERROR,"[M] Media 1 destroyed","",-1);
                if (!IsWindowVisible(MediaWindow_2)) SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==MediaWindow_2) {
                ShowWindow(MediaWindow_2,0);
                if (!IsWindowVisible(MediaWindow_2)) {
                    ShowWindow(MediaInfoWindow,0);
                    ShowWindow(PlayButtonWindow,0);
                    ShowWindow(StopButtonWindow,0);
                    ShowWindow(CenterButtonWindow,0);
                    ShowWindow(ResetButtonWindow,0);
                }
//                libvlc_media_player_stop_async(my_player_2);
                media_duration_2 = 0;
                run_media=false;
                file_log_count++; log_it(LOG_ERROR,"[M] Media 2 destroyed","",-1);
                if (!IsWindowVisible(MediaWindow_1)) SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==MainWindow) {
                PostMessage(MainWindow,MAIN_QUIT_RQST,0,0);
                return 0;
            } else if (hwndm==MainHelpWindow) {
                ShowWindow(MainHelpWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==MainBaliseListWindow) {
                ShowWindow(MainBaliseListWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==SequenceWindow) {
                ShowWindow(SequenceWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==ColorChartMainWindow) {
                ShowWindow(ColorChartMainWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==MainTrainListWindow) {
                ShowWindow(MainTrainListWindow,0);
                SetFocus(MessageWindow);
                return 0;
            } else if (hwndm==SpeedProfileWindow) {
                ShowWindow(SpeedProfileWindow,0);
                SetFocus(MessageWindow);
                return 0;
            }
            else return DefWindowProc(hwndm, msg, wParam, lParam);
        case WM_MEASUREITEM:
            pmis = (PMEASUREITEMSTRUCT) lParam;
            if (hwndm == MainFolderWindow || hwndm == VTRACKListWindow || hwndm == MainBaliseListWindow || hwndm == MainTrainListWindow || hwndm == SequenceListWindow1 || hwndm == SequenceListWindow2 || hwndm == CSVSettingsList1Window || hwndm == CSVSettingsList2Window) pmis->itemHeight = 20*y_scale;
            else pmis->itemHeight = 17*y_scale;
            return TRUE;
        break;
        case WM_COMMAND:
            if (HIWORD(wParam)==LBN_SELCHANGE) {
                HWND selchangewindow = LOWORD(lParam);
                PostMessage(selchangewindow,(UINT)SEL_CHANGE_MESSAGE,(WPARAM)0,(LPARAM)0);
                return true;
            }
            if (HIWORD(wParam)==BN_CLICKED) {
                PostMessage(hwndm,BTN_CLICKED_MESSAGE,(WPARAM)lParam,(LPARAM)0);
                return true;
            }
            return DefWindowProc(hwndm, msg, wParam, lParam);
        case WM_MOUSEMOVE:
            if (IsWindowVisible(VTRACKWindow)) PostMessage(hwndm,MOUSE_MOVE_MESSAGE,0,lParam);
        break;
        case WM_CTLCOLORSTATIC:
            hdc = (HDC)wParam;
            if ((HWND)lParam==TimeWindow || (HWND)lParam==DistanceWindow || (HWND)lParam==SpeedWindow) {
                SetBkColor(hdc, Orange_Edit);
                return (INT_PTR)Orange_Edit_Brush;
            }
            if ((HWND)lParam==TooltipWindow) {
                SetBkColor(hdc, YELLOW_MAP);
                SetTextColor(hdc,Black);
                return (INT_PTR)Yellow_Map_Brush;
            }
            if ((HWND)lParam==VehicleWindow) {
                if (Last_Message<=0) {
                    SetBkColor(hdc, Main);
                    return (INT_PTR)Main_Brush;
                } else if (valid_data) {
                    SetBkColor(hdc, Green_Edit);
                    return (INT_PTR)Green_Edit_Brush;
                } else {
                    SetBkColor(hdc, Orange_Edit);
                    return (INT_PTR)Orange_Edit_Brush;
                }
            }
            SetBkColor(hdc, Main);
            SetTextColor(hdc,Gold);
            return (INT_PTR)Main_Brush;
        break;
        case WM_CTLCOLOREDIT:
            hdc = (HDC) wParam;
            if (ROLE>=ROLE_DEMO && ((HWND)lParam==AdvancedSearchNameWindow || (HWND)lParam==AdvancedSearchValueWindow)) return GRAY_BRUSH;
            if ((HWND)lParam==FolderEditWindow) {
                 if (night_mode) {
                    SetBkColor(hdc, Gray);
                    return (INT_PTR)Gray_Brush;
                 }
                 else {
                    SetBkColor(hdc, White);
                    return (INT_PTR)White_Brush;
                 }
            }
            SetBkColor(hdc, Green_Edit);
            return (INT_PTR)Green_Edit_Brush;
        break;
        case WM_CTLCOLORLISTBOX:
            hdc = (HDC) wParam;
            if ((HWND)lParam==LinkingWindow || (HWND)lParam==BaliseListWindow || (HWND)lParam==TrainListWindow || (HWND)lParam==MAWindow || (HWND)lParam==CSVSettingsList1Window || (HWND)lParam==CSVSettingsList2Window) return (INT_PTR)Cyan_Brush;
            if ((HWND)lParam==FolderViewWindow || (HWND)lParam==SequenceListWindow1 || (HWND)lParam==SequenceListWindow2 || (HWND)lParam==MessageWindow || (HWND)lParam==HeadersWindow || (HWND)lParam==DetailsWindow) {
                if ((HWND)lParam==FolderViewWindow) {
                    if (night_mode) SetBkColor(hdc, Gray); else SetBkColor(hdc,White);
                }
                if (night_mode) return (INT_PTR)Gray_Brush; else return (INT_PTR)White_Brush;
            }
            else return DefWindowProc(hwndm, msg, wParam, lParam);
        break;
        case WM_CTLCOLORBTN:
            if ((HWND)lParam==Toggle1Window) {
                return (INT_PTR)Cyan_Brush;
            }
            else return DefWindowProc(hwndm, msg, wParam, lParam);
        break;
        case WM_DRAWITEM:
            Item = (LPDRAWITEMSTRUCT) lParam;
            int len = SendMessage(Item->hwndItem , LB_GETTEXT, (WPARAM)Item->itemID, (LPARAM)Message_Buffer);
                if (len>=2) {
                    len = utf8_encode(Message_Buffer);
                    if (Item->hwndItem==MessageWindow || Item->hwndItem==VTRACKListWindow) {
                        if (Item->hwndItem==VTRACKListWindow) {Item->rcItem.top-=5; Item->rcItem.bottom+=15;}
                        if (Item->itemState & ODS_FOCUS || Item->itemState & ODS_SELECTED || Item->itemID==Reference_Message || Item->hwndItem==VTRACKListWindow)
                        {
                            SetTextColor(Item->hDC, White);
                            if (Message_Buffer[0]=='C' && Message_Buffer[14]=='M') {
                                SetBkColor(Item->hDC, Purple);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Purple_Brush);
                            }
                            else if (Message_Buffer[0]=='D' && Message_Buffer[1]=='A') {
                                SetBkColor(Item->hDC, Pink);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Pink_Brush);
                            }
                            else if (Message_Buffer[0]=='I') {
                                SetBkColor(Item->hDC, Lime);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Lime_Brush);
                            }
                            else if (Message_Buffer[0]=='C' && Message_Buffer[14]=='N') {
                                SetBkColor(Item->hDC, Blue);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Blue_Brush);
                            }
                            else if (Message_Buffer[1]=='M' && Message_Buffer[14]=='B') {
                                SetBkColor(Item->hDC, Cyan);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                            }
                            else if (Message_Buffer[0]=='M' && Message_Buffer[13]=='R') {
                                SetBkColor(Item->hDC, Green);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Green_Brush);
                            }
                            else if (Message_Buffer[0]=='M' && Message_Buffer[8]=='T' && Message_Buffer[11]=='R') {
                                SetBkColor(Item->hDC, Peach);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Peach_Brush);
                            }
                            else if (Message_Buffer[0]=='E' && Message_Buffer[1]=='M') {
                                SetBkColor(Item->hDC, Red);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Red_Brush);
                            }
                            else if (Message_Buffer[0]=='B' && Message_Buffer[1]=='A') {
                                SetBkColor(Item->hDC, Brown);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Brown_Brush);
                            } else if (Message_Buffer[0]=='E' && Message_Buffer[1]=='V') {
                                SetBkColor(Item->hDC, Lemon);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Lemon_Brush);
                            } else if (Message_Buffer[0]=='P' && Message_Buffer[1]=='L') {
                                SetBkColor(Item->hDC, Light_Pink);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Light_Pink_Brush);
                            } else if (Message_Buffer[0]=='Z' && Message_Buffer[1]=='_') {
                                SetBkColor(Item->hDC, Sky);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Sky_Brush);
                            } else if (Message_Buffer[0]=='D' && Message_Buffer[1]=='R') {
                                SetBkColor(Item->hDC, Emerald);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Emerald_Brush);
                            } else if (Message_Buffer[0]=='E' && Message_Buffer[1]=='T') {
                                SetBkColor(Item->hDC, Sky);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Sky_Brush);
                            } else {
                                SetBkColor(Item->hDC, Black);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Black_Brush);
                            }
                        }
                        else
                        {
                            SetTextColor(Item->hDC, Black);
                            if (night_mode) {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush);
                                SetBkColor(Item->hDC, Gray);
                            }  else {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                                SetBkColor(Item->hDC, White);
                            }
                            if (Message_Buffer[0]=='I') SetTextColor(Item->hDC, Lime);
                            if (Message_Buffer[0]=='D' && Message_Buffer[1]=='A') SetTextColor(Item->hDC, Pink);
                            if (Message_Buffer[0]=='C' && Message_Buffer[14]=='M') SetTextColor(Item->hDC, Purple);
                            if (Message_Buffer[0]=='C' && Message_Buffer[14]=='N') SetTextColor(Item->hDC, Blue);
                            if (Message_Buffer[1]=='M' && Message_Buffer[14]=='B') SetTextColor(Item->hDC, Cyan);
                            if (Message_Buffer[0]=='M' && Message_Buffer[13]=='R') SetTextColor(Item->hDC, Green);
                            if (Message_Buffer[0]=='E' && Message_Buffer[1]=='V') SetTextColor(Item->hDC, Lemon);
                            if (Message_Buffer[0]=='P' && Message_Buffer[1]=='L') SetTextColor(Item->hDC, Light_Pink);
                            if (Message_Buffer[0]=='E' && Message_Buffer[1]=='T') SetTextColor(Item->hDC, Sky);
                            if (Message_Buffer[0]=='M' && Message_Buffer[8]=='T' && Message_Buffer[11]=='R') SetTextColor(Item->hDC, Peach);
                            if (Message_Buffer[0]=='E' && Message_Buffer[1]=='M') SetTextColor(Item->hDC, Red);
                            if (Message_Buffer[0]=='B' && Message_Buffer[1]=='A') SetTextColor(Item->hDC, Brown);
                            if (Message_Buffer[0]=='D' && Message_Buffer[1]=='R') SetTextColor(Item->hDC, Emerald);
                            if (Message_Buffer[0]=='Z' && Message_Buffer[1]=='_') SetTextColor(Item->hDC, Sky);
                        }
                    if (Item->hwndItem==VTRACKListWindow) Item->rcItem.top+=10;
                    if (Message_Buffer[0]=='+' || Message_Buffer[0]=='-') {
                        Item->rcItem.left+=5;
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)&Message_Buffer[1],len,12,(LPINT)&MessageWindow_Tabs,x_scale*140);
                    } else TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,12,(LPINT)&MessageWindow_Tabs,x_scale*140);
                    if (Message_Buffer[0]=='-' || Message_Buffer[0]=='+' || Message_Buffer[0]=='|') {
                        if (Message_Buffer[0]=='-') SetTextColor(Item->hDC, Red);
                        if (Message_Buffer[0]=='+') SetTextColor(Item->hDC, Green);
                        if (Message_Buffer[0]=='|') SetTextColor(Item->hDC, Very_Dark_Gray);
                        Item->rcItem.top-=1;
                        TextOut(Item->hDC,0, Item->rcItem.top,(LPCSTR)"|",1);
                    }
                    } else if (Item->hwndItem==DetailsWindow) {

                        HDC bitmap_source;
                        bitmap_source = CreateCompatibleDC(Item->hDC);
                        BITMAP bm;
                        HBITMAP hbm=NULL;
                        if (strstr(Message_Buffer,"DMI_SYMB_STATUS")!=NULL) {
                            if (strstr(Message_Buffer,"LE01")!=NULL) hbm = LE01;
                            if (strstr(Message_Buffer,"LE02")!=NULL) hbm = LE02;
                            if (strstr(Message_Buffer,"LE03")!=NULL) hbm = LE03;
                            if (strstr(Message_Buffer,"LE04")!=NULL) hbm = LE04;
                            if (strstr(Message_Buffer,"LE05")!=NULL) hbm = LE05;
                            if (strstr(Message_Buffer,"LE06")!=NULL) hbm = LE06;
                            if (strstr(Message_Buffer,"LE07")!=NULL) hbm = LE07;
                            if (strstr(Message_Buffer,"LE08")!=NULL) hbm = LE08;
                            if (strstr(Message_Buffer,"LE09")!=NULL) hbm = LE09;
                            if (strstr(Message_Buffer,"LE10")!=NULL) hbm = LE10;
                            if (strstr(Message_Buffer,"LE11")!=NULL) hbm = LE11;
                            if (strstr(Message_Buffer,"LE12")!=NULL) hbm = LE12;
                            if (strstr(Message_Buffer,"LE13")!=NULL) hbm = LE13;
                            if (strstr(Message_Buffer,"LE14")!=NULL) hbm = LE14;
                            if (strstr(Message_Buffer,"LE15")!=NULL) hbm = LE15;
                            if (strstr(Message_Buffer,"MO01")!=NULL) hbm = MO01;
                            if (strstr(Message_Buffer,"MO02")!=NULL) hbm = MO02;
                            if (strstr(Message_Buffer,"MO03")!=NULL) hbm = MO03;
                            if (strstr(Message_Buffer,"MO04")!=NULL) hbm = MO04;
                            if (strstr(Message_Buffer,"MO05")!=NULL) hbm = MO05;
                            if (strstr(Message_Buffer,"MO06")!=NULL) hbm = MO06;
                            if (strstr(Message_Buffer,"MO07")!=NULL) hbm = MO07;
                            if (strstr(Message_Buffer,"MO08")!=NULL) hbm = MO08;
                            if (strstr(Message_Buffer,"MO09")!=NULL) hbm = MO09;
                            if (strstr(Message_Buffer,"MO10")!=NULL) hbm = MO10;
                            if (strstr(Message_Buffer,"MO11")!=NULL) hbm = MO11;
                            if (strstr(Message_Buffer,"MO12")!=NULL) hbm = MO12;
                            if (strstr(Message_Buffer,"MO13")!=NULL) hbm = MO13;
                            if (strstr(Message_Buffer,"MO14")!=NULL) hbm = MO14;
                            if (strstr(Message_Buffer,"MO15")!=NULL) hbm = MO15;
                            if (strstr(Message_Buffer,"MO16")!=NULL) hbm = MO16;
                            if (strstr(Message_Buffer,"MO17")!=NULL) hbm = MO17;
                            if (strstr(Message_Buffer,"MO18")!=NULL) hbm = MO18;
                            if (strstr(Message_Buffer,"MO19")!=NULL) hbm = MO19;
                            if (strstr(Message_Buffer,"MO20")!=NULL) hbm = MO20;
                            if (strstr(Message_Buffer,"MO21")!=NULL) hbm = MO21;
                            if (strstr(Message_Buffer,"MO22")!=NULL) hbm = MO22;
                            if (strstr(Message_Buffer,"ST01")!=NULL) hbm = ST01;
                            if (strstr(Message_Buffer,"ST02")!=NULL) hbm = ST02;
                            if (strstr(Message_Buffer,"ST03")!=NULL) hbm = ST03;
                            if (strstr(Message_Buffer,"ST04")!=NULL) hbm = ST04;
                            if (strstr(Message_Buffer,"ST05")!=NULL) hbm = ST05;
                            if (strstr(Message_Buffer,"ST06")!=NULL) hbm = ST06;
                            if (strstr(Message_Buffer,"TC01")!=NULL) hbm = TC01;
                            if (strstr(Message_Buffer,"TC02")!=NULL) hbm = TC02;
                            if (strstr(Message_Buffer,"TC03")!=NULL) hbm = TC03;
                            if (strstr(Message_Buffer,"TC04")!=NULL) hbm = TC04;
                            if (strstr(Message_Buffer,"TC05")!=NULL) hbm = TC05;
                            if (strstr(Message_Buffer,"TC06")!=NULL) hbm = TC06;
                            if (strstr(Message_Buffer,"TC07")!=NULL) hbm = TC07;
                            if (strstr(Message_Buffer,"TC08")!=NULL) hbm = TC08;
                            if (strstr(Message_Buffer,"TC09")!=NULL) hbm = TC09;
                            if (strstr(Message_Buffer,"TC10")!=NULL) hbm = TC10;
                            if (strstr(Message_Buffer,"TC11")!=NULL) hbm = TC11;
                            if (strstr(Message_Buffer,"TC12")!=NULL) hbm = TC12;
                            if (strstr(Message_Buffer,"TC13")!=NULL) hbm = TC13;
                            if (strstr(Message_Buffer,"TC14")!=NULL) hbm = TC14;
                            if (strstr(Message_Buffer,"TC15")!=NULL) hbm = TC15;
                            if (strstr(Message_Buffer,"TC16")!=NULL) hbm = TC16;
                            if (strstr(Message_Buffer,"TC17")!=NULL) hbm = TC17;
                            if (strstr(Message_Buffer,"TC18")!=NULL) hbm = TC18;
                            if (strstr(Message_Buffer,"TC19")!=NULL) hbm = TC19;
                            if (strstr(Message_Buffer,"TC20")!=NULL) hbm = TC20;
                            if (strstr(Message_Buffer,"TC21")!=NULL) hbm = TC21;
                            if (strstr(Message_Buffer,"TC22")!=NULL) hbm = TC22;
                            if (strstr(Message_Buffer,"TC23")!=NULL) hbm = TC23;
                            if (strstr(Message_Buffer,"TC24")!=NULL) hbm = TC24;
                            if (strstr(Message_Buffer,"TC25")!=NULL) hbm = TC25;
                            if (strstr(Message_Buffer,"TC26")!=NULL) hbm = TC26;
                            if (strstr(Message_Buffer,"TC27")!=NULL) hbm = TC27;
                            if (strstr(Message_Buffer,"TC28")!=NULL) hbm = TC28;
                            if (strstr(Message_Buffer,"TC29")!=NULL) hbm = TC29;
                            if (strstr(Message_Buffer,"TC30")!=NULL) hbm = TC30;
                            if (strstr(Message_Buffer,"TC31")!=NULL) hbm = TC31;
                            if (strstr(Message_Buffer,"TC32")!=NULL) hbm = TC32;
                            if (strstr(Message_Buffer,"TC33")!=NULL) hbm = TC33;
                            if (strstr(Message_Buffer,"TC34")!=NULL) hbm = TC34;
                            if (strstr(Message_Buffer,"TC35")!=NULL) hbm = TC35;
                            if (strstr(Message_Buffer,"TC36")!=NULL) hbm = TC36;
                            if (strstr(Message_Buffer,"TC37")!=NULL) hbm = TC37;
                            if (strstr(Message_Buffer,"DR01")!=NULL) hbm = DR01;
                            if (strstr(Message_Buffer,"DR02")!=NULL) hbm = DR02;
                            if (strstr(Message_Buffer,"DR03")!=NULL) hbm = DR03;
                            if (strstr(Message_Buffer,"DR04")!=NULL) hbm = DR04;
                            if (strstr(Message_Buffer,"DR05")!=NULL) hbm = DR05;
                            if (strstr(Message_Buffer,"LX01")!=NULL) hbm = LX01;
                            if (strstr(Message_Buffer,"LS01")!=NULL) hbm = LS01;
                        } else SendMessage(Item->hwndItem,LB_SETITEMHEIGHT,Item->itemID,17);
                        if (Item->itemID==0) DetailsWindow_Switcher=0;
                        if (Item->itemID==0 && Message_Buffer[1]!=95 && Message_Buffer[3]!=95) {
                            SetTextColor(Item->hDC, White);
                            SetBkColor(Item->hDC, Azure);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Azure_Brush);
                        } else {
                            SetTextColor(Item->hDC, Black);
                            if (SendMessage(DetailsWindow,LB_GETITEMDATA,Item->itemID,0)==0) {
                                if (Message_Buffer[0]!=9) DetailsWindow_Switcher++;
                                if (!DetailsWindow_Switcher_Switcher && Item->itemID!=0) {
                                    DetailsWindow_Switcher_Switcher=true;
                                    DetailsWindow_Switcher = SendMessage(DetailsWindow,LB_GETITEMDATA,Item->itemID-1,0);
                                }
                                if (DetailsWindow_Switcher==2) DetailsWindow_Switcher=0;
                                if (DetailsWindow_Switcher==0) {
                                    if (night_mode) {
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush);
                                        SetBkColor(Item->hDC, Gray);
                                    }  else {
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                                        SetBkColor(Item->hDC, White);
                                    }
                                    SendMessage(DetailsWindow,LB_SETITEMDATA,Item->itemID,1);
                                } else {
                                    if (night_mode) {
                                        SetBkColor(Item->hDC, Medium_Gray);
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Medium_Gray_Brush);
                                    } else {
                                        SetBkColor(Item->hDC, Dark_Gray);
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Dark_Gray_Brush);
                                    }
                                    SendMessage(DetailsWindow,LB_SETITEMDATA,Item->itemID,2);
                                }
                            } else {
                                DetailsWindow_Switcher_Switcher=false;
                                if (SendMessage(DetailsWindow,LB_GETITEMDATA,Item->itemID,0)==1) {
                                    if (night_mode) {
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush);
                                        SetBkColor(Item->hDC, Gray);
                                    }  else {
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                                        SetBkColor(Item->hDC, White);
                                    }
                                } else {
                                    if (night_mode) {
                                        SetBkColor(Item->hDC, Medium_Gray);
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Medium_Gray_Brush);
                                    } else {
                                        SetBkColor(Item->hDC, Dark_Gray);
                                        FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Dark_Gray_Brush);
                                    }
                                }
                            }
                        }
                        if (Item->itemID==ASV_Search_Index+ASV_increment || (Item->itemID==ASV_Search_Index+ASV_increment+1 && Message_Buffer[0]=='\t')) {
                            char asv_highlight_check_buffer[64];
                            GetWindowText(AdvancedSearchNameWindow,asv_highlight_check_buffer,60);
                            uppercase(asv_highlight_check_buffer);
                            int checker_offset = 0;
                            if (Message_Buffer[2]==' ') checker_offset+=7;
                            if (Message_Buffer[3]==' ') checker_offset+=7;
                            int l = strlen(asv_highlight_check_buffer);
                            int i;
                            for (i=0;i<l;i++) {
                                if (asv_highlight_check_buffer[i]!=Message_Buffer[i+checker_offset]) break;
                            }
                            if (i==l && Message_Buffer[i+checker_offset]=='\t') {
                                SetTextColor(Item->hDC,White);
                                SetBkColor(Item->hDC, Purple);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Purple_Brush);
                            }
                        }
                        if (Message_Buffer[0]=='-' || Message_Buffer[0]=='+' || Message_Buffer[0]=='|') {
                            HDC bitmap_source = CreateCompatibleDC(Item->hDC);
                            if (Message_Buffer[0]=='-') {
                                SetTextColor(Item->hDC,Red);
                                SelectObject(bitmap_source,BALISE_REJECTED);
                            } else if (Message_Buffer[0]=='+') {
                                SetTextColor(Item->hDC,Neon_Green);
                                SelectObject(bitmap_source,BALISE_ACCEPTED);
                            } else {
                                SetTextColor(Item->hDC,Very_Dark_Gray);
                                SelectObject(bitmap_source,BALISE_NC);
                            }
                            if (Message_Buffer[1]!='-') {
                                Item->rcItem.left+=25;
                                BitBlt(Item->hDC,3,Item->rcItem.top,17,17,bitmap_source,0,0,SRCCOPY);
                            }
                            DeleteDC(bitmap_source);
                            TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)&Message_Buffer[1],len,11,(LPINT)&DetailsWindow_Tabs,140);
                        } else TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,11,(LPINT)&DetailsWindow_Tabs,140);
                        if (hbm!=NULL) {
                            GetObject(hbm,sizeof( BITMAP ),&bm);
                            SelectObject(bitmap_source,hbm);
                            BitBlt(Item->hDC,250,Item->rcItem.top+(2*y_scale),bm.bmWidth,bm.bmHeight,bitmap_source,0,0,SRCCOPY);
                        }
                        DeleteDC(bitmap_source);
                    } else if (Item->hwndItem==FolderViewWindow) {
                        index = SendMessage(FolderViewWindow,LB_GETITEMDATA,Item->itemID,0);
                        if (Item->itemState & ODS_FOCUS || Item->itemState & ODS_SELECTED) {
                            SetTextColor(Item->hDC, White);
                            if (index==16 || index==17) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                            else if (index==FILE_TYPE_JRU || index==FILE_TYPE_JRUFORCE) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Neon_Green_Brush);
                            else if (index==FILE_TYPE_JRUBL3) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Dark_Green_Brush);
                            else if (index==FILE_TYPE_JRUZIP) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Purple_Brush);
                            else if (index==FILE_TYPE_JRUTBF) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Orange_Brush);
                            else if (index==FILE_TYPE_BRUSOLO) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gold_Brush);
                            else FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Black_Brush);
                            if (index==16 || index==17) SetBkColor(Item->hDC, Cyan);
                            else if (index==FILE_TYPE_JRU || index==FILE_TYPE_JRUFORCE) SetBkColor(Item->hDC, Neon_Green);
                            else if (index==FILE_TYPE_JRUBL3) SetBkColor(Item->hDC, Dark_Green);
                            else if (index==FILE_TYPE_JRUZIP) SetBkColor(Item->hDC, Purple);
                            else if (index==FILE_TYPE_JRUTBF) SetBkColor(Item->hDC, Orange);
                            else if (index==FILE_TYPE_BRUSOLO) SetBkColor(Item->hDC, Gold);
                            else SetBkColor(Item->hDC, Black);
                        } else {
                            if (index==16 || index==17) SetTextColor(Item->hDC, Cyan);
                            else if (index==FILE_TYPE_JRU || index==FILE_TYPE_JRUFORCE) SetTextColor(Item->hDC, Neon_Green);
                            else if (index==FILE_TYPE_JRUBL3) SetTextColor(Item->hDC, Dark_Green);
                            else if (index==FILE_TYPE_JRUZIP) SetTextColor(Item->hDC, Purple);
                            else if (index==FILE_TYPE_JRUTBF) SetTextColor(Item->hDC, Orange);
                            else if (index==FILE_TYPE_BRUSOLO) SetTextColor(Item->hDC, Gold);
                            else SetTextColor(Item->hDC, Black);
                            if (night_mode) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush); else FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                            if (night_mode) SetBkColor(Item->hDC, Gray); else SetBkColor(Item->hDC, White);
                        }
                        HDC bitmap_source = CreateCompatibleDC(Item->hDC);
                        if (index==16 || index==17) SelectObject(bitmap_source,FOLDERICON);
                        else if (index<=FILE_TYPE_JRU && index>=FILE_TYPE_JRUBL3) SelectObject(bitmap_source,JRUICON);
                        else if (index==FILE_TYPE_JRUZIP) {
                            SelectObject(bitmap_source,JRUZIPICON);
                            len-=4;
                        }
                        else if (index==FILE_TYPE_JRUTBF) SelectObject(bitmap_source,JRUTBFICON);
                        else if (index==FILE_TYPE_BRUSOLO) SelectObject(bitmap_source,JRUBRUICON);
                        else SelectObject(bitmap_source,FILEICON);
                        if (len>100) len = 100;

                        if (index==FILE_TYPE_JRU || index==FILE_TYPE_JRUZIP) {len+=5; JRU_filename_deconstruct(Message_Buffer);}
                        Item->rcItem.left+=25;
                        BitBlt(Item->hDC,3,Item->rcItem.top+1,17,17,bitmap_source,0,0,SRCCOPY);
                        DeleteDC(bitmap_source);
                        Message_Buffer[len]='\0';
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,2,(LPINT)&FolderViewWindow_Tabs,10);
                    } else if (Item->hwndItem==LogListWindow) {
                        index = Message_Buffer[0]-'0';
                        if (index==LOG_INFO) {
                            if (Item->itemState & ODS_FOCUS) {
                                SetTextColor(Item->hDC, White);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                                SetBkColor(Item->hDC, Cyan);
                            } else {
                                SetTextColor(Item->hDC, Cyan);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                                SetBkColor(Item->hDC, White);
                            }
                        } else if (index==LOG_SUCCESS) {
                            if (Item->itemState & ODS_FOCUS) {
                                SetTextColor(Item->hDC, White);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Lime_Brush);
                                SetBkColor(Item->hDC, Lime);
                            } else {
                                SetTextColor(Item->hDC, Lime);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                                SetBkColor(Item->hDC, White);
                            }
                        } else if (index==LOG_WARNING) {
                            if (Item->itemState & ODS_FOCUS) {
                                SetTextColor(Item->hDC, White);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Orange_Brush);
                                SetBkColor(Item->hDC, Orange);
                            } else {
                                SetTextColor(Item->hDC, Orange);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                                SetBkColor(Item->hDC, White);
                            }
                        } else if (index==LOG_ERROR) {
                            if (Item->itemState & ODS_FOCUS) {
                                SetTextColor(Item->hDC, White);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Red_Brush);
                                SetBkColor(Item->hDC, Red);
                            } else {
                                SetTextColor(Item->hDC, Red);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                                SetBkColor(Item->hDC, White);
                            }
                        }
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)&Message_Buffer[1],len-1);
                    } else if (Item->hwndItem==MediaListWindow) {
                        if (Item->itemState & ODS_SELECTED) {
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Orange_Brush);
                            SetBkColor(Item->hDC, Orange);
                            SetTextColor(Item->hDC, White);
                        } else {
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                            SetBkColor(Item->hDC, White);
                            SetTextColor(Item->hDC, Orange);
                        }
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len);
                    } else if (Item->hwndItem==HeadersWindow) {
                        if (Item->itemState & ODS_SELECTED) {
                            if (night_mode) FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Peach_Brush); else FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Main_Brush);
                            if (night_mode) SetBkColor(Item->hDC, Peach); else SetBkColor(Item->hDC, Main);
                            SetTextColor(Item->hDC, White);
                        } else {
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)WHITE_BRUSH);
                            if (night_mode) {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush);
                                SetBkColor(Item->hDC, Gray);
                            }  else {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                                SetBkColor(Item->hDC, White);
                            }
                            if (night_mode) SetTextColor(Item->hDC, Peach); else SetTextColor(Item->hDC, Main);
                        }
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len);
                    } else if (Item->hwndItem==PacketListWindow_1 || Item->hwndItem==PacketListWindow_2 ||Item->hwndItem==MessageListWindow_1 ||Item->hwndItem==MessageListWindow_2) {
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len);
                    } else if (Item->hwndItem==TrainListWindow) {
                        if (Item->itemState & ODS_SELECTED) {
                            SetBkColor(Item->hDC, Azure);
                            SetTextColor(Item->hDC, White);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Azure_Brush);
                        } else {
                            SetBkColor(Item->hDC, Cyan);
                            SetTextColor(Item->hDC, Black);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                        }
                        Item->rcItem.top+=3;
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,1,(LPINT)&TrainListWindow_Tabs,40);
                    }else if (Item->hwndItem==BaliseListWindow) {
                        index = SendMessage(BaliseListWindow,LB_GETITEMDATA,Item->itemID,0);
                        HDC bitmap_source = CreateCompatibleDC(Item->hDC);
                        SetBkColor(Item->hDC, Cyan);
                        if (index>4) {
                            index-=5;
                            if (index==BALISE_UNEXPECTED) SelectObject(bitmap_source,CYAN_INACTIVE_BALISE_L); else SelectObject(bitmap_source,CYAN_ACTIVE_BALISE_L);
                        } else {
                            if (index==BALISE_UNEXPECTED) SelectObject(bitmap_source,CYAN_INACTIVE_BALISE_R); else SelectObject(bitmap_source,CYAN_ACTIVE_BALISE_R);
                        }
                        if (Item->itemState & ODS_SELECTED) {
                            SetBkColor(Item->hDC, Main);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Main_Brush);
                        } else {
                            SetBkColor(Item->hDC, Cyan);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                        }
                        if (Message_Buffer[len-1]=='0') {
                            Message_Buffer[len-1]='N';
                            Message_Buffer[len]='C';
                            Message_Buffer[len+1]='\0';
                            len+=1;
                        }
                        Item->rcItem.left+=25;
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,4,(LPINT)&BaliseListWindow_Tabs,40);
                        BitBlt(Item->hDC,5,Item->rcItem.top+4,12,12,bitmap_source,0,0,SRCCOPY);
                        DeleteDC(bitmap_source);
                    } else if (Item->hwndItem==MAWindow) {
                        SetBkColor(Item->hDC, Cyan);
                        if (Message_Buffer[0]=='N') SetTextColor(Item->hDC, Red); else SetTextColor(Item->hDC, Neon_Green);
                        HDC bitmap_source = CreateCompatibleDC(Item->hDC);
                        if (Item->itemID==0) {
                            SetTextColor(Item->hDC, Blue);
                            Item->rcItem.top+=5;
                            Item->rcItem.left+=5;
                        } else {
                            Item->rcItem.left+=33;
                            Item->rcItem.top+=10;
                        }
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,1,(LPINT)&MAWindow_Tabs,50);
                        if (Item->itemID==1) {
                            SelectObject(bitmap_source,SPEEDOMETER);
                            BitBlt(Item->hDC,5,27,24,17,bitmap_source,0,0,SRCCOPY);
                            SelectObject(bitmap_source,DISTANCE_BMP);
                            BitBlt(Item->hDC,90,27,22,14,bitmap_source,0,0,SRCCOPY);
                        }
                        DeleteDC(bitmap_source);
                    } else if (Item->hwndItem==CSVSettingsList1Window) {
                        Item->rcItem.bottom+=3;
                        if (Item->itemState & ODS_FOCUS || Item->itemState & ODS_SELECTED) {
                            SetBkColor(Item->hDC, Green);
                            SetTextColor(Item->hDC, White);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Green_Brush);
                        } else {
                            SetBkColor(Item->hDC, Cyan);
                            SetTextColor(Item->hDC, Green);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                        }
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len);
                    } else if (Item->hwndItem==CSVSettingsList2Window) {
                        Item->rcItem.bottom+=3;
                        if (Item->itemState & ODS_FOCUS || Item->itemState & ODS_SELECTED) {
                            SetBkColor(Item->hDC, Red);
                            SetTextColor(Item->hDC, White);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Red_Brush);
                        } else {
                            SetBkColor(Item->hDC, Cyan);
                            SetTextColor(Item->hDC, Red);
                            FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                        }
                        TextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len);
                    } else if (Item->hwndItem==LinkingWindow) {
                        SetBkColor(Item->hDC, Cyan);
                        if (Message_Buffer[0]=='1') SetTextColor(Item->hDC, Neon_Green);
                        else if (Message_Buffer[0]=='0') SetTextColor(Item->hDC, Orange);
                        else if (Message_Buffer[0]=='2') SetTextColor(Item->hDC, Red);
                        else SetTextColor(Item->hDC, Blue);
                        if (Item->itemID>0) {
                            index = SendMessage(LinkingWindow,LB_GETITEMDATA,Item->itemID,0);
                            Item->rcItem.left+=25;
                            HDC bitmap_source = CreateCompatibleDC(Item->hDC);
                            if (index) SelectObject(bitmap_source,CYAN_ACTIVE_BALISE_R); else SelectObject(bitmap_source,CYAN_ACTIVE_BALISE_L);

                            BitBlt(Item->hDC,5,Item->rcItem.top+2,12,12,bitmap_source,0,0,SRCCOPY);
                            DeleteDC(bitmap_source);
                        } else {
                            Item->rcItem.left+=5;
                            Item->rcItem.top+=5;
                        }
                        TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)&Message_Buffer[1],len,1,(LPINT)&LinkingWindow_Tabs,70);
                    } else if (Item->hwndItem==SequenceListWindow1 || Item->hwndItem==SequenceListWindow2) {
                        int sequence_item_data = SendMessage(Item->hwndItem,LB_GETITEMDATA,Item->itemID,0);
                        if (Item->itemState & ODS_FOCUS || Item->itemState & ODS_SELECTED) {
                            if (Message_Buffer[0]=='6') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Cyan_Brush);
                                SetBkColor(Item->hDC, Cyan);
                            } else if (Message_Buffer[0]=='9') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Green_Brush);
                                SetBkColor(Item->hDC, Green);
                            } else if (Message_Buffer[0]=='8') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Peach_Brush);
                                SetBkColor(Item->hDC, Peach);
                            } else if (Message_Buffer[0]=='3') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Red_Brush);
                                SetBkColor(Item->hDC, Red);
                            } else if (Message_Buffer[0]=='1') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Purple_Brush);
                                SetBkColor(Item->hDC, Purple);
                            } else if (Message_Buffer[0]=='2') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Blue_Brush);
                                SetBkColor(Item->hDC, Blue);
                            } else if (Message_Buffer[0]=='4') {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Lime_Brush);
                                SetBkColor(Item->hDC, Lime);
                            } else {
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Black_Brush);
                                SetBkColor(Item->hDC, Black);
                            }
                            SetTextColor(Item->hDC, White);
                        } else {
                            if (night_mode) {
                                SetBkColor(Item->hDC, Gray);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)Gray_Brush);
                            } else {
                                SetBkColor(Item->hDC, White);
                                FillRect(Item->hDC, &Item->rcItem, (HBRUSH)White_Brush);
                            }
                            if (Message_Buffer[0]=='6') SetTextColor(Item->hDC, Cyan);
                            else if (Message_Buffer[0]=='9') SetTextColor(Item->hDC, Green);
                            else if (Message_Buffer[0]=='8') SetTextColor(Item->hDC, Peach);
                            else if (Message_Buffer[0]=='3') SetTextColor(Item->hDC, Red);
                            else if (Message_Buffer[0]=='1') SetTextColor(Item->hDC, Purple);
                            else if (Message_Buffer[0]=='2') SetTextColor(Item->hDC, Blue);
                            else if (Message_Buffer[0]=='4') SetTextColor(Item->hDC, Lime);
                            else SetTextColor(Item->hDC, Black);
                        }
                        Item->rcItem.left+=3;
                        if (Message_Buffer[0]<=57 && Message_Buffer[0]>=48) {
                            Message_Buffer[0]=7;
                            TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,1,(LPINT)&SequenceWindow_Tabs,30);
                        } else {
                            if (sequence_item_data>=0) Item->rcItem.left+=3;
                            if (sequence_item_data==0) Item->rcItem.left+=15;
                            TabbedTextOut(Item->hDC,Item->rcItem.left, Item->rcItem.top,(LPCSTR)Message_Buffer,len,2,(LPINT)&SequenceWindow_Tabs_details,30);
                        }
                    }
                }
            return TRUE;
        case WM_ERASEBKGND:
            return true;
        case WM_PAINT:
            hdc = BeginPaint (hwndm, &ps);
            HFONT Old_Font;
            if (hwndm!=GameWindow) {
                GetClientRect(hwndm, &rect);
                SetBkMode(hdc,TRANSPARENT);
                Old_Font = SelectObject(hdc,Main_Font);
            }
            if (hwndm==VehicleWindow) {

            } else if (hwndm==MainCSVSettingsWindow) {
                SetBkColor(hdc,Gray);
                SelectObject(hdc,NOMINAL_PEN);
                FillRect(hdc,&ps.rcPaint,Main_Brush);
                TextOut(hdc,22,30,"INCLUDED MESSAGES",17);
                TextOut(hdc,413,30,"EXCLUDED MESSAGES",17);
            } else if (hwndm==MainHelpWindow) {
                SetBkColor(hdc,Gray);
                FillRect(hdc,&ps.rcPaint,Main_Brush);
                SelectObject(hdc,NOMINAL_PEN);
                RECT B_RECT;
                B_RECT.top = 36;
                B_RECT.bottom = ps.rcPaint.bottom;
                B_RECT.left = ps.rcPaint.left;
                B_RECT.right = ps.rcPaint.right;
                FillRect(hdc,&B_RECT,Gray_Brush);
                TextOut(hdc,420,75,"DESCRIBE THE BUG HERE",21);
                TextOut(hdc,270,50,"The LOG file and a screenshot of the main screen will be added to your report",77);
            } else if (hwndm==SequenceWindow) {
                FillRect(hdc,&ps.rcPaint,Main_Brush);
            } else if (hwndm==ColorChartMainWindow) {
                FillRect(hdc,&ps.rcPaint,Dark_Gray_Brush);
                HDC bitmap_source;
                bitmap_source = CreateCompatibleDC(hdc);
                SelectObject(bitmap_source,PALETTE);
                BitBlt(hdc,15,15,250,250,bitmap_source,0,0,SRCCOPY);
                DeleteDC(bitmap_source);
                EndPaint(hwndm, &ps);
            } else if (hwndm==MainTrainListWindow) {
                FillRect(hdc,&ps.rcPaint,Gray_Brush);
                TextOut(hdc,0,0,"TRAIN",5);
                TextOut(hdc,81,0,"DATE",4);
            } else if (hwndm==MainBaliseListWindow) {
                FillRect(hdc,&ps.rcPaint,Gray_Brush);
                TextOut(hdc,25,0,"NID_C",5);
                TextOut(hdc,81,0,"NID_BG",6);
                TextOut(hdc,142,0,"DECISION",8);
                TextOut(hdc,248,0,"DATE",4);
                TextOut(hdc,305,0,"TRAIN",5);
            } else if (hwndm==MediaSelectionWindow) {
                FillRect(hdc,&ps.rcPaint,Main_Brush);
                TextOut(hdc,0,0, "Available medias",16);
                TextOut(hdc,0,175, "Media starting point",20);
            }
//            else if (hwndm==GameWindow) {
//                SetBkColor(hdc,Odometer_Cyan);
//                int i,j;
//                int length = 1400/(game_columns-5);
//                int height = 400/game_rows;
//                HDC bitmap_source;
//                bitmap_source = CreateCompatibleDC(hdc);
//                BitBlt(hdc,-game_panorama_offset,0,3000*x_scale,450*y_scale,game_panorama_dc,0,0,SRCCOPY);
//                for (i=0;i<game_rows;i++) {
//                    for (j=0;j<game_columns;j++) {
//                        if (game_setup[i][j]>=game_part_track) {
//                            if (game_setup[i][j]==game_part_track) TransparentBlt(hdc,(length*j-game_train_pos_offset)*x_scale,(height*i+10)*y_scale,length*x_scale+1,10*y_scale,game_track_dc,0,0,length*x_scale+1,10*y_scale,Main);
//                            else if (game_setup[i][j]==game_part_bonus) TransparentBlt(hdc,(length*j-game_train_pos_offset)*x_scale,(height*i+10)*y_scale,length*x_scale+1,10*y_scale,game_bonus_dc,0,0,length*x_scale+1,10*y_scale,Main);
//                            else if (game_setup[i][j]==game_part_malus) TransparentBlt(hdc,(length*j-game_train_pos_offset)*x_scale,(height*i+10)*y_scale,length*x_scale+1,10*y_scale,game_malus_dc,0,0,length*x_scale+1,10*y_scale,Main);
//                        } else if (game_setup[i][j]<=game_part_train) {
//                            TransparentBlt(hdc,(length*j-game_train_pos_offset)*x_scale,(height*i+10)*y_scale,length*x_scale+1,10*y_scale,game_track_dc,0,0,length*x_scale+1,10*y_scale,Main);
//                            if (game_setup[i][j]==game_part_train) SelectObject(bitmap_source,THALYS);
//                            if (game_setup[i][j]==game_part_train-1) SelectObject(bitmap_source,ITALO);
//                            if (game_setup[i][j]==game_part_train-2) SelectObject(bitmap_source,TGV);
//                            if (game_setup[i][j]==game_part_train-3) SelectObject(bitmap_source,IZY);
//                            if (game_setup[i][j]==game_part_train-4) SelectObject(bitmap_source,DUPLEX);
//                            if (game_setup[i][j]==game_part_train-5) SelectObject(bitmap_source,ICE);
//                            if (game_setup[i][j]==game_part_train-6) SelectObject(bitmap_source,EUROSTAR);
//                            if (game_setup[i][j]==game_part_train-7) SelectObject(bitmap_source,TRAINSNCB);
//                            if (game_setup[i][j]==game_part_train-8) SelectObject(bitmap_source,TRAINNS);
//                            if (game_setup[i][j]==game_part_train-9) SelectObject(bitmap_source,TRAINDB);
//                            if (game_setup[i][j]==game_part_train-10) SelectObject(bitmap_source,OUIGO);
//                            TransparentBlt(hdc,(length*j-game_train_pos_offset)*x_scale,(height*i+10)*y_scale,46*x_scale,10*y_scale,bitmap_source,0,0,46*x_scale,10*y_scale,Main);
//                        }
//                    }
//                }
//                SelectObject(bitmap_source,SELECTED_TRAIN);
//                TransparentBlt(hdc,game_train_pos_x*x_scale,(height*game_train_pos_y+10)*y_scale,46*x_scale,10*y_scale,bitmap_source,0,0,46*x_scale,10*y_scale,Main);
//                TransparentBlt(hdc,0,380*y_scale,55*x_scale,55*y_scale,game_speedometer_dc,0,0,55*x_scale,55*y_scale,Main);
//
//                game_train_pos.top = (height*game_train_pos_y+10)*y_scale;
//                game_train_pos.left = game_train_pos_x*x_scale;
//                game_train_pos.right = game_train_pos.left+46*x_scale;
//                game_train_pos.bottom = game_train_pos.top+10*y_scale;
//                sprintf(Window_Buffer,"%03d",(int)(game_distance/1000));
//                TextOut(hdc,65*x_scale,387*y_scale,&Window_Buffer[0],1);
//                TextOut(hdc,78*x_scale,387*y_scale,&Window_Buffer[1],1);
//                TextOut(hdc,91*x_scale,387*y_scale,&Window_Buffer[2],1);
//                sprintf(Window_Buffer,"%03d",(int)(game_distance%1000));
//                TextOut(hdc,65*x_scale,407*y_scale,&Window_Buffer[0],1);
//                TextOut(hdc,78*x_scale,407*y_scale,&Window_Buffer[1],1);
//                TextOut(hdc,91*x_scale,407*y_scale,&Window_Buffer[2],1);
//                TransparentBlt(hdc,55*x_scale,380*y_scale,70*x_scale,55*y_scale,game_odometer_dc,0,0,70*x_scale,55*y_scale,Main);
//                DeleteDC(bitmap_source);
//                EndPaint(hwndm, &ps);
//                return true;
//            }
             else if (hwndm==SpeedProfileWindow) {
                int train, previous_train;
                int balise_y = 10;
                if (sdtrack_left==0) previous_train = -MAX_ASV_SEARCH; else previous_train = Message_Details_Storage[SendMessage(MessageWindow,LB_GETITEMDATA,sdtrack_left-1,0)-train_detail_offset];
                SelectObject(hdc,NOMINAL_PEN);
                FillRect(hdc,&ps.rcPaint,Main_Brush);
                unsigned long long sd_message;
                unsigned long long sd_distance;
                HDC bitmap_source;
                bitmap_source = CreateCompatibleDC(hdc);
                SelectObject(bitmap_source,SD_BACKGROUND);
                BitBlt(hdc,0,0,1480*x_scale,450*y_scale,bitmap_source,0,0,SRCCOPY);

                int sd_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,sdtrack_left,0);
                int sd_y = (400*y_scale)-Message_Details_Storage[sd_details_position-speed_detail_offset];
                int reference_x;
                int initial_mode = Message_Details_Storage[sd_details_position-mode_detail_offset];
                int initial_level = Message_Details_Storage[sd_details_position-level_detail_offset];
                int initial_mode_pos = 50*x_scale;

                if (initial_level==0) SelectObject(hdc,RED_PEN);
                else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                else SelectObject(hdc,GRAY_PEN);

                int new_mode,new_level;
                MoveToEx(hdc,(50*x_scale),sd_y,NULL);
                for (sd_message=sdtrack_left;sd_message<=sdtrack_right;sd_message++) {

                    SetTextColor(hdc,Red);
                    sd_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,sd_message,0);
                    sd_y = (400*y_scale)-Message_Details_Storage[sd_details_position-speed_detail_offset];
                    sd_distance = ((1300*x_scale)*((Distance_Storage[sd_message]-Distance_Storage[sdtrack_left])/3600)/SDTRACK_ZOOM);
                    if (sd_distance<0) sd_distance=0;
                    if (sd_distance>(1300*x_scale)) sd_distance=(1300*x_scale);
                    LineTo(hdc,(50*x_scale)+sd_distance,sd_y);

                    new_mode = Message_Details_Storage[sd_details_position-mode_detail_offset];
                    new_level = Message_Details_Storage[sd_details_position-level_detail_offset];
                    if (new_mode!=initial_mode || sd_message==sdtrack_right) {
                        if (initial_mode==0) SelectObject(hdc,GREEN_PEN);
                        else if (initial_mode==13) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_mode==7 || initial_mode==8) SelectObject(hdc,RED_PEN);
                        else if (initial_mode==5 || initial_mode==6) SelectObject(hdc,GRAY_PEN);
                        else SelectObject(hdc,PURPLE_PEN);
                        MoveToEx(hdc,initial_mode_pos,435,NULL);
                        LineTo(hdc,(50*x_scale)+sd_distance,435);
                        initial_mode = new_mode;
                        initial_mode_pos = (50*x_scale)+sd_distance;
                        if (initial_level==0) SelectObject(hdc,RED_PEN);
                        else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                        else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                        else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                        else SelectObject(hdc,GRAY_PEN);
                    }
                    if (new_level!=initial_level || sd_message==sdtrack_right) {
                        initial_level = new_level;
                        if (initial_level==0) SelectObject(hdc,RED_PEN);
                        else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                        else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                        else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                        else SelectObject(hdc,GRAY_PEN);
                    }
                    MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                    train = Message_Details_Storage[sd_details_position-train_detail_offset];
                    if (Message_Details_Storage[sd_details_position-id_detail_offset]==3 && Message_Details_Storage[sd_details_position]==1 && Message_Details_Storage[sd_details_position-speed_detail_offset]>0) {
                        sprintf(Window_Buffer,"EB");
                        TextOut(hdc,(53*x_scale)+sd_distance,balise_y,Window_Buffer,strlen(Window_Buffer));
                        SelectObject(hdc,RED_PEN);
                        LineTo(hdc,(50*x_scale)+sd_distance,balise_y+8);
                        if (initial_level==0) SelectObject(hdc,RED_PEN);
                        else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                        else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                        else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                        else SelectObject(hdc,GRAY_PEN);
                        MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                    }
                    SetTextColor(hdc,Blue);
                    if (train!=previous_train && train>10) {
                        sprintf(Window_Buffer,"%d",train);
                        TextOut(hdc,(53*x_scale)+sd_distance,balise_y,Window_Buffer,strlen(Window_Buffer));
                        if (sd_message!=sdtrack_left) {
                            SelectObject(hdc,NOMINAL_PEN);
                            LineTo(hdc,(50*x_scale)+sd_distance,balise_y+8);
                            if (initial_level==0) SelectObject(hdc,RED_PEN);
                            else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                            else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                            else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                            else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                            else SelectObject(hdc,GRAY_PEN);
                            MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                        }
//                        balise_y+=10; if (balise_y==50) balise_y=10;
                    }
                    SetTextColor(hdc,Green);
                    if (sd_message==Message_Position) {
                        SelectObject(bitmap_source,SELECTED_TRAIN);
                        BitBlt(hdc,4+sd_distance,405*y_scale,46*x_scale,10*y_scale,bitmap_source,0,0,SRCCOPY);
                        sprintf(Window_Buffer,"%03d",Message_Details_Storage[sd_details_position-speed_detail_offset]);
                        TextOut(hdc,(10*x_scale),sd_y,Window_Buffer,strlen(Window_Buffer));
                        TextOut(hdc,33*x_scale,sd_y-13,"__",2);
                        TextOut(hdc,(48*x_scale)+sd_distance,399,"|",1);
                        SelectObject(hdc,NEW_BLACK_PEN);
                        MoveToEx(hdc,50*x_scale,sd_y,NULL);
                        LineTo(hdc,(50*x_scale)+sd_distance,sd_y);
                        LineTo(hdc,(50*x_scale)+sd_distance,400);
                        MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                        if (initial_level==0) SelectObject(hdc,RED_PEN);
                        else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                        else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                        else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                        else SelectObject(hdc,GRAY_PEN);
                        if (Reference_Message>=0) {
                            SelectObject(hdc,DOTTED_ORANGE_PEN);
                            MoveToEx(hdc,(50*x_scale)+sd_distance,410*x_scale,NULL);
                            reference_x = (50*x_scale)+((1300*x_scale)*(Distance_Storage[Reference_Message]-Distance_Storage[sdtrack_left])/3600/SDTRACK_ZOOM);
                            if (Reference_Message<sdtrack_left) reference_x=50*x_scale;
                            if (Reference_Message>sdtrack_right) reference_x=1350*x_scale;
                            LineTo(hdc,reference_x,410*x_scale);
                            if (initial_level==0) SelectObject(hdc,RED_PEN);
                            else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                            else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                            else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                            else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                            else SelectObject(hdc,GRAY_PEN);
                            MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                        }
                    }
                    if (Reference_Message==sd_message) {
                        SelectObject(hdc,ORANGE_PEN);
                        MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                        LineTo(hdc,(50*x_scale)+sd_distance,410*x_scale);
                        if (initial_level==0) SelectObject(hdc,RED_PEN);
                        else if (initial_level<-1000) SelectObject(hdc,ORANGE_PEN);
                        else if (initial_level==2) SelectObject(hdc,CYAN_PEN);
                        else if (initial_level==3) SelectObject(hdc,GREEN_PEN);
                        else if (initial_level==4) SelectObject(hdc,PURPLE_PEN);
                        else SelectObject(hdc,GRAY_PEN);
                        MoveToEx(hdc,(50*x_scale)+sd_distance,sd_y,NULL);
                    }
                    previous_train = train;
                }
                SetTextColor(hdc,Purple);
                sprintf(Window_Buffer,"%I64u km",SDTRACK_ZOOM/10000);
                TextOut(hdc,56*x_scale,400*y_scale,Window_Buffer,strlen(Window_Buffer));
                DeleteDC(bitmap_source);
            } else if (hwndm==MainWindow) {
                FillRect(hdc,&ps.rcPaint,Main_Brush);
                HDC bitmap_source;
                bitmap_source = CreateCompatibleDC(hdc);
                SelectObject(bitmap_source,MESSAGE_HEADER);
                StretchBlt(hdc,15*x_scale,26*y_scale,1449*x_scale,45*y_scale,bitmap_source,0,0,2174,66,SRCCOPY);
                DeleteDC(bitmap_source);
                TextOut(hdc,25*x_scale,954*y_scale, "Copyrights Ugo CHEMLAL : 2015-2099",34);
                TextOut(hdc,1515*x_scale,90*y_scale,"On-Board Linking",16);
                TextOut(hdc,1530*x_scale,245*y_scale,"Track Free",10);
                TextOut(hdc,1470*x_scale,580*y_scale,"Message",7);
                TextOut(hdc,1470*x_scale,620*y_scale,"Date",4);
                TextOut(hdc,1470*x_scale,660*y_scale,"Train",5);
                TextOut(hdc,1626*x_scale,660*y_scale,"Speed",5);
                TextOut(hdc,1470*x_scale,700*y_scale,"Packet",6);
                TextOut(hdc,1570*x_scale,700*y_scale,"Radio Message",13);
                TextOut(hdc,1470*x_scale,740*y_scale,"Balise",6);
                TextOut(hdc,1582*x_scale,740*y_scale,"Linked Balise",13);
                TextOut(hdc,1470*x_scale,780*y_scale,"Variable",8);
                TextOut(hdc,1630*x_scale,780*y_scale,"Value",5);
                TextOut(hdc,1470*x_scale,820*y_scale,"Mode",4);
                TextOut(hdc,1630*x_scale,820*y_scale,"Level",6);
                TextOut(hdc,1568*x_scale,837*y_scale,"-",1);
                TextOut(hdc,1568*x_scale,797*y_scale,"-",1);
                TextOut(hdc,1568*x_scale,757*y_scale,"-",1);
                TextOut(hdc,1568*x_scale,717*y_scale,"-",1);
                TextOut(hdc,400*x_scale,518*y_scale,"Reference",10);
                TextOut(hdc,600*x_scale,525*y_scale,"Elapsed time : ",14);
                TextOut(hdc,850*x_scale,525*y_scale,"Distance : ",10);
                TextOut(hdc,1100*x_scale,525*y_scale,"Average speed : ",16);
                TextOut(hdc,1320*x_scale,525*y_scale,"Start / Stop : ",14);
                TextOut(hdc,1366*x_scale,545*y_scale,"Day : ",5);
            } else if (hwndm==VTRACKWindow) {
                HDC bitmap_source;
                bitmap_source = CreateCompatibleDC(hdc);
                int i,j,k;
                int nid_c = Message_Details_Storage[Details_Position-last_nid_c_offset];
                int balise = Message_Details_Storage[Details_Position-last_balise_offset];
                int direction = Message_Details_Storage[Details_Position-last_balise_direction_offset];
                int message_id = Message_Details_Storage[Details_Position-id_detail_offset];
                int balise_index = Message_Details_Storage[Details_Position-balise_storage_index];
                int vtrack_x,vtrack_x_p5,vtrack_xz,vtrack_y,vtrack_z,vtrack_yz;
                int vtrack_id,troncon_length;
                int packet_5_search_start=-1;
                int next_balise_color_B,next_balise_color_R;
                if (nid_c==89) vtrack_id = VTrack_balise_89(balise);
                else if (nid_c==128) vtrack_id = VTrack_balise_128(balise);
                else if (nid_c==154) vtrack_id = VTrack_balise_154(balise);
                else if (nid_c==253) vtrack_id = VTrack_balise_253(balise);
                else if (nid_c==254) vtrack_id = VTrack_balise_254(balise);
                else if (nid_c==255) vtrack_id = VTrack_balise_255(balise);
                else if (nid_c==426) vtrack_id = VTrack_balise_426(balise);
                else if (nid_c==427) vtrack_id = VTrack_balise_427(balise);
                else if (nid_c==428) vtrack_id = VTrack_balise_428(balise);
                else vtrack_id = 0;

                paint_balise_direction = ((direction * vtrack_id)>0);

                if (vtrack_id==0) {
                    if (balise>0) SelectObject(bitmap_source,NOVISUAL); else SelectObject(bitmap_source,NOTYETVISUAL);
                    BitBlt(hdc,0,0,1450*x_scale,450*y_scale,bitmap_source,0,0,SRCCOPY);
                    DeleteDC(bitmap_source);
                    sprintf(Window_Buffer,"Balise group %d-%d",nid_c,balise);
                    if (balise!=0) TextOut(hdc,200,200,Window_Buffer,strlen(Window_Buffer));
                    SelectObject(hdc,Old_Font);
                    EndPaint (hwndm, &ps);
                    return 0;
                }

                vtrack_x = 58*(abs(vtrack_id%2000)-12);
                vtrack_y = (int)(abs(vtrack_id)/2000);
                if (vtrack_y<9) vtrack_z = 0;
                else if (vtrack_y<11) vtrack_z = 53;
                else if (vtrack_y<13) vtrack_z = 106;
                else if (vtrack_y<15) vtrack_z = 159;
                else if (vtrack_y<19) vtrack_z = 212;
                else if (vtrack_y<21) vtrack_z = 265;
                else if (vtrack_y<23) vtrack_z = 318;
                else if (vtrack_y<25) vtrack_z = 371;
                else vtrack_z = 424;

                SelectObject(bitmap_source,TRACK);
                StretchBlt(hdc,0,0,1450*x_scale,848*y_scale,bitmap_source,vtrack_x,vtrack_z,1450,848,SRCCOPY);

                if (!Key_Is_Down) {
                    for (i=0;i<=Max_Number_Of_Balise_Visual;i++) {
                        if (shift) j=balise_index-i; else j=balise_index+i;
                        Balise_X_Storage[i]=0;
                        Balise_Y_Storage[i]=0;
                        if (j<0) continue;
                        if (j>Balise_Count) continue;
                        int path_nid_c = Message_Details_Storage[Balise_Storage[j]+7];
                        int path_bg = Message_Details_Storage[Balise_Storage[j]+8];
                        int decision = Message_Details_Storage[Balise_Storage[j]+10];
                        int path_vtrack_id = 0,path_vtrack_x,path_vtrack_y,path_vtrack_yz;
                        if (path_nid_c==89) path_vtrack_id = VTrack_balise_89(path_bg);
                        else if (path_nid_c==128) path_vtrack_id = VTrack_balise_128(path_bg);
                        else if (path_nid_c==154) path_vtrack_id = VTrack_balise_154(path_bg);
                        else if (path_nid_c==253) path_vtrack_id = VTrack_balise_253(path_bg);
                        else if (path_nid_c==254) path_vtrack_id = VTrack_balise_254(path_bg);
                        else if (path_nid_c==255) path_vtrack_id = VTrack_balise_255(path_bg);
                        else if (path_nid_c==426) path_vtrack_id = VTrack_balise_426(path_bg);
                        else if (path_nid_c==427) path_vtrack_id = VTrack_balise_427(path_bg);
                        else if (path_nid_c==428) path_vtrack_id = VTrack_balise_428(path_bg);
                        path_vtrack_x = 58*(abs(path_vtrack_id%2000)-12);
                        path_vtrack_y = (int)(abs(path_vtrack_id)/2000);
                        path_vtrack_yz = 53*(int)((path_vtrack_y-1)/2)-vtrack_z;
                        if (path_vtrack_y%2) path_vtrack_yz+=17; else path_vtrack_yz+=33;
                        if (path_vtrack_id>0) {
                            if (decision==BALISE_UNEXPECTED) SelectObject(bitmap_source,INACTIVE_BALISE_R); else SelectObject(bitmap_source,ACTIVE_BALISE_R);
                        } else {
                            if (decision==BALISE_UNEXPECTED) SelectObject(bitmap_source,INACTIVE_BALISE_L); else SelectObject(bitmap_source,ACTIVE_BALISE_L);
                        }
                        Balise_X_Storage[i]=711+(path_vtrack_x-vtrack_x);
                        Balise_Y_Storage[i]=(path_vtrack_yz);
                        Balise_X_Storage[i]*=x_scale;
                        Balise_Y_Storage[i]*=y_scale;
//                        TransparentBlt(hdc,Balise_X_Storage[i],Balise_Y_Storage[i],12*x_scale,12*y_scale,bitmap_source,0,0,12*x_scale,12*y_scale,White);
                        if (Balise_Details_Position_72[j]>0) {
                            for (k=0;k<Message_Details_Storage[Balise_Details_Position_72[j]];k++) {
                                Window_Buffer[k] = Message_Details_Storage[Balise_Details_Position_72[j]+k+1];
                            }
                            Window_Buffer[k]='\0';
                            TextOut(hdc,Balise_X_Storage[i]+(5*x_scale),0,Window_Buffer,strlen(Window_Buffer));
                            MoveToEx(hdc,Balise_X_Storage[i],Balise_Y_Storage[i],NULL);
                            LineTo(hdc,Balise_X_Storage[i],0);
                        }
                        if (Balise_Details_Position_79[j]>0) {
                            sprintf(Window_Buffer,"%d.%03d",Message_Details_Storage[Balise_Details_Position_79[j]]/1000,Message_Details_Storage[Balise_Details_Position_79[j]]-(1000*(int)(Message_Details_Storage[Balise_Details_Position_79[j]]/1000)));
                            TextOut(hdc,Balise_X_Storage[i]+5*x_scale,15*y_scale,Window_Buffer,strlen(Window_Buffer));
                            MoveToEx(hdc,Balise_X_Storage[i],Balise_Y_Storage[i],NULL);
                            LineTo(hdc,Balise_X_Storage[i],15*y_scale);
                        }
                    }
                    Track_Is_Redrawn=true;
                } else Track_Is_Redrawn=false;

                vtrack_yz = 53*(int)((vtrack_y-1)/2)-vtrack_z;
                if (vtrack_y%2) vtrack_yz+=18; else vtrack_yz+=33;
                if (paint_balise_direction) SelectObject(bitmap_source,SELECTED_TRAIN); else SelectObject(bitmap_source,SELECTED_TRAIN_R);
                if (paint_balise_direction) vtrack_xz = (message_id==6)?666:676; else vtrack_xz = (message_id==6)?722:712;
//                TransparentBlt(hdc,(int)(vtrack_xz*x_scale),(int)(vtrack_yz*y_scale),(int)(46*x_scale),(int)(10*y_scale),bitmap_source,0,0,(46*x_scale),(10*y_scale),Main);

                int packet_5_search_index=0,packet_5_distance=0;
                float packet_5_scale;
                int vtrack_yz_memor = vtrack_yz;

                if (message_id==6 || message_id==9) {
                    int p_136_nid_c,p_136_nid_bg,p_136_id,p_136_x,p_136_y,p_136_yz;
                    if (!Key_Is_Down) {
                        int newcountry_offset=0;
                        for (i=Details_Position;i<Details_End_Point;i++) {
                            if (Message_Details_Storage[i]<0 && packet_5_search_index>0) packet_5_search_start=0;
                            if (Message_Details_Storage[i]==-5) packet_5_search_start=i;
                            if (Message_Details_Storage[i]==-136) {
                                if (Message_Details_Storage[i+3]) {
                                    p_136_nid_c = Message_Details_Storage[i+4];
                                    p_136_nid_bg = Message_Details_Storage[i+5];
                                } else {
                                    p_136_nid_c = Message_Details_Storage[Details_Position-last_nid_c_offset];
                                    p_136_nid_bg = Message_Details_Storage[i+4];
                                }
                                if (p_136_nid_c==89) p_136_id = VTrack_balise_89(p_136_nid_bg);
                                else if (p_136_nid_c==128) p_136_id = VTrack_balise_128(p_136_nid_bg);
                                else if (p_136_nid_c==154) p_136_id = VTrack_balise_154(p_136_nid_bg);
                                else if (p_136_nid_c==253) p_136_id = VTrack_balise_253(p_136_nid_bg);
                                else if (p_136_nid_c==254) p_136_id = VTrack_balise_254(p_136_nid_bg);
                                else if (p_136_nid_c==255) p_136_id = VTrack_balise_255(p_136_nid_bg);
                                else if (p_136_nid_c==426) p_136_id = VTrack_balise_426(p_136_nid_bg);
                                else if (p_136_nid_c==427) p_136_id = VTrack_balise_427(p_136_nid_bg);
                                else if (p_136_nid_c==428) p_136_id = VTrack_balise_428(p_136_nid_bg);
                                else p_136_id = 0;
                                p_136_x = 58*(abs(p_136_id%2000)-12);
                                p_136_y = (int)(abs(p_136_id)/2000);
                                p_136_yz = 53*(int)((p_136_y-1)/2)-vtrack_z;
                                if (p_136_y%2) p_136_yz+=17; else p_136_yz+=33;
                                sprintf(Window_Buffer,"0 m");
                                if (p_136_y%2) p_136_yz+=6; else p_136_yz-=9;
                                TextOut(hdc,(711+(p_136_x-vtrack_x)+10)*x_scale,p_136_yz*y_scale,Window_Buffer,strlen(Window_Buffer));
                            }
                            if (Message_Details_Storage[i]==-42) {
                                Display_Nid_Radio(Window_Buffer,Message_Details_Storage[i+6],Message_Details_Storage[i+7],Message_Details_Storage[i+8],Message_Details_Storage[i+9],DetailsWindow);
                                SelectObject(bitmap_source,PHONE);
                                BitBlt(hdc,0,0,30*x_scale,30*y_scale,bitmap_source,0,0,SRCCOPY);
                                TextOut(hdc,32*x_scale,8*y_scale,Window_Buffer,strlen(Window_Buffer));
                            }
                            if (packet_5_search_start>0) {
                                packet_5_search_index = i-packet_5_search_start;
                                if (packet_5_search_index==3+newcountry_offset) packet_5_scale = pow(10,Message_Details_Storage[i]-1);
                                if ((packet_5_search_index==4+newcountry_offset) || (packet_5_search_index>=11+newcountry_offset && packet_5_search_index%6==((5+newcountry_offset)%6))) {
                                    packet_5_distance+=Message_Details_Storage[i]*packet_5_scale;
                                }
                                if ((packet_5_search_index==6+newcountry_offset) || (packet_5_search_index>=13+newcountry_offset && packet_5_search_index%6==((1+newcountry_offset)%6))) {
                                    balise = Message_Details_Storage[i];
                                    if (nid_c==89) vtrack_id = VTrack_balise_89(balise);
                                    else if (nid_c==128) vtrack_id = VTrack_balise_128(balise);
                                    else if (nid_c==154) vtrack_id = VTrack_balise_154(balise);
                                    else if (nid_c==253) vtrack_id = VTrack_balise_253(balise);
                                    else if (nid_c==254) vtrack_id = VTrack_balise_254(balise);
                                    else if (nid_c==255) vtrack_id = VTrack_balise_255(balise);
                                    else if (nid_c==426) vtrack_id = VTrack_balise_426(balise);
                                    else if (nid_c==427) vtrack_id = VTrack_balise_427(balise);
                                    else if (nid_c==428) vtrack_id = VTrack_balise_428(balise);
                                    else vtrack_id = 0;
                                    vtrack_x_p5 = 58*(abs(vtrack_id%2000)-12);
                                    vtrack_y = (int)(abs(vtrack_id)/2000);
                                    vtrack_yz = 53*(int)((vtrack_y-1)/2)-vtrack_z;
                                    if (vtrack_y%2) vtrack_yz+=17; else vtrack_yz+=33;
                                    int stored_distance = Message_Details_Storage[Details_Position-last_valid_linking_distance_offset];
                                    if (abs(stored_distance!=INTER_BALISE_DISTANCE_UNKNOWN)) sprintf(Window_Buffer,"%d m",packet_5_distance+stored_distance);
                                    else sprintf(Window_Buffer,"?? m");
                                    if (vtrack_y%2) vtrack_yz+=6; else vtrack_yz-=9;
                                    TextOut(hdc,(721+(vtrack_x_p5-vtrack_x))*x_scale,vtrack_yz*y_scale,Window_Buffer,strlen(Window_Buffer));
                                }
                                if ((packet_5_search_index==5+newcountry_offset) || (packet_5_search_index>=12+newcountry_offset && packet_5_search_index%6==(newcountry_offset%6))) {
                                    if (Message_Details_Storage[i]) {
                                        newcountry_offset++;
                                        i++; nid_c=Message_Details_Storage[i];
                                    }
                                }
                            }
                        }
                    }
                }
                if (message_id!=6) {
                    vtrack_yz = vtrack_yz_memor;
                    troncon_length=48*x_scale;
                    if (paint_balise_direction) {
                        for (i=1;i<=12;i++) {
                            next_balise_color_B = GetBValue(GetPixel(hdc,(712+58*i)*x_scale,(vtrack_yz+4)*y_scale));
                            next_balise_color_R = GetRValue(GetPixel(hdc,(712+58*i)*x_scale,(vtrack_yz+4)*y_scale));
                            if (next_balise_color_B==255 && next_balise_color_R==255) {
                                troncon_length-=24*x_scale; break;
                            }
                            else if (next_balise_color_B==0) troncon_length+=(58*x_scale);
                            else break;
                        }
                        vtrack_xz = (722*x_scale);
                    } else {
                        for (i=1;i<=12;i++) {
                            next_balise_color_B = GetBValue(GetPixel(hdc,(712-58*i)*x_scale,(vtrack_yz+4)*y_scale));
                            next_balise_color_R = GetRValue(GetPixel(hdc,(712-58*i)*x_scale,(vtrack_yz+4)*y_scale));
                            if (next_balise_color_B==255 && next_balise_color_R==255) {
                                troncon_length-=(24)*x_scale; break;
                            }
                            else if (next_balise_color_B==0) troncon_length+=(58*x_scale);
                            else break;
                        }
                        vtrack_xz = (712*x_scale)-troncon_length;
                    }
                    SelectObject(bitmap_source,TRONCON);
                    BitBlt(hdc,vtrack_xz,(vtrack_yz+4)*y_scale,troncon_length,4*y_scale,bitmap_source,0,0,SRCCOPY);
                }

                DeleteDC(bitmap_source);
            }
            SelectObject(hdc,Old_Font);
            EndPaint (hwndm, &ps);
            return 0;
        default:
            return DefWindowProc(hwndm, msg, wParam, lParam);
    }
    return 0;
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow){

    MSG Current_Message;

    sprintf(Soft_Title,"JRUGC - THIF JRU Decoding Tool - V 10.2.4-P");

    RECT MONITOR;
    HMONITOR MainMonitor,NewMonitor;
    MainMonitor = MonitorFromWindow(MainWindow,MONITOR_DEFAULTTONEAREST);
    MONITORINFO Monitor_Info;
    Monitor_Info.cbSize = sizeof(MONITORINFO);
    GetMonitorInfo(MainMonitor,&Monitor_Info);

    original_x_resolution = abs(Monitor_Info.rcWork.right-Monitor_Info.rcWork.left);
    original_y_resolution = abs(Monitor_Info.rcWork.bottom-Monitor_Info.rcWork.top);

    x_scale = (float)original_x_resolution/1680;
    y_scale = (float)original_y_resolution/1000;

    isCSVdone = false;
    CSVSequence1_is_done = false;
    CSVSequence2_is_done = false;

    bool short_started=false;
    if (strlen(lpCmdLine)) short_started=true;

    POINT pnt;

    tick_0 = GetTickCount();

//    my_vlc_instance_1 = libvlc_new(0,NULL);
//    my_vlc_instance_2 = libvlc_new(0,NULL);

    int i,j,k,l,m;
    srand(time(0));

    MessageWindow_Tabs[0]=120*x_scale;
    MessageWindow_Tabs[1]=352*x_scale;
    MessageWindow_Tabs[2]=412*x_scale;
    MessageWindow_Tabs[3]=490*x_scale;
    MessageWindow_Tabs[4]=568*x_scale;
    MessageWindow_Tabs[5]=705*x_scale;
    MessageWindow_Tabs[6]=785*x_scale;
    MessageWindow_Tabs[7]=860*x_scale;
    MessageWindow_Tabs[8]=935*x_scale;
    MessageWindow_Tabs[9]=1000*x_scale;
    MessageWindow_Tabs[10]=1080*x_scale;
    MessageWindow_Tabs[11]=1250*x_scale;

    DetailsWindow_Tabs[0]=150*x_scale;
    DetailsWindow_Tabs[1]=550*x_scale;
    LinkingWindow_Tabs[0]=55*x_scale;
    MAWindow_Tabs[0]=70*x_scale;
    BaliseListWindow_Tabs[0]=40*x_scale;
    BaliseListWindow_Tabs[1]=100*x_scale;
    BaliseListWindow_Tabs[2]=205*x_scale;
    BaliseListWindow_Tabs[3]=265*x_scale;
    TrainListWindow_Tabs[0]=40*x_scale;
    SequenceWindow_Tabs[0]=30*x_scale;
    SequenceWindow_Tabs[1]=100*x_scale;
    SequenceWindow_Tabs[2]=600*x_scale;
    SequenceWindow_Tabs_details[0]=120*x_scale;
    SequenceWindow_Tabs_details[1]=2500*x_scale;

    THALYS = ResizeBmp(LoadBitmap(hInstance,"THALYS"),0,0);
    THALYS_R = ResizeBmp(LoadBitmap(hInstance,"THALYS_R"),0,0);
    EUROSTAR = ResizeBmp(LoadBitmap(hInstance,"EUROSTAR"),0,0);
    EUROSTAR_R = ResizeBmp(LoadBitmap(hInstance,"EUROSTAR_R"),0,0);
    ICE = ResizeBmp(LoadBitmap(hInstance,"ICE"),0,0);
    ICE_R = ResizeBmp(LoadBitmap(hInstance,"ICE_R"),0,0);
    IZY = ResizeBmp(LoadBitmap(hInstance,"IZY"),0,0);
    IZY_R = ResizeBmp(LoadBitmap(hInstance,"IZY_R"),0,0);
    OUIGO = ResizeBmp(LoadBitmap(hInstance,"OUIGO"),0,0);
    OUIGO_R = ResizeBmp(LoadBitmap(hInstance,"OUIGO_R"),0,0);
    DUPLEX = ResizeBmp(LoadBitmap(hInstance,"DUPLEX"),0,0);
    DUPLEX_R = ResizeBmp(LoadBitmap(hInstance,"DUPLEX_R"),0,0);
    TGV = ResizeBmp(LoadBitmap(hInstance,"TGV"),0,0);
    TGV_R = ResizeBmp(LoadBitmap(hInstance,"TGV_R"),0,0);
    ITALO = ResizeBmp(LoadBitmap(hInstance,"ITALO"),0,0);
    ITALO_R = ResizeBmp(LoadBitmap(hInstance,"ITALO_R"),0,0);
    TRAINDB = ResizeBmp(LoadBitmap(hInstance,"TRAINDB"),0,0);
    TRAINDB_R = ResizeBmp(LoadBitmap(hInstance,"TRAINDB_R"),0,0);
    TRAINSNCB = ResizeBmp(LoadBitmap(hInstance,"TRAINSNCB"),0,0);
    TRAINSNCB_R = ResizeBmp(LoadBitmap(hInstance,"TRAINSNCB_R"),0,0);
    TRAINNS = ResizeBmp(LoadBitmap(hInstance,"TRAINNS"),0,0);
    TRAINNS_R = ResizeBmp(LoadBitmap(hInstance,"TRAINNS_R"),0,0);

    SELECTED_TRAIN = THALYS; SELECTED_TRAIN_R = THALYS_R;

    TRACK = LoadBitmap(hInstance,"TRACK");
    TRONCON = ResizeBmp(LoadBitmap(hInstance,"TRONCON"),0,0);
    NOVISUAL = ResizeBmp(LoadBitmap(hInstance,"NOVISUAL"),0,0);
    NOTYETVISUAL = ResizeBmp(LoadBitmap(hInstance,"NOTYETVISUAL"),0,0);
    ACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"ACTIVE_BALISE_ETCS_PROPRIETARY_DATAL"),0,0);
    ACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"ACTIVE_BALISE_R"),0,0);
    INACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"INACTIVE_BALISE_L"),0,0);
    INACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"INACTIVE_BALISE_R"),0,0);
    CYAN_ACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"CYAN_ACTIVE_BALISE_L"),0,0);
    CYAN_ACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"CYAN_ACTIVE_BALISE_R"),0,0);
    CYAN_INACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"CYAN_INACTIVE_BALISE_L"),0,0);
    CYAN_INACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"CYAN_INACTIVE_BALISE_R"),0,0);
    PHONE = ResizeBmp(LoadBitmap(hInstance,"PHONE"),0,0);
    EXCEL = ResizeBmp(LoadBitmap(hInstance,"EXCEL"),0,0);
    SPEEDOMETER = ResizeBmp(LoadBitmap(hInstance,"SPEEDOMETER"),0,0);
    DISTANCE_BMP = ResizeBmp(LoadBitmap(hInstance,"DISTANCE_BMP"),0,0);
    SD_BACKGROUND = ResizeBmp(LoadBitmap(hInstance,"SD_BACKGROUND"),0,0);

    VTRACK_BUTTON = ResizeBmp(LoadBitmap(hInstance,"VTRACK_BUTTON"),0,0);
    SPEED_PROFILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SPEED_PROFILE_BUTTON"),0,0);
    MESSAGE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MESSAGE_BUTTON"),0,0);
    BALISE_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"BALISE_LIST_BUTTON"),0,0);
    TRAIN_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"TRAIN_LIST_BUTTON"),0,0);
    MEDIA_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MEDIA_BUTTON"),0,0);
    PLAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PLAY_BUTTON"),0,0);
    STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"STOP_BUTTON"),0,0);
    SEARCH_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SEARCH_BUTTON"),0,0);
    FILE_EXCEL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"FILE_EXCEL_BUTTON"),0,0);
    FILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"FILE_BUTTON"),0,0);
    LAST_FILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"LAST_FILE_BUTTON"),0,0);
    SET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SET_BUTTON"),0,0);
    GOTO_BUTTON = ResizeBmp(LoadBitmap(hInstance,"GOTO_BUTTON"),0,0);
    CLEAR_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CLEAR_BUTTON"),0,0);
    SEQUENCING_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SEQUENCING_BUTTON"),0,0);
    RESET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"RESET_BUTTON"),0,0);
    COMMUTE_BUTTON_TRUE = ResizeBmp(LoadBitmap(hInstance,"COMMUTE_BUTTON_TRUE"),0,0);
    COMMUTE_BUTTON_FALSE = ResizeBmp(LoadBitmap(hInstance,"COMMUTE_BUTTON_FALSE"),0,0);
    QUIT_BUTTON = ResizeBmp(LoadBitmap(hInstance,"QUIT_BUTTON"),0,0);
    CLEARALL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CLEARALL_BUTTON"),0,0);
    PREVIOUS_START_STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PREVIOUS_START_STOP_BUTTON"),0,0);
    NEXT_START_STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"NEXT_START_STOP_BUTTON"),0,0);
    PREVIOUS_DAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PREVIOUS_DAY_BUTTON"),0,0);
    NEXT_DAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"NEXT_DAY_BUTTON"),0,0);
    CENTER_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CENTER_BUTTON"),0,0);
    MEDIA_RESET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MEDIA_RESET_BUTTON"),0,0);
    EXCEL_SETTINGS_BUTTON = ResizeBmp(LoadBitmap(hInstance,"EXCEL_SETTINGS_BUTTON"),0,0);
    CSV_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CSV_BUTTON"),0,0);
    ENLARGE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"ENLARGE_BUTTON"),0,0);
    NIGHT_MODE_TRUE = ResizeBmp(LoadBitmap(hInstance,"NIGHT_MODE_TRUE"),0,0);
    NIGHT_MODE_FALSE = ResizeBmp(LoadBitmap(hInstance,"NIGHT_MODE_FALSE"),0,0);
    PACKET_OPTION_FALSE = ResizeBmp(LoadBitmap(hInstance,"PACKET_OPTION_FALSE"),0,0);
    PACKET_OPTION_TRUE = ResizeBmp(LoadBitmap(hInstance,"PACKET_OPTION_TRUE"),0,0);
    COLOR_CHART_BUTTON = ResizeBmp(LoadBitmap(hInstance,"COLOR_CHART_BUTTON"),0,0);
    PALETTE = ResizeBmp(LoadBitmap(hInstance,"PALETTE"),0,0);

    RIGHT_ONCE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"RIGHT_ONCE_BUTTON"),0,0);
    LEFT_ONCE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"LEFT_ONCE_BUTTON"),0,0);
    RIGHT_ALL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"RIGHT_ALL_BUTTON"),0,0);
    LEFT_ALL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"LEFT_ALL_BUTTON"),0,0);

    OK_BUTTON = LoadBitmap(hInstance,"OK_BUTTON");
    REFRESH_BUTTON = LoadBitmap(hInstance,"REFRESH_BUTTON");
    MEDIA_OK_BUTTON = LoadBitmap(hInstance,"MEDIA_OK_BUTTON");
    CANCEL_BUTTON = LoadBitmap(hInstance,"CANCEL_BUTTON");
    BACK_BUTTON = LoadBitmap(hInstance,"BACK_BUTTON");
    SEQUENCE_START_BUTTON = LoadBitmap(hInstance,"SEQUENCE_START_BUTTON");
    COLLAPSE_BUTTON = LoadBitmap(hInstance,"COLLAPSE_BUTTON");
    EXPAND_BUTTON = LoadBitmap(hInstance,"EXPAND_BUTTON");
    SL_OPEN_BUTTON = LoadBitmap(hInstance,"SL_OPEN_BUTTON");

    PACKET_BUTTON_1 = LoadBitmap(hInstance,"PACKET_BUTTON_1");
    PACKET_BUTTON_2 = LoadBitmap(hInstance,"PACKET_BUTTON_2");
    MESSAGE_BUTTON_1 = LoadBitmap(hInstance,"MESSAGE_BUTTON_1");
    MESSAGE_BUTTON_2 = LoadBitmap(hInstance,"MESSAGE_BUTTON_2");
    REPORT_BUTTON = LoadBitmap(hInstance,"REPORT_BUTTON");
    SEND_REPORT_BUTTON = LoadBitmap(hInstance,"SEND_REPORT_BUTTON");
    SENDING_REPORT_BUTTON = LoadBitmap(hInstance,"SENDING_REPORT_BUTTON");
    SEND_REPORT_BUTTON_OK = LoadBitmap(hInstance,"SEND_REPORT_BUTTON_OK");
    SEND_REPORT_BUTTON_NOK = LoadBitmap(hInstance,"SEND_REPORT_BUTTON_NOK");
    LOG_BUTTON = LoadBitmap(hInstance,"LOG_BUTTON");
    HELP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"HELP_BUTTON"),0,0);

    BALISE_ACCEPTED = LoadBitmap(hInstance,"BALISE_ACCEPTED");
    BALISE_REJECTED = LoadBitmap(hInstance,"BALISE_REJECTED");
    BALISE_NC = LoadBitmap(hInstance,"BALISE_NC");
    FOLDERICON = LoadBitmap(hInstance,"FOLDERICON");
    FILEICON = LoadBitmap(hInstance,"FILEICON");
    JRUICON = LoadBitmap(hInstance,"JRUICON");
    JRUZIPICON = LoadBitmap(hInstance,"JRUZIPICON");
    JRUTBFICON = LoadBitmap(hInstance,"JRUTBFICON");
    JRUBRUICON = LoadBitmap(hInstance,"JRUBRUICON");

    BLACKBMP = LoadBitmap(hInstance,"BLACKBMP");
    PURPLEBMP = LoadBitmap(hInstance,"PURPLEBMP");
    PINKBMP = LoadBitmap(hInstance,"PINKBMP");
    LIMEBMP = LoadBitmap(hInstance,"LIMEBMP");
    BLUEBMP = LoadBitmap(hInstance,"BLUEBMP");
    CYANBMP = LoadBitmap(hInstance,"CYANBMP");
    GREENBMP = LoadBitmap(hInstance,"GREENBMP");
    PEACHBMP = LoadBitmap(hInstance,"PEACHBMP");
    REDBMP = LoadBitmap(hInstance,"REDBMP");
    BROWNBMP = LoadBitmap(hInstance,"BROWNBMP");
    LEMONBMP = LoadBitmap(hInstance,"LEMONBMP");
    LIGHTPINKBMP = LoadBitmap(hInstance,"LIGHTPINKBMP");
    SKYBMP = LoadBitmap(hInstance,"SKYBMP");
    EMERALDBMP = LoadBitmap(hInstance,"EMERALDBMP");

    VALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"VALID_DATA_FILE"),0,0);
    INVALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"INVALID_DATA_FILE"),0,0);
    PARTIAL_VALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"PARTIAL_VALID_DATA_FILE"),0,0);
    PARTIAL_INVALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"PARTIAL_INVALID_DATA_FILE"),0,0);
    NO_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"NO_DATA_FILE"),0,0);

    MESSAGE_HEADER = LoadBitmap(hInstance,"MESSAGE_HEADER");

    LE01 = LoadBitmap(hInstance,"LE01");
    LE02 = LoadBitmap(hInstance,"LE02");
    LE03 = LoadBitmap(hInstance,"LE03");
    LE04 = LoadBitmap(hInstance,"LE04");
    LE05 = LoadBitmap(hInstance,"LE05");
    LE06 = LoadBitmap(hInstance,"LE06");
    LE07 = LoadBitmap(hInstance,"LE07");
    LE08 = LoadBitmap(hInstance,"LE08");
    LE09 = LoadBitmap(hInstance,"LE09");
    LE10 = LoadBitmap(hInstance,"LE10");
    LE11 = LoadBitmap(hInstance,"LE11");
    LE12 = LoadBitmap(hInstance,"LE12");
    LE13 = LoadBitmap(hInstance,"LE13");
    LE14 = LoadBitmap(hInstance,"LE14");
    LE15 = LoadBitmap(hInstance,"LE15");
    MO01 = LoadBitmap(hInstance,"MO01");
    MO02 = LoadBitmap(hInstance,"MO02");
    MO03 = LoadBitmap(hInstance,"MO03");
    MO04 = LoadBitmap(hInstance,"MO04");
    MO05 = LoadBitmap(hInstance,"MO05");
    MO06 = LoadBitmap(hInstance,"MO06");
    MO07 = LoadBitmap(hInstance,"MO07");
    MO08 = LoadBitmap(hInstance,"MO08");
    MO09 = LoadBitmap(hInstance,"MO09");
    MO10 = LoadBitmap(hInstance,"MO10");
    MO11 = LoadBitmap(hInstance,"MO11");
    MO12 = LoadBitmap(hInstance,"MO12");
    MO13 = LoadBitmap(hInstance,"MO13");
    MO14 = LoadBitmap(hInstance,"MO14");
    MO15 = LoadBitmap(hInstance,"MO15");
    MO16 = LoadBitmap(hInstance,"MO16");
    MO17 = LoadBitmap(hInstance,"MO17");
    MO18 = LoadBitmap(hInstance,"MO18");
    MO19 = LoadBitmap(hInstance,"MO19");
    MO20 = LoadBitmap(hInstance,"MO20");
    MO21 = LoadBitmap(hInstance,"MO21");
    MO22 = LoadBitmap(hInstance,"MO22");
    ST01 = LoadBitmap(hInstance,"ST01");
    ST02 = LoadBitmap(hInstance,"ST02");
    ST03 = LoadBitmap(hInstance,"ST03");
    ST04 = LoadBitmap(hInstance,"ST04");
    ST05 = LoadBitmap(hInstance,"ST05");
    ST06 = LoadBitmap(hInstance,"ST06");
    TC01 = LoadBitmap(hInstance,"TC01");
    TC02 = LoadBitmap(hInstance,"TC02");
    TC03 = LoadBitmap(hInstance,"TC03");
    TC04 = LoadBitmap(hInstance,"TC04");
    TC05 = LoadBitmap(hInstance,"TC05");
    TC06 = LoadBitmap(hInstance,"TC06");
    TC07 = LoadBitmap(hInstance,"TC07");
    TC08 = LoadBitmap(hInstance,"TC08");
    TC09 = LoadBitmap(hInstance,"TC09");
    TC10 = LoadBitmap(hInstance,"TC10");
    TC11 = LoadBitmap(hInstance,"TC11");
    TC12 = LoadBitmap(hInstance,"TC12");
    TC13 = LoadBitmap(hInstance,"TC13");
    TC14 = LoadBitmap(hInstance,"TC14");
    TC15 = LoadBitmap(hInstance,"TC15");
    TC16 = LoadBitmap(hInstance,"TC16");
    TC17 = LoadBitmap(hInstance,"TC17");
    TC18 = LoadBitmap(hInstance,"TC18");
    TC19 = LoadBitmap(hInstance,"TC19");
    TC20 = LoadBitmap(hInstance,"TC20");
    TC21 = LoadBitmap(hInstance,"TC21");
    TC22 = LoadBitmap(hInstance,"TC22");
    TC23 = LoadBitmap(hInstance,"TC23");
    TC24 = LoadBitmap(hInstance,"TC24");
    TC25 = LoadBitmap(hInstance,"TC25");
    TC26 = LoadBitmap(hInstance,"TC26");
    TC27 = LoadBitmap(hInstance,"TC27");
    TC28 = LoadBitmap(hInstance,"TC28");
    TC29 = LoadBitmap(hInstance,"TC29");
    TC30 = LoadBitmap(hInstance,"TC30");
    TC31 = LoadBitmap(hInstance,"TC31");
    TC32 = LoadBitmap(hInstance,"TC32");
    TC33 = LoadBitmap(hInstance,"TC33");
    TC34 = LoadBitmap(hInstance,"TC34");
    TC35 = LoadBitmap(hInstance,"TC35");
    TC36 = LoadBitmap(hInstance,"TC36");
    TC37 = LoadBitmap(hInstance,"TC37");
    DR01 = LoadBitmap(hInstance,"DR01");
    DR02 = LoadBitmap(hInstance,"DR02");
    DR03 = LoadBitmap(hInstance,"DR03");
    DR04 = LoadBitmap(hInstance,"DR04");
    DR05 = LoadBitmap(hInstance,"DR05");
    LX01 = LoadBitmap(hInstance,"LX01");
    LS01 = LoadBitmap(hInstance,"LS01");

    GAME_PART_TRACK = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_TRACK"),0,0);
    GAME_PART_BONUS = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_BONUS"),0,0);
    GAME_PART_MALUS = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_MALUS"),0,0);
    PANORAMA = ResizeBmp(LoadBitmap(hInstance,"PANORAMA"),0,0);
    GAME_SPEEDOMETER_40 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_40"),0,0);
    GAME_SPEEDOMETER_60 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_60"),0,0);
    GAME_SPEEDOMETER_80 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_80"),0,0);
    GAME_SPEEDOMETER_100 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_100"),0,0);
    GAME_SPEEDOMETER_120 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_120"),0,0);
    GAME_SPEEDOMETER_140 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_140"),0,0);
    GAME_SPEEDOMETER_160 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_160"),0,0);
    GAME_SPEEDOMETER_180 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_180"),0,0);
    GAME_SPEEDOMETER_200 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_200"),0,0);
    GAME_SPEEDOMETER_220 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_220"),0,0);
    GAME_SPEEDOMETER_240 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_240"),0,0);
    GAME_SPEEDOMETER_260 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_260"),0,0);
    GAME_SPEEDOMETER_280 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_280"),0,0);
    GAME_SPEEDOMETER_300 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_300"),0,0);
    GAME_ODOMETER = ResizeBmp(LoadBitmap(hInstance,"GAME_ODOMETER"),0,0);

    TTX_OKAY = LoadBitmap(hInstance,"TTX_OKAY");
    TTX_NOK = LoadBitmap(hInstance,"TTX_NOK");
    TTX_NOTYET = LoadBitmap(hInstance,"TTX_NOTYET");
    TTX_EXPIRED = LoadBitmap(hInstance,"TTX_EXPIRED");
    TTX_MISSING = LoadBitmap(hInstance,"TTX_MISSING");

    game_track_dc = CreateCompatibleDC(game_DC);
    game_bonus_dc = CreateCompatibleDC(game_DC);
    game_malus_dc = CreateCompatibleDC(game_DC);
    game_panorama_dc = CreateCompatibleDC(game_DC);
    game_speedometer_dc = CreateCompatibleDC(game_DC);
    game_odometer_dc = CreateCompatibleDC(game_DC);
    SelectObject(game_track_dc,GAME_PART_TRACK);
    SelectObject(game_bonus_dc,GAME_PART_BONUS);
    SelectObject(game_malus_dc,GAME_PART_MALUS);
    SelectObject(game_panorama_dc,PANORAMA);
    SelectObject(game_odometer_dc,GAME_ODOMETER);

    game_setup_init();
    game_dashboard.top = 409*y_scale;
    game_dashboard.bottom = 428*y_scale;
    game_dashboard.left = 64*x_scale;
    game_dashboard.right = 100*x_scale;

    RED_MAP = RGB(255,216,216);
    BLUE_MAP = RGB(229,244,255);
    YELLOW_MAP = RGB(255,242,178);
    PURPLE_MAP = RGB(219,206,255);
    Light_Purple = RGB(185,115,255);
    Brown = RGB(137,0,34);
    Neon_Green = RGB(0,255,90);
    Orange_Edit = RGB(255,173,92);

    Dark_Purple = RGB(255,0,255);
    Green_Edit = RGB(92,255,97);
    White = RGB(255,255,255);
    Purple = RGB(157,0,255);
    Pink = RGB(255,90,215);
    Light_Pink = RGB(255,135,163);
    Lime = RGB(90,255,150);
    Lemon = RGB(172,147,255);
    Sky = RGB(130,238,255);
    Blue = RGB(0,0,255);
    Cyan = RGB(0,200,255);
    Green = RGB(0,255,33);
    Peach = RGB(255,175,0);
    Red = RGB(255,0,0);
    Black = RGB(0,0,0);
    Gray = RGB(120,120,120);
    Purple = RGB(157,0,255);
    Azure = RGB(51,153,255);
    Dark_Green = RGB(0,255,0);
    Orange = RGB(255,106,0);
    Dark_Orange = RGB(230,50,2);
    Purple_Edit = RGB(211,145,255);
    Purple = RGB(157,0,255);
    Dark_Gray = RGB(235,235,235);
    Medium_Gray = RGB(175,175,175);
    Gold = RGB(255,225,0);
    Very_Dark_Gray = RGB(128,128,128);
    Emerald = RGB(147,255,183);
    Odometer_Cyan = RGB(143,228,239);
    Thalys_Red = RGB(174,24,53);

    int iterations,iterations_bis,switcher,switcher_bis;

    Gray_Brush = CreateSolidBrush(Gray);

    Brown_Brush = CreateSolidBrush(Brown);
    Green_Edit_Brush =  CreateSolidBrush(Green_Edit);
    Orange_Edit_Brush = CreateSolidBrush(Orange_Edit);
    Purple_Edit_Brush = CreateSolidBrush(Purple_Edit);
    Purple_Brush = CreateSolidBrush(Purple);
    Pink_Brush = CreateSolidBrush(Pink);
    Lime_Brush = CreateSolidBrush(Lime);
    Blue_Brush = CreateSolidBrush(Blue);
    Cyan_Brush = CreateSolidBrush(Cyan);
    Green_Brush = CreateSolidBrush(Green);
    Red_Brush = CreateSolidBrush(Red);
    Black_Brush = CreateSolidBrush(Black);
    Azure_Brush = CreateSolidBrush(Azure);
    Dark_Gray_Brush = CreateSolidBrush(Dark_Gray);
    Medium_Gray_Brush = CreateSolidBrush(Medium_Gray);
    White_Brush = CreateSolidBrush(White);
    Orange_Brush = CreateSolidBrush(Orange);
    Peach_Brush = CreateSolidBrush(Peach);
    Neon_Green_Brush = CreateSolidBrush(Neon_Green);
    Gold_Brush = CreateSolidBrush(Gold);
    Light_Pink_Brush = CreateSolidBrush(Light_Pink);
    Lemon_Brush = CreateSolidBrush(Lemon);
    Sky_Brush = CreateSolidBrush(Sky);
    Emerald_Brush = CreateSolidBrush(Emerald);
    Dark_Green_Brush = CreateSolidBrush(Dark_Green);
    Yellow_Map_Brush = CreateSolidBrush(YELLOW_MAP);

    NOMINAL_PEN = CreatePen(PS_SOLID,1,Blue);
    ORANGE_PEN = CreatePen(PS_SOLID,2,Orange_Edit);
    DOTTED_ORANGE_PEN = CreatePen(PS_DOT,1,Orange_Edit);
    CYAN_PEN = CreatePen(PS_SOLID,2,Cyan);
    PURPLE_PEN = CreatePen(PS_SOLID,2,Purple);
    RED_PEN = CreatePen(PS_SOLID,2,Red);
    GREEN_PEN = CreatePen(PS_SOLID,2,Neon_Green);
    GRAY_PEN = CreatePen(PS_SOLID,2,Gray);
    NEW_BLACK_PEN = CreatePen(PS_SOLID,1,Black);

    WNDCLASSEX wc;
    HWND Current_Window;
    MSG Peek_Message;
    unsigned long long Current_Time;
    unsigned long long Reference_Time;
    unsigned long long Reference_Distance;
    unsigned long long Delta_Time;
    unsigned long long Delta_Distance;
    unsigned long long Average_Speed;

//    bool Media_Center_Request = false;

    int Delta_Hour;
    int Delta_Minute;
    int Delta_Second;
    float q_scale;

    int current_message_speed;
    int current_message_version;

    int Search_Message,Search_Header;

    Main_Font = CreateFont(15*y_scale,6*x_scale,0,0,600,FALSE,FALSE,FALSE,ANSI_CHARSET,OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY, DEFAULT_PITCH,TEXT("Arial"));
    Medium_Font = CreateFont(14*y_scale,5*x_scale,0,0,600,FALSE,FALSE,FALSE,ANSI_CHARSET,OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY, DEFAULT_PITCH,TEXT("Arial"));

    char* DistanceWindow_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (DistanceWindow_Buffer==NULL) {log_it(LOG_ERROR,"DistanceWindow_Buffer","",-1);}
    char* TimeWindow_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (TimeWindow_Buffer==NULL) {log_it(LOG_ERROR,"TimeWindow_Buffer","",-1);}
    char* SpeedWindow_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (SpeedWindow_Buffer==NULL) {log_it(LOG_ERROR,"SpeedWindow_Buffer","",-1);}
    char* Message_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Message_Search_Buffer==NULL) {log_it(LOG_ERROR,"Message_Search_Buffer","",-1);}
    char* Date_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Date_Search_Buffer==NULL) {log_it(LOG_ERROR,"Date_Search_Buffer","",-1);}
    char* Train_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Train_Search_Buffer==NULL) {log_it(LOG_ERROR,"Train_Search_Buffer","",-1);}
    char* Balise_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Balise_Search_Buffer==NULL) {log_it(LOG_ERROR,"Balise_Search_Buffer","",-1);}
    char* Linked_Balise_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Linked_Balise_Search_Buffer==NULL) {log_it(LOG_ERROR,"Linked_Balise_Search_Buffer","",-1);}
    char* Packet_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Packet_Search_Buffer==NULL) {log_it(LOG_ERROR,"Packet_Search_Buffer","",-1);}
    char* Radio_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Radio_Search_Buffer==NULL) {log_it(LOG_ERROR,"Radio_Search_Buffer","",-1);}
    char* Speed_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Speed_Search_Buffer==NULL) {log_it(LOG_ERROR,"Speed_Search_Buffer","",-1);}
    char* Level_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Level_Search_Buffer==NULL) {log_it(LOG_ERROR,"Level_Search_Buffer","",-1);}
    char* Mode_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (Mode_Search_Buffer==NULL) {log_it(LOG_ERROR,"Mode_Search_Buffer","",-1);}
    char* ASV_Name_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (ASV_Name_Search_Buffer==NULL) {log_it(LOG_ERROR,"ASV_Name_Search_Buffer","",-1);}
    char* ASV_Value_Search_Buffer = malloc(Search_Buffer_Size*sizeof(char)); if (ASV_Value_Search_Buffer==NULL) {log_it(LOG_ERROR,"ASV_Value_Search_Buffer","",-1);}

    Inter_Balise_Distance = malloc(3*Max_Inter_Balise_Distances*sizeof(int)); if (Inter_Balise_Distance==NULL) {log_it(LOG_ERROR,"Inter_Balise_Distance","",-1);}

    executable_path_buffer = malloc(Path_Buffer_Size*sizeof(char)); if (executable_path_buffer==NULL) {log_it(LOG_ERROR,"executable_path_buffer","",-1);}
    LBG_Command_Buffer = malloc(CSV_Command_Buffer_Size*sizeof(char)); if (LBG_Command_Buffer==NULL) {log_it(LOG_ERROR,"LBG_Command_Buffer","",-1);}
    CSV_Command_Buffer = malloc(CSV_Command_Buffer_Size*sizeof(char)); if (CSV_Command_Buffer==NULL) {log_it(LOG_ERROR,"CSV_Command_Buffer","",-1);}
    SL1_Command_Buffer = malloc(CSV_Command_Buffer_Size*sizeof(char)); if (SL1_Command_Buffer==NULL) {log_it(LOG_ERROR,"SL1_Command_Buffer","",-1);}
    SL2_Command_Buffer = malloc(CSV_Command_Buffer_Size*sizeof(char)); if (SL2_Command_Buffer==NULL) {log_it(LOG_ERROR,"SL2_Command_Buffer","",-1);}
    command_buffer = malloc(CSV_Command_Buffer_Size*sizeof(char)); if (command_buffer==NULL) {log_it(LOG_ERROR,"command_buffer","",-1);}
    current_file_buffer = malloc(Path_Buffer_Size*sizeof(char)); if (current_file_buffer==NULL) {log_it(LOG_ERROR,"command_buffer","",-1);}

    ASV_Buffer = malloc(ASV_location_size*100*sizeof(char)); if (ASV_Buffer==NULL) {log_it(LOG_ERROR,"ASV_Buffer","",-1);}

    int Search_Progress,Mode_Search,Level_Search,Radio_Search,Train_Search,Id_Search,Search_Day,Search_Month,Search_Year,Balise_Search,Nid_c_Search,Linked_Balise_Search,Packet_Search,Speed_Search,Current_Details_Search_Position,Current_Details_Search_End_Position;
    bool Radio_Search_Check,Message_Search_Check,Date_Search_Check,Train_Search_Check,Balise_Search_Check,Nid_c_Search_Check,Linked_Balise_Search_Check,Packet_Search_Check,Speed_Search_Check,Level_Search_Check,Mode_Search_Check,ASV_check;

    Window_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (Window_Buffer==NULL) {log_it(LOG_ERROR,"Window_Buffer","",-1);}
    Error_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (Error_Buffer==NULL) {log_it(LOG_ERROR,"Error_Buffer","",-1);}
    Iterations_Buffer = malloc(Window_Buffer_Size*sizeof(char)); if (Iterations_Buffer==NULL) {log_it(LOG_ERROR,"Iterations_Buffer","",-1);}
    Separator_Buffer = malloc(Separator_Size*sizeof(char)); if (Separator_Buffer==NULL) {log_it(LOG_ERROR,"Separator_Buffer","",-1);}
    sprintf(Separator_Buffer,"----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");

    Master_Bluffer = malloc(Master_Bluffer_Size*sizeof(char)); if (Master_Bluffer==NULL) {log_it(LOG_ERROR,"Master_Bluffer","",-1);}
    Path_Buffer = malloc(Path_Buffer_Size*sizeof(char)); if (Path_Buffer==NULL) {log_it(LOG_ERROR,"Path_Buffer","",-1);}
    Remanent_Path_Buffer = malloc(Path_Buffer_Size*sizeof(char)); if (Remanent_Path_Buffer==NULL) {log_it(LOG_ERROR,"Remanent_Path_Buffer","",-1);}
    Filename_Buffer = malloc(Path_Buffer_Size*sizeof(char)); if (Filename_Buffer==NULL) {log_it(LOG_ERROR,"Filename_Buffer","",-1);}
    Hexdec_Buffer = malloc(32*sizeof(char)); if (Hexdec_Buffer==NULL) {log_it(LOG_ERROR,"Hexdec_Buffer","",-1);}
    Message_Buffer = malloc(Message_Buffer_Size*sizeof(char)); if (Message_Buffer==NULL) {log_it(LOG_ERROR,"Message_Buffer","",-1);}
    Current_Message_Buffer = malloc(Message_Buffer_Size*sizeof(char)); if (Current_Message_Buffer==NULL) {log_it(LOG_ERROR,"Current_Message_Buffer","",-1);}
    Current_Search_Buffer = malloc(Message_Buffer_Size*sizeof(char)); if (Current_Search_Buffer==NULL) {log_it(LOG_ERROR,"Current_Search_Buffer","",-1);}
    Current_Packet_Buffer = malloc(30*sizeof(char)); if (Current_Packet_Buffer==NULL) {log_it(LOG_ERROR,"Current_Packet_Buffer","",-1);}

    getcwd(Path_Buffer,Path_Buffer_Size-1);

    sprintf(LBG_Command_Buffer,"%s\\LBG.csv",Path_Buffer);
    sprintf(CSV_Command_Buffer,"%s\\CSV.csv",Path_Buffer);
    sprintf(SL1_Command_Buffer,"%s\\SL1.csv",Path_Buffer);
    sprintf(SL2_Command_Buffer,"%s\\SL2.csv",Path_Buffer);

    wc.cbSize        = sizeof(WNDCLASSEX);
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hInstance;
    wc.hIcon         = LoadIcon(hInstance,"MAINICON");
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW+1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = g_szClassName;
    wc.hIconSm       = LoadIcon(hInstance,"MAINICON");
    RegisterClassEx(&wc);

    time_t Now = time(0);
    struct tm* Today = localtime(&Now);

    if ((SETTINGS_FILE = fopen("settings.ugc","r+")) == NULL) {
        SETTINGS_FILE = fopen("settings.ugc","w+");
        Init_Settings();
    }
    if (!Check_Settings()) {
        Init_Settings();
    }

    fseek(SETTINGS_FILE,-12,SEEK_END);

    main_R = 100*(fgetc(SETTINGS_FILE)-48)+10*(fgetc(SETTINGS_FILE)-48)+fgetc(SETTINGS_FILE)-48;
    main_G = 100*(fgetc(SETTINGS_FILE)-48)+10*(fgetc(SETTINGS_FILE)-48)+fgetc(SETTINGS_FILE)-48;
    main_B = 100*(fgetc(SETTINGS_FILE)-48)+10*(fgetc(SETTINGS_FILE)-48)+fgetc(SETTINGS_FILE)-48;
    color_saturation = 100*(fgetc(SETTINGS_FILE)-48)+10*(fgetc(SETTINGS_FILE)-48)+fgetc(SETTINGS_FILE)-48;
    Main = RGB(color_saturation*main_R/100,color_saturation*main_G/100,color_saturation*main_B/100);
    Main_Brush = CreateSolidBrush(Main);

    MainWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,Soft_Title,WS_CLIPCHILDREN| WS_OVERLAPPEDWINDOW|WS_MAXIMIZE,0, 0, 1700*x_scale, 1000*y_scale,NULL, NULL, hInstance, NULL);
    MessageWindow = CreateWindowEx(0,"LISTBOX" ,"Data",WS_CHILD |WS_VSCROLL | WS_BORDER | WS_SIZEBOX | LBS_USETABSTOPS | LBS_NOTIFY | LBS_HASSTRINGS | LBS_OWNERDRAWFIXED,15*x_scale,70*y_scale,1450*x_scale,450*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    HeadersWindow = CreateWindowEx(0,"LISTBOX" ,"Sub_data",WS_CHILD |WS_HSCROLL |WS_VSCROLL |WS_BORDER|WS_THICKFRAME | LBS_USETABSTOPS | LBS_NOINTEGRALHEIGHT | LBS_NOTIFY | LBS_OWNERDRAWFIXED |LBS_HASSTRINGS,15*x_scale,580*y_scale,300*x_scale,370*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    DetailsWindow = CreateWindowEx(0,"LISTBOX" ,"Details",WS_CHILD |WS_HSCROLL |WS_VSCROLL |WS_BORDER|WS_THICKFRAME | LBS_USETABSTOPS | LBS_NOINTEGRALHEIGHT | LBS_NOTIFY | LBS_OWNERDRAWVARIABLE |LBS_HASSTRINGS | LBS_NOSEL,350*x_scale,580*y_scale,1116*x_scale,370*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ProgressBarWindow = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER | PBS_SMOOTH,15*x_scale,15*y_scale,1450*x_scale,10*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    QuitButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","QUIT",BS_BITMAP|WS_CHILD |WS_BORDER,1595*x_scale,5*y_scale,75*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ClearAllButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","CLEAR",BS_BITMAP|WS_CHILD |WS_BORDER,1515*x_scale,5*y_scale,75*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    NightModeWindow = CreateWindowEx((DWORD)0,"BUTTON","NIGHT_MODE",BS_BITMAP|WS_CHILD |WS_BORDER,1470*x_scale,5*y_scale,40*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    VehicleWindow = CreateWindowEx((DWORD)0,"Static","",SS_CENTER|WS_CHILD|SS_LEFT|WS_BORDER,1496*x_scale,40*y_scale,174*x_scale,40*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ValidDataWindow = CreateWindowEx((DWORD)0,"Static","",SS_BITMAP|SS_CENTERIMAGE|WS_CHILD |WS_BORDER,1470*x_scale,40*y_scale,26*x_scale,40*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    TimeWindow = CreateWindowEx((DWORD)0,"Static","No Reference",SS_CENTER|WS_CHILD |WS_BORDER,600*x_scale,545*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    DistanceWindow = CreateWindowEx((DWORD)0,"Static","No Reference",SS_CENTER|WS_CHILD |WS_BORDER,850*x_scale,545*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SpeedWindow = CreateWindowEx((DWORD)0,"Static","No Reference",SS_CENTER|WS_CHILD |WS_BORDER,1100*x_scale,545*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SetButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Set",BS_BITMAP|WS_CHILD |WS_BORDER,350*x_scale,535*y_scale,50*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    GoToButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","GoTo",BS_BITMAP|WS_CHILD |WS_BORDER,410*x_scale,535*y_scale,50*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ClearButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Clear",BS_BITMAP|WS_CHILD |WS_BORDER,470*x_scale,535*y_scale,50*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SequencingButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Sequencing",BS_BITMAP|WS_CHILD |WS_BORDER,350*x_scale,557*y_scale,170*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    LineWindow = CreateWindowEx((DWORD)0,"Static","",WS_CHILD |WS_BORDER,15*x_scale,545*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    TrackInformationWindow = CreateWindowEx((DWORD)0,"Static","",WS_CHILD |WS_BORDER,15*x_scale,520*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SearchButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Rechercher",WS_CHILD |WS_BORDER | BS_BITMAP,1470*x_scale,880*y_scale,80*x_scale,35*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SearchProgressWindow = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER |PBS_SMOOTH,1470*x_scale,918*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SearchResetWindow = CreateWindowEx((DWORD)0,"BUTTON","Reset",BS_BITMAP|WS_CHILD |WS_BORDER,1560*x_scale,880*y_scale,50*x_scale,35*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SearchCommuteWindow = CreateWindowEx((DWORD)0,"BUTTON","Reset",BS_BITMAP|WS_CHILD |WS_BORDER,1620*x_scale,880*y_scale,50*x_scale,35*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    CSVListExportButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,1505*x_scale,531*y_scale,33*x_scale,33*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    CSVListSettingsButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,1470*x_scale,531*y_scale,33*x_scale,33*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    CSVListExportProgressWindow = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER |PBS_SMOOTH,1470*x_scale,566*y_scale,200*x_scale,10*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    CSVListOpenCSVButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,1540*x_scale,531*y_scale,130*x_scale,33*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    MainBufferSaturationBar = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER | PBS_SMOOTH | PBS_VERTICAL,1*x_scale,70*y_scale,13*x_scale,80*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    MessageSaturationBar = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER | PBS_SMOOTH | PBS_VERTICAL,1*x_scale,170*y_scale,13*x_scale,80*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    DetailsSaturationBar = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER | PBS_SMOOTH | PBS_VERTICAL,1*x_scale,270*y_scale,13*x_scale,80*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    MainCSVSettingsWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Excel Export Settings",WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,150, 150, 800, 450,NULL, NULL, hInstance, NULL);
    CSVSettingsList1Window = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,20,50,350,300,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsList2Window = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,410,50,350,300,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsLeftOnceButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,373,125,35,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsLeftAllButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,373,165,35,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsRightOnceButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,373,205,35,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsRightAllButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,373,245,35,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsSwitchPacketOptionButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_PUSHBUTTON | BS_BITMAP|WS_CHILD |WS_BORDER,20,350,35,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);
    CSVSettingsTextBox = CreateWindowEx((DWORD)0,"Static","",SS_CENTERIMAGE|SS_CENTER | WS_CHILD |WS_BORDER,55,350,315,35,MainCSVSettingsWindow,(HMENU) NULL,hInstance,NULL);

    MainFolderWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Folder selection",WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,150, 150, 1000, 700,NULL, NULL, hInstance, NULL);
    DecodeButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","File Selection",BS_BITMAP|WS_CHILD |WS_BORDER,1470*x_scale,494*y_scale,160*x_scale,35*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    LastFileButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Last File",BS_BITMAP|WS_CHILD |WS_BORDER,1635*x_scale,494*y_scale,35*x_scale,35*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    FolderEditWindow = CreateWindowEx(0,"EDIT","",WS_CHILD |WS_BORDER,50,610,750,35,MainFolderWindow,(HMENU) NULL,hInstance,NULL);
    FolderViewWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL |WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS | LBS_SORT,0,0,980,620,MainFolderWindow,(HMENU) NULL,hInstance,NULL);
    FolderOkWindow = CreateWindowEx(0,"BUTTON","OK",BS_BITMAP|WS_CHILD |WS_BORDER,930,610,50,35,MainFolderWindow,(HMENU) NULL,hInstance,NULL);
    FolderRefreshWindow = CreateWindowEx(0,"BUTTON","REFRESH",BS_BITMAP|WS_CHILD |WS_BORDER,800,610,50,35,MainFolderWindow,(HMENU) NULL,hInstance,NULL);
    FolderCancelWindow = CreateWindowEx(0,"BUTTON","Cancel",BS_BITMAP|WS_CHILD |WS_BORDER,850,610,80,35,MainFolderWindow,(HMENU) NULL,hInstance,NULL);
    FolderBackWindow = CreateWindowEx(0,"BUTTON","<<",BS_BITMAP|WS_CHILD|WS_BORDER,0,610,50,35,MainFolderWindow,(HMENU) NULL,hInstance,NULL);

    MessageSearchWindow = CreateWindowEx((DWORD)0,"COMBOBOX","",CBS_DISABLENOSCROLL|CBS_AUTOHSCROLL|CBS_DROPDOWN|WS_CHILD |WS_BORDER|WS_VSCROLL,1470*x_scale,595*y_scale,200*x_scale,350*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    DateSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1470*x_scale,635*y_scale,200*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    TrainSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1470*x_scale,675*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SpeedSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1580*x_scale,675*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    PacketSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1470*x_scale,715*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    RadioSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1580*x_scale,715*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    BaliseSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1470*x_scale,755*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    LinkedBaliseSearchWindow = CreateWindowEx((DWORD)0,"EDIT","",WS_CHILD |WS_BORDER,1580*x_scale,755*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    AdvancedSearchNameWindow = CreateWindowEx((DWORD)0,"EDIT","",ES_AUTOHSCROLL|WS_CHILD |WS_BORDER,1470*x_scale,795*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    AdvancedSearchValueWindow = CreateWindowEx((DWORD)0,"EDIT","",ES_AUTOHSCROLL|WS_CHILD |WS_BORDER,1580*x_scale,795*y_scale,90*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    LevelSearchWindow = CreateWindowEx((DWORD)0,"COMBOBOX","",CBS_DROPDOWN|WS_CHILD |WS_BORDER,1580*x_scale,835*y_scale,90*x_scale,100*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ModeSearchWindow = CreateWindowEx((DWORD)0,"COMBOBOX","",CBS_DROPDOWN|WS_CHILD |WS_BORDER,1470*x_scale,835*y_scale,90*x_scale,500*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    PreviousStartStopSearchWidow = CreateWindowEx((DWORD)0,"BUTTON","<",BS_BITMAP|WS_CHILD |WS_BORDER,1405*x_scale,525*y_scale,25*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    NextStartStopSearchWindow = CreateWindowEx((DWORD)0,"BUTTON",">",BS_BITMAP|WS_CHILD |WS_BORDER,1430*x_scale,525*y_scale,25*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    PreviousDaySearchWindow = CreateWindowEx((DWORD)0,"BUTTON","<",BS_BITMAP|WS_CHILD |WS_BORDER,1405*x_scale,545*y_scale,25*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    NextDaySearchWindow = CreateWindowEx((DWORD)0,"BUTTON",">",BS_BITMAP|WS_CHILD |WS_BORDER,1430*x_scale,545*y_scale,25*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    VTRACKButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Track Profile",BS_CHECKBOX|BS_PUSHLIKE|WS_CHILD |WS_BORDER|BS_BITMAP,1465*x_scale,368*y_scale,35*x_scale,40*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    VTRACKWindow = CreateWindowEx(0,g_szClassName,"",WS_CHILD|WS_BORDER|WS_THICKFRAME ,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    VTRACKListWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_BORDER | LBS_USETABSTOPS | LBS_NOTIFY | LBS_HASSTRINGS | LBS_OWNERDRAWFIXED | WS_THICKFRAME,15*x_scale,470*y_scale,1450*x_scale,0,MainWindow,(HMENU) NULL,hInstance,NULL);

    MediaWindow_1 = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Media display",WS_OVERLAPPED | WS_CAPTION |WS_MINIMIZEBOX|WS_SYSMENU|WS_THICKFRAME,0, 0, 1000*x_scale, 700*y_scale,NULL, NULL, hInstance, NULL);
    MediaWindow_2 = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Media display",WS_OVERLAPPED | WS_CAPTION |WS_MINIMIZEBOX|WS_SYSMENU|WS_THICKFRAME,678*x_scale, 300*y_scale, 1000*x_scale, 700*y_scale,NULL, NULL, hInstance, NULL);
    MediaSelectionWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Media selection",WS_OVERLAPPED | WS_CAPTION |WS_MINIMIZEBOX|WS_SYSMENU|WS_THICKFRAME,150, 150, 800, 275,NULL, NULL, hInstance, NULL);
    MediaListWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_THICKFRAME|WS_CHILD |WS_VSCROLL |WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS |LBS_MULTIPLESEL,0,20,800,170,MediaSelectionWindow,(HMENU) NULL,hInstance,NULL);
    MediaStartWindow = CreateWindowEx(0,DATETIMEPICK_CLASS,"Media starting point",WS_BORDER|WS_CHILD|WS_VISIBLE,0,200,240,25,MediaSelectionWindow,NULL,hInstance,NULL);
    MediaOkWindow = CreateWindowEx(0,"BUTTON","OK",BS_BITMAP|WS_BORDER|WS_CHILD|WS_VISIBLE,240,198,40,28,MediaSelectionWindow,NULL,hInstance,NULL);
    MediaButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Media",WS_CHILD |WS_BORDER|BS_BITMAP,1515*x_scale,415*y_scale,120*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    MediaInfoWindow = CreateWindowEx(0,"Static","  Media controls",WS_CHILD |WS_BORDER,1520*x_scale,445*y_scale,115*x_scale,45*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    PlayButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","P",WS_CHILD | BS_BITMAP,1540*x_scale,470*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    StopButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","S",WS_CHILD | BS_BITMAP,1560*x_scale,470*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    CenterButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","C",WS_CHILD | BS_BITMAP | BS_PUSHBUTTON,1580*x_scale,470*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ResetButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","R",WS_CHILD | BS_BITMAP,1600*x_scale,470*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    MainHelpWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Track to train packets",WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,150, 150, 1000, 700,NULL, NULL, hInstance, NULL);
    LogListWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,35,980,625,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    PacketListWindow_1 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,35,980,625,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    PacketListWindow_2 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,35,980,625,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    MessageListWindow_1 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,35,980,625,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    MessageListWindow_2 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,35,980,625,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    ReportWindow = CreateWindowEx(0,"Edit","",WS_CHILD |WS_BORDER | ES_MULTILINE,100,100,775,450,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    PacketListButtonWindow_1 = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,0,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    PacketListButtonWindow_2 = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,100,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    MessageListButtonWindow_1 = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,200,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    MessageListButtonWindow_2 = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,300,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    LogListButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,400,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    ReportButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_CHECKBOX|BS_PUSHLIKE|BS_BITMAP|WS_CHILD|WS_BORDER,500,0,100,35,MainHelpWindow,(HMENU) NULL,hInstance,NULL);
    SendReportButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","SendReport",WS_CHILD | BS_BITMAP,400,560,200,50,MainHelpWindow,(HMENU) NULL,hInstance,NULL);

    HelpButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","HELP",WS_CHILD |WS_BORDER|BS_BITMAP,1515*x_scale,389*y_scale,120*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    EnlargeMessageWindowButton = CreateWindowEx((DWORD)0,"BUTTON","",WS_CHILD|WS_BORDER|BS_BITMAP,0,498*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    EnlargeHeadersWindowButton = CreateWindowEx((DWORD)0,"BUTTON","",WS_CHILD|WS_BORDER|BS_BITMAP,0,923*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    EnlargeDetailsWindowButton = CreateWindowEx((DWORD)0,"BUTTON","",WS_CHILD|WS_BORDER|BS_BITMAP,334*x_scale,923*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    BaliseListButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Balise_List",WS_CHILD |WS_BORDER|BS_BITMAP,1515*x_scale,337*y_scale,120*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    MainBaliseListWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Balise list",WS_CLIPCHILDREN|WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,150, 150, 410, 715,NULL, NULL, hInstance, NULL);
    BaliseListWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,20,385,603,MainBaliseListWindow,(HMENU) NULL,hInstance,NULL);
    BaliseListExportButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,0,623,33,33,MainBaliseListWindow,(HMENU) NULL,hInstance,NULL);
    BaliseListExportProgressWindow = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER |PBS_SMOOTH,2,656,384,10,MainBaliseListWindow,(HMENU) NULL,hInstance,NULL);
    BaliseListOpenCSVButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,33,623,355,33,MainBaliseListWindow,(HMENU) NULL,hInstance,NULL);

    LinkingWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_HSCROLL |WS_VSCROLL |WS_BORDER | LBS_USETABSTOPS  | LBS_NOTIFY | LBS_OWNERDRAWFIXED |LBS_HASSTRINGS,1470*x_scale,105*y_scale,200*x_scale,150*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    MAWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_BORDER | LBS_NOTIFY | LBS_OWNERDRAWFIXED |LBS_HASSTRINGS | LBS_NOINTEGRALHEIGHT | LBS_USETABSTOPS,1470*x_scale,260*y_scale,200*x_scale,47*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    TrainListButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Balise_List",WS_CHILD |WS_BORDER|BS_BITMAP,1515*x_scale,363*y_scale,120*x_scale,25*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    MainTrainListWindow = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Train list",WS_CLIPCHILDREN | WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,350, 200, 250, 650,NULL, NULL, hInstance, NULL);
    TrainListWindow = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,0,20,228,585,MainTrainListWindow,(HMENU) NULL,hInstance,NULL);

    SequenceWindow  = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Sequencing",WS_CLIPCHILDREN | WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,350, 200, 1100, 750,NULL, NULL, hInstance, NULL);
    SequenceListWindow1 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,10,20,508,630,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequenceListWindow2 = CreateWindowEx(0,"LISTBOX" ,"",WS_CHILD |WS_VSCROLL | WS_BORDER | LBS_OWNERDRAWFIXED | LBS_NOTIFY | LBS_HASSTRINGS,558,20,508,630,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequencingStartButtonWindow1 = CreateWindowEx((DWORD)0,"BUTTON","Start Sequencing 1",BS_BITMAP|WS_CHILD |WS_BORDER,10,635,300,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequencingStartButtonWindow2 = CreateWindowEx((DWORD)0,"BUTTON","Start Sequencing 2",BS_BITMAP|WS_CHILD |WS_BORDER,558,635,300,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    ExpandAllButton1 = CreateWindowEx((DWORD)0,"BUTTON","Expand All 1",BS_BITMAP|WS_CHILD |WS_BORDER,310,635,50,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    ExpandAllButton2 = CreateWindowEx((DWORD)0,"BUTTON","Expand All 2",BS_BITMAP|WS_CHILD |WS_BORDER,858,635,50,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    CollapseAllButton1 = CreateWindowEx((DWORD)0,"BUTTON","Collapse All 1",BS_BITMAP|WS_CHILD |WS_BORDER,360,635,50,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    CollapseAllButton2 = CreateWindowEx((DWORD)0,"BUTTON","Collapse All 2",BS_BITMAP|WS_CHILD |WS_BORDER,908,635,50,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);

    SequenceExportButtonWindow1 = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,410,635,35,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequenceExportProgressWindow1 = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER |PBS_SMOOTH,10,675,507,10,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequenceOpenCSVButtonWindow1 = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,445,635,73,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);

    SequenceExportButtonWindow2 = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,958,635,35,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequenceExportProgressWindow2 = CreateWindowEx(0,PROGRESS_CLASS,NULL,WS_CHILD |WS_BORDER |PBS_SMOOTH,558,675,507,10,SequenceWindow,(HMENU) NULL,hInstance,NULL);
    SequenceOpenCSVButtonWindow2 = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP|WS_CHILD |WS_BORDER,993,635,73,35,SequenceWindow,(HMENU) NULL,hInstance,NULL);

    SpeedProfileButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Speed Profile",BS_CHECKBOX|BS_PUSHLIKE|WS_CHILD |WS_BORDER|BS_BITMAP,1465*x_scale,408*y_scale,35*x_scale,40*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    SpeedProfileWindow = CreateWindowEx(0,g_szClassName,"",WS_CHILD|WS_BORDER|WS_THICKFRAME,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    MessageButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Message",BS_CHECKBOX|BS_PUSHLIKE|WS_CHILD |WS_BORDER|BS_BITMAP,1465*x_scale,328*y_scale,35*x_scale,40*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    GameWindow = CreateWindowEx(0,g_szClassName,"",WS_CHILD|WS_BORDER|WS_THICKFRAME,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

    TTXWindow  = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"",WS_CLIPCHILDREN | WS_OVERLAPPED | WS_CAPTION | WS_THICKFRAME,600*x_scale, 350*y_scale, 500*x_scale, 300*y_scale,NULL, NULL, hInstance, NULL);
    TTXButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","Balise_List",WS_CHILD |WS_BORDER|BS_BITMAP,20*x_scale,200*y_scale,450*x_scale,25*y_scale,TTXWindow,(HMENU) NULL,hInstance,NULL);

    DebugButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",WS_CHILD|WS_BORDER|BS_BITMAP,1665*x_scale,957*y_scale,15*x_scale,15*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ColorChartButtonWindow = CreateWindowEx((DWORD)0,"BUTTON","",WS_CHILD|WS_BORDER|BS_BITMAP,0*x_scale,952*y_scale,20*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);
    ColorChartMainWindow  = CreateWindowEx(WS_EX_CLIENTEDGE,g_szClassName,"Main Color Selection",WS_CLIPCHILDREN | WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU | WS_THICKFRAME | WS_MINIMIZEBOX,350, 200, 280, 280,NULL, NULL, hInstance, NULL);

    TooltipWindow = CreateWindowEx((DWORD)0,"Static","",SS_CENTER|WS_CHILD|SS_LEFT|WS_BORDER,1533*x_scale,472*y_scale,100*x_scale,20*y_scale,MainWindow,(HMENU) NULL,hInstance,NULL);

//    Toggle1Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,70,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle2Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,85,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle3Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,100,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle5Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,115,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle6Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,130,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle9Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,145,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle10Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,160,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle11Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,175,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle12Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,190,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle15Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,205,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle197Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,220,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle198Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,235,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle199Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,250,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);
//    Toggle200Window = CreateWindowEx((DWORD)0,"BUTTON","",BS_BITMAP | WS_CHILD | BS_PUSHBUTTON | BS_CENTER | BS_VCENTER,0,265,15,15,MainWindow,(HMENU) NULL,hInstance,NULL);

    SendMessage(FolderViewWindow,LB_SETCOLUMNWIDTH,487,0);
    SendMessage(BaliseListExportProgressWindow,PBM_SETBARCOLOR,0,Neon_Green);
    SendMessage(CSVListExportProgressWindow,PBM_SETBARCOLOR,0,Neon_Green);

    SendMessage(MainBufferSaturationBar,PBM_SETBARCOLOR,0,Light_Purple);
    SendMessage(MessageSaturationBar,PBM_SETBARCOLOR,0,Cyan);
    SendMessage(DetailsSaturationBar,PBM_SETBARCOLOR,0,Cyan);

//    SendMessage(Toggle1Window,BM_SETSTATE,1,0);
    SendMessage(Toggle2Window,BM_SETSTATE,1,0);
    SendMessage(Toggle3Window,BM_SETSTATE,1,0);
    SendMessage(Toggle5Window,BM_SETSTATE,1,0);
    SendMessage(Toggle6Window,BM_SETSTATE,1,0);
    SendMessage(Toggle9Window,BM_SETSTATE,1,0);
    SendMessage(Toggle10Window,BM_SETSTATE,1,0);
    SendMessage(Toggle11Window,BM_SETSTATE,1,0);
    SendMessage(Toggle12Window,BM_SETSTATE,1,0);
    SendMessage(Toggle15Window,BM_SETSTATE,1,0);
    SendMessage(Toggle197Window,BM_SETSTATE,1,0);
    SendMessage(Toggle198Window,BM_SETSTATE,1,0);
    SendMessage(Toggle199Window,BM_SETSTATE,1,0);
    SendMessage(Toggle200Window,BM_SETSTATE,1,0);

    ShowWindow(MainWindow, SW_MAXIMIZE);
    ShowWindow(MessageWindow, nCmdShow);
    ShowWindow(HeadersWindow, nCmdShow);
    ShowWindow(DetailsWindow, nCmdShow);
    ShowWindow(QuitButtonWindow, nCmdShow);
    ShowWindow(ClearAllButtonWindow, nCmdShow);
    ShowWindow(NightModeWindow, nCmdShow);
    ShowWindow(VehicleWindow, nCmdShow);
    ShowWindow(ValidDataWindow, nCmdShow);
    ShowWindow(TimeWindow, nCmdShow);
    ShowWindow(DistanceWindow, nCmdShow);
    ShowWindow(SpeedWindow, nCmdShow);
    ShowWindow(SetButtonWindow, nCmdShow);
    ShowWindow(GoToButtonWindow, nCmdShow);
    ShowWindow(ClearButtonWindow, nCmdShow);
    ShowWindow(SequencingButtonWindow, nCmdShow);
    ShowWindow(MessageSearchWindow, nCmdShow);
    ShowWindow(DateSearchWindow, nCmdShow);
    ShowWindow(TrainSearchWindow, nCmdShow);
    ShowWindow(BaliseSearchWindow, nCmdShow);
    ShowWindow(LinkedBaliseSearchWindow, nCmdShow);
    ShowWindow(PacketSearchWindow, nCmdShow);
    ShowWindow(RadioSearchWindow, nCmdShow);
    ShowWindow(SpeedSearchWindow, nCmdShow);
    ShowWindow(AdvancedSearchNameWindow, nCmdShow);
    ShowWindow(AdvancedSearchValueWindow, nCmdShow);
    ShowWindow(LevelSearchWindow, nCmdShow);
    ShowWindow(ModeSearchWindow, nCmdShow);
    ShowWindow(LineWindow, nCmdShow);
    ShowWindow(DecodeButtonWindow, nCmdShow);
    ShowWindow(SearchButtonWindow, nCmdShow);
    ShowWindow(SearchResetWindow, nCmdShow);
    ShowWindow(PreviousDaySearchWindow, nCmdShow);
    ShowWindow(NextDaySearchWindow, nCmdShow);
    ShowWindow(PreviousStartStopSearchWidow, nCmdShow);
    ShowWindow(NextStartStopSearchWindow, nCmdShow);
    ShowWindow(VTRACKButtonWindow, nCmdShow);
    ShowWindow(MediaButtonWindow, nCmdShow);
    ShowWindow(MediaListWindow, nCmdShow);
    ShowWindow(MediaStartWindow, nCmdShow);
    ShowWindow(MediaOkWindow, nCmdShow);
    ShowWindow(PacketListWindow_1, nCmdShow);
    ShowWindow(PacketListButtonWindow_1, nCmdShow);
    ShowWindow(PacketListButtonWindow_2, nCmdShow);
    ShowWindow(MessageListButtonWindow_1, nCmdShow);
    ShowWindow(MessageListButtonWindow_2, nCmdShow);
    ShowWindow(ReportButtonWindow, nCmdShow);
    ShowWindow(SendReportButtonWindow, nCmdShow);
    ShowWindow(LogListButtonWindow, nCmdShow);
    ShowWindow(HelpButtonWindow, nCmdShow);
    ShowWindow(BaliseListButtonWindow, nCmdShow);
    ShowWindow(TrainListButtonWindow, nCmdShow);
    ShowWindow(BaliseListWindow, nCmdShow);
    ShowWindow(TrainListWindow, nCmdShow);
    ShowWindow(LinkingWindow, nCmdShow);
    ShowWindow(BaliseListExportButtonWindow, nCmdShow);
    ShowWindow(CSVListExportButtonWindow, nCmdShow);
    ShowWindow(CSVListSettingsButtonWindow, nCmdShow);
    ShowWindow(TrackInformationWindow, nCmdShow);
    ShowWindow(MAWindow, nCmdShow);
    ShowWindow(SequenceListWindow1, nCmdShow);
    ShowWindow(SequenceListWindow2, nCmdShow);
    ShowWindow(SequencingStartButtonWindow1, nCmdShow);
    ShowWindow(SequencingStartButtonWindow2, nCmdShow);
    ShowWindow(CollapseAllButton1, nCmdShow);
    ShowWindow(CollapseAllButton2, nCmdShow);
    ShowWindow(ExpandAllButton1, nCmdShow);
    ShowWindow(ExpandAllButton2, nCmdShow);
    ShowWindow(SequenceExportButtonWindow1, nCmdShow);
    ShowWindow(SequenceExportButtonWindow2, nCmdShow);
    //ShowWindow(SequenceExportProgressWindow1, nCmdShow);
    //ShowWindow(SequenceExportProgressWindow2, nCmdShow);
    ShowWindow(SpeedProfileButtonWindow, nCmdShow);
    ShowWindow(MessageButtonWindow, nCmdShow);
    ShowWindow(TTXWindow, nCmdShow);
    ShowWindow(SearchCommuteWindow, nCmdShow);
    ShowWindow(DebugButtonWindow, nCmdShow);
    ShowWindow(ColorChartButtonWindow, nCmdShow);

    ShowWindow(CSVSettingsList1Window, nCmdShow);
    ShowWindow(CSVSettingsList2Window, nCmdShow);
    ShowWindow(CSVSettingsLeftOnceButtonWindow, nCmdShow);
    ShowWindow(CSVSettingsLeftAllButtonWindow, nCmdShow);
    ShowWindow(CSVSettingsRightOnceButtonWindow, nCmdShow);
    ShowWindow(CSVSettingsRightAllButtonWindow, nCmdShow);
    ShowWindow(CSVSettingsSwitchPacketOptionButtonWindow, nCmdShow);
    ShowWindow(CSVSettingsTextBox, nCmdShow);

    SetFocus(TTXWindow);
    SetFocus(TTXButtonWindow);

//    ShowWindow(Toggle1Window, nCmdShow);
//    ShowWindow(Toggle2Window, nCmdShow);
//    ShowWindow(Toggle3Window, nCmdShow);
//    ShowWindow(Toggle5Window, nCmdShow);
//    ShowWindow(Toggle6Window, nCmdShow);
//    ShowWindow(Toggle9Window, nCmdShow);
//    ShowWindow(Toggle10Window, nCmdShow);
//    ShowWindow(Toggle11Window, nCmdShow);
//    ShowWindow(Toggle12Window, nCmdShow);
//    ShowWindow(Toggle15Window, nCmdShow);
//    ShowWindow(Toggle197Window, nCmdShow);
//    ShowWindow(Toggle198Window, nCmdShow);
//    ShowWindow(Toggle199Window, nCmdShow);
//    ShowWindow(Toggle200Window, nCmdShow);

    EnableWindow(VTRACKListWindow,false);
    EnableWindow(VTRACKWindow,false);

    ShowWindow(FolderEditWindow, nCmdShow);
    ShowWindow(FolderViewWindow, nCmdShow);
    ShowWindow(FolderOkWindow, nCmdShow);
    ShowWindow(FolderCancelWindow, nCmdShow);
    ShowWindow(FolderRefreshWindow, nCmdShow);
    ShowWindow(FolderBackWindow, nCmdShow);

    SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)NO_DATA_FILE);

    SendMessage(VTRACKButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)VTRACK_BUTTON);
    SendMessage(SpeedProfileButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SPEED_PROFILE_BUTTON);
    SendMessage(MessageButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON);
    SendMessage(BaliseListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BALISE_LIST_BUTTON);
    SendMessage(TrainListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)TRAIN_LIST_BUTTON);
    SendMessage(MediaButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_BUTTON);
    SendMessage(PlayButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PLAY_BUTTON);
    SendMessage(StopButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)STOP_BUTTON);
    SendMessage(SearchButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEARCH_BUTTON);
    SendMessage(DecodeButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)FILE_BUTTON);
    SendMessage(LastFileButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LAST_FILE_BUTTON);
    SendMessage(SetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SET_BUTTON);
    SendMessage(GoToButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)GOTO_BUTTON);
    SendMessage(ClearButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CLEAR_BUTTON);
    SendMessage(SequencingButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCING_BUTTON);
    SendMessage(SearchResetWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)RESET_BUTTON);
    SendMessage(SearchCommuteWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COMMUTE_BUTTON_TRUE);
    SendMessage(QuitButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)QUIT_BUTTON);
    SendMessage(ClearAllButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CLEARALL_BUTTON);
    SendMessage(NightModeWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NIGHT_MODE_FALSE);
    SendMessage(NextDaySearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NEXT_DAY_BUTTON);
    SendMessage(PreviousDaySearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PREVIOUS_DAY_BUTTON);
    SendMessage(NextStartStopSearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NEXT_START_STOP_BUTTON);
    SendMessage(PreviousStartStopSearchWidow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PREVIOUS_START_STOP_BUTTON);
    SendMessage(CenterButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CENTER_BUTTON);
    SendMessage(ResetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_RESET_BUTTON);
    SendMessage(ResetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_RESET_BUTTON);
    SendMessage(PacketListButtonWindow_1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_BUTTON_1);
    SendMessage(PacketListButtonWindow_2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_BUTTON_2);
    SendMessage(MessageListButtonWindow_1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON_1);
    SendMessage(MessageListButtonWindow_2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON_2);
    SendMessage(ReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)REPORT_BUTTON);
    SendMessage(SendReportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEND_REPORT_BUTTON);
    SendMessage(LogListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LOG_BUTTON);
    SendMessage(HelpButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)HELP_BUTTON);
    SendMessage(EnlargeMessageWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
    SendMessage(EnlargeHeadersWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
    SendMessage(EnlargeDetailsWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
    SendMessage(FolderOkWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)OK_BUTTON);
    SendMessage(FolderRefreshWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)REFRESH_BUTTON);
    SendMessage(MediaOkWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_OK_BUTTON);
    SendMessage(FolderBackWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BACK_BUTTON);
    SendMessage(FolderCancelWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CANCEL_BUTTON);
    SendMessage(BaliseListExportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
    SendMessage(CSVListExportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
    SendMessage(BaliseListOpenCSVButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CSV_BUTTON);
    SendMessage(CSVListOpenCSVButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CSV_BUTTON);
    SendMessage(CSVListSettingsButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL_SETTINGS_BUTTON);
    SendMessage(Toggle1Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BLACKBMP);
    SendMessage(Toggle2Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PINKBMP);
    SendMessage(Toggle3Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)REDBMP);
    SendMessage(Toggle5Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LEMONBMP);
    SendMessage(Toggle6Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CYANBMP);
    SendMessage(Toggle9Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)GREENBMP);
    SendMessage(Toggle10Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PEACHBMP);
    SendMessage(Toggle11Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EMERALDBMP);
    SendMessage(Toggle12Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BROWNBMP);
    SendMessage(Toggle15Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LIGHTPINKBMP);
    SendMessage(Toggle197Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SKYBMP);
    SendMessage(Toggle198Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LIMEBMP);
    SendMessage(Toggle199Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PURPLEBMP);
    SendMessage(Toggle200Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BLUEBMP);
    SendMessage(SequencingStartButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCE_START_BUTTON);
    SendMessage(SequencingStartButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCE_START_BUTTON);
    SendMessage(SequenceExportButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
    SendMessage(SequenceExportButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
    SendMessage(CollapseAllButton1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COLLAPSE_BUTTON);
    SendMessage(CollapseAllButton2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COLLAPSE_BUTTON);
    SendMessage(ExpandAllButton1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXPAND_BUTTON);
    SendMessage(ExpandAllButton2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXPAND_BUTTON);
    SendMessage(SequenceOpenCSVButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SL_OPEN_BUTTON);
    SendMessage(SequenceOpenCSVButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SL_OPEN_BUTTON);
    SendMessage(ColorChartButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COLOR_CHART_BUTTON);

    SendMessage(CSVSettingsLeftOnceButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LEFT_ONCE_BUTTON);
    SendMessage(CSVSettingsRightOnceButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)RIGHT_ONCE_BUTTON);
    SendMessage(CSVSettingsLeftAllButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LEFT_ALL_BUTTON);
    SendMessage(CSVSettingsRightAllButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)RIGHT_ALL_BUTTON);

    SendMessage(MessageWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(HeadersWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(DetailsWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(VehicleWindow,WM_SETFONT,(WPARAM)Medium_Font,(LPARAM)TRUE);
    SendMessage(TooltipWindow,WM_SETFONT,(WPARAM)Medium_Font,(LPARAM)TRUE);
    SendMessage(CSVSettingsTextBox,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(QuitButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(DistanceWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(TimeWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SpeedWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SetButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(GoToButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(ClearButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SequencingButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MessageSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(DateSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(TrainSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(BaliseSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(LinkedBaliseSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(PacketSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(RadioSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SpeedSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(AdvancedSearchNameWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(AdvancedSearchValueWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(LevelSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(ModeSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(LineWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(DecodeButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(FolderOkWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(FolderCancelWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SearchButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SearchResetWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(PreviousDaySearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(NextDaySearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(PreviousStartStopSearchWidow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(NextStartStopSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(VTRACKListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MediaSelectionWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MediaListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MediaStartWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MediaInfoWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(LogListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MediaOkWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(PacketListWindow_1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(PacketListWindow_2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MessageListWindow_1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MessageListWindow_2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(HelpButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(LinkingWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MainBaliseListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(TrainListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(TrackInformationWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(MAWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SequenceListWindow1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(SequenceListWindow2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
    SendMessage(TTXWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);

    DateTime_SetFormat(MediaStartWindow,"dd/MM/yyy HH:mm:ss");

    MessageSearchWindowChild = GetWindow(MessageSearchWindow,GW_CHILD);
    LevelSearchWindowChild = GetWindow(LevelSearchWindow,GW_CHILD);
    ModeSearchWindowChild = GetWindow(ModeSearchWindow,GW_CHILD);

    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "ADDITIONAL_BRAKE_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "ADDITIONAL_DATA");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "BALISE_GROUP_ERROR");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "CAB_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "CHANGEMENT_DE_MODE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "CHANGEMENT_DE_NIVEAU");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "COLD_MOVEMENT_DETECTOR_INFO");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DATA_ENTRY_COMPLETED");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DIRECTION_CONTROLLER_POSITION");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DMI_SOUND_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DMI_SYMBOL_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DMI_SYSTEM_STATUS_MESSAGE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DRIVER_ACTIONS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DRIVER_SR_SPEED_DISTANCE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DRIVER_VBC_REMOVED");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "DRIVER_VBC_SET");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "EDDY_CURRENT_BRAKE_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "EMERGENCY_BRAKE_STATE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "EP_BRAKE_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "ETCS_PROPRIETARY_DATA");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "EVENTS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "FIXED_TEXT_MESSAGE_START");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "FIXED_TEXT_MESSAGE_STOP");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "INFO_VITESSES_DISTANCE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MA_LOWEST_SUPERVISED_SPEED");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MAGNETIC_SHOE_BRAKE_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MESSAGE_FROM_BALISE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MESSAGE_FROM_LOOP");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MESSAGE_FROM_RBC");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MESSAGE_FROM_RIU");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "MESSAGE_TO_RBC");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "NATIONAL_SYSTEM_ISOLATION");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "NON_LEADING_INPUT");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "PASSIVE_SHUNTING_INPUT");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "PLAIN_TEXT_MESSAGE_START");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "PLAIN_TEXT_MESSAGE_STOP");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "RADIO_ERROR");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "REGENERATIVE_BRAKE_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SAFETY_CRITICAL_FAULT");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SB_COMMAND_STATE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SLEEPING_INPUT");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SPEED_DISTANCE_MONITORING");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "STM_INFORMATION");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "STM_SELECTED");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "TRACTION_CUT_OFF_COMMAND_STATE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "TRACTION_STATUS");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "TRAIN_DATA_TYPE");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "Z_BGIS_POSITION");
    SendMessage(MessageSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "Z_EXPL_POSITION");

    SendMessage(LevelSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "Level 0");
    SendMessage(LevelSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "Level 1");
    SendMessage(LevelSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "Level 2");

    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "FS Full Supervision");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SN National System");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SB Stand By");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SL Sleeping");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "OS On Sight");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "TR Trip");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SR Staff Responsible");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "IS Isolation");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SF System Failure");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "SH Shunting");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "UN Unfitted");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "PT Post Trip");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "NL Non Leading");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "RV Reversing");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "LS Limited Supervision");
    SendMessage(ModeSearchWindow, CB_ADDSTRING, (WPARAM)0,(LPARAM) "PS Passive Shunting");

    SendMessage(ModeSearchWindow, CB_SETDROPPEDWIDTH, (WPARAM)140,(LPARAM)0);

    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "2 : SR Authorisation");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "3 : Movement Authority");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "6 : Recognition of exit from TRIP mode");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "8 : Acknowledgement of Train Data");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "9 : Request to Shorten MA");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "15 : Conditional Emergency Stop");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "16 : Unconditional Emergency Stop");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "18 : Revocation of Emergency Stop");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "24 : General message");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "27 : SH Refused");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "28 : SH Authorised");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "33 : MA with Shifted Location Reference");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "34 : Track Ahead Free Request");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "37 : Infill MA");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "40 : Train Rejected");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "32 : RBC/RIU System Version");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "38 : Initiation of a communication session");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "39 : Acknowledgement of termination of a communication session");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "41 : Train Accepted");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "43 : SoM position report confirmed by RBC");
    SendMessage(MessageListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "45 : Assignment of coordinate system");

    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "129 : Validated Train Data");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "130 : Request for Shunting");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "132 : MA Request");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "136 : Train Position Report");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "137 : Request to shorten MA is granted");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "138 : Request to shorten MA is rejected");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "146 : Acknowledgement");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "147 : Acknowledgement of Emergency Stop");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "149 : Track Ahead Free Granted");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "150 : End of Mission");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "153 : Radio infill request");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "154 : No compatible version supported");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "155 : Initiation of a communication session");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "156 : Termination of a communication session");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "157 : SoM Position Report");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "158 : Text message acknowledged by driver");
    SendMessage(MessageListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "159 : Session Established");

    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "0 : Virtual Balise Cover marker");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "2 : System Version order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "3 : National Values");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "5 : Linking");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "6 : Virtual Balise Cover order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "12 : Level 1 Movement Authority");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "13 : Staff Responsible distance information from loop");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "15 : Level 2/3 Movement Authority");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "16 : Repositioning Information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "21 : Gradient Profile");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "27 : International Static Speed Profile");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "39 : Track Condition Change of traction system");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "40 : Track Condition Change of allowed current consumption");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "41 : Level Transition Order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "42 : Session Management");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "44 : Data used by applications outside the ERTMS/ETCS system.");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "45 : Radio Network registration");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "46 : Conditional Level Transition Order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "49 : List of balises for SH Area");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "51 : Axle load Speed Profile");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "52 : Permitted Braking Distance Information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "57 : Movement Authority Request Parameters");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "58 : Position Report Parameters");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "63 : List of Balises in SR Authority");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "64 : Inhibition of revocable TSRs from balises in L2/3");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "65 : Temporary Speed Restriction");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "66 : Temporary Speed Restriction Revocation");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "67 : Track Condition Big Metal Masses");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "68 : Track Condition");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "69 : Track Condition Station Platforms");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "70 : Route Suitability Data");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "71 : Adhesion Factor");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "72 : Packet for sending plain text messages");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "76 : Packet for sending fixed text messages");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "79 : Geographical Position Information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "80 : Mode profile associated to an MA");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "88 : Level crossing information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "90 : Track Ahead Free up to level 2/3 transition location");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "131 : RBC transition order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "132 : Danger for Shunting information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "133 : Radio infill area information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "134 : EOLM Packet");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "135 : Stop Shunting on desk opening");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "136 : Infill location reference");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "137 : Stop if in Staff Responsible");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "138 : Reversing area information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "139 : Reversing supervision information");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "140 : Train running number from RBC");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "141 : Default Gradient for Temporary Speed Restriction");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "143 : Session Management with neighbouring Radio Infill Unit");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "145 : Inhibition of balise group message consistency reaction");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "180 : LSSMA display toggle order");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "181 : Generic LS function marker");
    SendMessage(PacketListWindow_1, LB_ADDSTRING, (WPARAM)0,(LPARAM) "254 : Default balise, loop or RIU information");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "0 : Position Report");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "1 : Position Report based on two balise groups");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "3 : Onboard telephone numbers");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "4 : Error Reporting");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "5 : Train running number");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "9 : Level 2/3 transition information");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "11 : Validated train data");
    SendMessage(PacketListWindow_2, LB_ADDSTRING, (WPARAM)0,(LPARAM) "44 : Data used by applications outside the ERTMS/ETCS system.");

    Arrow_Cursor = LoadCursor(NULL,IDC_ARROW);
    Hand_Cursor = LoadCursor(NULL,IDC_HAND);
    Beam_Cursor = LoadCursor(NULL,IDC_IBEAM);

    log_it(LOG_SUCCESS,"Program start","",-1);

    username_buffer = malloc((Username_string_length+1)*sizeof(char)); if (username_buffer==NULL) {log_it(LOG_ERROR,"username_buffer","",-1);}
    mobile_buffer = malloc((P_PT_string_length+1)*sizeof(char)); if (mobile_buffer==NULL) {log_it(LOG_ERROR,"mobile_buffer","",-1);}
    mobile_buffer[0]='\0';

    GetModuleFileName(NULL,executable_path_buffer,Path_Buffer_Size-1);
    for (i=strlen(executable_path_buffer);i>=0;i--) {
        if (executable_path_buffer[i]=='\\') {
            executable_path_buffer[i]='\0';
            sprintf(&executable_path_buffer[i],"\\JRUGC_LICENCE.ugc");
            break;
        }
    }

    FILE* RET_FILE = fopen(executable_path_buffer,"rb");
    fgets(mobile_buffer,P_PT_string_length+1,RET_FILE);
    fclose(RET_FILE);

    executable_path_buffer[i]='\0';

    DWORD username_len = (Username_string_length+1);
    GetUserName(username_buffer, &username_len);
    username_buffer[Username_string_length]='\0';
    lowercase(username_buffer);

    if (Today->tm_mday==15 && Today->tm_mon==11 && username_buffer[0]=='u' && username_buffer[1]=='g' && username_buffer[2]=='c' && strlen(username_buffer)==3) isPhilippeBirthday=true;

    M_MZ = NID_Z_checker();

    SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);

    int MA_display = Message_Details_Storage[Details_Position-MA_offset];
    int MA_display_speed=MA_display/2000000;
    int MA_display_distance = MA_display%10000000-((int)(Distance_Storage[Message_Position]-Distance_Storage[Message_Details_Storage[Details_Position-MA_index_offset]])/3600);

    if (short_started && !M_MZ) short_started=false;

    if (ROLE>=ROLE_DEMO) {
        G_VTRACK_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_VTRACK_BUTTON"),0,0);
        G_SPEED_PROFILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_SPEED_PROFILE_BUTTON"),0,0);
        G_BALISE_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_BALISE_LIST_BUTTON"),0,0);
        G_TRAIN_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_TRAIN_LIST_BUTTON"),0,0);
        G_MEDIA_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_MEDIA_BUTTON"),0,0);
        G_HELP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_HELP_BUTTON"),0,0);
        G_SEQUENCING_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_SEQUENCING_BUTTON"),0,0);
        SendMessage(VTRACKButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_VTRACK_BUTTON);
        SendMessage(SpeedProfileButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_SPEED_PROFILE_BUTTON);
        SendMessage(BaliseListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_BALISE_LIST_BUTTON);
        SendMessage(TrainListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_TRAIN_LIST_BUTTON);
        SendMessage(MediaButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_MEDIA_BUTTON);
        SendMessage(HelpButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_HELP_BUTTON);
        SendMessage(SequencingButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)G_SEQUENCING_BUTTON);
        RedrawWindow(AdvancedSearchNameWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
        RedrawWindow(AdvancedSearchValueWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
    }

    executable_path_length = strlen(executable_path_buffer);
    sprintf(&executable_path_buffer[executable_path_length],"\\JRUGC_LOG.txt");
    log_file = fopen(executable_path_buffer,"w+");
    executable_path_buffer[executable_path_length]='\0';
    fclose(log_file);

    ShowWindow(LastFileButtonWindow,nCmdShow);

    fseek(SETTINGS_FILE,44,SEEK_SET);

    for (i=0;i<=255;i++) {
        excel_message_settings[i]=fgetc(SETTINGS_FILE);
        Message_INDEX2ID(i,Window_Buffer);
        if (Window_Buffer[0]=='?') continue;
        if (excel_message_settings[i]=='1')
            SendMessage(CSVSettingsList1Window,LB_SETITEMDATA,SendMessage(CSVSettingsList1Window,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer),i);
        else
            SendMessage(CSVSettingsList2Window,LB_SETITEMDATA,SendMessage(CSVSettingsList2Window,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer),i);
    }

    fgetc(SETTINGS_FILE);fgetc(SETTINGS_FILE);
    if (fgetc(SETTINGS_FILE)=='0') exportpacketexpand = false; else exportpacketexpand = true;
    if (fgetc(SETTINGS_FILE)=='0') night_mode = false; else night_mode = true;
    fgetc(SETTINGS_FILE);
    fgets(Remanent_Path_Buffer,Path_Buffer_Size,SETTINGS_FILE);
    fgets(Filename_Buffer,Path_Buffer_Size,SETTINGS_FILE);

    if (Remanent_Path_Buffer[strlen(Remanent_Path_Buffer)-1]=='\n') Remanent_Path_Buffer[strlen(Remanent_Path_Buffer)-1]='\0';
    if (Filename_Buffer[strlen(Filename_Buffer)-1]=='\n') Filename_Buffer[strlen(Filename_Buffer)-1]='\0';
    sprintf(Path_Buffer,Remanent_Path_Buffer);

    if (exportpacketexpand) {
        SetWindowText(CSVSettingsTextBox,"Packets will be exported in a new line");
        SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_OPTION_TRUE);
        SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETSTATE,1,0);
    } else {
        SetWindowText(CSVSettingsTextBox,"Packets will not be exported");
        SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_OPTION_FALSE);
    }

    int monitor_left = Monitor_Info.rcMonitor.left;
    int monitor_right = Monitor_Info.rcMonitor.right;
    int monitor_top = Monitor_Info.rcMonitor.top;
    int monitor_bottom = Monitor_Info.rcMonitor.bottom;

    int moniwork_left = Monitor_Info.rcWork.left;
    int moniwork_right = Monitor_Info.rcWork.right;
    int moniwork_top = Monitor_Info.rcWork.top;
    int moniwork_bottom = Monitor_Info.rcWork.bottom;

    GetWindowRect(MainWindow,&MONITOR);

    int window_left = MONITOR.left;
    int window_right = MONITOR.right;
    int window_top = MONITOR.top;
    int window_bottom = MONITOR.bottom;

    int user_width,user_height;

//LOOP_START

    while(GetMessage(&Current_Message, NULL, 0, 0)>0)
    {

        Current_Window=GetFocus();

        NewMonitor = MonitorFromWindow(MainWindow,MONITOR_DEFAULTTONEAREST);
        GetMonitorInfo(NewMonitor,&Monitor_Info);
        GetWindowRect(MainWindow,&MONITOR);

        if (has_been_resized) {
            monitor_left = Monitor_Info.rcMonitor.left;
            monitor_right = Monitor_Info.rcMonitor.right;
            monitor_top = Monitor_Info.rcMonitor.top;
            monitor_bottom = Monitor_Info.rcMonitor.bottom;
            window_left = MONITOR.left;
            window_right = MONITOR.right;
            window_top = MONITOR.top;
            window_bottom = MONITOR.bottom;
            moniwork_left = Monitor_Info.rcWork.left;
            moniwork_right = Monitor_Info.rcWork.right;
            moniwork_top = Monitor_Info.rcWork.top;
            moniwork_bottom = Monitor_Info.rcWork.bottom;
            has_been_resized = false;
        }

        if (monitor_left!=Monitor_Info.rcMonitor.left || monitor_right!=Monitor_Info.rcMonitor.right || monitor_top!=Monitor_Info.rcMonitor.top || monitor_bottom!=Monitor_Info.rcMonitor.bottom || window_left!=MONITOR.left|| window_right!=MONITOR.right|| window_top!=MONITOR.top|| window_bottom!=MONITOR.bottom || moniwork_left!=Monitor_Info.rcWork.left || moniwork_right!=Monitor_Info.rcWork.right || moniwork_top!=Monitor_Info.rcWork.top || moniwork_bottom!=Monitor_Info.rcWork.bottom) {
            MainMonitor=NewMonitor;

            user_width = abs(Monitor_Info.rcWork.right-Monitor_Info.rcWork.left);
            user_height = abs(Monitor_Info.rcWork.bottom-Monitor_Info.rcWork.top);

            x_scale = (float)user_width/1680;
            y_scale = (float)user_height/1000;

            DeleteObject(Main_Font);
            DeleteObject(Medium_Font);

            Main_Font = CreateFont(15*y_scale,6*x_scale,0,0,600,FALSE,FALSE,FALSE,ANSI_CHARSET,OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY, DEFAULT_PITCH,TEXT("Arial"));
            Medium_Font = CreateFont(14*y_scale,5*x_scale,0,0,600,FALSE,FALSE,FALSE,ANSI_CHARSET,OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,DEFAULT_QUALITY, DEFAULT_PITCH,TEXT("Arial"));

            SendMessage(MessageWindow,LB_SETITEMHEIGHT,0,17*y_scale);
            SendMessage(HeadersWindow,LB_SETITEMHEIGHT,0,17*y_scale);
            SendMessage(DetailsWindow,LB_SETITEMHEIGHT,0,17*y_scale);

            ShowWindow(TooltipWindow,0);

            SendMessage(MessageWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(HeadersWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(DetailsWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(VehicleWindow,WM_SETFONT,(WPARAM)Medium_Font,(LPARAM)TRUE);
            SendMessage(CSVSettingsTextBox,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(QuitButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(DistanceWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TimeWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SpeedWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SetButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(GoToButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(ClearButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SequencingButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MessageSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(DateSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TrainSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(BaliseSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(LinkedBaliseSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(PacketSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(RadioSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SpeedSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(AdvancedSearchNameWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(AdvancedSearchValueWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(LevelSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(ModeSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(LineWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(DecodeButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(FolderOkWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(FolderCancelWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SearchButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SearchResetWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(PreviousDaySearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(NextDaySearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(PreviousStartStopSearchWidow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(NextStartStopSearchWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(VTRACKListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MediaSelectionWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MediaListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MediaStartWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MediaInfoWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(LogListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MediaOkWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(PacketListWindow_1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(PacketListWindow_2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MessageListWindow_1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MessageListWindow_2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(HelpButtonWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(LinkingWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MainBaliseListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TrainListWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TrackInformationWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(MAWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SequenceListWindow1,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(SequenceListWindow2,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TTXWindow,WM_SETFONT,(WPARAM)Main_Font,(LPARAM)TRUE);
            SendMessage(TooltipWindow,WM_SETFONT,(WPARAM)Medium_Font,(LPARAM)TRUE);

            SetWindowPos(MainWindow,NULL,0,0,1700*x_scale+18,1000*y_scale+30,SWP_NOZORDER|SWP_NOMOVE);
            SetWindowPos(MessageWindow,NULL,15*x_scale,70*y_scale,1450*x_scale,450*y_scale,SWP_NOZORDER);
            SetWindowPos(HeadersWindow,NULL,15*x_scale,580*y_scale,300*x_scale,370*y_scale,SWP_NOZORDER);
            SetWindowPos(DetailsWindow,NULL,350*x_scale,580*y_scale,1116*x_scale,370*y_scale,SWP_NOZORDER);

            SetWindowPos(ProgressBarWindow,NULL,15*x_scale,15*y_scale,1450*x_scale,10*y_scale,SWP_NOZORDER);
            SetWindowPos(QuitButtonWindow,NULL,1595*x_scale,5*y_scale,75*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(ClearAllButtonWindow,NULL,1515*x_scale,5*y_scale,75*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(NightModeWindow,NULL,1470*x_scale,5*y_scale,40*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(VehicleWindow,NULL,1496*x_scale,40*y_scale,174*x_scale,40*y_scale,SWP_NOZORDER);
            SetWindowPos(TooltipWindow,NULL,1533*x_scale,472*y_scale,100*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(ValidDataWindow,NULL,1470*x_scale,40*y_scale,26*x_scale,40*y_scale,SWP_NOZORDER);
            SetWindowPos(TimeWindow,NULL,600*x_scale,545*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(DistanceWindow,NULL,850*x_scale,545*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SpeedWindow,NULL,1100*x_scale,545*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SetButtonWindow,NULL,350*x_scale,535*y_scale,50*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(GoToButtonWindow,NULL,410*x_scale,535*y_scale,50*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(ClearButtonWindow,NULL,470*x_scale,535*y_scale,50*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SequencingButtonWindow,NULL,350*x_scale,557*y_scale,170*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(LineWindow,NULL,15*x_scale,545*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(TrackInformationWindow,NULL,15*x_scale,520*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SearchButtonWindow,NULL,1470*x_scale,880*y_scale,80*x_scale,35*y_scale,SWP_NOZORDER);
            SetWindowPos(SearchProgressWindow,NULL,1470*x_scale,918*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SearchResetWindow,NULL,1560*x_scale,880*y_scale,50*x_scale,35*y_scale,SWP_NOZORDER);
            SetWindowPos(SearchCommuteWindow,NULL,1620*x_scale,880*y_scale,50*x_scale,35*y_scale,SWP_NOZORDER);
            SetWindowPos(CSVListExportButtonWindow,NULL,1505*x_scale,531*y_scale,33*x_scale,33*y_scale,SWP_NOZORDER);
            SetWindowPos(CSVListSettingsButtonWindow,NULL,1470*x_scale,531*y_scale,33*x_scale,33*y_scale,SWP_NOZORDER);

            SetWindowPos(MainBufferSaturationBar,NULL,1*x_scale,70*y_scale,13*x_scale,80*y_scale,SWP_NOZORDER);
            SetWindowPos(MessageSaturationBar,NULL,1*x_scale,170*y_scale,13*x_scale,80*y_scale,SWP_NOZORDER);
            SetWindowPos(DetailsSaturationBar,NULL,1*x_scale,270*y_scale,13*x_scale,80*y_scale,SWP_NOZORDER);

            SetWindowPos(CSVListExportProgressWindow,NULL,1470*x_scale,566*y_scale,200*x_scale,10*y_scale,SWP_NOZORDER);
            SetWindowPos(CSVListOpenCSVButtonWindow,NULL,1505*x_scale,531*y_scale,165*x_scale,33*y_scale,SWP_NOZORDER);
            SetWindowPos(DecodeButtonWindow,NULL,1470*x_scale,494*y_scale,160*x_scale,35*y_scale,SWP_NOZORDER);
            SetWindowPos(LastFileButtonWindow,NULL,1635*x_scale,494*y_scale,35*x_scale,35*y_scale,SWP_NOZORDER);

            SetWindowPos(MessageSearchWindow,NULL,1470*x_scale,595*y_scale,200*x_scale,350*y_scale,SWP_NOZORDER);
            SetWindowPos(DateSearchWindow,NULL,1470*x_scale,635*y_scale,200*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(TrainSearchWindow,NULL,1470*x_scale,675*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(SpeedSearchWindow,NULL,1580*x_scale,675*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(PacketSearchWindow,NULL,1470*x_scale,715*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(RadioSearchWindow,NULL,1580*x_scale,715*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(BaliseSearchWindow,NULL,1470*x_scale,755*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(LinkedBaliseSearchWindow,NULL,1580*x_scale,755*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(AdvancedSearchNameWindow,NULL,1470*x_scale,795*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(AdvancedSearchValueWindow,NULL,1580*x_scale,795*y_scale,90*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(LevelSearchWindow,NULL,1580*x_scale,835*y_scale,90*x_scale,100*y_scale,SWP_NOZORDER);
            SetWindowPos(ModeSearchWindow,NULL,1470*x_scale,835*y_scale,90*x_scale,500*y_scale,SWP_NOZORDER);
            SetWindowPos(PreviousStartStopSearchWidow,NULL,1405*x_scale,525*y_scale,25*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(NextStartStopSearchWindow,NULL,1430*x_scale,525*y_scale,25*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(PreviousDaySearchWindow,NULL,1405*x_scale,545*y_scale,25*x_scale,20*y_scale,SWP_NOZORDER);
            SetWindowPos(NextDaySearchWindow,NULL,1430*x_scale,545*y_scale,25*x_scale,20*y_scale,SWP_NOZORDER);

            SetWindowPos(VTRACKButtonWindow,NULL,1465*x_scale,368*y_scale,35*x_scale,40*y_scale,SWP_NOZORDER);
            SetWindowPos(VTRACKWindow,NULL,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,SWP_NOZORDER);
            SetWindowPos(VTRACKListWindow,NULL,15*x_scale,470*y_scale,1450*x_scale,0,SWP_NOZORDER);
            SetWindowPos(MediaButtonWindow,NULL,1515*x_scale,415*y_scale,120*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(MediaInfoWindow,NULL,1520*x_scale,445*y_scale,115*x_scale,45*y_scale,SWP_NOZORDER);
            SetWindowPos(PlayButtonWindow,NULL,1540*x_scale,470*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(StopButtonWindow,NULL,1560*x_scale,470*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(CenterButtonWindow,NULL,1580*x_scale,470*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(ResetButtonWindow,NULL,1600*x_scale,470*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(HelpButtonWindow,NULL,1515*x_scale,389*y_scale,120*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(EnlargeMessageWindowButton,NULL,0,498*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(EnlargeHeadersWindowButton,NULL,0,923*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(EnlargeDetailsWindowButton,NULL,334*x_scale,923*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(BaliseListButtonWindow,NULL,1515*x_scale,337*y_scale,120*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(LinkingWindow,NULL,1470*x_scale,105*y_scale,200*x_scale,150*y_scale,SWP_NOZORDER);
            SetWindowPos(MAWindow,NULL,1470*x_scale,260*y_scale,200*x_scale,47*y_scale,SWP_NOZORDER);
            SetWindowPos(TrainListButtonWindow,NULL,1515*x_scale,363*y_scale,120*x_scale,25*y_scale,SWP_NOZORDER);
            SetWindowPos(SpeedProfileButtonWindow,NULL,1465*x_scale,408*y_scale,35*x_scale,40*y_scale,SWP_NOZORDER);
            SetWindowPos(SpeedProfileWindow,NULL,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,SWP_NOZORDER);
            SetWindowPos(MessageButtonWindow,NULL,1465*x_scale,328*y_scale,35*x_scale,40*y_scale,SWP_NOZORDER);
            SetWindowPos(GameWindow,NULL,15*x_scale,25*y_scale,1450*x_scale,450*y_scale,SWP_NOZORDER);

            SetWindowPos(DebugButtonWindow,NULL,1665*x_scale,957*y_scale,15*x_scale,15*y_scale,SWP_NOZORDER);
            SetWindowPos(ColorChartButtonWindow,NULL,0*x_scale,952*y_scale,20*x_scale,20*y_scale,SWP_NOZORDER);

            THALYS = ResizeBmp(LoadBitmap(hInstance,"THALYS"),0,0);
            THALYS_R = ResizeBmp(LoadBitmap(hInstance,"THALYS_R"),0,0);
            EUROSTAR = ResizeBmp(LoadBitmap(hInstance,"EUROSTAR"),0,0);
            EUROSTAR_R = ResizeBmp(LoadBitmap(hInstance,"EUROSTAR_R"),0,0);
            ICE = ResizeBmp(LoadBitmap(hInstance,"ICE"),0,0);
            ICE_R = ResizeBmp(LoadBitmap(hInstance,"ICE_R"),0,0);
            IZY = ResizeBmp(LoadBitmap(hInstance,"IZY"),0,0);
            IZY_R = ResizeBmp(LoadBitmap(hInstance,"IZY_R"),0,0);
            OUIGO = ResizeBmp(LoadBitmap(hInstance,"OUIGO"),0,0);
            OUIGO_R = ResizeBmp(LoadBitmap(hInstance,"OUIGO_R"),0,0);
            DUPLEX = ResizeBmp(LoadBitmap(hInstance,"DUPLEX"),0,0);
            DUPLEX_R = ResizeBmp(LoadBitmap(hInstance,"DUPLEX_R"),0,0);
            TGV = ResizeBmp(LoadBitmap(hInstance,"TGV"),0,0);
            TGV_R = ResizeBmp(LoadBitmap(hInstance,"TGV_R"),0,0);
            ITALO = ResizeBmp(LoadBitmap(hInstance,"ITALO"),0,0);
            ITALO_R = ResizeBmp(LoadBitmap(hInstance,"ITALO_R"),0,0);
            TRAINDB = ResizeBmp(LoadBitmap(hInstance,"TRAINDB"),0,0);
            TRAINDB_R = ResizeBmp(LoadBitmap(hInstance,"TRAINDB_R"),0,0);
            TRAINSNCB = ResizeBmp(LoadBitmap(hInstance,"TRAINSNCB"),0,0);
            TRAINSNCB_R = ResizeBmp(LoadBitmap(hInstance,"TRAINSNCB_R"),0,0);
            TRAINNS = ResizeBmp(LoadBitmap(hInstance,"TRAINNS"),0,0);
            TRAINNS_R = ResizeBmp(LoadBitmap(hInstance,"TRAINNS_R"),0,0);

            VALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"VALID_DATA_FILE"),0,0);
            INVALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"INVALID_DATA_FILE"),0,0);
            PARTIAL_VALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"PARTIAL_VALID_DATA_FILE"),0,0);
            PARTIAL_INVALID_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"PARTIAL_INVALID_DATA_FILE"),0,0);
            NO_DATA_FILE = ResizeBmp(LoadBitmap(hInstance,"NO_DATA_FILE"),0,0);

            SELECTED_TRAIN = THALYS; SELECTED_TRAIN_R = THALYS_R;

            TRONCON = ResizeBmp(LoadBitmap(hInstance,"TRONCON"),0,0);
            NOVISUAL = ResizeBmp(LoadBitmap(hInstance,"NOVISUAL"),0,0);
            NOTYETVISUAL = ResizeBmp(LoadBitmap(hInstance,"NOTYETVISUAL"),0,0);
            ACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"ACTIVE_BALISE_L"),0,0);
            ACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"ACTIVE_BALISE_R"),0,0);
            INACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"INACTIVE_BALISE_L"),0,0);
            INACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"INACTIVE_BALISE_R"),0,0);
            CYAN_ACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"CYAN_ACTIVE_BALISE_L"),0,0);
            CYAN_ACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"CYAN_ACTIVE_BALISE_R"),0,0);
            CYAN_INACTIVE_BALISE_L = ResizeBmp(LoadBitmap(hInstance,"CYAN_INACTIVE_BALISE_L"),0,0);
            CYAN_INACTIVE_BALISE_R = ResizeBmp(LoadBitmap(hInstance,"CYAN_INACTIVE_BALISE_R"),0,0);
            PHONE = ResizeBmp(LoadBitmap(hInstance,"PHONE"),0,0);
            EXCEL = ResizeBmp(LoadBitmap(hInstance,"EXCEL"),0,0);
            SPEEDOMETER = ResizeBmp(LoadBitmap(hInstance,"SPEEDOMETER"),0,0);
            DISTANCE_BMP = ResizeBmp(LoadBitmap(hInstance,"DISTANCE_BMP"),0,0);
            SD_BACKGROUND = ResizeBmp(LoadBitmap(hInstance,"SD_BACKGROUND"),0,0);

            VTRACK_BUTTON = ResizeBmp(LoadBitmap(hInstance,"VTRACK_BUTTON"),0,0);
            SPEED_PROFILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SPEED_PROFILE_BUTTON"),0,0);
            MESSAGE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MESSAGE_BUTTON"),0,0);
            BALISE_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"BALISE_LIST_BUTTON"),0,0);
            TRAIN_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"TRAIN_LIST_BUTTON"),0,0);
            MEDIA_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MEDIA_BUTTON"),0,0);
            PLAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PLAY_BUTTON"),0,0);
            STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"STOP_BUTTON"),0,0);
            SEARCH_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SEARCH_BUTTON"),0,0);
            FILE_EXCEL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"FILE_EXCEL_BUTTON"),0,0);
            FILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"FILE_BUTTON"),0,0);
            SET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SET_BUTTON"),0,0);
            GOTO_BUTTON = ResizeBmp(LoadBitmap(hInstance,"GOTO_BUTTON"),0,0);
            CLEAR_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CLEAR_BUTTON"),0,0);
            SEQUENCING_BUTTON = ResizeBmp(LoadBitmap(hInstance,"SEQUENCING_BUTTON"),0,0);
            RESET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"RESET_BUTTON"),0,0);
            QUIT_BUTTON = ResizeBmp(LoadBitmap(hInstance,"QUIT_BUTTON"),0,0);
            CLEARALL_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CLEARALL_BUTTON"),0,0);
            PREVIOUS_START_STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PREVIOUS_START_STOP_BUTTON"),0,0);
            NEXT_START_STOP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"NEXT_START_STOP_BUTTON"),0,0);
            PREVIOUS_DAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"PREVIOUS_DAY_BUTTON"),0,0);
            NEXT_DAY_BUTTON = ResizeBmp(LoadBitmap(hInstance,"NEXT_DAY_BUTTON"),0,0);
            CENTER_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CENTER_BUTTON"),0,0);
            MEDIA_RESET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MEDIA_RESET_BUTTON"),0,0);
            MEDIA_RESET_BUTTON = ResizeBmp(LoadBitmap(hInstance,"MEDIA_RESET_BUTTON"),0,0);
            CSV_BUTTON = ResizeBmp(LoadBitmap(hInstance,"CSV_BUTTON"),0,0);
            ENLARGE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"ENLARGE_BUTTON"),0,0);

            HELP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"HELP_BUTTON"),0,0);

            GAME_PART_TRACK = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_TRACK"),0,0);
            GAME_PART_BONUS = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_BONUS"),0,0);
            GAME_PART_MALUS = ResizeBmp(LoadBitmap(hInstance,"GAME_PART_MALUS"),0,0);
            PANORAMA = ResizeBmp(LoadBitmap(hInstance,"PANORAMA"),0,0);
            GAME_SPEEDOMETER_40 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_40"),0,0);
            GAME_SPEEDOMETER_60 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_60"),0,0);
            GAME_SPEEDOMETER_80 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_80"),0,0);
            GAME_SPEEDOMETER_100 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_100"),0,0);
            GAME_SPEEDOMETER_120 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_120"),0,0);
            GAME_SPEEDOMETER_140 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_140"),0,0);
            GAME_SPEEDOMETER_160 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_160"),0,0);
            GAME_SPEEDOMETER_180 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_180"),0,0);
            GAME_SPEEDOMETER_200 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_200"),0,0);
            GAME_SPEEDOMETER_220 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_220"),0,0);
            GAME_SPEEDOMETER_240 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_240"),0,0);
            GAME_SPEEDOMETER_260 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_260"),0,0);
            GAME_SPEEDOMETER_280 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_280"),0,0);
            GAME_SPEEDOMETER_300 = ResizeBmp(LoadBitmap(hInstance,"GAME_SPEEDOMETER_300"),0,0);
            GAME_ODOMETER = ResizeBmp(LoadBitmap(hInstance,"GAME_ODOMETER"),0,0);

            G_VTRACK_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_VTRACK_BUTTON"),0,0);
            G_SPEED_PROFILE_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_SPEED_PROFILE_BUTTON"),0,0);
            G_BALISE_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_BALISE_LIST_BUTTON"),0,0);
            G_TRAIN_LIST_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_TRAIN_LIST_BUTTON"),0,0);
            G_MEDIA_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_MEDIA_BUTTON"),0,0);
            G_HELP_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_HELP_BUTTON"),0,0);
            G_SEQUENCING_BUTTON = ResizeBmp(LoadBitmap(hInstance,"G_SEQUENCING_BUTTON"),0,0);

            SendMessage(VTRACKButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)VTRACK_BUTTON);
            SendMessage(SpeedProfileButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SPEED_PROFILE_BUTTON);
            SendMessage(MessageButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON);
            SendMessage(BaliseListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BALISE_LIST_BUTTON);
            SendMessage(TrainListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)TRAIN_LIST_BUTTON);
            SendMessage(MediaButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_BUTTON);
            SendMessage(PlayButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PLAY_BUTTON);
            SendMessage(StopButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)STOP_BUTTON);
            SendMessage(SearchButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEARCH_BUTTON);
            SendMessage(DecodeButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)FILE_BUTTON);
            SendMessage(SetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SET_BUTTON);
            SendMessage(GoToButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)GOTO_BUTTON);
            SendMessage(ClearButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CLEAR_BUTTON);
            SendMessage(SequencingButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCING_BUTTON);
            SendMessage(SearchResetWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)RESET_BUTTON);
            SendMessage(QuitButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)QUIT_BUTTON);
            SendMessage(ClearAllButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CLEARALL_BUTTON);
            SendMessage(NextDaySearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NEXT_DAY_BUTTON);
            SendMessage(PreviousDaySearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PREVIOUS_DAY_BUTTON);
            SendMessage(NextStartStopSearchWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NEXT_START_STOP_BUTTON);
            SendMessage(PreviousStartStopSearchWidow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PREVIOUS_START_STOP_BUTTON);
            SendMessage(CenterButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CENTER_BUTTON);
            SendMessage(ResetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_RESET_BUTTON);
            SendMessage(ResetButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_RESET_BUTTON);
            SendMessage(PacketListButtonWindow_1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_BUTTON_1);
            SendMessage(PacketListButtonWindow_2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_BUTTON_2);
            SendMessage(MessageListButtonWindow_1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON_1);
            SendMessage(MessageListButtonWindow_2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MESSAGE_BUTTON_2);
            SendMessage(LogListButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LOG_BUTTON);
            SendMessage(HelpButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)HELP_BUTTON);
            SendMessage(EnlargeMessageWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
            SendMessage(EnlargeHeadersWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
            SendMessage(EnlargeDetailsWindowButton,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)ENLARGE_BUTTON);
            SendMessage(FolderOkWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)OK_BUTTON);
            SendMessage(FolderRefreshWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)REFRESH_BUTTON);
            SendMessage(MediaOkWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)MEDIA_OK_BUTTON);
            SendMessage(FolderBackWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BACK_BUTTON);
            SendMessage(FolderCancelWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CANCEL_BUTTON);
            SendMessage(BaliseListExportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
            SendMessage(CSVListExportButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
            SendMessage(BaliseListOpenCSVButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CSV_BUTTON);
            SendMessage(CSVListOpenCSVButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CSV_BUTTON);
            SendMessage(Toggle1Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BLACKBMP);
            SendMessage(Toggle2Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PINKBMP);
            SendMessage(Toggle3Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)REDBMP);
            SendMessage(Toggle5Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LEMONBMP);
            SendMessage(Toggle6Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)CYANBMP);
            SendMessage(Toggle9Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)GREENBMP);
            SendMessage(Toggle10Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PEACHBMP);
            SendMessage(Toggle11Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EMERALDBMP);
            SendMessage(Toggle12Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BROWNBMP);
            SendMessage(Toggle15Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LIGHTPINKBMP);
            SendMessage(Toggle197Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SKYBMP);
            SendMessage(Toggle198Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)LIMEBMP);
            SendMessage(Toggle199Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PURPLEBMP);
            SendMessage(Toggle200Window,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)BLUEBMP);
            SendMessage(SequencingStartButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCE_START_BUTTON);
            SendMessage(SequencingStartButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SEQUENCE_START_BUTTON);
            SendMessage(SequenceExportButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
            SendMessage(SequenceExportButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXCEL);
            SendMessage(CollapseAllButton1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COLLAPSE_BUTTON);
            SendMessage(CollapseAllButton2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COLLAPSE_BUTTON);
            SendMessage(ExpandAllButton1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXPAND_BUTTON);
            SendMessage(ExpandAllButton2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)EXPAND_BUTTON);
            SendMessage(SequenceOpenCSVButtonWindow1,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SL_OPEN_BUTTON);
            SendMessage(SequenceOpenCSVButtonWindow2,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)SL_OPEN_BUTTON);

            MessageWindow_Tabs[0]=120*x_scale;
            MessageWindow_Tabs[1]=352*x_scale;
            MessageWindow_Tabs[2]=412*x_scale;
            MessageWindow_Tabs[3]=490*x_scale;
            MessageWindow_Tabs[4]=568*x_scale;
            MessageWindow_Tabs[5]=705*x_scale;
            MessageWindow_Tabs[6]=785*x_scale;
            MessageWindow_Tabs[7]=860*x_scale;
            MessageWindow_Tabs[8]=935*x_scale;
            MessageWindow_Tabs[9]=1000*x_scale;
            MessageWindow_Tabs[10]=1080*x_scale;
            MessageWindow_Tabs[11]=1250*x_scale;

            DetailsWindow_Tabs[0]=150*x_scale;
            DetailsWindow_Tabs[1]=550*x_scale;
            LinkingWindow_Tabs[0]=55*x_scale;
            MAWindow_Tabs[0]=70*x_scale;
            BaliseListWindow_Tabs[0]=40*x_scale;
            BaliseListWindow_Tabs[1]=100*x_scale;
            BaliseListWindow_Tabs[2]=205*x_scale;
            BaliseListWindow_Tabs[3]=265*x_scale;
            TrainListWindow_Tabs[0]=40*x_scale;
            SequenceWindow_Tabs[0]=30*x_scale;
            SequenceWindow_Tabs[1]=100*x_scale;
            SequenceWindow_Tabs[2]=600*x_scale;
            SequenceWindow_Tabs_details[0]=120*x_scale;
            SequenceWindow_Tabs_details[1]=2500*x_scale;

            RedrawWindow(MainWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW|RDW_ALLCHILDREN);
            if (IsWindowVisible(VTRACKWindow)) {
                RedrawWindow(VTRACKWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
                RedrawWindow(VTRACKListWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            }
            if (IsWindowVisible(SpeedProfileWindow)) {
                RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
                RedrawWindow(VTRACKListWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            }

            SelectObject(game_track_dc,GAME_PART_TRACK);
            SelectObject(game_bonus_dc,GAME_PART_BONUS);
            SelectObject(game_malus_dc,GAME_PART_MALUS);
            SelectObject(game_panorama_dc,PANORAMA);
            SelectObject(game_odometer_dc,GAME_ODOMETER);

            if (game_train_speed==20) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_40);
            if (game_train_speed==19) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_60);
            if (game_train_speed==18) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_80);
            if (game_train_speed==17) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_100);
            if (game_train_speed==16) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_120);
            if (game_train_speed==15) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_140);
            if (game_train_speed==14) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_160);
            if (game_train_speed==13) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_180);
            if (game_train_speed==12) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_200);
            if (game_train_speed==11) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_220);
            if (game_train_speed==10) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_240);
            if (game_train_speed==9) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_260);
            if (game_train_speed==8) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_280);
            if (game_train_speed==7) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_300);

            game_dashboard.top = 409*y_scale;
            game_dashboard.bottom = 428*y_scale;
            game_dashboard.left = 64*x_scale;
            game_dashboard.right = 100*x_scale;

            if (IsWindowVisible(GameWindow)) {
                RedrawWindow(GameWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            }

            has_been_resized = true;
        }

        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)DebugButtonWindow) {
            debug_mode=!debug_mode;
            if (debug_mode) {
                ShowWindow(MessageSaturationBar,nCmdShow);
                ShowWindow(DetailsSaturationBar,nCmdShow);
                ShowWindow(MainBufferSaturationBar,nCmdShow);
            } else {
                ShowWindow(MessageSaturationBar,0);
                ShowWindow(DetailsSaturationBar,0);
                ShowWindow(MainBufferSaturationBar,0);
            }
            continue;
        }

        if (((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)LastFileButtonWindow &&  strstr(Filename_Buffer,"void")==NULL) ||  (Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='L' && shift && control)) && strstr(Filename_Buffer,"void")==NULL) {
            short_started=true;
            control = false;
            shift = false;
            sprintf(lpCmdLine,"\"%s\\%s\"",Remanent_Path_Buffer,Filename_Buffer);
            continue;
        }

        if (Current_Message.message==WM_LBUTTONDOWN && Current_Message.hwnd==CSVSettingsSwitchPacketOptionButtonWindow && IsWindowVisible(CSVSettingsTextBox)) {
            if (exportpacketexpand) {
                exportpacketexpand = false;
                fseek(SETTINGS_FILE,302,SEEK_SET); fputc('0',SETTINGS_FILE);
                SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETSTATE,0,0);
                SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_OPTION_FALSE);
                SetWindowText(CSVSettingsTextBox,"Packets will not be exported");
            } else {
                exportpacketexpand = true;
                fseek(SETTINGS_FILE,302,SEEK_SET); fputc('1',SETTINGS_FILE);
                SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETSTATE,1,0);
                SendMessage(CSVSettingsSwitchPacketOptionButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)PACKET_OPTION_TRUE);
                SetWindowText(CSVSettingsTextBox,"Packets will be exported in a new line");
            }
            continue;
        }

        if ((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CSVSettingsLeftOnceButtonWindow) || (Current_Window==CSVSettingsList2Window && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_LEFT && !shift) ) {
            int selection = SendMessage(CSVSettingsList2Window,LB_GETCURSEL,0,0);
            switch_setting(selection,true);
            SendMessage(CSVSettingsList2Window,LB_SETCURSEL,0,0);
            continue;
        }
        if ((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CSVSettingsRightOnceButtonWindow) || (Current_Window==CSVSettingsList1Window && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RIGHT && !shift) ) {
            int selection = SendMessage(CSVSettingsList1Window,LB_GETCURSEL,0,0);
            switch_setting(selection,false);
            SendMessage(CSVSettingsList1Window,LB_SETCURSEL,0,0);
            continue;
        }
        if ((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CSVSettingsLeftAllButtonWindow) || (Current_Window==CSVSettingsList2Window && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_LEFT && shift) ) {
            switch_all(true);
            SetFocus(CSVSettingsList1Window);
            SendMessage(CSVSettingsList1Window,LB_SETCURSEL,0,0);
            continue;
        }
        if ((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CSVSettingsRightAllButtonWindow) || (Current_Window==CSVSettingsList1Window && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RIGHT && shift) ) {
            switch_all(false);
            SetFocus(CSVSettingsList2Window);
            SendMessage(CSVSettingsList2Window,LB_SETCURSEL,0,0);
            continue;
        }

        if (IsWindowVisible(TTXWindow) && (Current_Message.message==WM_KEYDOWN || Current_Message.message==WM_LBUTTONDOWN)) {
            if (!M_MZ) break;
            ShowWindow(TTXWindow,SW_HIDE);
            SetFocus(DecodeButtonWindow);
        }

        if (Current_Message.message==WM_KEYDOWN) {
            Key_Is_Down=true;
            if (Current_Message.wParam==VK_SHIFT) {
                if (!shift) RedrawWindow(VTRACKWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
                Key_Is_Down = false;
                shift = true;
            }
            if (Current_Message.wParam==VK_CONTROL) control = true;
            if (Current_Message.wParam=='Q' && control) break;
            if (Current_Message.wParam=='R' && control && !IsWindowVisible(GameWindow)) {
                reset_view();
                continue;
            }
            if (IsWindowVisible(GameWindow)) {
                if (Current_Message.wParam==VK_ESCAPE) {
                    ShowWindow(GameWindow,SW_HIDE);
                    SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);
                    SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                    SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                    ShowWindow(EnlargeMessageWindowButton,nCmdShow);
                    ShowWindow(MessageWindow,nCmdShow);
                    SetFocus(MessageWindow);
                }
                if (Current_Message.wParam==VK_UP && game_train_pos_y>0) {
                    if (GetPixel(game_DC,(game_train_pos_x+35)*x_scale,(400/game_rows*(game_train_pos_y-1)+19)*y_scale)==Black)
                    game_train_pos_y--;
                }
                if (Current_Message.wParam==VK_DOWN && game_train_pos_y<game_rows-1) {
                    if (GetPixel(game_DC,(game_train_pos_x+35)*x_scale,(400/game_rows*(game_train_pos_y+1)+19)*y_scale)==Black)
                    game_train_pos_y++;
                }
                if (Current_Message.wParam=='R' && control) {
                    game_setup_init();
                }
                if (Current_Message.wParam=='P') game_paused = game_paused?false:true;
            }
        }

        if (Current_Message.message==WM_KEYDOWN && (Current_Window==MessageWindow || Current_Window==VTRACKWindow || Current_Window==SpeedProfileWindow || Current_Window==GameWindow) && (IsWindowVisible(GameWindow) || IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow)) && Current_Message.wParam=='W') {
            VTrack_selected_train_index++; if (VTrack_selected_train_index==12) VTrack_selected_train_index=1;
            switch(VTrack_selected_train_index) {
                case 1:
                    SELECTED_TRAIN = THALYS; SELECTED_TRAIN_R = THALYS_R;
                break;
                case 2:
                    SELECTED_TRAIN = EUROSTAR; SELECTED_TRAIN_R = EUROSTAR_R;
                break;
                case 3:
                    SELECTED_TRAIN = ICE; SELECTED_TRAIN_R = ICE_R;
                break;
                case 4:
                    SELECTED_TRAIN = IZY; SELECTED_TRAIN_R = IZY_R;
                break;
                case 5:
                    SELECTED_TRAIN = OUIGO; SELECTED_TRAIN_R = OUIGO_R;
                break;
                case 6:
                    SELECTED_TRAIN = DUPLEX; SELECTED_TRAIN_R = DUPLEX_R;
                break;
                case 7:
                    SELECTED_TRAIN = TGV; SELECTED_TRAIN_R = TGV_R;
                break;
                case 8:
                    SELECTED_TRAIN = ITALO; SELECTED_TRAIN_R = ITALO_R;
                break;
                case 9:
                    SELECTED_TRAIN = TRAINDB; SELECTED_TRAIN_R = TRAINDB_R;
                break;
                case 10:
                    SELECTED_TRAIN = TRAINSNCB; SELECTED_TRAIN_R = TRAINSNCB_R;
                break;
                case 11:
                    SELECTED_TRAIN = TRAINNS; SELECTED_TRAIN_R = TRAINNS_R;
                break;

            }
            if (IsWindowVisible(VTRACKWindow)) RedrawWindow(VTRACKWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            if (IsWindowVisible(GameWindow)) {
                RedrawWindow(GameWindow,&game_train_pos,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            }
        }

        if (IsWindowVisible(GameWindow)) {
            if (game_paused) continue;
            game_distance++;
            if (game_train_pos_x<(700*x_scale)) {
                game_train_pos_x++;
                RedrawWindow(GameWindow,&game_train_pos,NULL,RDW_UPDATENOW|RDW_INVALIDATE);
                RedrawWindow(GameWindow,&game_dashboard,NULL,RDW_UPDATENOW|RDW_INVALIDATE);
            } else {
                game_train_pos_offset++;
                game_panorama_offset++;

                if (game_panorama_offset==(int)(1500*x_scale)) game_panorama_offset=0;
                if (game_train_pos_offset==((int)(1400*x_scale)/(game_columns-1))) {
                    game_train_pos_offset=0;
                    for (i=0;i<game_rows;i++) {
                        for (j=0;j<game_columns;j++) {
                            if (j<game_columns-1) {
                                game_setup[i][j]=game_setup[i][j+1];
                            } else {
                                l = range_rand(100);
                                if (game_setup[i][j-1]!=game_part_void) {
                                    if (l<=10) {
                                        if (j>=7 && game_setup[i][j-1]!=game_part_void && game_setup[i][j-2]!=game_part_void&& game_setup[i][j-3]!=game_part_void&& game_setup[i][j-4]!=game_part_void&& game_setup[i][j-5]!=game_part_void&& game_setup[i][j-6]!=game_part_void&& game_setup[i][j-7]!=game_part_void) game_setup[i][j]=game_part_void;
                                        else game_setup[i][j]=game_part_track;
                                    }
                                    else if (l<=90) game_setup[i][j]=game_part_track;
                                    else if (l<=93) game_setup[i][j]=game_part_malus;
                                    else game_setup[i][j]=game_part_bonus;
                                } else {
                                    if (l<=75 && (game_setup[i][j-1]!=game_part_void || game_setup[i][j-2]!=game_part_void)) game_setup[i][j]=game_part_void;
                                    else if (l<=90) game_setup[i][j]=game_part_track;
                                    else if (l<=93) game_setup[i][j]=game_part_malus;
                                    else game_setup[i][j]=game_part_bonus;
                                }
                                if (l==90 && game_setup[i][j]==game_part_track) game_setup[i][j]=game_part_train-range_rand(11);
                            }
                        }
                    }
                }
                RedrawWindow(GameWindow,NULL,NULL,RDW_ERASENOW|RDW_UPDATENOW|RDW_INVALIDATE|RDW_NOERASE);
            }

            TranslateMessage(&Current_Message);
            DispatchMessage(&Current_Message);
            if (PeekMessage(&Peek_Message,NULL,0,0,PM_NOREMOVE)==0) PostMessage(MainWindow,GAME_CONTINUOUS_MESSAGE,0,0);
            Sleep(game_train_speed);
            if (GetPixel(game_DC,(game_train_pos_x+55)*x_scale,(400/game_rows*(game_train_pos_y)+19)*y_scale)!=Black) {
                game_setup_init();
            }
            if (game_setup[game_train_pos_y][game_columns/2-1]==game_part_bonus && game_train_pos_offset==((int)(700*x_scale)/(game_columns-1)) && game_train_speed>7) {
                game_train_speed--;
                if (game_train_speed==20) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_40);
                if (game_train_speed==19) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_60);
                if (game_train_speed==18) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_80);
                if (game_train_speed==17) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_100);
                if (game_train_speed==16) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_120);
                if (game_train_speed==15) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_140);
                if (game_train_speed==14) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_160);
                if (game_train_speed==13) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_180);
                if (game_train_speed==12) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_200);
                if (game_train_speed==11) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_220);
                if (game_train_speed==10) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_240);
                if (game_train_speed==9) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_260);
                if (game_train_speed==8) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_280);
                if (game_train_speed==7) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_300);
            }
            if (game_setup[game_train_pos_y][game_columns/2-1]==game_part_malus && game_train_pos_offset==((int)(700*x_scale)/(game_columns-1)) && game_train_speed<20) {
                game_train_speed+=4;
                if (game_train_speed>20) game_train_speed=20;
                if (game_train_speed==20) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_40);
                if (game_train_speed==19) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_60);
                if (game_train_speed==18) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_80);
                if (game_train_speed==17) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_100);
                if (game_train_speed==16) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_120);
                if (game_train_speed==15) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_140);
                if (game_train_speed==14) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_160);
                if (game_train_speed==13) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_180);
                if (game_train_speed==12) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_200);
                if (game_train_speed==11) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_220);
                if (game_train_speed==10) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_240);
                if (game_train_speed==9) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_260);
                if (game_train_speed==8) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_280);
                if (game_train_speed==7) SelectObject(game_speedometer_dc,GAME_SPEEDOMETER_300);
            }
            continue;
        }

        if (Current_Window==SpeedProfileWindow && Current_Message.message==WM_KEYDOWN) {
            SendMessage(MessageWindow,WM_KEYDOWN,Current_Message.wParam,Current_Message.lParam);
        }
        if (Current_Message.message==WM_LBUTTONDOWN) is_still_down=1;
        if (Current_Message.message==WM_LBUTTONUP || Current_Message.message==WM_NCLBUTTONUP) {
            is_still_down=0;
        }
        if (is_still_down>0) {
            is_still_down++;
            if (PeekMessage(&Peek_Message,NULL,0,0,PM_NOREMOVE)==0) {
                PostMessage(SpeedProfileWindow,IS_STILL_DOWN_MESSAGE,0,0);
            }
        }

        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==SendReportButtonWindow) {
            GetWindowText(ReportWindow,Window_Buffer,Window_Buffer_Size-1);
            send_report(Window_Buffer,MONITOR.left+9, MONITOR.top+9, MONITOR.right-MONITOR.left-18, MONITOR.bottom-MONITOR.top-18);
        }

        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==ExpandAllButton1) sequence_expand_all(SequenceListWindow1);
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==ExpandAllButton2) sequence_expand_all(SequenceListWindow2);
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CollapseAllButton1) sequence_collapse_all(SequenceListWindow1);
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CollapseAllButton2) sequence_collapse_all(SequenceListWindow2);

        if (GetCursor()!=Arrow_Cursor && GetCursor()!=Hand_Cursor && GetCursor()!=Beam_Cursor) SetCursor(Arrow_Cursor);
        if ((Current_Message.message==WM_KEYDOWN && (isMessageWindowMaximized||isHeadersWindowMaximized||isDetailsWindowMaximized) && Current_Message.wParam==VK_ESCAPE) || ((isMessageWindowMaximized || isDetailsWindowMaximized || isHeadersWindowMaximized) && Current_Message.message==WM_NCLBUTTONDOWN)) {
            isWindowMaximized=true;
            EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)MessageWindow);
            isMessageWindowMaximized=false;
            isHeadersWindowMaximized=false;
            isDetailsWindowMaximized=false;
            continue;
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE) {
            if (Current_Window==EnlargeMessageWindowButton) {
                isWindowMaximized=false;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)MessageWindow);
                isMessageWindowMaximized=true;
                SetFocus(MessageWindow);
                continue;
            }
            else if (Current_Window==EnlargeHeadersWindowButton) {
                isWindowMaximized=false;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)HeadersWindow);
                isHeadersWindowMaximized=true;
                SetFocus(MessageWindow);
                continue;
            }
            else if (Current_Window==EnlargeDetailsWindowButton) {
                isWindowMaximized=false;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)DetailsWindow);
                isDetailsWindowMaximized=true;
                SetFocus(MessageWindow);
                continue;
            }
        }
        if (Current_Message.message==WM_NCLBUTTONDOWN && Current_Message.wParam<=HTBOTTOMRIGHT && Current_Message.wParam>=HTLEFT) continue;
        if (Current_Message.message==BTN_CLICKED_MESSAGE) {
            if (Current_Window==PacketListButtonWindow_1) {
                Init_Help();
                ShowWindow(PacketListWindow_1,nCmdShow);
                SendMessage(PacketListButtonWindow_1,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Track to train packets");
                SetFocus(PacketListWindow_1);
                continue;
            }
            if (Current_Window==PacketListButtonWindow_2) {
                Init_Help();
                ShowWindow(PacketListWindow_2,nCmdShow);
                SendMessage(PacketListButtonWindow_2,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Train to track packets");
                SetFocus(PacketListWindow_2);
                continue;
            }
            if (Current_Window==MessageListButtonWindow_1) {
                Init_Help();
                ShowWindow(MessageListWindow_1,nCmdShow);
                SendMessage(MessageListButtonWindow_1,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Track to train messages");
                SetFocus(MessageListWindow_1);
                continue;
            }
            if (Current_Window==MessageListButtonWindow_2) {
                Init_Help();
                ShowWindow(MessageListWindow_2,nCmdShow);
                SendMessage(MessageListButtonWindow_2,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Train to track messages");
                SetFocus(MessageListWindow_2);
                continue;
            }
            if (Current_Window==LogListButtonWindow) {
                Init_Help();
                ShowWindow(LogListWindow,nCmdShow);
                SendMessage(LogListButtonWindow,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Logs");
                SetFocus(LogListWindow);
                SendMessage(LogListWindow,LB_SETCURSEL,SendMessage(LogListWindow,LB_GETCOUNT,0,0)-1,0);
                SetFocus(LogListWindow);
                continue;
            }
            if (Current_Window==ReportButtonWindow) {
                Init_Help();
                ShowWindow(ReportWindow,nCmdShow);
                ShowWindow(SendReportButtonWindow,nCmdShow);
                SendMessage(ReportButtonWindow,BM_SETCHECK,1,0);
                SetWindowText(MainHelpWindow,"Report a bug");
                SetFocus(ReportWindow);
                continue;
            }
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_TAB) {
            if (shift) {
                if (IsWindowVisible(PacketListWindow_1)) {
                    Init_Help();
                    ShowWindow(ReportWindow,nCmdShow);
                    ShowWindow(SendReportButtonWindow,nCmdShow);
                    SendMessage(ReportButtonWindow,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Report a bug");
                    SetFocus(ReportWindow);
                    continue;
                } else if (IsWindowVisible(PacketListWindow_2)) {
                    Init_Help();
                    ShowWindow(PacketListWindow_1,nCmdShow);
                    SendMessage(PacketListButtonWindow_1,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Track to train packets");
                    SetFocus(PacketListWindow_1);
                    continue;
                } else if (IsWindowVisible(MessageListWindow_1)) {
                    Init_Help();
                    ShowWindow(PacketListWindow_2,nCmdShow);
                    SendMessage(PacketListButtonWindow_2,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Train to track packets");
                    SetFocus(PacketListWindow_2);
                    continue;
                } else if (IsWindowVisible(MessageListWindow_2)) {
                    Init_Help();
                    ShowWindow(MessageListWindow_1,nCmdShow);
                    SendMessage(MessageListButtonWindow_1,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Track to train messages");
                    SetFocus(MessageListWindow_1);
                    continue;
                } else if (IsWindowVisible(LogListWindow)) {
                    Init_Help();
                    ShowWindow(MessageListWindow_2,nCmdShow);
                    SendMessage(MessageListButtonWindow_2,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Train to track messages");
                    SetFocus(MessageListWindow_2);
                    continue;
                } else if (IsWindowVisible(ReportWindow)) {
                    Init_Help();
                    ShowWindow(LogListWindow,nCmdShow);
                    SendMessage(LogListButtonWindow,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Logs");
                    SetFocus(LogListWindow);
                    SendMessage(LogListWindow,LB_SETCURSEL,SendMessage(LogListWindow,LB_GETCOUNT,0,0)-1,0);
                    continue;
                }
            } else {
                if (IsWindowVisible(PacketListWindow_1)) {
                    Init_Help();
                    ShowWindow(PacketListWindow_2,nCmdShow);
                    SendMessage(PacketListButtonWindow_2,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Train to track packets");
                    SetFocus(PacketListWindow_2);
                    continue;
                } else if (IsWindowVisible(PacketListWindow_2)) {
                    Init_Help();
                    ShowWindow(MessageListWindow_1,nCmdShow);
                    SendMessage(MessageListButtonWindow_1,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Track to train messages");
                    SetFocus(MessageListWindow_1);
                    continue;
                } else if (IsWindowVisible(MessageListWindow_1)) {
                    Init_Help();
                    ShowWindow(MessageListWindow_2,nCmdShow);
                    SendMessage(MessageListButtonWindow_2,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Train to track messages");
                    SetFocus(MessageListWindow_2);
                    continue;
                } else if (IsWindowVisible(MessageListWindow_2)) {
                    Init_Help();
                    ShowWindow(LogListWindow,nCmdShow);
                    SendMessage(LogListButtonWindow,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Logs");
                    SetFocus(LogListWindow);
                    SendMessage(LogListWindow,LB_SETCURSEL,SendMessage(LogListWindow,LB_GETCOUNT,0,0)-1,0);
                    continue;
                } else if (IsWindowVisible(LogListWindow)) {
                    Init_Help();
                    ShowWindow(ReportWindow,nCmdShow);
                    ShowWindow(SendReportButtonWindow,nCmdShow);
                    SendMessage(ReportButtonWindow,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Report a bug");
                    SetFocus(ReportWindow);
                    continue;
                } else if (IsWindowVisible(ReportWindow)) {
                    Init_Help();
                    ShowWindow(PacketListWindow_1,nCmdShow);
                    SendMessage(PacketListButtonWindow_1,BM_SETCHECK,1,0);
                    SetWindowText(MainHelpWindow,"Track to train packets");
                    SetFocus(PacketListWindow_1);
                    continue;
                }
            }
        }

        if ((Current_Window==LogListWindow || Current_Window==TrainListWindow) && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RETURN) || (Current_Message.message==WM_LBUTTONDBLCLK))) {
            int index = SendMessage(Current_Window,LB_GETITEMDATA,SendMessage(Current_Window,LB_GETCURSEL,0,0),0);
            if (index>=0) {
                SendMessage(MessageWindow,LB_SETCURSEL,index,0);
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
            }
        }
        if (Current_Window==BaliseListWindow && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RETURN) || (Current_Message.message==WM_LBUTTONDBLCLK))) {
            int index = SendMessage(BaliseListWindow,LB_GETCURSEL,0,0);
            SendMessage(MessageWindow,LB_SETCURSEL,Message_Details_Storage[Balise_Storage[index]-message_index_offset],0);
            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window == BaliseListExportButtonWindow && Last_Message>0) {
            LBG_File = fopen("LBG.csv","w+");
            int lbg_count = SendMessage(BaliseListWindow,LB_GETCOUNT,0,0);
            fprintf(LBG_File,"NID_C;NID_BG;DIRECTION;DECISION;DATE;TRAIN\n");
            ShowWindow(BaliseListExportProgressWindow, nCmdShow);
            for (i=0;i<lbg_count;i++) {
                SendMessage(BaliseListWindow,LB_GETTEXT,i,(LPARAM)Window_Buffer);
                int index = SendMessage(BaliseListWindow,LB_GETITEMDATA,i,0);
                strtok(Window_Buffer,"\t");
                fprintf(LBG_File,"%s",Window_Buffer);
                fprintf(LBG_File,";%s",strtok(NULL,"\t"));
                if (index>4) fprintf(LBG_File,";Nominal"); else fprintf(LBG_File,";Reverse");
                fprintf(LBG_File,";%s",strtok(NULL,"\t"));
                fprintf(LBG_File,";%s",strtok(NULL,"\t"));
                fprintf(LBG_File,";%s\n",strtok(NULL,"\t"));
                SendMessage(BaliseListExportProgressWindow,PBM_SETPOS,(100*i)/lbg_count,0);
            }
            fclose(LBG_File);
            ShowWindow(BaliseListExportProgressWindow, SW_HIDE);
            ShowWindow(BaliseListOpenCSVButtonWindow, nCmdShow);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window == SequenceExportButtonWindow1 && Last_Message>0) {
            SL1_File = fopen("SL1.csv","w+");
            int sl1_count = SendMessage(SequenceListWindow1,LB_GETCOUNT,0,0);
            ShowWindow(SequenceExportProgressWindow1, nCmdShow);
            for (i=0;i<sl1_count;i++) {
                SendMessage(SequenceListWindow1,LB_GETTEXT,i,(LPARAM)Window_Buffer);
                strtok(Window_Buffer,"\t");
                fprintf(SL1_File,"%s",Window_Buffer);
                fprintf(SL1_File,";%s",strtok(NULL,"\t"));
                fprintf(SL1_File,";%s\n",strtok(NULL,"\t"));
                SendMessage(SequenceExportProgressWindow1,PBM_SETPOS,(100*i)/sl1_count,0);
            }
            fclose(SL1_File);
            ShowWindow(SequenceExportProgressWindow1, SW_HIDE);
            ShowWindow(SequenceOpenCSVButtonWindow1, nCmdShow);
            CSVSequence1_is_done = true;
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window == SequenceExportButtonWindow2 && Last_Message>0) {
            SL2_File = fopen("SL2.csv","w+");
            int sl2_count = SendMessage(SequenceListWindow2,LB_GETCOUNT,0,0);
            ShowWindow(SequenceExportProgressWindow2, nCmdShow);
            for (i=0;i<sl2_count;i++) {
                SendMessage(SequenceListWindow2,LB_GETTEXT,i,(LPARAM)Window_Buffer);
                strtok(Window_Buffer,"\t");
                fprintf(SL2_File,"%s",Window_Buffer);
                fprintf(SL2_File,";%s",strtok(NULL,"\t"));
                fprintf(SL2_File,";%s\n",strtok(NULL,"\t"));
                SendMessage(SequenceExportProgressWindow1,PBM_SETPOS,(100*i)/sl2_count,0);
            }
            fclose(SL2_File);
            ShowWindow(SequenceExportProgressWindow2, SW_HIDE);
            ShowWindow(SequenceOpenCSVButtonWindow2, nCmdShow);
            CSVSequence2_is_done = true;
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window == CSVListExportButtonWindow && Last_Message>0) {
            CSV_File = fopen("CSV.csv","w+");
            int csv_count = SendMessage(MessageWindow,LB_GETCOUNT,0,0);
            ShowWindow(CSVListExportProgressWindow, nCmdShow);
            fprintf(CSV_File,"MESSAGE_ID;TIMESTAMP;Q_SCALE (m);NID_C;NID_LRBG;D_LRBG;Q_DIR/QDLRBG;L_DOUBTOVER/L_DOUBTUNDER;V_TRAIN;DRIVER_ID;NID_OPERATIONAL;LEVEL;MODE\n");
            for (i=0;i<csv_count;i++) {
                SendMessage(MessageWindow,LB_GETTEXT,i,(LPARAM)Window_Buffer);
                int split_count = 0;
                int csv_detail_position = SendMessage(MessageWindow,LB_GETITEMDATA,i,0);
                int csv_details_End_Point;
                int csv_id;
                if (i==Last_Message) csv_details_End_Point = End_Details_Position; else csv_details_End_Point = SendMessage(MessageWindow,LB_GETITEMDATA,i+1,0)-max_details_offset;
                for(j=0;j<strlen(Window_Buffer);j++) {
                    if (Window_Buffer[j]=='\t') {
                        Window_Buffer[j]=';';
                        if (split_count==0) Window_Buffer[j+22]=';';
                        split_count ++;
                    }
                }
                csv_id = Message_Details_Storage[csv_detail_position-id_detail_offset];
                if (excel_message_settings[csv_id]=='1') {
                    if (csv_id==6 || csv_id==9 || csv_id==10) {
                        fprintf(CSV_File,"%s\n",Window_Buffer);
                        if (exportpacketexpand) {
                            for (k=csv_detail_position;k<=csv_details_End_Point;k++) {
                                int csv_p = Message_Details_Storage[k];
                                if (csv_p<0 && csv_p!=-255) {
                                    if (csv_p==-256) csv_p=0;
                                    fprintf(CSV_File,"%s;P%03d\n",Window_Buffer,-csv_p);
                                }
                            }
                        }
                    } else {
                        fprintf(CSV_File,"%s\n",Window_Buffer);
                    }
                }

                SendMessage(CSVListExportProgressWindow,PBM_SETPOS,(100*i)/csv_count,0);
            }
            isCSVdone = true;
            fclose(CSV_File);
            ShowWindow(CSVListExportProgressWindow, SW_HIDE);
            ShowWindow(CSVListOpenCSVButtonWindow, nCmdShow);
        }
//        if (run_media || Current_Message.message==VLC_CONTINUOUS_MESSAGE) {
//            if (IsWindowVisible(MediaWindow_1)) {
//                float media_time_1 = libvlc_media_player_get_position(my_player_1);
//                unsigned long long media_time_position_1 = (unsigned long long)(media_time_1*media_duration_1);
//                unsigned long long media_time_goal_1 = media_start_1-(unsigned long long)initial_tts_1+media_time_position_1;
//                if (media_start_1==0 && media_time_1==0) media_time_goal_1=0;
//                for (i=Message_Position;i<Last_Message;i++) {
//                    if (Time_Storage[i+1]>media_time_goal_1) break;
//                }
//                if (i!=Message_Position) {
//                    SendMessage(MessageWindow,LB_SETCURSEL,i,0);
//                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,-1);
//                    UpdateWindow(MessageWindow);
//                }
//                media_time_1 = libvlc_media_player_get_position(my_player_1);
//                struct tm tm_media_1 = *localtime(&media_time_t_1);
//                tm_media_1.tm_sec += (int)(media_time_position_1/1000);
//                int media_tts_1 = media_time_position_1-1000*(int)(media_time_position_1/1000);
//                mktime(&tm_media_1);
//                sprintf(Window_Buffer,"%02d:%02d:%02d:%03d\n",tm_media_1.tm_hour,tm_media_1.tm_min,tm_media_1.tm_sec,media_tts_1);
//            }
//            if (IsWindowVisible(MediaWindow_2)) {
//                float media_time_2 = libvlc_media_player_get_position(my_player_2);
//                unsigned long long media_time_position_2 = (unsigned long long)(media_time_2*media_duration_2);
//                unsigned long long media_time_goal_2 = media_start_2-(unsigned long long)initial_tts_2+media_time_position_2;
//                if (media_start_2==0 && media_time_2==0) media_time_goal_2=0;
//                for (i=Message_Position;i<Last_Message;i++) {
//                    if (Time_Storage[i+1]>media_time_goal_2) break;
//                }
//                if (i!=Message_Position) {
//                    SendMessage(MessageWindow,LB_SETCURSEL,i,0);
//                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,-1);
//                    UpdateWindow(MessageWindow);
//                }
//                media_time_2 = libvlc_media_player_get_position(my_player_2);
//                struct tm tm_media_2 = *localtime(&media_time_t_2);
//                tm_media_2.tm_sec += (int)(media_time_position_2/1000);
//                int media_tts_2 = media_time_position_2-1000*(int)(media_time_position_2/1000);
//                mktime(&tm_media_2);
//                sprintf(Window_Buffer,"%02d:%02d:%02d:%03d",tm_media_2.tm_hour,tm_media_2.tm_min,tm_media_2.tm_sec,media_tts_2);
//            }
//
//            if (PeekMessage(&Peek_Message,NULL,0,0,PM_NOREMOVE)==0) PostMessage(MainWindow,VLC_CONTINUOUS_MESSAGE,0,0);
//        }

        if ((IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow))  && Current_Window==MainWindow) {
            SetFocus(MessageWindow);
            Current_Window=MessageWindow;
        }
        if (Current_Window==FolderViewWindow && Current_Message.message==WM_KEYDOWN && shift) {
            int folder_view_pos = SendMessage(FolderViewWindow,LB_GETCURSEL,0,0);
            if (Current_Message.wParam=='D') SendMessage(FolderViewWindow,LB_SETITEMDATA,folder_view_pos,16);
            if (Current_Message.wParam=='J') SendMessage(FolderViewWindow,LB_SETITEMDATA,folder_view_pos,98);
            if (Current_Message.wParam=='D' || Current_Message.wParam=='J') {
                RedrawWindow(FolderViewWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
                SendMessage(FolderViewWindow,LB_SETCURSEL,folder_view_pos,0);
                continue;
            }
        }
        if (Current_Message.message==MOUSE_MOVE_MESSAGE && IsWindowVisible(VTRACKWindow)) {
            int x = LOWORD(Current_Message.lParam)-23;
            int y = HIWORD(Current_Message.lParam)-39;
            SetCursor(Arrow_Cursor);
            for (i=Max_Number_Of_Balise_Visual;i>=0;i--) {
                if (Balise_X_Storage[i]==0) continue;
                if ((x-Balise_X_Storage[i])>0 && (x-Balise_X_Storage[i])<12 && (y-Balise_Y_Storage[i])>0 && (y-Balise_Y_Storage[i])<12) {
                    SetCursor(Hand_Cursor);
                }
            }
        }
        if (Current_Message.message==WM_LBUTTONUP && (Current_Window==MessageWindow || Current_Window==VTRACKWindow) && IsWindowVisible(VTRACKWindow)) {
            int x = LOWORD(Current_Message.lParam)-23;
            int y = HIWORD(Current_Message.lParam)-39;
            int balise_index = Message_Details_Storage[Details_Position-balise_storage_index];
            int bg;
            int nc;
            int source;
            for (i=Max_Number_Of_Balise_Visual;i>=0;i--) {
                if (Balise_X_Storage[i]==0) continue;
                if ((x-Balise_X_Storage[i])>0 && (x-Balise_X_Storage[i])<12 && (y-Balise_Y_Storage[i])>0 && (y-Balise_Y_Storage[i])<12) {
                    if (shift) source = Balise_Storage[balise_index-i]; else source = Balise_Storage[balise_index+i];
                    nc = Message_Details_Storage[source+7];
                    bg = Message_Details_Storage[source+8];
                    if (nc==Message_Details_Storage[Details_Position-last_nid_c_offset] && bg==Message_Details_Storage[Details_Position-last_balise_offset]) {
                        int pig = Message_Details_Storage[Details_Position+3];
                        int total = Message_Details_Storage[Details_Position+4];
                        if (Message_Details_Storage[Details_Position-last_balise_direction_offset]==1) {
                            if (shift) {
                                if (pig==0) SendMessage(MessageWindow,LB_SETCURSEL,min(Message_Position+total,Last_Message),0);
                                else SendMessage(MessageWindow,LB_SETCURSEL,max(Message_Position-1,0),0);
                            } else {
                                if (pig==total) SendMessage(MessageWindow,LB_SETCURSEL,max(Message_Position-total,0),0);
                                else SendMessage(MessageWindow,LB_SETCURSEL,min(Message_Position+1,Last_Message),0);
                            }
                        } else {
                            if (shift) {
                                if (pig==total) SendMessage(MessageWindow,LB_SETCURSEL,min(Message_Position+total,Last_Message),0);
                                else SendMessage(MessageWindow,LB_SETCURSEL,max(Message_Position-1,0),0);
                            } else {
                                if (pig==0) SendMessage(MessageWindow,LB_SETCURSEL,max(Message_Position-total,0),0);
                                else SendMessage(MessageWindow,LB_SETCURSEL,min(Message_Position+1,Last_Message),0);
                            }
                        }
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                        break;
                    }
                    sprintf(Window_Buffer,"%d-%d\n",nc,bg);
                    SetWindowText(BaliseSearchWindow,Window_Buffer);
                    SetWindowText(PacketSearchWindow,"");
                    if (shift) PostMessage(MessageWindow,SEARCH_TRGR_MESSAGE,-1,0); else PostMessage(MessageWindow,SEARCH_TRGR_MESSAGE,1,0);
                    break;
                }
            }
        }
        if (Current_Message.message==WM_LBUTTONDBLCLK && Current_Window==LinkingWindow) {
            SendMessage(LinkingWindow,LB_GETTEXT,0,(LPARAM)Window_Buffer);

            if (Window_Buffer[1]=='N') {
                int new_details_position;
                int new_header_position= 0;

                for (i=Message_Position+1;i<Last_Message;i++) {
                    new_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,i,0);
                    if (Message_Details_Storage[new_details_position-last_valid_linking_offset]>0) break;
                }
                for (j=0;j<10000;j++) {
                    if (Message_Details_Storage[new_details_position+j]<0) new_header_position++;
                    if (Message_Details_Storage[new_details_position+j]==-5) {
                        if (Message_Details_Storage[new_details_position-id_detail_offset]==9) new_header_position--;
                        SendMessage(MessageWindow,LB_SETCURSEL,i,0);
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)new_header_position,0);
                        PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,0);
                        break;
                    }
                }
            } else if (Window_Buffer[9]=='U') {
                SendMessage(MessageWindow,LB_SETCURSEL,first_confidence_balise_index,0);
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
            } else {
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                int P5_position = Message_Details_Storage[Details_Position-last_valid_linking_offset]%linking_data_delimiter;
                int P5_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,P5_position,0);
                int P5_details_header = 0;
                for (i=0;i<10000;i++) {
                    if (Message_Details_Storage[P5_details_position+i]<0) P5_details_header++;
                    if (Message_Details_Storage[P5_details_position+i]==-5) {
                        if (Message_Details_Storage[P5_details_position-id_detail_offset]==9) P5_details_header--;
                        SendMessage(MessageWindow,LB_SETCURSEL,P5_position,0);
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)P5_details_header,0);
                        PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,0);
                        break;
                    }
                }
            }
            SetFocus(MessageWindow);
        }
        if ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='H' && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==HelpButtonWindow)) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(MainHelpWindow)) ShowWindow(MainHelpWindow,0); else {
                SetWindowText(MainHelpWindow,"Train to track packets");
                Init_Help();
                SendMessage(PacketListButtonWindow_1,BM_SETCHECK,1,0);
                ShowWindow(PacketListWindow_1,nCmdShow);
                ShowWindow(MainHelpWindow,nCmdShow);
                SetFocus(PacketListWindow_1);
            }
            continue;
        }
        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && !shift && !control && Current_Message.wParam=='L' && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==BaliseListButtonWindow))) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(MainBaliseListWindow)) {
                ShowWindow(MainBaliseListWindow,0);
                SetFocus(MessageWindow);
            } else {
                ShowWindow(MainBaliseListWindow,nCmdShow);
                SetFocus(BaliseListWindow);
            }
            continue;
        }
        if (Last_Message>0 && ((Current_Window==MessageWindow && Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='T') || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==TrainListButtonWindow))) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(MainTrainListWindow)) {
                ShowWindow(MainTrainListWindow,0);
                SetFocus(MessageWindow);
            } else {
                ShowWindow(MainTrainListWindow,nCmdShow);
                SetFocus(TrainListWindow);
            }
            continue;
        }
        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='S' && shift && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==SequencingButtonWindow))) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(SequenceWindow)) {
                ShowWindow(SequenceWindow,0);
                SetFocus(MessageWindow);
            } else {
                ShowWindow(SequenceWindow,nCmdShow);
                SetFocus(SequenceWindow);
            }
            continue;
        }

        if (((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='C' && shift && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==ColorChartButtonWindow))) {
            if (IsWindowVisible(ColorChartMainWindow)) {
                ShowWindow(ColorChartMainWindow,0);
                SetFocus(MessageWindow);
            } else {
                ShowWindow(ColorChartMainWindow,nCmdShow);
                SetFocus(ColorChartMainWindow);
            }
            continue;
        }
        if (Current_Message.message==WM_LBUTTONDOWN && Current_Window==ColorChartMainWindow && IsWindowVisible(ColorChartMainWindow)) {
            int cc_x_pos = LOWORD(Current_Message.lParam)+11;
            int cc_y_pos = HIWORD(Current_Message.lParam)+37;
            HDC cc_hdc = GetWindowDC(Current_Window);
            if ((int)GetPixel(cc_hdc,cc_x_pos,cc_y_pos)!=15461355) Main = GetPixel(cc_hdc,cc_x_pos,cc_y_pos);
            Main_Brush = CreateSolidBrush(Main);
            DeleteDC(cc_hdc);
            main_R = GetRValue(Main);
            main_G = GetGValue(Main);
            main_B = GetBValue(Main);
            color_saturation = 100;
            fseek(SETTINGS_FILE,-12,SEEK_END);
            fprintf(SETTINGS_FILE,"%03d%03d%03d100",main_R,main_G,main_B);
            RedrawWindow(MainWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE|RDW_ALLCHILDREN);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Window==ColorChartMainWindow && IsWindowVisible(ColorChartMainWindow)) {
            if (Current_Message.wParam==VK_ESCAPE) {
                Main = RGB(30,139,200);
                main_R = 30;
                main_G = 139;
                main_B = 200;
                DeleteObject(Main_Brush);
                Main_Brush = CreateSolidBrush(Main);
                RedrawWindow(MainWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE|RDW_ALLCHILDREN);
                fseek(SETTINGS_FILE,-12,SEEK_END);
                fprintf(SETTINGS_FILE,"030139200100");
                color_saturation=100;
            }
            if (Current_Message.wParam==VK_DOWN && color_saturation>0) {
                color_saturation-=5;
                Main = RGB(color_saturation*main_R/100,color_saturation*main_G/100,color_saturation*main_B/100);
                DeleteObject(Main_Brush);
                Main_Brush = CreateSolidBrush(Main);
                RedrawWindow(MainWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE|RDW_ALLCHILDREN);
                fseek(SETTINGS_FILE,-3,SEEK_END);
                fprintf(SETTINGS_FILE,"%03d",color_saturation);
            }
            if (Current_Message.wParam==VK_UP && color_saturation<100) {
                color_saturation+=5;
                Main = RGB(color_saturation*main_R/100,color_saturation*main_G/100,color_saturation*main_B/100);
                DeleteObject(Main_Brush);
                Main_Brush = CreateSolidBrush(Main);
                RedrawWindow(MainWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE|RDW_ALLCHILDREN);
                fseek(SETTINGS_FILE,-3,SEEK_END);
                fprintf(SETTINGS_FILE,"%03d",color_saturation);
            }
            continue;
        }
        if (Current_Message.message==WM_MOUSEMOVE) {
            if (Current_Message.hwnd==LastFileButtonWindow && !display_tooltip)  {
                display_tooltip = true;
                ShowWindow(TooltipWindow,nCmdShow);
                int filename_length = strlen(Filename_Buffer);
                if (strstr(Filename_Buffer,"void")!=NULL) {
                    SetWindowText(TooltipWindow,"No file");
                    SetWindowPos(TooltipWindow,NULL,1584*x_scale,472*y_scale,49*x_scale,20*y_scale,SWP_NOZORDER);
                } else {
                    SetWindowText(TooltipWindow,Filename_Buffer);
                    SetWindowPos(TooltipWindow,NULL,(1633-7*filename_length)*x_scale,472*y_scale,7*filename_length*x_scale,20*y_scale,SWP_NOZORDER);
                }
            } else if (Current_Message.hwnd!=LastFileButtonWindow && display_tooltip) {
                display_tooltip = false;
                ShowWindow(TooltipWindow,0);
            }
        }

        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='V' && shift && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==SpeedProfileButtonWindow))) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(SpeedProfileWindow)) {
                SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);
                ShowWindow(SpeedProfileWindow,0);
                ShowWindow(VTRACKListWindow,0);
                SetFocus(MessageWindow);
                ShowWindow(MessageWindow,1);
                ShowWindow(EnlargeMessageWindowButton,nCmdShow);
            } else {
                SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,1,0);
                SendMessage(MessageButtonWindow,BM_SETCHECK,0,0);
                ShowWindow(SpeedProfileWindow,nCmdShow);
                ShowWindow(VTRACKListWindow,1);
                SetFocus(MessageWindow);
                ShowWindow(MessageWindow,0);
                ShowWindow(VTRACKWindow,0);
                ShowWindow(EnlargeMessageWindowButton,0);
            }
            continue;
        }
        if (Last_Message>0 && Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==MessageButtonWindow) {
            if (!IsWindowVisible(MessageWindow)) {
                SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);
                ShowWindow(SpeedProfileWindow,0);
                ShowWindow(VTRACKWindow,0);
                ShowWindow(MessageWindow,nCmdShow);
                ShowWindow(VTRACKListWindow,0);
                SetFocus(MessageWindow);
                ShowWindow(EnlargeMessageWindowButton,nCmdShow);
            }
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && (Current_Window==SequencingStartButtonWindow1 || Current_Window==SequencingStartButtonWindow2)) {
            if (Reference_Message>=0) {
                int debut,fin,i,Sequencing_details_position,sequence_message_id,j,sequencing_packet,time_parse,time_parse_min,time_parse_sec,sequence_last_details;
                HWND sequencelist_window;
                if (Current_Window==SequencingStartButtonWindow1) {
                    ShowWindow(SequenceExportProgressWindow1,nCmdShow);
                    sequencelist_window=SequenceListWindow1;
                    ShowWindow(SequenceOpenCSVButtonWindow1,SW_HIDE);
                    CSVSequence1_is_done = false;
                }else {
                    ShowWindow(SequenceExportProgressWindow2,nCmdShow);
                    sequencelist_window=SequenceListWindow2;
                    ShowWindow(SequenceOpenCSVButtonWindow2,SW_HIDE);
                    CSVSequence2_is_done = false;
                }
                SendMessage(sequencelist_window,WM_SETREDRAW,0,0);
                SendMessage(sequencelist_window,LB_RESETCONTENT,0,0);
                unsigned long long sequencing_distance,sequencing_time;
                if (Reference_Message<=Message_Position) {debut = Reference_Message; fin = Message_Position;} else {debut = Message_Position; fin = Reference_Message;}
                sequencing_time = Time_Storage[debut];
                sequencing_distance = Distance_Storage[debut];
                for (i=debut;i<=fin;i++) {
                    Sequencing_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,i,0);
                    if (i==Last_Message) sequence_last_details = End_Details_Position; else sequence_last_details = SendMessage(MessageWindow,LB_GETITEMDATA,i+1,0)-max_details_offset;
                    sequence_message_id = Message_Details_Storage[Sequencing_details_position-id_detail_offset];
                    time_parse = (int)(Time_Storage[i]-sequencing_time);
                    time_parse_min=0;
                    time_parse_sec=0;
                    while (time_parse>=60000) {time_parse-=60000; time_parse_min++;}
                    while (time_parse>=1000) {time_parse-=1000; time_parse_sec++;}
                    if (sequence_message_id==6) {
                        if (Message_Details_Storage[Sequencing_details_position+7]==1) sprintf(Window_Buffer,"6 %02d:%02d:%03d\t%d m\tLinked Balise %04d-%05d(%d/%d) ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),Message_Details_Storage[Sequencing_details_position+7],Message_Details_Storage[Sequencing_details_position+8],Message_Details_Storage[Sequencing_details_position+3]+1,Message_Details_Storage[Sequencing_details_position+4]+1);
                        else sprintf(Window_Buffer,"6 %02d:%02d:%03d\t%d m\tUninked Balise %04d-%05d(%d/%d) ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),Message_Details_Storage[Sequencing_details_position+7],Message_Details_Storage[Sequencing_details_position+8],Message_Details_Storage[Sequencing_details_position+3]+1,Message_Details_Storage[Sequencing_details_position+4]+1);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                        j=1;
                        while (Sequencing_details_position+j<sequence_last_details-1) {
                            if (Message_Details_Storage[Sequencing_details_position+j]<0) {
                                sequencing_packet=Message_Details_Storage[Sequencing_details_position+j];
                                Track_To_Train_Packet_Name(sequencelist_window,-sequencing_packet,Sequencing_details_position+j+1+600000000);
                            }
                            j=j+1;
                        }
                    } else if (sequence_message_id==9) {
                        sprintf(Window_Buffer,"9 %02d:%02d:%03d\t%d m\tMessage RBC %03d ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),isBL3?-Message_Details_Storage[Sequencing_details_position+2]:-Message_Details_Storage[Sequencing_details_position]);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                        j=isBL3?3:1;
                        while (Sequencing_details_position+j<sequence_last_details-1) {
                            if (Message_Details_Storage[Sequencing_details_position+j]<0) {
                                sequencing_packet=Message_Details_Storage[Sequencing_details_position+j];
                                Track_To_Train_Packet_Name(sequencelist_window,-sequencing_packet,Sequencing_details_position+j+1+900000000);
                            }
                            j=j+1;
                        }
                    } else if (sequence_message_id==10) {
                        sprintf(Window_Buffer,"8 %02d:%02d:%03d\t%d m\tMessage RBC %03d ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),isBL3?-Message_Details_Storage[Sequencing_details_position+2]:-Message_Details_Storage[Sequencing_details_position]);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                        j=isBL3?3:1;
                        while (Sequencing_details_position+j<sequence_last_details-1) {
                            if (Message_Details_Storage[Sequencing_details_position+j]<0) {
                                sequencing_packet=Message_Details_Storage[Sequencing_details_position+j];
                                Train_To_Track_Packet_Name(sequencelist_window,-sequencing_packet,Sequencing_details_position+j+1+800000000);
                            }
                            j=j+1;
                        }
                    } else if (sequence_message_id==3) {
                        if (Message_Details_Storage[Sequencing_details_position]==1) sprintf(Window_Buffer,"3 %02d:%02d:%03d\t%d m\tEMERGENCY BRAKE : Application",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600));
                        else sprintf(Window_Buffer,"3 %02d:%02d:%03d\t%d m\tEMERGENCY BRAKE : Revocation",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600));
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),i);
                    } else if (sequence_message_id==199) {
                        sprintf(Window_Buffer,"1 %02d:%02d:%03d\t%d m\tCHANGEMENT DE MODE : ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600));
                        D_m_mode_text(Message_Details_Storage[Sequencing_details_position],&Window_Buffer[strlen(Window_Buffer)]);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                    } else if (sequence_message_id==200) {
                        sprintf(Window_Buffer,"2 %02d:%02d:%03d\t%d m\tCHANGEMENT DE NIVEAU : ",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600));
                        D_m_level_text(Message_Details_Storage[Sequencing_details_position],&Window_Buffer[strlen(Window_Buffer)]);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                    } else if (sequence_message_id==198) {
                        if (Message_Details_Storage[Sequencing_details_position+1]!=32767) sprintf(Window_Buffer,"4 %02d:%02d:%03d\t%d m\tINFO V|D : %d km/h | %d m",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),Message_Details_Storage[Sequencing_details_position],Message_Details_Storage[Sequencing_details_position+1]);
                        else sprintf(Window_Buffer,"4 %02d:%02d:%03d\t%d m\tINFO V|D : %d km/h",time_parse_min,time_parse_sec,time_parse,(int)((Distance_Storage[i]-sequencing_distance)/3600),Message_Details_Storage[Sequencing_details_position]);
                        SendMessage(sequencelist_window,LB_SETITEMDATA,SendMessage(sequencelist_window,LB_ADDSTRING,0,(LPARAM)Window_Buffer),-i);
                    }
                    if (debut!=fin) {
                        if (Current_Window==SequencingStartButtonWindow1) SendMessage(SequenceExportProgressWindow1,PBM_SETPOS,100*(i-debut)/(fin-debut),0); else SendMessage(SequenceExportProgressWindow2,PBM_SETPOS,100*(i-debut)/(fin-debut),0);
                    }
                }
                SendMessage(sequencelist_window,WM_SETREDRAW,1,0);
                SendMessage(sequencelist_window,LB_SETCURSEL,0,0);
                if (Current_Window==SequencingStartButtonWindow1) ShowWindow(SequenceExportProgressWindow1,SW_HIDE); else ShowWindow(SequenceExportProgressWindow2,SW_HIDE);
            }
        }
        if (Last_Message>0 && (Current_Window==SequenceListWindow1 || Current_Window==SequenceListWindow2) && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RETURN) || (Current_Message.message==WM_LBUTTONDBLCLK) || Current_Message.message==BTN_CLICKED_MESSAGE)) {
            int sequence_cur_sel = SendMessage(Current_Window,LB_GETCURSEL,0,0);
            int sequence_item_data = SendMessage(Current_Window,LB_GETITEMDATA,sequence_cur_sel,0);
            if (sequence_item_data<0) {
                SendMessage(MessageWindow,LB_SETCURSEL,abs(sequence_item_data),0);
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
            } else {
                int sequence_next_item_data = SendMessage(Current_Window,LB_GETITEMDATA,sequence_cur_sel+1,0);
                if (sequence_next_item_data==0 && sequence_item_data>0) sequence_collapse(sequence_cur_sel,Current_Window);
                else if (sequence_item_data>0) sequence_expand(sequence_cur_sel,sequence_item_data,Current_Window);
            }
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_ESCAPE && IsWindowVisible(MainHelpWindow)) ShowWindow(MainHelpWindow,0);
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_TAB) {
            if (shift) {
                if ((Current_Window==MessageWindow || Current_Window==VTRACKWindow)) SetFocus(DetailsWindow);
                else if (Current_Window==DetailsWindow) SetFocus(HeadersWindow);
                else if (Current_Window==HeadersWindow) {if (IsWindowVisible(MessageWindow)) SetFocus(MessageWindow); else if (IsWindowVisible(VTRACKWindow)) SetFocus(VTRACKListWindow); else SetFocus(SpeedProfileWindow);}
                else if (Current_Window==MessageSearchWindow || Current_Window==MessageSearchWindowChild) SetFocus(LevelSearchWindow);
                else if (Current_Window==DateSearchWindow) SetFocus(MessageSearchWindow);
                else if (Current_Window==TrainSearchWindow) SetFocus(DateSearchWindow);
                else if (Current_Window==PacketSearchWindow) SetFocus(SpeedSearchWindow);
                else if (Current_Window==RadioSearchWindow) SetFocus(PacketSearchWindow);
                else if (Current_Window==BaliseSearchWindow) SetFocus(RadioSearchWindow);
                else if (Current_Window==LinkedBaliseSearchWindow) SetFocus(BaliseSearchWindow);
                else if (Current_Window==SpeedSearchWindow) SetFocus(TrainSearchWindow);
                else if (Current_Window==LevelSearchWindow || Current_Window==LevelSearchWindowChild) SetFocus(ModeSearchWindow);
                else if (Current_Window==ModeSearchWindow || Current_Window==ModeSearchWindowChild) SetFocus(AdvancedSearchValueWindow);
                else if (Current_Window==AdvancedSearchValueWindow) SetFocus(AdvancedSearchNameWindow);
                else if (Current_Window==AdvancedSearchNameWindow) SetFocus(LinkedBaliseSearchWindow);
                else if (Current_Window==CSVSettingsList1Window) {SetFocus(CSVSettingsList2Window); SendMessage(CSVSettingsList1Window,LB_SETCURSEL,-1,0); SendMessage(CSVSettingsList2Window,LB_SETCURSEL,0,0);}
                else if (Current_Window==CSVSettingsList2Window) {SetFocus(CSVSettingsList1Window); SendMessage(CSVSettingsList2Window,LB_SETCURSEL,-1,0); SendMessage(CSVSettingsList1Window,LB_SETCURSEL,0,0);}
                else SetFocus(MessageWindow);
            } else {
                if ((Current_Window==MessageWindow || Current_Window==VTRACKWindow)) SetFocus(HeadersWindow);
                else if (Current_Window==HeadersWindow) SetFocus(DetailsWindow);
                else if (Current_Window==DetailsWindow) {if (IsWindowVisible(MessageWindow)) SetFocus(MessageWindow); else if (IsWindowVisible(VTRACKWindow)) SetFocus(VTRACKListWindow); else SetFocus(SpeedProfileWindow);}
                else if (Current_Window==MessageSearchWindow || Current_Window==MessageSearchWindowChild) SetFocus(DateSearchWindow);
                else if (Current_Window==DateSearchWindow) SetFocus(TrainSearchWindow);
                else if (Current_Window==TrainSearchWindow) SetFocus(SpeedSearchWindow);
                else if (Current_Window==PacketSearchWindow) SetFocus(RadioSearchWindow);
                else if (Current_Window==RadioSearchWindow) SetFocus(BaliseSearchWindow);
                else if (Current_Window==BaliseSearchWindow) SetFocus(LinkedBaliseSearchWindow);
                else if (Current_Window==LinkedBaliseSearchWindow) SetFocus(AdvancedSearchNameWindow);
                else if (Current_Window==AdvancedSearchNameWindow) SetFocus(AdvancedSearchValueWindow);
                else if (Current_Window==AdvancedSearchValueWindow) SetFocus(ModeSearchWindow);
                else if (Current_Window==SpeedSearchWindow) SetFocus(PacketSearchWindow);
                else if (Current_Window==LevelSearchWindow || Current_Window==LevelSearchWindowChild) SetFocus(MessageSearchWindow);
                else if (Current_Window==ModeSearchWindow || Current_Window==ModeSearchWindowChild) SetFocus(LevelSearchWindow);
                else if (Current_Window==CSVSettingsList1Window) {SetFocus(CSVSettingsList2Window); SendMessage(CSVSettingsList1Window,LB_SETCURSEL,-1,0); SendMessage(CSVSettingsList2Window,LB_SETCURSEL,0,0);}
                else if (Current_Window==CSVSettingsList2Window) {SetFocus(CSVSettingsList1Window); SendMessage(CSVSettingsList2Window,LB_SETCURSEL,-1,0); SendMessage(CSVSettingsList1Window,LB_SETCURSEL,0,0);}
                else SetFocus(MessageWindow);
            }
        }

        if ((Current_Message.message==WM_LBUTTONDOWN && Current_Message.hwnd==SearchCommuteWindow) || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_TAB && control)) {
            if (combinate_search_mode) {
                combinate_search_mode = false;
                SendMessage(SearchCommuteWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COMMUTE_BUTTON_FALSE);
            } else {
                combinate_search_mode = true;
                SendMessage(SearchCommuteWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)COMMUTE_BUTTON_TRUE);
            }
            continue;
        }
        if ((Current_Message.message==WM_LBUTTONDOWN && Current_Message.hwnd==NightModeWindow) || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='N' && control)) {
            if (night_mode) {
                night_mode = false;
                fseek(SETTINGS_FILE,303,SEEK_SET); fputc('0',SETTINGS_FILE);
                SendMessage(NightModeWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NIGHT_MODE_FALSE);
            } else {
                night_mode = true;
                fseek(SETTINGS_FILE,303,SEEK_SET); fputc('1',SETTINGS_FILE);
                SendMessage(NightModeWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)NIGHT_MODE_TRUE);
            }
            RedrawWindow(MessageWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            RedrawWindow(DetailsWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW|RDW_UPDATENOW);
            RedrawWindow(HeadersWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            RedrawWindow(TrainListWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            RedrawWindow(SequenceListWindow1,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            RedrawWindow(SequenceListWindow2,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            RedrawWindow(MainFolderWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
            continue;
        }

//        if ((Current_Message.message==WM_LBUTTONDOWN || Current_Message.message==WM_LBUTTONDBLCLK) && Current_Message.hwnd==CenterButtonWindow) {
//            if (Media_Center_Request) {
//                Media_Center_Request=false;
//                SendMessage(CenterButtonWindow,BM_SETSTATE,0,0);
//            } else {
//                Media_Center_Request=true;
//                SendMessage(CenterButtonWindow,BM_SETSTATE,1,0);
//                libvlc_media_player_pause(my_player_1);
//                libvlc_media_player_pause(my_player_2);
//                run_media=false;
//            }
//            continue;
//        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==BaliseListOpenCSVButtonWindow && Last_Message>0 && FindWindow(NULL,"LBG.csv - Excel")==NULL) {
            ShellExecute(NULL,"open",LBG_Command_Buffer,NULL,NULL,1);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==CSVListOpenCSVButtonWindow && Last_Message>0 && FindWindow(NULL,"CSV.csv - Excel")==NULL) {
            ShellExecute(NULL,"open",CSV_Command_Buffer,NULL,NULL,1);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==SequenceOpenCSVButtonWindow1 && Last_Message>0 && FindWindow(NULL,"SL1.csv - Excel")==NULL && CSVSequence1_is_done) {
            ShellExecute(NULL,"open",SL1_Command_Buffer,NULL,NULL,1);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==SequenceOpenCSVButtonWindow2 && Last_Message>0 && FindWindow(NULL,"SL2.csv - Excel")==NULL &&CSVSequence2_is_done) {
            ShellExecute(NULL,"open",SL2_Command_Buffer,NULL,NULL,1);
        }
        if (Current_Message.message==WM_KEYDOWN && Last_Message!=0 && (Current_Window==MessageWindow || Current_Window==HeadersWindow || Current_Window==DetailsWindow)) {
            if (Current_Message.wParam=='1' && !IsWindowVisible(VTRACKWindow)) {
                isWindowMaximized=isMessageWindowMaximized;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)MessageWindow);
                if (isMessageWindowMaximized) isMessageWindowMaximized=false; else {isMessageWindowMaximized=true; SetFocus(MessageWindow);}
            }
            if (Current_Message.wParam=='2') {
                isWindowMaximized=isHeadersWindowMaximized;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)HeadersWindow);
                if (isHeadersWindowMaximized) isHeadersWindowMaximized=false; else {isHeadersWindowMaximized=true; SetFocus(HeadersWindow);}
            }
            if (Current_Message.wParam=='3') {
                isWindowMaximized=isDetailsWindowMaximized;
                EnumChildWindows(MainWindow,EnumWindowCallback,(LPARAM)DetailsWindow);
                if (isDetailsWindowMaximized) isDetailsWindowMaximized=false; else {isDetailsWindowMaximized=true; SetFocus(DetailsWindow);}
            }
        }
        if (((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='O' && control && Current_Window!=MainHelpWindow && Current_Window!=FolderEditWindow && Current_Window!=FolderViewWindow))||((Current_Window==DecodeButtonWindow && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==13) ||(Current_Message.message==BTN_CLICKED_MESSAGE && (Current_Message.wParam==(WPARAM)DecodeButtonWindow || Current_Message.wParam==(WPARAM)FolderCancelWindow)))) {
            if (IsWindowVisible(MainFolderWindow)) {
                ShowWindow(MainFolderWindow,0);
            } else {
                ShowWindow(MainFolderWindow,1);
                Folder_View_Fill();
                SetFocus(FolderViewWindow);
            }
        }

        if (((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='S' && shift && !is_edit_window(Current_Window)))||((Current_Window==CSVListSettingsButtonWindow && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==13) ||(Current_Message.message==BTN_CLICKED_MESSAGE && (Current_Message.wParam==(WPARAM)CSVListSettingsButtonWindow)))) {
            if (IsWindowVisible(MainCSVSettingsWindow)) {
                ShowWindow(MainCSVSettingsWindow,0);
            } else {
                ShowWindow(MainCSVSettingsWindow,1);
                SetFocus(CSVSettingsList1Window);
                SendMessage(CSVSettingsList1Window,LB_SETCURSEL,0,0);
            }
        }

        if (Last_Message>0 && (((Current_Window==MessageWindow || Current_Window==VTRACKListWindow || Current_Window==VTRACKWindow) && Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='V' && !isMessageWindowMaximized && !isHeadersWindowMaximized && !isDetailsWindowMaximized) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)VTRACKButtonWindow))) {
            if (ROLE>=ROLE_DEMO) continue;
            if (IsWindowVisible(VTRACKWindow)) {
                ShowWindow(VTRACKWindow,0);
                ShowWindow(EnlargeMessageWindowButton,nCmdShow);
                SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);
                ShowWindow(VTRACKListWindow,0);
                ShowWindow(SpeedProfileWindow,0);
                ShowWindow(MessageWindow,1);
                SetFocus(MessageWindow);
            } else {
                SendMessage(VTRACKButtonWindow,BM_SETCHECK,1,0);
                SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                SendMessage(MessageButtonWindow,BM_SETCHECK,0,0);
                ShowWindow(MessageWindow,0);
                ShowWindow(EnlargeMessageWindowButton,0);
                ShowWindow(SpeedProfileWindow,0);
                ShowWindow(VTRACKWindow,1);
                ShowWindow(VTRACKListWindow,1);
                SetFocus(MessageWindow);
            }
        }
        if (Last_Message>0 && ROLE<ROLE_DEMO && !IsWindowVisible(MediaSelectionWindow) && (!IsWindowVisible(MediaWindow_1) || !IsWindowVisible(MediaWindow_2)) && (((Current_Window==MessageWindow || Current_Window==SpeedProfileWindow || Current_Window==VTRACKListWindow || Current_Window==VTRACKWindow) && Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='M' && Current_Window==MessageWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)MediaButtonWindow))) {
            char datetime_buffer[Message_Buffer_Size];
            SendMessage(MessageWindow,LB_GETTEXT,Message_Position,(LPARAM)datetime_buffer);
            strtok(datetime_buffer,"\t");
            sys_time_1.wDay = atoi(strtok(NULL,"/"));
            sys_time_1.wMonth = atoi(strtok(NULL,"/"));
            sys_time_1.wYear = atoi(strtok(NULL,"/ "))+2000;
            sys_time_1.wHour = atoi(strtok(NULL," :"));
            sys_time_1.wMinute = atoi(strtok(NULL,":"));
            sys_time_1.wSecond = atoi(strtok(NULL,":"));
            SendMessage(MediaStartWindow,DTM_SETSYSTEMTIME,GDT_VALID,(LPARAM)&sys_time_1);
            UpdateWindow(MediaStartWindow);
            VLC_List_Fill();
            ShowWindow(MediaSelectionWindow,nCmdShow);
            SendMessage(MediaListWindow,LB_SETCURSEL,0,0);
            SetFocus(MediaListWindow);
        }
        if (IsWindowVisible(MainFolderWindow) && Current_Message.message==WM_KEYDOWN && ((Current_Message.wParam==13 && Current_Window==FolderEditWindow) || (Current_Message.wParam=='R' && control && Current_Window==FolderViewWindow))) {
            GetWindowText(FolderEditWindow,Path_Buffer,Path_Buffer_Size-1);
            Folder_View_Fill();
        }
//        if (((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_SPACE && Last_Message>0) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==PlayButtonWindow && !run_media) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==StopButtonWindow && run_media))) {
//            if (IsWindowVisible(MediaWindow_1) || IsWindowVisible(MediaWindow_2)) {
//                if (run_media) {
//                    run_media = false;
//                    if (IsWindowVisible(MediaWindow_1)) {libvlc_media_player_pause(my_player_1);  log_it(LOG_INFO,"Pausing Media 1","",-1);}
//                    if (IsWindowVisible(MediaWindow_2)) {libvlc_media_player_pause(my_player_2);  log_it(LOG_INFO,"Pausing Media 2","",-1);}
//                } else {
//                    run_media = true;
//                    if (IsWindowVisible(MediaWindow_1)) {sprintf(Window_Buffer,"result : %d",libvlc_media_player_play(my_player_1));   log_it(LOG_INFO,"Playing Media 1",Window_Buffer,-1);}
//                    if (IsWindowVisible(MediaWindow_2)) {sprintf(Window_Buffer,"result : %d",libvlc_media_player_play(my_player_2));   log_it(LOG_INFO,"Playing Media 2",Window_Buffer,-1);}
//                }
//            }
//        }
//        if (IsWindowVisible(MediaWindow_1) && libvlc_media_player_is_playing(my_player_1) && !run_media) libvlc_media_player_pause(my_player_1);
//        if (IsWindowVisible(MediaWindow_2) && libvlc_media_player_is_playing(my_player_2) && !run_media) libvlc_media_player_pause(my_player_2);
//        if (Last_Message>0 && (Current_Window==MediaListWindow || Current_Window==MediaStartWindow || Current_Window==MediaOkWindow) && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_RETURN) || (Current_Message.message==WM_LBUTTONDBLCLK) || Current_Message.message==BTN_CLICKED_MESSAGE)) {
//            int length = strlen(VLC_Buffer);
//            int vlc_file_count = SendMessage(MediaListWindow,LB_GETCOUNT,0,0);
//            if (vlc_file_count==0) continue;
//            int vlc_added_files = 0;
//            time_t start_time_t = mktime(&time_start);
//            for (j=0;j<vlc_file_count+1;j++) {
//                if (SendMessage(MediaListWindow,LB_GETSEL,j,0)) {
//                    SendMessage(MediaListWindow,LB_GETTEXT,j,(LPARAM)&VLC_Buffer[length]);
//                    if (!IsWindowVisible(MediaWindow_1)) {
//                        vlc_added_files++;
//                        ShowWindow(MediaWindow_1,nCmdShow);
//                        my_media_file_1 = libvlc_media_new_path(my_vlc_instance_1, VLC_Buffer);
//                        my_player_1 = libvlc_media_player_new_from_media(my_media_file_1);
//                        libvlc_media_player_set_hwnd(my_player_1,MediaWindow_1);
//                        libvlc_media_player_play(my_player_1);
//                        DateTime_GetSystemtime(MediaStartWindow,&sys_time_1);
//                        media_time_t_1 = get_time_t(sys_time_1);
//                        media_start_1 = 1000*(unsigned long long)difftime(media_time_t_1,start_time_t);
//                        for (i=0;i<Last_Message;i++) {
//                            if (Time_Storage[i+1]>media_start_1) break;
//                        }
//                        if (i==Last_Message) i=Last_Message-1;
//                        SendMessage(MessageWindow,LB_SETCURSEL,i,0);
//                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
//                        SetWindowText(MediaWindow_1,&VLC_Buffer[length]);
//                        while (!(media_duration_1 = (int)libvlc_media_player_get_length(my_player_1)));
//                        Sleep(1000);
//                        libvlc_media_player_set_position(my_player_1,0,false);
//                        sprintf(Window_Buffer,"%I64u",media_start_1);
//                        log_it(LOG_SUCCESS,"[M] Creating Media 1",Window_Buffer,-1);
//                    } else if (!IsWindowVisible(MediaWindow_2)) {
//                        vlc_added_files++;
//                        ShowWindow(MediaWindow_2,nCmdShow);
//                        my_media_file_2 = libvlc_media_new_path(my_vlc_instance_2, VLC_Buffer);
//                        my_player_2 = libvlc_media_player_new_from_media(my_media_file_2);
//                        libvlc_media_player_set_hwnd(my_player_2,MediaWindow_2);
//                        libvlc_media_player_play(my_player_2);
//                        DateTime_GetSystemtime(MediaStartWindow,&sys_time_2);
//                        media_time_t_2 = get_time_t(sys_time_2);
//                        media_start_2 = 1000*(unsigned long long)difftime(media_time_t_2,start_time_t);
//                        for (i=0;i<Last_Message;i++) {
//                            if (Time_Storage[i+1]>media_start_2) break;
//                        }
//                        if (i==Last_Message) i=Last_Message-1;
//                        SendMessage(MessageWindow,LB_SETCURSEL,i,0);
//                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
//                        SetWindowText(MediaWindow_2,&VLC_Buffer[length]);
//                        while (!(media_duration_2 = (int)libvlc_media_player_get_length(my_player_2)));
//                        libvlc_media_player_set_position(my_player_2,0,false);
//                        sprintf(Window_Buffer,"%I64u",media_start_2);
//                        log_it(LOG_SUCCESS,"[M] Creating Media 2",Window_Buffer,-1);
//                    }
//                }
//            }
//            if (vlc_added_files>0) {
//                ShowWindow(MediaInfoWindow,nCmdShow);
//                ShowWindow(PlayButtonWindow,nCmdShow);
//                ShowWindow(StopButtonWindow,nCmdShow);
//                ShowWindow(CenterButtonWindow,nCmdShow);
//                ShowWindow(ResetButtonWindow,nCmdShow);
//            }
//            ShowWindow(MediaSelectionWindow,0);
//            RedrawWindow(MessageWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
//            VLC_Buffer[length]='\0';
//        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==ResetButtonWindow) {
            int i;
            for (i=0;i<Last_Message;i++) {
                if (Time_Storage[i+1]>media_start_2) break;
            }
            if (i==Last_Message) i=Last_Message-1;
            SendMessage(MessageWindow,LB_SETCURSEL,i,0);
            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
        }
        if (Current_Message.message==WM_MOUSEWHEEL && (Current_Window==MessageWindow || Current_Window==SpeedProfileWindow) && IsWindowVisible(SpeedProfileWindow) && control) {
            int mousewheel = HIWORD(Current_Message.wParam);
            if (mousewheel==WHEEL_DELTA) {
                if (SDTRACK_ZOOM>10000) {
                    if (SDTRACK_ZOOM<=100000) SDTRACK_ZOOM-=10000; else SDTRACK_ZOOM-=100000;
                }
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);
            } else if (mousewheel==65416) {
                if (SDTRACK_ZOOM<1000000) {
                    if (SDTRACK_ZOOM<100000) SDTRACK_ZOOM+=10000; else SDTRACK_ZOOM+=100000;
                }
                PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);
            } else continue;
        } else if (Current_Message.message==WM_MOUSEWHEEL && (Current_Window==MessageWindow || Current_Window==SpeedProfileWindow || Current_Window==VTRACKWindow || Current_Window==FolderViewWindow || Current_Window==MediaSelectionWindow || Current_Window==DetailsWindow || Current_Window==HeadersWindow || Current_Window==BaliseListWindow || Current_Window==SequenceListWindow1 || Current_Window==SequenceListWindow2)) {
            HWND Target_Window = Current_Window;
            if (Current_Window==SpeedProfileWindow) Target_Window=MessageWindow;
            if (isHeadersWindowMaximized || isDetailsWindowMaximized) continue;
            int mousewheel = HIWORD(Current_Message.wParam);
            int original_position = SendMessage(Target_Window,LB_GETCURSEL,0,0);
            int max_position = SendMessage(Target_Window,LB_GETCOUNT,0,0);



            if (mousewheel==WHEEL_DELTA) {
                if (original_position>0) {
                    SendMessage(Target_Window,LB_SETCURSEL,original_position-1,0);
                    PostMessage(Target_Window,SEL_CHANGE_MESSAGE,0,0);
                    continue;
                }
            } else if (mousewheel==65416) {
                if (original_position<max_position) {
                    SendMessage(Target_Window,LB_SETCURSEL,original_position+1,0);
                    PostMessage(Target_Window,SEL_CHANGE_MESSAGE,0,0);
                    continue;
                }
            } else continue;
        }
        if ((Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)FolderBackWindow) || (Current_Window==FolderViewWindow && Current_Message.message==WM_KEYDOWN && Current_Message.wParam==VK_BACK)) {
            Path_Buffer_Back();
            Folder_View_Fill();
            continue;
        }
        if (Current_Window==FolderViewWindow && Current_Message.message==WM_KEYDOWN && shift) {
            if (Current_Message.wParam=='F') {
                sprintf(Path_Buffer,"\\\\srv-faco\\FACO\\THI\\REX\\JRU\\");
                Folder_View_Fill();
                continue;
            }
            if (Current_Message.wParam=='H') {
                getcwd(Path_Buffer,Path_Buffer_Size-1);
                Folder_View_Fill();
                continue;
            }
            if (Current_Message.wParam=='L') {
                sprintf(Path_Buffer,Remanent_Path_Buffer);
                Folder_View_Fill();
                continue;
            }
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(MainFolderWindow)) {
            ShowWindow(MainFolderWindow,0);
            SetFocus(DecodeButtonWindow);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(MainCSVSettingsWindow)) {
            ShowWindow(MainCSVSettingsWindow,0);
            if (Last_Message>=1) SetFocus(MessageWindow); else SetFocus(DecodeButtonWindow);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(MainBaliseListWindow)) {
            ShowWindow(MainBaliseListWindow,0);
            SetFocus(MessageWindow);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(MainTrainListWindow)) {
            ShowWindow(MainTrainListWindow,0);
            SetFocus(MessageWindow);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(SequenceWindow)) {
            ShowWindow(SequenceWindow,0);
            SetFocus(MessageWindow);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && IsWindowVisible(MediaSelectionWindow)) {
            ShowWindow(MediaSelectionWindow,0);
            SetFocus(MessageWindow);
            continue;
        }
//        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && Current_Window==MediaWindow_1) {
//            libvlc_media_player_stop_async(my_player_1);
//            run_media=false;
//            media_duration_1 = 0;
//            ShowWindow(MediaWindow_1,0);
//            if (!IsWindowVisible(MediaWindow_2)) {
//                ShowWindow(MediaInfoWindow,0);
//                ShowWindow(PlayButtonWindow,0);
//                ShowWindow(StopButtonWindow,0);
//                ShowWindow(CenterButtonWindow,0);
//                ShowWindow(ResetButtonWindow,0);
//            }
//            log_it(LOG_ERROR,"[M] Media 1 destroyed","",-1);
//            if (!IsWindowVisible(MediaWindow_2)) SetFocus(MessageWindow);
//            continue;
//        }
//        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==27 && Current_Window==MediaWindow_2) {
//            libvlc_media_player_stop_async(my_player_2);
//            run_media=false;
//            media_duration_2 = 0;
//            ShowWindow(MediaWindow_2,0);
//            if (!IsWindowVisible(MediaWindow_1)) {
//                ShowWindow(MediaInfoWindow,0);
//                ShowWindow(PlayButtonWindow,0);
//                ShowWindow(StopButtonWindow,0);
//                ShowWindow(CenterButtonWindow,0);
//                ShowWindow(ResetButtonWindow,0);
//            }
//            log_it(LOG_ERROR,"[M] Media 2 destroyed","",-1);
//            if (!IsWindowVisible(MediaWindow_1)) SetFocus(MessageWindow);
//        }
        if (Current_Message.hwnd!=FolderBackWindow && IsWindowVisible(MainFolderWindow) &&  Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==FolderRefreshWindow) {
            Folder_View_Fill();
        }
        if ((Current_Message.hwnd!=FolderBackWindow && IsWindowVisible(MainFolderWindow) && ((Current_Window==FolderViewWindow && (Current_Message.message==WM_LBUTTONDBLCLK || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==13))) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Window==FolderOkWindow))) || short_started) {
            ShowWindow(VTRACKWindow,0);
            ShowWindow(SpeedProfileWindow,0);
            ShowWindow(VTRACKListWindow,0);
            ShowWindow(MessageWindow,nCmdShow);
            Last_Message=-1;
            SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)NO_DATA_FILE);
            RedrawWindow(VehicleWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
            int index = SendMessage(FolderViewWindow,LB_GETCURSEL,0,0);
            int filetype = SendMessage(FolderViewWindow,LB_GETITEMDATA,index,0);

            if (filetype==16 || filetype==17 || filetype==FILE_TYPE_JRU || filetype==FILE_TYPE_JRUFORCE || filetype==FILE_TYPE_JRUBL3 || filetype==FILE_TYPE_JRUZIP || filetype==FILE_TYPE_JRUTBF || filetype==FILE_TYPE_BRUSOLO || short_started) {

                if (debug_mode) {
                    SendMessage(MainBufferSaturationBar,PBM_SETPOS,0,0);
                    SendMessage(MessageSaturationBar,PBM_SETPOS,0,0);
                    SendMessage(DetailsSaturationBar,PBM_SETPOS,0,0);
                    SendMessage(MainBufferSaturationBar,PBM_SETBARCOLOR,0,Light_Purple);
                    SendMessage(MessageSaturationBar,PBM_SETBARCOLOR,0,Cyan);
                    SendMessage(DetailsSaturationBar,PBM_SETBARCOLOR,0,Cyan);
                }

                int initial_length;
                int additional_length;
                if (short_started) {
                    initial_length = strlen(lpCmdLine);
                    int offset_1 = (lpCmdLine[0]=='\"')?2:1;
                    int offset_2 = (lpCmdLine[0]=='\"')?5:4;
                    int offset_3 = (lpCmdLine[0]=='\"')?4:3;
                    if (lpCmdLine[initial_length-offset_1]=='U' && lpCmdLine[initial_length-offset_2]=='_') filetype=FILE_TYPE_JRU;
                    else if (lpCmdLine[initial_length-offset_1]=='u' && lpCmdLine[initial_length-offset_2]=='.' && lpCmdLine[initial_length-offset_3]=='j') filetype=FILE_TYPE_JRUBL3;
                    else if (lpCmdLine[initial_length-offset_1]=='u' && lpCmdLine[initial_length-offset_2]=='.' && lpCmdLine[initial_length-offset_3]=='b') filetype=FILE_TYPE_BRUSOLO;
                    else if (lpCmdLine[initial_length-offset_1]=='f' && lpCmdLine[initial_length-offset_2]=='.') filetype=FILE_TYPE_JRUTBF;
                    else if (lpCmdLine[initial_length-offset_1]=='p' && lpCmdLine[initial_length-offset_2]=='.') filetype=FILE_TYPE_JRUZIP;
                    else filetype=FILE_TYPE_JRUFORCE;
                    for (j=initial_length;j>0;j--) {
                        if (lpCmdLine[j]=='\\') {
                            additional_length = initial_length-j-1;
                            initial_length=j+1;
                            if (lpCmdLine[0]=='"') {
                                sprintf(Path_Buffer,"%s",&lpCmdLine[1]);
                                initial_length--;
                                additional_length--;
                                Path_Buffer[initial_length+additional_length]='\0';
                            } else sprintf(Path_Buffer,"%s",lpCmdLine);
                            break;
                        }
                    }
                } else {
                    initial_length = strlen(Path_Buffer);

                    SendMessage(FolderViewWindow,LB_GETTEXT,index,(LPARAM)Window_Buffer);
                    additional_length=strlen(Window_Buffer);
                    for (j=additional_length;j>0;j--) {
                        if (Window_Buffer[j]=='\t') {
                            additional_length=j;
                            break;
                        }
                    }

                    SendMessage(FolderViewWindow,LB_GETTEXT,index,(LPARAM)&Path_Buffer[initial_length]);
                    strtok(Path_Buffer,"\t");
                }

                short_started = false;
                isVelaro = false;
                isBL3 = false;

                if (filetype<=FILE_TYPE_JRU && filetype>=FILE_TYPE_BRUSOLO) {
                    sprintf(Filename_Buffer,&Path_Buffer[initial_length]);
                    ShowWindow(MainFolderWindow,0);
                    UpdateWindow(MainWindow);
                    int path_buffer_actual_size = strlen(Path_Buffer);
                    if (filetype==FILE_TYPE_JRUZIP) {
                        path_buffer_actual_size -= 4;
                        additional_length-=4;
                        Path_Buffer[path_buffer_actual_size]='\0';
                        extract_zip(Path_Buffer);
                    }

                    int offset_for_path_buffer = Path_Buffer[path_buffer_actual_size-2]=='_'?2:0;

                    if (filetype!=FILE_TYPE_BRUSOLO && filetype!=FILE_TYPE_JRUBL3) {
                        if (Path_Buffer[path_buffer_actual_size-14-offset_for_path_buffer]=='3') {
                            if (Path_Buffer[path_buffer_actual_size-11-offset_for_path_buffer]=='1') {
                                sprintf(Window_Buffer,"PBKA %c3%c%c Motrice 0\n%s",Path_Buffer[path_buffer_actual_size-15-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-13-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-12-offset_for_path_buffer],&Path_Buffer[initial_length]);
                            } else {
                                sprintf(Window_Buffer,"PBKA %c3%c%c Motrice 9\n%s",Path_Buffer[path_buffer_actual_size-15-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-13-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-12-offset_for_path_buffer],&Path_Buffer[initial_length]);
                            }
                        } else if  (Path_Buffer[path_buffer_actual_size-14-offset_for_path_buffer]=='0') {
                                sprintf(Window_Buffer,"Eurostar E320 %c0%c%c\n%s",Path_Buffer[path_buffer_actual_size-15-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-13-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-12-offset_for_path_buffer],&Path_Buffer[initial_length]);
                                isVelaro = true;
                        }
                        else {
                            if (Path_Buffer[path_buffer_actual_size-11-offset_for_path_buffer]=='1') {
                                sprintf(Window_Buffer,"PBA %c5%c%c Motrice 1\n%s",Path_Buffer[path_buffer_actual_size-15-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-13-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-12-offset_for_path_buffer],&Path_Buffer[initial_length]);
                            } else {
                                sprintf(Window_Buffer,"PBA %c5%c%c Motrice 2\n%s",Path_Buffer[path_buffer_actual_size-15-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-13-offset_for_path_buffer],Path_Buffer[path_buffer_actual_size-12-offset_for_path_buffer],&Path_Buffer[initial_length]);
                            }
                        }
                    }

                    unknown_file=false;
                    if (filetype==FILE_TYPE_JRUFORCE) {sprintf(Window_Buffer,"Rame ???? Motrice ?"); unknown_file=true;}
                    if (filetype==FILE_TYPE_JRUBL3) {sprintf(Window_Buffer,"Rame ???? Motrice ?"); unknown_file=true;}
                    if (filetype==FILE_TYPE_JRUTBF) {sprintf(Window_Buffer,"Rame ???? Motrice ?"); unknown_file=true;}
                    if (filetype==FILE_TYPE_BRUSOLO) {sprintf(Window_Buffer,"Rame ???? Motrice ?"); unknown_file=true;}

                    Path_Buffer[initial_length+additional_length]='\\';

                    Path_Buffer[initial_length+additional_length+1]='\0';

                    path_buffer_actual_size++;

                    SetWindowText(VehicleWindow,Window_Buffer);

                    if (strstr(Filename_Buffer,"no_SNCF_number")!=NULL || strstr(Filename_Buffer,"no SNCF number")!=NULL) {
                        isVelaro = true;
                    }

                    strcat(Path_Buffer,"Lecture_24H.bin");
                    if ((BIN_File=fopen(Path_Buffer,"rb"))!=NULL) {
                        isBinaryFile=true;
                    } else isBinaryFile=false;
                    Path_Buffer[path_buffer_actual_size]='\0';
                    log_it(LOG_INFO,"File Decoding Start",Path_Buffer,-1);
                    if (filetype==FILE_TYPE_JRUZIP) sprintf(command_buffer,"rmdir /S /Q %s",Path_Buffer);
                    sprintf(VLC_Buffer,Path_Buffer);
                    if (!isBinaryFile && filetype!=FILE_TYPE_JRUBL3 && filetype!=FILE_TYPE_JRUTBF) strcat(Path_Buffer,"flash24h\\");
                    SendMessage(MessageWindow,LB_RESETCONTENT,0,0);
                    SendMessage(HeadersWindow,LB_RESETCONTENT,0,0);
                    SendMessage(DetailsWindow,LB_RESETCONTENT,0,0);
                    if (IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow)) {
                        ShowWindow(VTRACKWindow,0);
                        ShowWindow(VTRACKListWindow,0);
                        ShowWindow(SpeedProfileWindow,0);
                        ShowWindow(MessageWindow,1);
                        SetFocus(MessageWindow);
                    }
                    SetWindowText(TrackInformationWindow,"");
                    Init_Log();
                    valid_data=true;
                    truncated_data=false;
                    if (filetype==FILE_TYPE_BRUSOLO) {
                        ShowWindow(ProgressBarWindow, 1);
                        SendMessage(ProgressBarWindow,PBM_SETBARCOLOR,0,Light_Purple);
                        SendMessage(ProgressBarWindow,PBM_SETPOS,0,0);
                        Path_Buffer[path_buffer_actual_size-1]='\0';
                        bru_file_decode(Path_Buffer,true);
                        file_length = General_Position;
                        sprintf(Window_Buffer,"%02I64d %% Main buffer used",(100*General_Position)/Master_Bluffer_Size);
                        log_it(LOG_SUCCESS,"File Encoding End",Window_Buffer,-1);
                        General_Position = 0;
                    } else if (isBinaryFile) {
                        isBL3 = false;
                        bin_file_decode();
                        fclose(BIN_File);
                    } else if (filetype==FILE_TYPE_JRUTBF) {
                        Path_Buffer[path_buffer_actual_size-1]='\0';
                        isBL3=true; tbf_file();
                    } else if (filetype!=FILE_TYPE_JRUBL3) {
                        isBL3 = false; bru_file();
                    } else {
                        Path_Buffer[path_buffer_actual_size-1]='\0';
                        isBL3 = true;
                        if (strstr(Path_Buffer,"_cab4")!=NULL) {
                            isVelaro=true;
                        }
                        isBL3 = true;
                        isVelaro = true;
                        jru_file();
                        General_Position=0;
                    }
                    message_index=-1;
                    file_log_count=0;
                    SendMessage(TrainListWindow,LB_RESETCONTENT,0,0);
                    SendMessage(BaliseListWindow,LB_RESETCONTENT,0,0);
                    ASV_Search_Index=-1;
                    ASV_increment=0;

                    retry = 0;
                    encode_skip = 0;

                    compile_file_read();

                    if (retry>0) {
                        ShowWindow(VTRACKWindow,0);
                        ShowWindow(SpeedProfileWindow,0);
                        ShowWindow(VTRACKListWindow,0);
                        ShowWindow(MessageWindow,nCmdShow);
                        Last_Message=-1;
                        SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)NO_DATA_FILE);
                        RedrawWindow(VehicleWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
                        valid_data=true;
                        General_Position=0;
                        message_index=-1;
                        RedrawWindow(ProgressBarWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
                        ShowWindow(ProgressBarWindow,0);
                        ShowWindow(ProgressBarWindow,nCmdShow);
                        SendMessage(ProgressBarWindow,PBM_SETPOS,(int)50,0);
                        SendMessage(TrainListWindow,LB_RESETCONTENT,0,0);
                        SendMessage(BaliseListWindow,LB_RESETCONTENT,0,0);
                        SendMessage(MessageWindow,LB_RESETCONTENT,0,0);
                        SendMessage(HeadersWindow,LB_RESETCONTENT,0,0);
                        SendMessage(DetailsWindow,LB_RESETCONTENT,0,0);
                        if (IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow)) {
                            ShowWindow(VTRACKWindow,0);
                            ShowWindow(VTRACKListWindow,0);
                            ShowWindow(SpeedProfileWindow,0);
                            ShowWindow(MessageWindow,1);
                            SetFocus(MessageWindow);
                        }
                        ASV_Search_Index=-1;
                        ASV_increment=0;
                        file_log_count++;
                        compile_file_read();
                    }

                    retry = 0;

                    is_zipped = (filetype==FILE_TYPE_JRUZIP);
                    if (isBL3) {
                        GetWindowText(VehicleWindow,Window_Buffer,Window_Buffer_Size-1);
                        int first_line_length = strlen(Window_Buffer);
                        if (isVelaro) sprintf(Window_Buffer,"%s\n%s",Window_Buffer,&current_file_buffer[initial_length+15]);
                        else sprintf(Window_Buffer,"%s\n%s",Window_Buffer,&current_file_buffer[initial_length]);
                        Window_Buffer[first_line_length+27]='\0';
                        SetWindowText(VehicleWindow,Window_Buffer);
                    }
                    SendMessage(MessageButtonWindow,BM_SETCHECK,1,0);
                    SendMessage(VTRACKButtonWindow,BM_SETCHECK,0,0);
                    SendMessage(SpeedProfileButtonWindow,BM_SETCHECK,0,0);
                    SendMessage(SequenceListWindow1,LB_RESETCONTENT,0,0);
                    SendMessage(SequenceListWindow2,LB_RESETCONTENT,0,0);
                    file_log_count=0;
                    ShowWindow(CSVListOpenCSVButtonWindow,SW_HIDE);
                    Last_Message=SendMessage(MessageWindow,LB_GETCOUNT,0,0)-1;
                    if (Last_Message>0) {
                        ShowWindow(EnlargeMessageWindowButton, nCmdShow);
                        ShowWindow(EnlargeHeadersWindowButton, nCmdShow);
                        ShowWindow(EnlargeDetailsWindowButton, nCmdShow);
                    } else log_it(LOG_ERROR,"File Decoding Error : No messages found",Path_Buffer,-1);
                    SendMessage(DecodeButtonWindow,BM_SETIMAGE,IMAGE_BITMAP,(LPARAM)FILE_BUTTON);
                    SetFocus(MessageWindow);
                    SendMessage(MessageWindow,LB_SETCURSEL,0,0);
                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                    Path_Buffer[initial_length-1]='\0';
                    if (filetype==FILE_TYPE_JRUZIP) {
                        system(command_buffer);
                        log_it(LOG_INFO,"Deleting extracted files",command_buffer,-1);
                    }
                    if (Last_Message>=1) sprintf(Window_Buffer,"%02I64u %% messages slots used",(unsigned long long)((unsigned long long)(100*(unsigned long long)Last_Message)/(unsigned long long)Mean_Message_Number_Count));
                    else sprintf(Window_Buffer,"00 %% messages slots used");
                    log_it(LOG_SUCCESS,"File Decoding End",Window_Buffer,-1);
                    sprintf(Window_Buffer,"%02I64u %% details slots used",(unsigned long long)((unsigned long long)(100*(unsigned long long)Details_Position)/(unsigned long long)Mean_Details_Number));
                    log_it(LOG_SUCCESS,"File Decoding End",Window_Buffer,-1);

                    Rewrite_Settings();
                    ShowWindow(LastFileButtonWindow, nCmdShow);
                    RedrawWindow(VehicleWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
                    sprintf(Complete_Soft_Title,"%s : %s",Soft_Title,Filename_Buffer);
                    SetWindowText(MainWindow,Complete_Soft_Title);
                    control = false; shift = false;
                    if (Last_Message>=0) {
                        if (valid_data) {
                            if (truncated_data) SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)PARTIAL_VALID_DATA_FILE);
                            else SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)VALID_DATA_FILE);
                        }
                        else {
                            if (truncated_data) SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)PARTIAL_INVALID_DATA_FILE);
                            else SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)INVALID_DATA_FILE);
                        }
                    } else SendMessage(ValidDataWindow,STM_SETIMAGE,(WPARAM)IMAGE_BITMAP,(LPARAM)NO_DATA_FILE);
                } else {
                    Folder_View_Fill();
                }
            }
            continue;
        }

        if(Message_Position!=SendMessage(MessageWindow,LB_GETCURSEL,0,0) && Last_Message>0) {
            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
        }
        if(header_position!=SendMessage(HeadersWindow,LB_GETCURSEL,0,0) && SendMessage(HeadersWindow,LB_GETCURSEL,0,0)>=0 && Last_Message>0) {
            PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,0);
        }

        if (Current_Message.message == SEL_CHANGE_MESSAGE && Last_Message>0) {

            header_position = SendMessage(HeadersWindow,LB_GETCURSEL,0,0);
            if (Current_Message.hwnd==MessageWindow) {
                Message_Position = SendMessage(MessageWindow,LB_GETCURSEL,0,0);

                Current_Time = Time_Storage[Message_Position];
//                int media_elapsed_time_1,media_elapsed_time_2;
//                if (IsWindowVisible(MediaWindow_1)) {
//                    if (Current_Message.lParam<=0) {
//                        run_media=false;
//                        libvlc_media_player_set_pause(my_player_1,1);
//                    }
//                    if (!run_media) {
//                        media_elapsed_time_1 = (int)(Current_Time-media_start_1)+initial_tts_1;
//                        if (control || Media_Center_Request) {
//                            Media_Center_Request=false;
//                            SendMessage(CenterButtonWindow,BM_SETSTATE,0,0);
//                            media_start_1 = Current_Time+(unsigned long long)initial_tts_1-(unsigned long long)(libvlc_media_player_get_position(my_player_1)*media_duration_1);
//                            media_start_2 = Current_Time+(unsigned long long)initial_tts_2-(unsigned long long)(libvlc_media_player_get_position(my_player_2)*media_duration_2);
//                            sprintf(Window_Buffer,"(%I64u:%I64u)",media_start_1,media_start_2);
//                            log_it(LOG_INFO,"[M] Setting new media start",Window_Buffer,-1);
//                        } else {
//                            libvlc_media_player_set_position(my_player_1,min(1.0,(float)((float)media_elapsed_time_1/(float)media_duration_1)),false);
//                            sprintf(Window_Buffer,"(%.2f)",min(1.0,(float)((float)media_elapsed_time_1/(float)media_duration_1)));
//                            log_it(LOG_INFO,"[M] Setting new position for media 1",Window_Buffer,-1);
//                        }
//                    }
//                }
//                if (IsWindowVisible(MediaWindow_2)) {
//                    if (Current_Message.lParam<=0) {
//                        run_media=false;
//                        libvlc_media_player_set_pause(my_player_2,1);
//                        log_it(LOG_INFO,"[M] Pausing media 2","",-1);
//                    }
//                    if (!run_media) {
//                        media_elapsed_time_2 = (int)(Current_Time-media_start_2)+initial_tts_2;
//                        if (control || Media_Center_Request) {
//                            Media_Center_Request=false;
//                            SendMessage(CenterButtonWindow,BM_SETSTATE,0,0);
//                            media_start_2 = Current_Time+(unsigned long long)initial_tts_2-(unsigned long long)(libvlc_media_player_get_position(my_player_2)*media_duration_2);
//                            media_start_1 = Current_Time+(unsigned long long)initial_tts_1-(unsigned long long)(libvlc_media_player_get_position(my_player_1)*media_duration_1);
//                            sprintf(Window_Buffer,"(%I64u:%I64u)",media_start_1,media_start_2);
//                            log_it(LOG_INFO,"[M] Setting new media start",Window_Buffer,-1);
//                        } else {
//                            libvlc_media_player_set_position(my_player_2,min(1.0,(float)((float)media_elapsed_time_2/(float)media_duration_2)),false);
//                            sprintf(Window_Buffer,"(%.2f)",min(1.0,(float)((float)media_elapsed_time_2/(float)media_duration_2)));
//                            log_it(LOG_INFO,"[M] Setting new position for media 2",Window_Buffer,-1);
//                        }
//                    }
//                }

                Current_Distance = Distance_Storage[Message_Position];
                sdtrack_left = Message_Position;
                sdtrack_right = Message_Position;
                unsigned long long sdtrack_total=0;
                while ((unsigned long long)((Current_Distance-Distance_Storage[sdtrack_left])/3600)<(SDTRACK_ZOOM/2) && sdtrack_left>0) {
                    sdtrack_left--;
                }
                sdtrack_total = (unsigned long long)((Current_Distance-Distance_Storage[sdtrack_left])/3600);
                while ((unsigned long long)((Distance_Storage[sdtrack_right]-Current_Distance)/3600)<(SDTRACK_ZOOM-sdtrack_total) && sdtrack_right<Last_Message) {
                    sdtrack_right++;
                }
                sdtrack_total += (unsigned long long)((Distance_Storage[sdtrack_right]-Current_Distance)/3600);

                if (sdtrack_total<SDTRACK_ZOOM) {
                    sdtrack_total -= (unsigned long long)((Current_Distance-Distance_Storage[sdtrack_left])/3600);
                    while ((unsigned long long)((Current_Distance-Distance_Storage[sdtrack_left])/3600)<(SDTRACK_ZOOM-sdtrack_total) && sdtrack_left>0) {
                        sdtrack_left--;
                    }
                }
                sdtrack_total = (unsigned long long)((Current_Distance-Distance_Storage[sdtrack_left])/3600)+(unsigned long long)((Distance_Storage[sdtrack_right]-Current_Distance)/3600);

                RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);

                Details_Position = SendMessage(MessageWindow,LB_GETITEMDATA,Message_Position,0);
                current_message_version = Message_Details_Storage[Details_Position-version_detail_offset];

                MA_display = Message_Details_Storage[Details_Position-MA_offset];
                MA_display_speed=MA_display/2000000;
                int MA_detail_stored = Message_Details_Storage[Details_Position-MA_index_offset];
                if (MA_detail_stored>=0) MA_display_distance = MA_display%10000000-((int)(Distance_Storage[Message_Position]-Distance_Storage[MA_detail_stored])/3600);
                else MA_display_distance = -1;

                int MA_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,MA_detail_stored,0);
                int balise_MA, nid_C_MA;
                if (MA_detail_stored>=0) {
                    if (Message_Details_Storage[MA_details_position-id_detail_offset]==9) {
                        nid_C_MA = Message_Details_Storage[MA_details_position+5];
                        balise_MA = Message_Details_Storage[MA_details_position+6];
                    } else {
                        nid_C_MA = Message_Details_Storage[MA_details_position+7];
                        balise_MA = Message_Details_Storage[MA_details_position+8];
                    }
                }

                SendMessage(MAWindow,LB_RESETCONTENT,0,0);

                if (MA_display_speed==-5 || MA_display_distance<0 || MA_display_distance>MAX_DISTANCE_MA || MA_detail_stored<0) {
                    SendMessage(MAWindow,LB_ADDSTRING,0,(LPARAM)"No Track Free information");
                    SendMessage(MAWindow,LB_ADDSTRING,0,(LPARAM)"\t");
                } else {
                    sprintf(Window_Buffer,"Track Free from %d-%d",nid_C_MA,balise_MA);
                    SendMessage(MAWindow,LB_ADDSTRING,0,(LPARAM)Window_Buffer);
                    sprintf(Window_Buffer,"%d km/h\t%d m",MA_display_speed,MA_display_distance);
                    SendMessage(MAWindow,LB_ADDSTRING,0,(LPARAM)Window_Buffer);
                }
                int line_number = Message_Details_Storage[Details_Position-line_information_offset];
//                line_number%=10000000;
                if (line_number>0) {
                    for (i=1;i<=Message_Details_Storage[line_number];i++) {
                        if (Message_Details_Storage[line_number+i]!=';' && i<=10) Window_Buffer[i-1] = Message_Details_Storage[line_number+i];
                        else break;
                    }
                    Window_Buffer[i-1]='\0';
                } else if (line_number<0) {
                    if (line_number==line_info_B) sprintf(Window_Buffer,"B");
                    else if (line_number==line_info_L1) sprintf(Window_Buffer,"L1");
                    else if (line_number==line_info_LGV_EST) sprintf(Window_Buffer,"LGV EST");
                    else {
                        line_number=-line_number;
                        for (i=1;i<=Message_Details_Storage[line_number]-5;i++) {
                            Window_Buffer[i-1] = Message_Details_Storage[line_number+i+5];
                        }
                        Window_Buffer[i-1]='\0';
                    }
                } else sprintf(Window_Buffer,"Unknown Line");
                SetWindowText(TrackInformationWindow,Window_Buffer);
                int last_valid_linking = Message_Details_Storage[Details_Position-last_valid_linking_offset];
                if (last_valid_linking>=0) {
                    int balise_seen = (int)(last_valid_linking/linking_data_delimiter);
                    last_valid_linking = (last_valid_linking%linking_data_delimiter);
                    int last_valid_linking_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,last_valid_linking,0);
                    int last_valid_linking_nid_c = Message_Details_Storage[last_valid_linking_details_position-last_nid_c_offset];
                    SendMessage(LinkingWindow,LB_RESETCONTENT,0,0);
                    if (Message_Details_Storage[last_valid_linking_details_position-id_detail_offset]==6) {
                        sprintf(Window_Buffer,"3Linking : %d-%d",last_valid_linking_nid_c,Message_Details_Storage[last_valid_linking_details_position+8]);
                    } else {
                        sprintf(Window_Buffer,"3Linking : %d-%d",Message_Details_Storage[last_valid_linking_details_position+5],Message_Details_Storage[last_valid_linking_details_position+6]);
                    }
                    SendMessage(LinkingWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                    while (Message_Details_Storage[last_valid_linking_details_position]!=-5) last_valid_linking_details_position++;
                    last_valid_linking_details_position++;
                    int linking_distance;
                    float scale = pow(10,Message_Details_Storage[last_valid_linking_details_position+2]-1);
                    linking_distance = (int)(scale*Message_Details_Storage[last_valid_linking_details_position+3]);
                    if (Message_Details_Storage[last_valid_linking_details_position+4]==1) {
                        last_valid_linking_details_position+=1;
                        last_valid_linking_nid_c = Message_Details_Storage[last_valid_linking_details_position+4];
                    }
                    int stored_distance = Message_Details_Storage[Details_Position-last_valid_linking_distance_offset];
                    int printing_distance = linking_distance-((int)((Distance_Storage[Message_Position]-Distance_Storage[last_valid_linking])/3600)-stored_distance);
                    int balise_id = Message_Details_Storage[last_valid_linking_details_position+5];
                    if (abs(stored_distance)!=INTER_BALISE_DISTANCE_UNKNOWN) {
                        if (balise_id == 16383) sprintf(Window_Buffer,"0%d - NC\t%d m",last_valid_linking_nid_c,printing_distance); else sprintf(Window_Buffer,"0%d - %d\t%d m",last_valid_linking_nid_c,balise_id,printing_distance);
                    } else {
                        if (balise_id == 16383) sprintf(Window_Buffer,"0%d - NC\t?? m",last_valid_linking_nid_c); else sprintf(Window_Buffer,"0%d - %d\t?? m",last_valid_linking_nid_c,balise_id);
                    }
                    if (balise_seen>=1) Window_Buffer[0]='1';
                    if (printing_distance>-retroactive_linking_display_distance || abs(stored_distance)==INTER_BALISE_DISTANCE_UNKNOWN) SendMessage(LinkingWindow,LB_SETITEMDATA,SendMessage(LinkingWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer),Message_Details_Storage[last_valid_linking_details_position+6]);
                    int linking_iterations = Message_Details_Storage[last_valid_linking_details_position+9];
                    for (i=0;i<linking_iterations;i++) {
                        printing_distance += (int)(scale*Message_Details_Storage[last_valid_linking_details_position+10+6*i]);
                        if (Message_Details_Storage[last_valid_linking_details_position+11+6*i]==1) {
                            last_valid_linking_details_position+=1;
                            last_valid_linking_nid_c = Message_Details_Storage[last_valid_linking_details_position+11+6*i];
                        }
                        balise_id = Message_Details_Storage[last_valid_linking_details_position+12+6*i];
                        if (abs(stored_distance)!=INTER_BALISE_DISTANCE_UNKNOWN) {
                            if (balise_id==16383) sprintf(Window_Buffer,"0%d - NC\t%d m",last_valid_linking_nid_c,printing_distance); else sprintf(Window_Buffer,"0%d - %d\t%d m",last_valid_linking_nid_c,balise_id,printing_distance);
                        } else {
                            if (balise_id==16383) sprintf(Window_Buffer,"0%d - NC\t?? m",last_valid_linking_nid_c); else sprintf(Window_Buffer,"0%d - %d\t?? m",last_valid_linking_nid_c,balise_id);
                        }
                        if (balise_seen>=i+2) Window_Buffer[0]='1';
                        if (printing_distance>-retroactive_linking_display_distance || abs(stored_distance)==INTER_BALISE_DISTANCE_UNKNOWN) SendMessage(LinkingWindow,LB_SETITEMDATA,SendMessage(LinkingWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer),Message_Details_Storage[last_valid_linking_details_position+13+6*i]);
                    }
                } else {
                    SendMessage(LinkingWindow,LB_RESETCONTENT,0,0);
                    if (last_valid_linking==-1) SendMessage(LinkingWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"2No Linking");
                    else SendMessage(LinkingWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"2Linking Unknown");
                }
                    int balise_list_count = SendMessage(BaliseListWindow,LB_GETCOUNT,0,0);
                    SendMessage(BaliseListWindow,WM_SETREDRAW,0,0);

                    for (i=balise_list_count;i<=Message_Details_Storage[Details_Position-balise_storage_index];i++) {
                        int decision = Message_Details_Storage[Balise_Storage[i]+10];
                        int seen_nid_c = Message_Details_Storage[Balise_Storage[i]+7];
                        int seen_nid_bg = Message_Details_Storage[Balise_Storage[i]+8];
                        int train = Message_Details_Storage[Balise_Storage[i]-train_detail_offset];
                        int day = Message_Details_Storage[Balise_Storage[i]-day_detail_offset];
                        int month = Message_Details_Storage[Balise_Storage[i]-mon_detail_offset];
                        if (decision==BALISE_UNEXPECTED) sprintf(Window_Buffer,"%d\t%d\tUnexpected\t%02d/%02d\t%d",seen_nid_c,seen_nid_bg,day,month,train);
                        else if (decision==BALISE_GRANTED_EXPECTED) sprintf(Window_Buffer,"%d\t%d\tExpected\t%02d/%02d\t%d",seen_nid_c,seen_nid_bg,day,month,train);
                        else if (decision==BALISE_GRANTED_UNLINKED) sprintf(Window_Buffer,"%d\t%d\tUnlinked\t%02d/%02d\t%d",seen_nid_c,seen_nid_bg,day,month,train);
                        else if (decision==BALISE_GRANTED_VOID) sprintf(Window_Buffer,"%d\t%d\tNo Linking\t%02d/%02d\t%d",seen_nid_c,seen_nid_bg,day,month,train);
                        else if (decision==BALISE_DECISION_UNKNOWN) sprintf(Window_Buffer,"%d\t%d\tUnknown\t%02d/%02d\t%d",seen_nid_c,seen_nid_bg,day,month,train);
                        if(Message_Details_Storage[Balise_Storage[i]+3]) decision+=5;
                        SendMessage(BaliseListWindow,LB_SETITEMDATA,SendMessage(BaliseListWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer),decision);
                        balise_list_count++;
                    }
                    for (i=balise_list_count;i>=Message_Details_Storage[Details_Position-balise_storage_index]+1 ;i--) {
                        SendMessage(BaliseListWindow,LB_DELETESTRING,i,0);
                    }

                    balise_list_count = SendMessage(BaliseListWindow,LB_GETCOUNT,0,0);
                    if (balise_list_count>=1) SendMessage(BaliseListWindow,LB_SETCURSEL,balise_list_count-1,0);

                    SendMessage(BaliseListWindow,WM_SETREDRAW,1,0);
                if (Message_Position==Last_Message) Details_End_Point = End_Details_Position; else Details_End_Point = SendMessage(MessageWindow,LB_GETITEMDATA,Message_Position+1,0)-max_details_offset;

                SendMessage(MessageWindow,LB_GETTEXT,(WPARAM)Message_Position,(LPARAM)Current_Message_Buffer);

                SendMessage(VTRACKListWindow,LB_RESETCONTENT,(WPARAM)0,(LPARAM)Current_Message_Buffer);
                SendMessage(VTRACKListWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Current_Message_Buffer);

                if (Message_Details_Storage[Details_Position-id_detail_offset]==6) {
                    sprintf(Window_Buffer,"Line %I64u - Balise %d",(Message_Position+1),Message_Details_Storage[Details_Position+8]);
                } else {
                    sprintf(Window_Buffer,"Line %I64u",Message_Position+1);
                }
                SetWindowText(LineWindow,Window_Buffer);
                current_message_speed = Message_Details_Storage[Details_Position-speed_detail_offset];
                if (Reference_Message>=0) {
                    Delta_Hour = 0;
                    Delta_Minute = 0;
                    Delta_Second = 0;

                    if (Reference_Message<=Message_Position) {
                        Delta_Time = Current_Time-Reference_Time;
                        Delta_Distance = Current_Distance-Reference_Distance;
                    }
                    else {
                        Delta_Time = Reference_Time-Current_Time;
                        Delta_Distance = Reference_Distance-Current_Distance;
                    }
                    if (Delta_Time>=31536000000) Delta_Time=0;
                    if (Delta_Time>0) Average_Speed = (3600*Delta_Distance/Delta_Time); else Average_Speed=3600*current_message_speed;

                    while (Delta_Time>=3600000) {Delta_Time-=3600000; Delta_Hour++;}
                    while (Delta_Time>=60000) {Delta_Time-=60000; Delta_Minute++;}
                    while (Delta_Time>=1000) {Delta_Time-=1000; Delta_Second++;}

                    sprintf(TimeWindow_Buffer,"%02d h %02d m %02d s %03I64u ms",Delta_Hour,Delta_Minute,Delta_Second,Delta_Time);
                    sprintf(DistanceWindow_Buffer,"%I64u km %03I64u m",Delta_Distance/3600000,(Delta_Distance/3600)%1000);
                    sprintf(SpeedWindow_Buffer,"%I64u km/h",Average_Speed/3600);

                    SetWindowText(TimeWindow,TimeWindow_Buffer);
                    SetWindowText(DistanceWindow,DistanceWindow_Buffer);
                    SetWindowText(SpeedWindow,SpeedWindow_Buffer);
                }
            }
            if ((Current_Message.hwnd==MessageWindow || Current_Message.hwnd==HeadersWindow) && Current_Message.lParam==0) {
                    ASV_Search_Index=-1; ASV_increment=0;
            }
            if (Current_Message.hwnd==MessageWindow || (Current_Message.hwnd==HeadersWindow && header_position==0)) {

                SendMessage(HeadersWindow,LB_RESETCONTENT,0,0);
                SendMessage(DetailsWindow,LB_RESETCONTENT,0,0);
                target_window_index=-1;
                if ((Message_Details_Storage[Details_Position-id_detail_offset]>=6 && Message_Details_Storage[Details_Position-id_detail_offset]<=10) || (isBL3 && !isVelaro && Message_Details_Storage[Details_Position-id_detail_offset]==5)) {
                    if (Message_Details_Storage[Details_Position-id_detail_offset]==9 || Message_Details_Storage[Details_Position-id_detail_offset]==10 || (Message_Details_Storage[Details_Position-id_detail_offset]==5 && isBL3 && !isVelaro) || Message_Details_Storage[Details_Position-id_detail_offset]==8) {
                        if (isBL3 && !isVelaro) {
                            if (Message_Details_Storage[Details_Position-id_detail_offset]==9 || Message_Details_Storage[Details_Position-id_detail_offset]==8) Track_To_Train_message_Name(DetailsWindow,-Message_Details_Storage[Details_Position+2],0);
                            else Train_To_Track_message_Name(DetailsWindow,-Message_Details_Storage[Details_Position+2],0);
                            D_nid_c(Message_Details_Storage[Details_Position],DetailsWindow);
                            if (Message_Details_Storage[Details_Position-id_detail_offset]==9 || Message_Details_Storage[Details_Position-id_detail_offset]==10) D_nid_rbc(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            else D_nid_riu(Message_Details_Storage[Details_Position+1],DetailsWindow);
                        } else {
                            if (Message_Details_Storage[Details_Position-id_detail_offset]==9) Track_To_Train_message_Name(DetailsWindow,-Message_Details_Storage[Details_Position],0);
                            else Train_To_Track_message_Name(DetailsWindow,-Message_Details_Storage[Details_Position],0);
                        }
                        if (isBL3 && !isVelaro) sprintf(Window_Buffer,"Message #%03d",-Message_Details_Storage[Details_Position+2]);
                        else sprintf(Window_Buffer,"Message #%03d",-Message_Details_Storage[Details_Position]);
                        SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        for (i=Details_Position+1;i<Details_End_Point;i++) {
                            if (isBL3 && !isVelaro && i<Details_Position+3) continue;
                            if (Message_Details_Storage[i]<0 && Message_Details_Storage[i]!=-255) {
                                if (Message_Details_Storage[i]==-256) sprintf(Window_Buffer,"Packet #000"); else sprintf(Window_Buffer,"Packet #%03d",-Message_Details_Storage[i]);
                                SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            }
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==9) {
                            if (isBL3 && !isVelaro) D_track_to_train_message(Details_Position+2,DetailsWindow);
                            else D_track_to_train_message(Details_Position,DetailsWindow);
                        } else {
                            if (isBL3 && !isVelaro) D_train_to_track_message(Details_Position+2,DetailsWindow);
                            else D_train_to_track_message(Details_Position,DetailsWindow);
                        }
                    } else {
                        SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Message Header");
                        for (i=Details_Position;i<Details_End_Point;i++) {
                            if (Message_Details_Storage[i]<0 && Message_Details_Storage[i]!=-255) {
                                if (Message_Details_Storage[i]==-256) sprintf(Window_Buffer,"Packet #000"); else sprintf(Window_Buffer,"Packet #%03d",-Message_Details_Storage[i]);
                                SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            }
                        }
                        if (isPhilippeBirthday) SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Paquet Cadeau");
                        if (Message_Details_Storage[Details_Position]==0) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_UPDOWN\tDown link telegram\tBalise telegram transmission direction"); else SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_UPDOWN\tUp link telegram\tBalise telegram transmission direction");
                        D_m_version(Message_Details_Storage[Details_Position+1],DetailsWindow);
                        if (Message_Details_Storage[Details_Position+2]==0) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_MEDIA\tBalise\tMedia Type"); else SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_MEDIA\tLoop\tType of media");
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==6) {
                            sprintf(Window_Buffer,"N_PIG\tI am the #%d\tPosition in group",Message_Details_Storage[Details_Position+3]+1);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            sprintf(Window_Buffer,"N_TOTAL\t%d balise(s) in the group\tTotal number of balise(s) in the group",Message_Details_Storage[Details_Position+4]+1);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            switch (Message_Details_Storage[Details_Position+5]) {
                                case 0:
                                    sprintf(Window_Buffer,"M_DUP\tNo duplicates\tDuplicate balise");
                                break;
                                case 1:
                                    sprintf(Window_Buffer,"M_DUP\tThis balise is a duplicate of the next balise\tDuplicate balise");
                                break;
                                case 2:
                                    sprintf(Window_Buffer,"M_DUP\tThis balise is a duplicate of the previous balise\tDuplicate balise");
                                break;
                            }
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            sprintf(Window_Buffer,"M_MCOUNT\t%d\tMessage counter",Message_Details_Storage[Details_Position+6]);
                            if (Message_Details_Storage[Details_Position+6]==254) sprintf(Window_Buffer,"M_MCOUNT\t254 : The telegram never fits any message of the group\tMessage counter");
                            if (Message_Details_Storage[Details_Position+6]==255) sprintf(Window_Buffer,"M_MCOUNT\t255 : The telegram fits all telegrams of the group\tMessage counter");
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            D_nid_c(Message_Details_Storage[Details_Position+7],DetailsWindow);
                            D_nid_bg(Message_Details_Storage[Details_Position+8],DetailsWindow);
                            if (Message_Details_Storage[Details_Position+9]==0) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_LINK\tUnlinked\tLink qualifier"); else SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Q_LINK\tLinked\tLink qualifier");
                            if (Message_Details_Storage[Details_Position+10]==BALISE_UNEXPECTED) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"-UNEXPECTED LINKED BALISE GROUP");
                            else if (Message_Details_Storage[Details_Position+10]==BALISE_GRANTED_VOID) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"+NO MORE LINKING");
                            else if (Message_Details_Storage[Details_Position+10]==BALISE_GRANTED_UNLINKED) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"+UNLINKED BALISE GROUP");
                            else if (Message_Details_Storage[Details_Position+10]!=BALISE_DECISION_UNKNOWN) SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"+BALISE GROUP EXPECTED");
                            else SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"|LINKING UNKNOWN");
                        } else {
                            D_nid_c(Message_Details_Storage[Details_Position+3],DetailsWindow);
                            D_g(Message_Details_Storage[Details_Position+4],"NID_LOOP","Identity number of the loop",DetailsWindow);
                        }
                    }
                } else {
                    if (Message_Details_Storage[Details_Position-id_detail_offset]!=1 && Message_Details_Storage[Details_Position-id_detail_offset]!=27) {
                        SendMessage(HeadersWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"Message Header");
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==12) {
                            D_nid_c(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_bg(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            D_m_error(Message_Details_Storage[Details_Position+2],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==199) {
                            D_m_mode(Message_Details_Storage[Details_Position],DetailsWindow);
                            if (Message_Details_Storage[Details_Position+1]==1) sprintf(Window_Buffer,"Q_MANUEL_AUTO\tAUTOMATIC\tTransition Mode"); else sprintf(Window_Buffer,"Q_MANUEL_AUTO\tMANUEL\tTransition Mode");
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==196) {
                            D_g_u(Message_Details_Storage[Details_Position],"M_TRAIN_BRAKE_PERC","Train brake percentage",""," %",DetailsWindow);
                            D_g_u(7-Message_Details_Storage[Details_Position+1],"M_ZBG_IS","ZBG_IS position","Position ","",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==197) {
                            D_z_expl(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==200) {
                            D_m_level(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_stm(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            if (Message_Details_Storage[Details_Position+2]==1) sprintf(Window_Buffer,"Q_MANUEL_AUTO\tAUTOMATIC\tTransition Mode"); else sprintf(Window_Buffer,"Q_MANUEL_AUTO\tMANUAL\tTransition Mode");
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==198) {
                            q_scale = pow(10,Message_Details_Storage[Details_Position+2]-1);
                            if (Message_Details_Storage[Details_Position] == 1023) sprintf(Window_Buffer,"V_PERMITTED\tNone\tPermitted speed"); else sprintf(Window_Buffer,"V_PERMITTED\t%d km/h\tPermitted speed",Message_Details_Storage[Details_Position]);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            D_d_g(q_scale,Message_Details_Storage[Details_Position+1],"D_TARGET","Target distance","None",DetailsWindow);
                            D_q_scale(q_scale,DetailsWindow);
                            if (Message_Details_Storage[Details_Position+3] == 1023) sprintf(Window_Buffer,"V_TARGET\tNone\tTarget Speed"); else sprintf(Window_Buffer,"V_TARGET\t%d km/h\tTarget speed",Message_Details_Storage[Details_Position+3]);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            if (Message_Details_Storage[Details_Position+4] == 1023) sprintf(Window_Buffer,"V_RELEASE\tNone\tRelease Speed"); else sprintf(Window_Buffer,"V_RELEASE\t%d km/h\tRelease speed",Message_Details_Storage[Details_Position+4]);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==2) {
                        packet_offset=0;
                            if (isBL3 && !isVelaro) {
                                D_v_g(Message_Details_Storage[Details_Position+packet_offset],"V_MAXTRAIN","Maximum train speed",5,DetailsWindow);
                                D_nc_cdtrain(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_nc_train(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_d_g(1,Message_Details_Storage[Details_Position+packet_offset],"L_TRAIN","Absolute real length of the train","",DetailsWindow);
                                D_t_traction_cut_off(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_brake_position(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_nom_rot_mass(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_regenerativebrake(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_eddycurrentbrake(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_magneticshoebrake(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_electropneumaticbrake(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_q_g(Message_Details_Storage[Details_Position+packet_offset],"Q_TRACTIONCUTOFFINTERFACE","Qualifier for traction cut off interface","Implemented","Not implemented",DetailsWindow);
                                D_q_g(Message_Details_Storage[Details_Position+packet_offset],"Q_SERVICEBRAKEINTERFACE","Qualifier for service brake interface","Implemented","Not implemented",DetailsWindow);
                                D_q_g(Message_Details_Storage[Details_Position+packet_offset],"Q_SERVICEBRAKEFEEDBACK","Qualifier for service brake feedback interface","Implemented","Not implemented",DetailsWindow);
                                switcher = Message_Details_Storage[Details_Position+packet_offset];
                                D_q_g(switcher,"Q_BRAKE_CAPT_TYPE","Qualifier for gamma/lambda discrimination","Gamma Type","Lambda type",DetailsWindow);
                                if (switcher==0) {
                                    D_m_brake_percentage(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                    iterations = Message_Details_Storage[Details_Position+packet_offset];
                                    D_g(iterations,"N_BRAKE_CONF","Special brakes configuration number",DetailsWindow);
                                    for (i=0;i<iterations;i++) {
                                        n_iter_i=i+1;
                                        D_m_brake_lambda_conf(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        D_t_brake_service(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                    }
                                    n_iter_i=0;
                                    if (iterations>0) {
                                        SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                        if (target_window_index>0) target_window_index++;
                                    }
                                } else {
                                    iterations = Message_Details_Storage[Details_Position+packet_offset];
                                    D_g(iterations,"N_BRAKE_CONF","Special brakes configuration number",DetailsWindow);
                                    for (i=0;i<iterations;i++) {
                                        n_iter_i=i+1;
                                        D_m_brake_gamma_conf(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        D_t_brake_emergency(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        iterations_bis = Message_Details_Storage[Details_Position+packet_offset];
                                        D_n_brake_sections(iterations_bis,DetailsWindow);
                                        for (j=0;j<iterations_bis;j++) {
                                        n_iter_j=j+1;
                                            D_v_g(Message_Details_Storage[Details_Position+packet_offset],"V_BRAKE_EMERGENCY_COMP","Emergency brake speed component",1,DetailsWindow);
                                            D_a_brake_emergency_comp(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],0,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],1,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],2,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],3,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],4,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],5,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],6,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],7,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],8,DetailsWindow);
                                            D_m_kdry_rst(Message_Details_Storage[Details_Position+packet_offset],9,DetailsWindow);
                                            D_m_kwet_rst(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        }
                                        n_iter_j=0;
                                        if (iterations_bis>0) {
                                            SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                            if (target_window_index>0) target_window_index++;
                                        }
                                        D_t_brake_service(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        iterations_bis = Message_Details_Storage[Details_Position+packet_offset];
                                        D_n_brake_sections(iterations_bis,DetailsWindow);
                                        for (j=0;j<iterations_bis;j++) {
                                            n_iter_j=j+1;
                                            D_v_g(Message_Details_Storage[Details_Position+packet_offset],"V_BRAKE_SERVICE_COMP","Service brake speed component",1,DetailsWindow);
                                            D_a_brake_service_comp(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                        }
                                        n_iter_j=0;
                                        if (iterations_bis>0) {
                                            SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                            if (target_window_index>0) target_window_index++;
                                        }
                                    }
                                    n_iter_i=0;
                                    if (iterations>0) {
                                        SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                        if (target_window_index>0) target_window_index++;
                                    }
                                }
                                n_iter_j=0;
                                D_m_loadinggauge(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_n_axle(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                D_m_axleloadcat(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                iterations = Message_Details_Storage[Details_Position+packet_offset];
                                D_n_iter(iterations,DetailsWindow);
                                for (i=0;i<iterations;i++) {
                                    n_iter_i=i+1;
                                    D_m_voltage(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                    D_nid_ctraction(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                }
                                n_iter_i=0;
                                if (iterations>0) {
                                    SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                    if (target_window_index>0) target_window_index++;
                                }
                                iterations = Message_Details_Storage[Details_Position+packet_offset];
                                D_n_iter(iterations,DetailsWindow);
                                for (i=0;i<iterations;i++) {
                                    n_iter_i=i+1;
                                    D_nid_stm(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                                }
                                n_iter_i=0;
                                if (iterations>0) {
                                    SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                    if (target_window_index>0) target_window_index++;
                                }
                                D_m_airtight(Message_Details_Storage[Details_Position+packet_offset],DetailsWindow);
                            } else {
                                D_v_g(Message_Details_Storage[Details_Position],"V_MAXTRAIN","Maximum train speed",5,DetailsWindow);
                                D_nc_train_old(Message_Details_Storage[Details_Position+1],DetailsWindow);
                                D_d_g(1,Message_Details_Storage[Details_Position+2],"L_TRAIN","Absolute real length of the train","",DetailsWindow);
                                int n_gamma_service = Message_Details_Storage[Details_Position+3];
                                sprintf(Window_Buffer,"N_GAMMA_SERVICE\t%d\tNumber of Service Brake Gammas",n_gamma_service); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);

                                if (!isVelaro) n_gamma_service=7;

                                for (i=1;i<=n_gamma_service;i++) {
                                    n_iter_i=i;
                                    sprintf(Window_Buffer,"V_DSGUARENTED_%d\t[%03d-...] km/h\tV_DSGUARENTED_%d",i,Message_Details_Storage[Details_Position+2*i+2],i); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                    sprintf(Window_Buffer,"A_DSGUARANTED_%d\t%.3f m/s²\tA_DSGUARANTED_%d",i,(float)((float)Message_Details_Storage[Details_Position+2*i+3]/1000),i); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                }
                                n_iter_i=0;
                                if (iterations>0) {
                                    SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                    if (target_window_index>0) target_window_index++;
                                }

                                int n_gamma_emergency = Message_Details_Storage[Details_Position+4+2*n_gamma_service];
                                sprintf(Window_Buffer,"N_GAMMA_EMERGENCY\t%d\tNumber of Emergency Brake Gammas",n_gamma_emergency); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);

                                if (!isVelaro) n_gamma_emergency=7;

                                for (i=1;i<=n_gamma_emergency;i++) {
                                    n_iter_i=i;
                                    sprintf(Window_Buffer,"V_DEGUARENTED_%d\t[%03d-...] km/h\tV_DEGUARENTED_%d",i,Message_Details_Storage[Details_Position+2*i+3+2*n_gamma_service],i); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                    sprintf(Window_Buffer,"A_DEGUARANTED_%d\t%.3f m/s²\tA_DEGUARANTED_%d",i,(float)((float)Message_Details_Storage[Details_Position+2*i+4+2*n_gamma_service]/1000),i); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                }
                                n_iter_i=0;
                                if (iterations>0) {
                                    SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                    if (target_window_index>0) target_window_index++;
                                }

                                if (!isVelaro) sprintf(Window_Buffer,"T_CUT_OFF\t%d s\tTraction Cut Time",Message_Details_Storage[Details_Position+5+2*n_gamma_emergency+2*n_gamma_service]);
                                else sprintf(Window_Buffer,"T_CUT_OFF\t%.2f s\tTraction Cut Time",(float)(0.001*Message_Details_Storage[Details_Position+5+2*n_gamma_emergency+2*n_gamma_service]));
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);

                                if (!isVelaro) sprintf(Window_Buffer,"T_SERVICE_DELAY\t%d s\tDelay for Service Brake",Message_Details_Storage[Details_Position+6+2*n_gamma_emergency+2*n_gamma_service]);
                                else sprintf(Window_Buffer,"T_SERVICE_DELAY\t%.2f s\tDelay for Service Brake",(float)(0.05*Message_Details_Storage[Details_Position+6+2*n_gamma_emergency+2*n_gamma_service]));
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);

                                if (!isVelaro) sprintf(Window_Buffer,"T_EMERGENCY_DELAY\t%d s\tDelay for Emergency Brake",Message_Details_Storage[Details_Position+7+2*n_gamma_emergency+2*n_gamma_service]);
                                else sprintf(Window_Buffer,"T_EMERGENCY_DELAY\t%.2f s\tDelay for Emergency Brake",(float)(0.05*Message_Details_Storage[Details_Position+7+2*n_gamma_emergency+2*n_gamma_service]));
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);

                                D_m_loadinggauge(Message_Details_Storage[Details_Position+8+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                D_m_axleload(Message_Details_Storage[Details_Position+9+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);

                                int offset = 0;

                                if (isVelaro) {
                                    iterations = Message_Details_Storage[Details_Position+10+2*n_gamma_emergency+2*n_gamma_service];
                                    D_n_iter(iterations,DetailsWindow);
                                    for (i=0;i<iterations;i++) {
                                        n_iter_i=i+1;
                                        D_m_traction(Message_Details_Storage[Details_Position+11+i+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                    }
                                    n_iter_i=0;
                                    if (iterations>0) {
                                        SendMessage(DetailsWindow,LB_INSERTSTRING,(WPARAM)target_window_index,(LPARAM)Separator_Buffer);
                                        if (target_window_index>0) target_window_index++;
                                    }
                                    offset = 1+iterations;
                                } else {
                                    D_m_traction(Message_Details_Storage[Details_Position+10+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                    D_m_voltage(Message_Details_Storage[Details_Position+11+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                    offset+=2;
                                }

                                D_m_airtight(Message_Details_Storage[Details_Position+10+offset+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                D_m_adhesion(Message_Details_Storage[Details_Position+11+offset+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);

                                if (isVelaro) {
                                    D_nid_mn(Message_Details_Storage[Details_Position+12+offset+2*n_gamma_emergency+2*n_gamma_service],Message_Details_Storage[Details_Position+13+offset+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                                    offset++;
                                }
                                else D_nid_c(Message_Details_Storage[Details_Position+12+offset+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);

                                if (Message_Details_Storage[Details_Position+13+offset+2*n_gamma_emergency+2*n_gamma_service]==16383) sprintf(Window_Buffer,"NID_RBC\tContact last known RBC\tRBC ETCS identity number"); else sprintf(Window_Buffer,"NID_RBC\t%d\tRBC ETCS identity number",Message_Details_Storage[Details_Position+13+offset+2*n_gamma_emergency+2*n_gamma_service]);
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                D_nid_radio(Message_Details_Storage[Details_Position+14+offset+2*n_gamma_emergency+2*n_gamma_service],Message_Details_Storage[Details_Position+15+offset+2*n_gamma_emergency+2*n_gamma_service],Message_Details_Storage[Details_Position+16+offset+2*n_gamma_emergency+2*n_gamma_service],Message_Details_Storage[Details_Position+17+offset+2*n_gamma_emergency+2*n_gamma_service],DetailsWindow);
                            }

                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==3) {
                            if (Message_Details_Storage[Details_Position]==1) sprintf(Window_Buffer,"M_BRAKE_STATE\tApplication\tEmergency brake application/revocation"); else sprintf(Window_Buffer,"M_BRAKE_STATE\tRevocation\tEmergency brake application/revocation");
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==4) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_BRAKE_COMMAND_STATE","Brake command state","Commanded","Not commanded",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==13) {
                            D_nid_c(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_rbc(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            D_m_error(Message_Details_Storage[Details_Position+2],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==14) {
                            D_nid_stm(Message_Details_Storage[Details_Position],DetailsWindow);
                            switcher = Message_Details_Storage[Details_Position+1];
                            D_nid_stmevent(switcher,DetailsWindow);
                            if (switcher==0) {
                                D_m_discsender(Message_Details_Storage[Details_Position+2],DetailsWindow);
                                D_m_disctype(Message_Details_Storage[Details_Position+3],DetailsWindow);
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"M_DISCREASON\tNot yet implemented in JRUGC\tDisconnection reason");
                            } else if (switcher==1) {
                                D_stm_system_status_message(Message_Details_Storage[Details_Position+2],DetailsWindow);
                            }else if (switcher==2) {
                                D_g(Message_Details_Storage[Details_Position+2],"NID_STMPACKET","STM packet",DetailsWindow);
                                D_l_packet(Message_Details_Storage[Details_Position+3],DetailsWindow);
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)"STM Packet are not yet implemented in JRUGC");
                            }
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==15) {
                            if (isBL3 && !isVelaro) {
                                D_m_cold_mvt(Message_Details_Storage[Details_Position],DetailsWindow);
                            } else {
                                sprintf(Window_Buffer,"L_TEXT\t%d\tLongueur du texte",Message_Details_Storage[Details_Position]);
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                char* plain_text = malloc((Message_Details_Storage[Details_Position]+1)*sizeof(char)); if (plain_text==NULL) {log_it(LOG_ERROR,"plain_text_buffer 1","",-1);}
                                for (i=Details_Position+1;i<Details_End_Point;i++) {
                                    plain_text[i-Details_Position-1]=Message_Details_Storage[i];
                                }
                                plain_text[Message_Details_Storage[Details_Position]]='\0';
                                sprintf(Window_Buffer,"X_TEXT\t%s\tTexte",plain_text);
                                SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                free(plain_text);
                            }
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==16 || Message_Details_Storage[Details_Position-id_detail_offset]==17) {
                            D_q_text(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==18 || Message_Details_Storage[Details_Position-id_detail_offset]==19) {
                            sprintf(Window_Buffer,"L_TEXT\t%d\tLongueur du texte",Message_Details_Storage[Details_Position]);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            char* plain_text = malloc((Message_Details_Storage[Details_Position]+1)*sizeof(char)); if (plain_text==NULL) {log_it(LOG_ERROR,"plain_text_buffer 2","",-1);}
                            for (i=Details_Position+1;i<Details_End_Point;i++) {
                                plain_text[i-Details_Position-1]=Message_Details_Storage[i];
                            }
                            plain_text[Message_Details_Storage[Details_Position]]='\0';
                            sprintf(Window_Buffer,"X_TEXT\t%s\tTexte",plain_text);
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                            free(plain_text);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==5) {
                            switch(Message_Details_Storage[Details_Position]) {
                                case 0:
                                    sprintf(Window_Buffer,"M_EVENTS\tNot used\tEvenement");
                                break;
                                case 1:
                                    sprintf(Window_Buffer,"M_EVENTS\tService Brake Failure\tEvenement");
                                break;
                                case 2:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tStandstill supervision intervention\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tTrain Stop Supervision\tEvenement");
                                break;
                                case 3:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tRoll away supervision intervention\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tTrain Slide Detection\tEvenement");
                                break;
                                case 4:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tReverse movement supervision intervention\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tReverse Movement Detection\tEvenement");
                                break;
                                case 5:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tOverride activated\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tTrain EOA Crossing\tEvenement");
                                break;
                                case 6:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tLoop transmission error\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tEurobalise transmission Error\tEvenement");
                                break;
                                case 7:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tOdometer failure\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tRadio transmission Error\tEvenement");
                                break;
                                case 8:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tPassenger brake application\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tRadio transmission Error\tEvenement");
                                break;
                                case 9:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tVersion incompatibility with RBC/RIU\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tOdotachymetry Failure\tEvenement");
                                break;
                                case 10:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tOverride deactivated\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tPassenger Brake\tEvenement");
                                break;
                                case 11:
                                    if (isVelaro) sprintf(Window_Buffer,"M_EVENTS\tTrain enters unsuitable route\tEvenement");
                                    else sprintf(Window_Buffer,"M_EVENTS\tRBC Version Incompatibility\tEvenement");
                                break;
                                case 12:
                                    sprintf(Window_Buffer,"M_EVENTS\tNormal adhesion used\tEvenement");
                                break;
                                case 13:
                                    sprintf(Window_Buffer,"M_EVENTS\tReduced adhesion used\tEvenement");
                                break;
                                case 14:
                                    sprintf(Window_Buffer,"M_EVENTS\tVersion incompatibility with balise\tEvenement");
                                break;
                                default:
                                    sprintf(Window_Buffer,"M_EVENTS\tUnknown (%d)\tEvenement",Message_Details_Storage[Details_Position]);
                                break;
                            }
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==11) {
                            switch(Message_Details_Storage[Details_Position]) {
                                case 0:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(0) Ack of On Sight mode\tAction conducteur");
                                break;
                                case 1:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(1) Ack of Shunting mode\tAction conducteur");
                                break;
                                case 2:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(2) Ack of Train Trip\tAction conducteur");
                                break;
                                case 3:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(3) Ack of Staff Responsible mode\tAction conducteur");
                                break;
                                case 4:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(4) Ack of Unfitted mode\tAction conducteur");
                                break;
                                case 5:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(5) Ack of Reversing mode\tAction conducteur");
                                break;
                                case 6:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(6) Ack of level 0\tAction conducteur");
                                break;
                                case 7:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(7) Ack of level 1\tAction conducteur");
                                break;
                                case 8:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(8) Ack of level 2\tAction conducteur");
                                break;
                                case 9:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(9) Ack of level 3\tAction conducteur");
                                break;
                                case 10:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(10) Ack level NTC\tAction conducteur");
                                break;
                                case 11:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(11) Shunting selected\tAction conducteur");
                                break;
                                case 12:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(12) Non Leading selected\tAction conducteur");
                                break;
                                case 13:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(13) Ack of Limited Supervision mode\tAction conducteur");
                                break;
                                case 14:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(14) Override selected\tAction conducteur");
                                break;
                                case 15:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(15) \"Continue Shunting on desk closure\" selected\tAction conducteur");
                                break;
                                case 16:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(16) Brake release acknowledgment\tAction conducteur");
                                break;
                                case 17:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(17) Exit of Shunting selected\tAction conducteur");
                                break;
                                case 18:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(18) Isolation selected\tAction conducteur");
                                break;
                                case 19:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(19) Start selected\tAction conducteur");
                                break;
                                case 20:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(20) Train Data Entry requested\tAction conducteur");
                                break;
                                case 21:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(21) Validation of train data\tAction conducteur");
                                break;
                                case 22:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(22) Confirmation of Track Ahead Free\tAction conducteur");
                                break;
                                case 23:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(23) Ack of Plain Text information\tAction conducteur");
                                break;
                                case 24:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(24) Ack of Fixed Text information\tAction conducteur");
                                break;
                                case 25:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(25) Request to hide supervision limits\tAction conducteur");
                                break;
                                case 26:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(26) Train integrity confirmation\tAction conducteur");
                                break;
                                case 27:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(27) Request to show supervision limits\tAction conducteur");
                                break;
                                case 28:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(28) Ack of SN mode\tAction conducteur");
                                break;
                                case 29:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(29) Selection of Language\tAction conducteur");
                                break;
                                case 30:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(30) Request to show geographical position\tAction conducteur");
                                break;
                                case 31:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(31) Spare\tAction conducteur");
                                break;
                                case 32:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(32) Spare\tAction conducteur");
                                break;
                                case 33:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(33) Request to hide geographical position\tAction conducteur");
                                break;
                                case 34:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(34) Level 0 selected\tAction conducteur");
                                break;
                                case 35:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(35) Level 1 selected\tAction conducteur");
                                break;
                                case 36:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(36) Level 2 selected\tAction conducteur");
                                break;
                                case 37:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(37) Level 3 selected\tAction conducteur");
                                break;
                                case 38:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(38) Level NTC selected\tAction conducteur");
                                break;
                                case 39:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(39) Request to show tunnel stopping area information\tAction conducteur");
                                break;
                                case 40:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(40) Request to hide tunnel stopping area information\tAction conducteur");
                                break;
                                case 41:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(41) Scroll up button activated\tAction conducteur");
                                break;
                                case 42:
                                    sprintf(Window_Buffer,"M_DRIVERACTIONS\t(42) Scroll down button activated\tAction conducteur");
                                break;
                            }
                            SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==20) {
                            D_m_sdmtype(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_m_sdmsupstat(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            D_v_g(Message_Details_Storage[Details_Position+2],"V_PERM","Permitted speed",1,DetailsWindow);
                            D_v_g(Message_Details_Storage[Details_Position+3],"V_SBI","Service brake intervention speed",1,DetailsWindow);
                            D_v_g(Message_Details_Storage[Details_Position+4],"V_TARGET","Target speed",1,DetailsWindow);
                            D_d_g(1.0,Message_Details_Storage[Details_Position+5],"D_TARGET","Target distance","None",DetailsWindow);
                            D_v_g(Message_Details_Storage[Details_Position+6],"V_TARGET","Release speed",1,DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==21) {
                            D_dmi_symb_status(Message_Details_Storage[Details_Position],Message_Details_Storage[Details_Position+1],Message_Details_Storage[Details_Position+2],Message_Details_Storage[Details_Position+3],Message_Details_Storage[Details_Position+4],Message_Details_Storage[Details_Position+5],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==22) {
                            D_dmi_sound_status(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==23) {
                            D_system_status_message(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==24) {
                            D_m_adhesion(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_mn(Message_Details_Storage[Details_Position+1],Message_Details_Storage[Details_Position+2],DetailsWindow);
                            switcher = Message_Details_Storage[Details_Position+3];
                            D_q_rbcentry(switcher,DetailsWindow);
                            if (switcher==2) {
                                D_nid_c(Message_Details_Storage[Details_Position+4],DetailsWindow);
                                D_nid_rbc(Message_Details_Storage[Details_Position+5],DetailsWindow);
                                D_nid_radio(Message_Details_Storage[Details_Position+6],Message_Details_Storage[Details_Position+7],Message_Details_Storage[Details_Position+8],Message_Details_Storage[Details_Position+9],DetailsWindow);
                                D_nid_operational(Message_Details_Storage[Details_Position+10],Message_Details_Storage[Details_Position+10],DetailsWindow);
                            } else D_nid_operational(Message_Details_Storage[Details_Position+4],Message_Details_Storage[Details_Position+5],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==25) {
                            D_d_sr(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_v_sr(Message_Details_Storage[Details_Position+1],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==26) {
                            D_nid_stm(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==28) {
                            D_nid_vbcmk(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_c(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            D_t_vbc(Message_Details_Storage[Details_Position+2],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==29) {
                            D_nid_c(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_nid_vbcmk(Message_Details_Storage[Details_Position+1],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==30) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_SLEEPING","Sleeping input state","Sleeping requested","Sleeping not requested",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==31) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_PASSIVE_SHUNTING","Passive shunting input state","Passive shunting permitted","Passive shunting not permitted",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==32) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_NON_LEADING","Non leading input state","Non leading permitted","Non leading not permitted",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==33) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_RB_STATUS","Status of the regenerative brake","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==34) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_MSB_STATUS","Status of the magnetic shoe brake","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==35) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_ECB_STATUS","Status of the eddy current brake","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==36) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_EP_STATUS","Status of the electro pneumatic brake","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==37) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_AB_STATUS","Status of the additional brakes","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==38) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_CAB_A_STATUS","Cab A status","Active","Not active",DetailsWindow);
                            switcher = Message_Details_Storage[Details_Position+1];
                            D_q_g(Message_Details_Storage[Details_Position+1],"Q_CAB_B","Qualifier for cab B","Yes","No",DetailsWindow);
                            if (switcher==1) D_q_g(Message_Details_Storage[Details_Position+2],"M_CAB_B_STATUS","Cab B status","Active","Not active",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==39) {
                            D_m_direction_controller(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==40) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_TRACTION_STATUS","Traction status","On","Off",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==41) {
                            D_m_train_data_entry(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==42) {
                            D_nid_stm(Message_Details_Storage[Details_Position],DetailsWindow);
                            D_q_g(Message_Details_Storage[Details_Position+1],"M_NATIONAL_SYSTEM_ISOLATION","Isolation of the National System","STM not isolated","STM isolated",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==43) {
                            D_q_g(Message_Details_Storage[Details_Position],"M_TCO_COMMAND_STATE","Traction cut off command state","Commanded","Not commanded",DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==44) {
                            D_v_g(Message_Details_Storage[Details_Position],"V_LSSMA","Lowest Speed Supervised within the Movement Authority",1,DetailsWindow);
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]==255) {
                            //ETCS PROPRIETARY DATA  RUNDOWN
                            switcher = Message_Details_Storage[Details_Position];
                            D_nid_obp_message(switcher,DetailsWindow);
                            iterations_bis=Details_Position;
                            if (switcher==196) {
                                Details_Position++;
                                iterations = Message_Details_Storage[Details_Position];
                                D_n_iter(iterations,DetailsWindow);
                                Details_Position++;
                                for (i=0;i<iterations;i++) {
                                    switcher_bis = Message_Details_Storage[Details_Position];
                                    D_m_level(switcher_bis,DetailsWindow);
                                    Details_Position++;
                                    if (switcher_bis==1) {
                                        D_nid_stm(Message_Details_Storage[Details_Position],DetailsWindow);
                                        Details_Position++;
                                    }
                                    D_q_g(Message_Details_Storage[Details_Position],"INH_STATE","Level availability","(1) Inhibited due to failure","(0) Available",DetailsWindow);
                                    Details_Position++;
                                }
                                Details_Position=iterations_bis;
                            } else if (switcher==197) {
                                D_z_expl(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            } else if (switcher==198) {
                                D_m_sdmtype(Message_Details_Storage[Details_Position+1],DetailsWindow);
                                D_m_sdmsupstat(Message_Details_Storage[Details_Position+2],DetailsWindow);
                                D_v_g(Message_Details_Storage[Details_Position+4],"V_PERM","Permitted speed",1,DetailsWindow);
                                D_v_g(Message_Details_Storage[Details_Position+3],"V_SBI","Service brake intervention speed",1,DetailsWindow);
                                D_v_g(Message_Details_Storage[Details_Position+5],"V_TARGET","Target speed",1,DetailsWindow);
                                D_d_g(1.0,Message_Details_Storage[Details_Position+6],"D_TARGET","Target distance","None",DetailsWindow);
                                D_v_g(Message_Details_Storage[Details_Position+5],"V_RELEASE","Release speed",1,DetailsWindow);
                            } else if (switcher==199) {
                                D_m_mode(Message_Details_Storage[Details_Position+1],DetailsWindow);
                                D_q_manuel_auto(Message_Details_Storage[Details_Position+2],DetailsWindow);
                            } else if (switcher==200) {
                                D_m_level(Message_Details_Storage[Details_Position+1],DetailsWindow);
                                D_nid_stm(Message_Details_Storage[Details_Position+2],DetailsWindow);
                                D_q_manuel_auto(Message_Details_Storage[Details_Position+3],DetailsWindow);
                            } else if (switcher==201 || switcher==202) {
                                D_q_text_dmi(Message_Details_Storage[Details_Position+1],DetailsWindow);
                            } else if (switcher==203) {
                                sprintf(Window_Buffer,"N_GAMMA_SERVICE\t%d\tNumber of Service Brake Gammas",Message_Details_Storage[Details_Position+1]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                if (Message_Details_Storage[Details_Position+1]>=1) {sprintf(Window_Buffer,"V_DSGUARENTED_1\t[%03d-...] km/h\tV_DSGUARENTED_1",Message_Details_Storage[Details_Position+2]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=1) {sprintf(Window_Buffer,"A_DSGUARANTED_1\t%.3f m/s²\tA_DSGUARANTED_1",(float)((float)Message_Details_Storage[Details_Position+3]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=2) {sprintf(Window_Buffer,"V_DSGUARENTED_2\t[%03d-...] km/h\tV_DSGUARENTED_2",Message_Details_Storage[Details_Position+4]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=2) {sprintf(Window_Buffer,"A_DSGUARANTED_2\t%.3f m/s²\tA_DSGUARANTED_2",(float)((float)Message_Details_Storage[Details_Position+5]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=3) {sprintf(Window_Buffer,"V_DSGUARENTED_3\t[%03d-...] km/h\tV_DSGUARENTED_3",Message_Details_Storage[Details_Position+6]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=3) {sprintf(Window_Buffer,"A_DSGUARANTED_3\t%.3f m/s²\tA_DSGUARANTED_3",(float)((float)Message_Details_Storage[Details_Position+7]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=4) {sprintf(Window_Buffer,"V_DSGUARENTED_4\t[%03d-...] km/h\tV_DSGUARENTED_4",Message_Details_Storage[Details_Position+8]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=4) {sprintf(Window_Buffer,"A_DSGUARANTED_4\t%.3f m/s²\tA_DSGUARANTED_4",(float)((float)Message_Details_Storage[Details_Position+9]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=5) {sprintf(Window_Buffer,"V_DSGUARENTED_5\t[%03d-...] km/h\tV_DSGUARENTED_5",Message_Details_Storage[Details_Position+10]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=5) {sprintf(Window_Buffer,"A_DSGUARANTED_5\t%.3f m/s²\tA_DSGUARANTED_5",(float)((float)Message_Details_Storage[Details_Position+11]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=6) {sprintf(Window_Buffer,"V_DSGUARENTED_6\t[%03d-...] km/h\tV_DSGUARENTED_6",Message_Details_Storage[Details_Position+12]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=6) {sprintf(Window_Buffer,"A_DSGUARANTED_6\t%.3f m/s²\tA_DSGUARANTED_6",(float)((float)Message_Details_Storage[Details_Position+13]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=7) {sprintf(Window_Buffer,"V_DSGUARENTED_7\t[%03d-...] km/h\tV_DSGUARENTED_7",Message_Details_Storage[Details_Position+14]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+1]>=7) {sprintf(Window_Buffer,"A_DSGUARANTED_7\t%.3f m/s²\tA_DSGUARANTED_7",(float)((float)Message_Details_Storage[Details_Position+15]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                sprintf(Window_Buffer,"N_GAMMA_EMERGENCY\t%d\tNumber of Emergency Brake Gammas",Message_Details_Storage[Details_Position+16]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);
                                if (Message_Details_Storage[Details_Position+16]>=1) {sprintf(Window_Buffer,"V_DEGUARENTED_1\t[%03d-...] km/h\tV_DEGUARENTED_1",Message_Details_Storage[Details_Position+17]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=1) {sprintf(Window_Buffer,"A_DEGUARANTED_1\t%.3f m/s²\tA_DEGUARANTED_1",(float)((float)Message_Details_Storage[Details_Position+18]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=2) {sprintf(Window_Buffer,"V_DEGUARENTED_2\t[%03d-...] km/h\tV_DEGUARENTED_2",Message_Details_Storage[Details_Position+19]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=2) {sprintf(Window_Buffer,"A_DEGUARANTED_2\t%.3f m/s²\tA_DEGUARANTED_2",(float)((float)Message_Details_Storage[Details_Position+20]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=3) {sprintf(Window_Buffer,"V_DEGUARENTED_3\t[%03d-...] km/h\tV_DEGUARENTED_3",Message_Details_Storage[Details_Position+21]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=3) {sprintf(Window_Buffer,"A_DEGUARANTED_3\t%.3f m/s²\tA_DEGUARANTED_3",(float)((float)Message_Details_Storage[Details_Position+22]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=4) {sprintf(Window_Buffer,"V_DEGUARENTED_4\t[%03d-...] km/h\tV_DEGUARENTED_4",Message_Details_Storage[Details_Position+23]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=4) {sprintf(Window_Buffer,"A_DEGUARANTED_4\t%.3f m/s²\tA_DEGUARANTED_4",(float)((float)Message_Details_Storage[Details_Position+24]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=5) {sprintf(Window_Buffer,"V_DEGUARENTED_5\t[%03d-...] km/h\tV_DEGUARENTED_5",Message_Details_Storage[Details_Position+25]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=5) {sprintf(Window_Buffer,"A_DEGUARANTED_5\t%.3f m/s²\tA_DEGUARANTED_5",(float)((float)Message_Details_Storage[Details_Position+26]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=6) {sprintf(Window_Buffer,"V_DEGUARENTED_6\t[%03d-...] km/h\tV_DEGUARENTED_6",Message_Details_Storage[Details_Position+27]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=6) {sprintf(Window_Buffer,"A_DEGUARANTED_6\t%.3f m/s²\tA_DEGUARANTED_6",(float)((float)Message_Details_Storage[Details_Position+28]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=7) {sprintf(Window_Buffer,"V_DEGUARENTED_7\t[%03d-...] km/h\tV_DEGUARENTED_7",Message_Details_Storage[Details_Position+29]); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                                if (Message_Details_Storage[Details_Position+16]>=7) {sprintf(Window_Buffer,"A_DEGUARANTED_7\t%.3f m/s²\tA_DEGUARANTED_7",(float)((float)Message_Details_Storage[Details_Position+30]/1000)); SendMessage(DetailsWindow,LB_ADDSTRING,(WPARAM)0,(LPARAM)Window_Buffer);}
                            } else if (switcher==204) {
                                D_nid_c(Message_Details_Storage[Details_Position+1],DetailsWindow);
                                D_g(Message_Details_Storage[Details_Position+2],"NID_LOOP","Identity number of the loop",DetailsWindow);
                                D_m_error(Message_Details_Storage[Details_Position+3],DetailsWindow);
                                D_q_g(Message_Details_Storage[Details_Position+4],"BLTM_ACTIVE","Active BLTM chain","BLTM_B","BLTM_A",DetailsWindow);
                            }
                        }
                        if (Message_Details_Storage[Details_Position-id_detail_offset]>1000) {
                            D_other_data(Message_Details_Storage[Details_Position],DetailsWindow);
                        }
                    }
                }
                SendMessage(HeadersWindow,LB_SETCURSEL,Current_Message.wParam,0);
            }
            else if (Current_Message.hwnd==HeadersWindow && header_position!=0) {
                SendMessage(DetailsWindow,LB_RESETCONTENT,0,0);
                int headers_index = SendMessage(HeadersWindow,LB_GETCURSEL,0,0);
                int packet_count = 0;
                if (isBL3 && !isVelaro && (Message_Details_Storage[Details_Position-id_detail_offset]==10 || Message_Details_Storage[Details_Position-id_detail_offset]==9)) packet_count--;
                int nid_packet;
                if (Message_Details_Storage[Details_Position-id_detail_offset]==9) {
                    for (i=Details_Position+1;i<=Details_End_Point;i++) {
                        if (Message_Details_Storage[i]<0) packet_count++;
                        if (packet_count==headers_index) {
                            packet_offset = i+1;
                            nid_packet = -Message_Details_Storage[i];
                            if (nid_packet==0) nid_packet=256;
                            break;
                        }
                    }
                    D_track_to_train_packet(nid_packet,DetailsWindow,true,current_message_version);
                }
                if (Message_Details_Storage[Details_Position-id_detail_offset]==10) {
                    for (i=Details_Position+1;i<=Details_End_Point;i++) {
                        if (Message_Details_Storage[i]<0) packet_count++;
                        if (packet_count==headers_index) {
                            packet_offset = i+1;
                            nid_packet = -Message_Details_Storage[i];
                            if (nid_packet==0) nid_packet=256;
                            break;
                        }
                    }
                    D_train_to_track_packet(nid_packet,DetailsWindow,true,current_message_version);
                }
                if (Message_Details_Storage[Details_Position-id_detail_offset]==6 || Message_Details_Storage[Details_Position-id_detail_offset]==7) {
                    SendMessage(HeadersWindow,LB_GETTEXT,(WPARAM)headers_index,(LPARAM)Current_Packet_Buffer);
                    if (Current_Packet_Buffer[8]=='a') {
                        SendMessage(DetailsWindow,LB_ADDSTRING,0,(WPARAM)"JOYEUX ANNIVERSAIRE PHILIPPE");
                    } else {
                        for (i=Details_Position+1;i<=Details_End_Point;i++) {
                            if (Message_Details_Storage[i]<0) packet_count++;
                            if (packet_count==headers_index) {
                                packet_offset = i+1;
                                nid_packet = -Message_Details_Storage[i];
                                if (nid_packet==0) nid_packet=256;
                                break;
                            }
                        }
                        D_track_to_train_packet(nid_packet,DetailsWindow,true,current_message_version);
                    }
                }
            }
            if (IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow)) {
                RedrawWindow(VTRACKWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW);
                UpdateWindow(VTRACKWindow);
                UpdateWindow(VTRACKListWindow);
            }
        }
        if (Current_Message.message==WM_LBUTTONDBLCLK && Current_Window==MAWindow) {
            int index = Message_Details_Storage[Details_Position-MA_index_offset];
            int new_details_position;
            int new_header_position=0;

            if (MA_display_speed==-5 || MA_display_distance<0 || MA_display_distance>MAX_DISTANCE_MA || index<0) {

                for (i=Message_Position+1;i<Last_Message;i++) {
                    new_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,i,0);
                    if (i==Message_Details_Storage[new_details_position-MA_index_offset]) break;
                }
            } else {
                i = index;
                new_details_position = SendMessage(MessageWindow,LB_GETITEMDATA,index,0);
            }
            for (j=0;j<10000;j++) {
                if (Message_Details_Storage[new_details_position+j]<0) new_header_position++;

                if (Message_Details_Storage[new_details_position+j]==-12 || Message_Details_Storage[new_details_position+j]==-15) {
                    if (Message_Details_Storage[new_details_position-id_detail_offset]==9) new_header_position--;
                    SendMessage(MessageWindow,LB_SETCURSEL,i,0);
                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)new_header_position,0);
                    PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,0);
                    break;
                }
            }
        }
        if (Current_Message.message==WM_KEYUP) {
            Key_Is_Down=false;
            if (!Track_Is_Redrawn) {
                RedrawWindow(VTRACKWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);
                Track_Is_Redrawn=true;
            }
            if (Current_Message.wParam==VK_SHIFT) {shift = false; RedrawWindow(VTRACKWindow,NULL,NULL,RDW_ERASENOW|RDW_INVALIDATE);}
            if (Current_Message.wParam==VK_CONTROL || Current_Message.wParam==VK_MENU) control = false;
        }

        if (Current_Message.message==WM_LBUTTONDOWN && Current_Message.hwnd==MainWindow && (IsWindowVisible(VTRACKWindow) || IsWindowVisible(SpeedProfileWindow) ))  {
            SetFocus(MessageWindow);
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE) {
            if (Current_Message.wParam==(WPARAM)QuitButtonWindow) break;
            if (Current_Message.wParam==(WPARAM)ClearAllButtonWindow) {
                reset_view();
            }
        }
        if (Last_Message>0 && (((Current_Message.message==WM_LBUTTONDBLCLK && Current_Window==MessageWindow) || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='S' && (Current_Window==MessageWindow || Current_Window==VTRACKWindow || Current_Window==SpeedProfileWindow))) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)SetButtonWindow))) {
            Reference_Message = Message_Position;
            Reference_Time = Time_Storage[Message_Position];
            Reference_Distance = Distance_Storage[Message_Position];
            SetWindowText(TimeWindow,"00 h 00 m 00 s 000 ms");
            SetWindowText(DistanceWindow,"0 km 000 m");
            sprintf(SpeedWindow_Buffer,"%d km/h",current_message_speed);
            SetWindowText(SpeedWindow,SpeedWindow_Buffer);
            RedrawWindow(MessageWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(VTRACKWindow)) RedrawWindow(VTRACKWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);
            continue;
        }
        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='C' && Reference_Message>=0 && (Current_Window==MessageWindow || Current_Window==VTRACKWindow || Current_Window==SpeedProfileWindow)) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)ClearButtonWindow && Reference_Message>=0))) {
            Reference_Message = -1;
            SetWindowText(TimeWindow,"No Reference");
            SetWindowText(DistanceWindow,"No Reference");
            SetWindowText(SpeedWindow,"No Reference");
            RedrawWindow(MessageWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(VTRACKWindow)) RedrawWindow(VTRACKWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);
            continue;
        }
        if (Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='C' && Current_Window==MessageWindow) continue;
        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='G' && Reference_Message>=0 && (Current_Window==MessageWindow || Current_Window==VTRACKWindow || Current_Window==SpeedProfileWindow)) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)GoToButtonWindow && Reference_Message>=0))) {
            SendMessage(MessageWindow,LB_SETCURSEL,Reference_Message,0);
            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
            RedrawWindow(MessageWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(VTRACKWindow)) RedrawWindow(VTRACKWindow,NULL,NULL,RDW_INVALIDATE);
            if (IsWindowVisible(SpeedProfileWindow)) RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE);
            SetFocus(MessageWindow);
            continue;
        }
        if (Current_Message.message==BTN_CLICKED_MESSAGE) {
            if (Current_Message.wParam==(WPARAM)PreviousDaySearchWindow) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,DAY_SEARCH_RQST,-1);
            if (Current_Message.wParam==(WPARAM)NextDaySearchWindow) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,DAY_SEARCH_RQST,0);
            if (Current_Message.wParam==(WPARAM)PreviousStartStopSearchWidow) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,START_STOP_SEARCH_RQST,-1);
            if (Current_Message.wParam==(WPARAM)NextStartStopSearchWindow) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,START_STOP_SEARCH_RQST,0);
        }
        if (Current_Message.message==WM_KEYDOWN && (Current_Window==MessageWindow|| Current_Window==SpeedProfileWindow  || Current_Window==VTRACKWindow || Current_Window==VTRACKListWindow)) {
            if (Current_Message.wParam=='N') {
                if (shift) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,START_STOP_SEARCH_RQST,-1); else PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,START_STOP_SEARCH_RQST,0);
            }
            if (Current_Message.wParam=='D') {
                if (shift) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,DAY_SEARCH_RQST,-1); else PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,DAY_SEARCH_RQST,0);
                continue;
            }
            if (Current_Message.wParam=='B' || (Current_Message.wParam==VK_SPACE && !IsWindowVisible(MediaWindow_1) && !IsWindowVisible(MediaWindow_2))) {
                if (shift) PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,BALISE_SEARCH_RQST,-1); else PostMessage(MessageWindow,SEARCH_RQST_MESSAGE,BALISE_SEARCH_RQST,0);
                continue;
            }
        }
        if (Last_Message>0 && ((Current_Message.message==WM_KEYDOWN && Current_Message.wParam==13 && (Current_Window==SearchButtonWindow || Current_Window==MessageSearchWindowChild || Current_Window==DateSearchWindow || Current_Window==TrainSearchWindow || Current_Window==BaliseSearchWindow || Current_Window==LinkedBaliseSearchWindow || Current_Window==PacketSearchWindow || Current_Window==RadioSearchWindow || Current_Window==SpeedSearchWindow || Current_Window==LevelSearchWindowChild || Current_Window==ModeSearchWindowChild|| Current_Window==AdvancedSearchNameWindow|| Current_Window==AdvancedSearchValueWindow)) || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam=='R' && Current_Window==MessageWindow && Last_Message>0) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)SearchButtonWindow) || (Current_Message.message==SEARCH_RQST_MESSAGE || Current_Message.message==SEARCH_TRGR_MESSAGE))) {
            if (ROLE>=ROLE_DEMO) SetWindowText(AdvancedSearchNameWindow,"");
            if (ROLE>=ROLE_DEMO) SetWindowText(AdvancedSearchValueWindow,"");
            ASV_Search_Index=-1; ASV_increment=0;
            ShowWindow(SearchProgressWindow, nCmdShow);
            GetWindowText(MessageSearchWindowChild,Message_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(DateSearchWindow,Date_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(TrainSearchWindow,Train_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(BaliseSearchWindow,Balise_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(LinkedBaliseSearchWindow,Linked_Balise_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(PacketSearchWindow,Packet_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(RadioSearchWindow,Radio_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(SpeedSearchWindow,Speed_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(LevelSearchWindowChild,Level_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(ModeSearchWindowChild,Mode_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(AdvancedSearchNameWindow,ASV_Name_Search_Buffer,Search_Buffer_Size-1);
            GetWindowText(AdvancedSearchValueWindow,ASV_Value_Search_Buffer,Search_Buffer_Size-1);

            uppercase(ASV_Name_Search_Buffer);

            if (Date_Search_Buffer[0]!='\0') {
                Search_Day = atoi(strtok(Date_Search_Buffer,"/"));
                Search_Month = atoi(strtok(NULL,"/"));
                Search_Year = atoi(strtok(NULL,"/"));
            }
            int initial_day = Message_Details_Storage[Details_Position-day_detail_offset];
            int initial_balise = Message_Details_Storage[Details_Position-last_balise_offset];
            bool initial_speed = (Message_Details_Storage[Details_Position-speed_detail_offset]>0);
            int start_searching_in_link=-1,newcountry_offset;
            if (Message_Search_Buffer[0]!='\0') {
                Id_Search = Message_ID2INDEX(Message_Search_Buffer);
                if (Id_Search==-999) {
                    ShowWindow(GameWindow,nCmdShow);
                    game_paused=false;
                    game_DC = GetWindowDC(GameWindow);
                    ShowWindow(MessageWindow,SW_HIDE);
                    ShowWindow(VTRACKWindow,SW_HIDE);
                    ShowWindow(VTRACKListWindow,SW_HIDE);
                    ShowWindow(SpeedProfileWindow,SW_HIDE);
                    ShowWindow(EnlargeMessageWindowButton,SW_HIDE);
                    ShowWindow(SearchProgressWindow, SW_HIDE);
                    SetWindowText(MessageSearchWindow,"");
                    SetWindowText(DateSearchWindow,"");
                    SetWindowText(TrainSearchWindow,"");
                    SetWindowText(BaliseSearchWindow,"");
                    SetWindowText(LinkedBaliseSearchWindow,"");
                    SetWindowText(PacketSearchWindow,"");
                    SetWindowText(RadioSearchWindow,"");
                    SetWindowText(SpeedSearchWindow,"");
                    SetWindowText(LevelSearchWindow,"");
                    SetWindowText(ModeSearchWindow,"");
                    SetWindowText(AdvancedSearchNameWindow,"");
                    SetWindowText(AdvancedSearchValueWindow,"");
                    SetFocus(GameWindow);
                    continue;
                }
            }
            if (Level_Search_Buffer[0]!='\0') {
                Level_Search = Level_ID2INDEX(Level_Search_Buffer);
            }
            if (Mode_Search_Buffer[0]!='\0') {
                Mode_Search = Mode_ID2INDEX(Mode_Search_Buffer);
            }

            Train_Search = atoi(Train_Search_Buffer);
            if (Balise_Search_Buffer[2]=='-' && strlen(Balise_Search_Buffer)>2) {
                Nid_c_Search = atoi(Balise_Search_Buffer);
                Balise_Search = atoi(&Balise_Search_Buffer[3]);
            } else if (Balise_Search_Buffer[3]=='-' && strlen(Balise_Search_Buffer)>3) {
                Nid_c_Search = atoi(Balise_Search_Buffer);
                Balise_Search = atoi(&Balise_Search_Buffer[4]);
            } else {
                Nid_c_Search =-9999;
                Balise_Search = atoi(Balise_Search_Buffer);
            }

            Linked_Balise_Search = atoi(Linked_Balise_Search_Buffer);
            if (Linked_Balise_Search_Buffer[0]!='\0') {
                if (Packet_Search_Buffer[0]=='\0') {
                    Packet_Search_Buffer[0]='5';
                    Packet_Search_Buffer[1]='\0';
                }
                if (Message_Search_Buffer[0]=='\0') Id_Search=6;
            }
            Packet_Search = atoi(Packet_Search_Buffer);
            if (Linked_Balise_Search_Buffer[0]!='\0' && ((Packet_Search!=5 && Packet_Search_Buffer[0]!='\0') || (Id_Search!=6 && Message_Search_Buffer[0]!='\0'))) {
                SendMessage(SearchProgressWindow,PBM_SETPOS,100,0);
                Sleep(200);
                ShowWindow(SearchProgressWindow, 0);
                continue;
            }

            float ASV_search_value_min,ASV_search_value_max,ASV_Search_Value;
            int ASV_switch_offset;
            ASV_Stored_Value=-1;

            if (ASV_Name_Search_Buffer[0]!='\0') {
                if (ASV_Value_Search_Buffer[0]=='\0') {
                    ASV_search_value_min=-MAX_ASV_SEARCH;
                    ASV_search_value_max=MAX_ASV_SEARCH;
                } else {
                    char* ASV_VALUE_NEXT;
                    ASV_search_value_min = atof(ASV_Value_Search_Buffer);
                    if (ASV_Value_Search_Buffer[0]=='-' && ASV_Value_Search_Buffer[1]==';') ASV_search_value_min=-MAX_ASV_SEARCH;
                    strtok(ASV_Value_Search_Buffer,";");
                    ASV_VALUE_NEXT = strtok(NULL,";");
                    if (ASV_VALUE_NEXT==NULL) ASV_search_value_max = ASV_search_value_min; else {
                        ASV_search_value_max = atof(ASV_VALUE_NEXT);
                        if (ASV_VALUE_NEXT[0]=='+') ASV_search_value_max = +MAX_ASV_SEARCH;
                    }
                }
            }

            int incremental_asv_target_offset;

            int ASV_packet_search_index = -1;
            int ASV_location_count;
            float ASV_factor = 1.0;

            Radio_Search = atoi(Radio_Search_Buffer);
            if (Packet_Search==256) Packet_Search=9999;
            if (Packet_Search==0) Packet_Search=256;
            if (Radio_Search==256) Radio_Search=9999;
            if (Radio_Search==0) Radio_Search=256;
            Speed_Search = atoi(Speed_Search_Buffer);
            Search_Header=0;
            if (Linked_Balise_Search_Buffer[0]=='\0' && combinate_search_mode) Linked_Balise_Search_Check=true; else Linked_Balise_Search_Check=false;
            for (i=1;i<=Last_Message+1;i++) {
                if (shift || (Current_Message.message==SEARCH_RQST_MESSAGE && Current_Message.lParam==-1) || (Current_Message.message==SEARCH_TRGR_MESSAGE && Current_Message.wParam==-1)) Search_Message=Message_Position-i; else Search_Message=Message_Position+i;
                if (Search_Message<0) Search_Message+=Last_Message+1;
                if (Search_Message>Last_Message) Search_Message-=(Last_Message+1);
                Current_Details_Search_Position = SendMessage(MessageWindow,LB_GETITEMDATA,Search_Message,0);
                int Search_Version = Message_Details_Storage[Current_Details_Search_Position-version_detail_offset];
                int Search_Id = Message_Details_Storage[Current_Details_Search_Position-id_detail_offset];
                if (combinate_search_mode) ASV_check = true;
                if (ASV_Name_Search_Buffer[0]!='\0') {
                    ASV_check = false;
                    ASV_location_count = get_ASV_detail(ASV_Name_Search_Buffer,Search_Version);
                    ASV_Search_Value=-2*MAX_ASV_SEARCH;
                    if (Search_Id==9 || Search_Id==10) {
                        if (strstr(ASV_Name_Search_Buffer,"NID_C")!=NULL && strlen(ASV_Name_Search_Buffer)==5 && isBL3) {
                            if (isBL3 && !isVelaro) ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position];
                            if (ASV_Search_Value<=ASV_search_value_max && ASV_Search_Value>=ASV_search_value_min && !ASV_check) {
                                ASV_check=true;
                                ASV_increment=0;
                                ASV_Search_Index=1;
                            }
                        }
                        if (strstr(ASV_Name_Search_Buffer,"NID_C")!=NULL && strlen(ASV_Name_Search_Buffer)==5 && !ASV_check && Search_Id==9) {
                            if (isBL3 && !isVelaro) ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+7];
                            else ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+4];
                            ASV_Search_Index=isBL3?7:5;
                        } else if (strstr(ASV_Name_Search_Buffer,"T_TRAIN")!=NULL && strlen(ASV_Name_Search_Buffer)==7) {
                            unsigned long long search_t_train;
                            if (isBL3 && !isVelaro) search_t_train = 65536LLU*(unsigned long long)(Message_Details_Storage[Current_Details_Search_Position+4])+(unsigned long long)(Message_Details_Storage[Current_Details_Search_Position+5]);
                            else search_t_train = 65536LLU*(unsigned long long)(Message_Details_Storage[Current_Details_Search_Position+2])+(unsigned long long)(Message_Details_Storage[Current_Details_Search_Position+3]);
                            ASV_Search_Value = 0.01*search_t_train;
                            ASV_Search_Value = roundf(ASV_Search_Value*100)/100;
                            ASV_Search_Index=isBL3?4:2;
                            if (ASV_Search_Value<=ASV_search_value_max && ASV_Search_Value>=ASV_search_value_min) ASV_check=true;
                            ASV_increment=0;
                        } else if (strstr(ASV_Name_Search_Buffer,"NID_RBC")!=NULL && strlen(ASV_Name_Search_Buffer)==7 && isBL3) {
                            ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+1];
                            ASV_Search_Index=2;
                        } else if (strstr(ASV_Name_Search_Buffer,"M_ACK")!=NULL && strlen(ASV_Name_Search_Buffer)==5 && Search_Id==9) {
                            if (isBL3 && !isVelaro) ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+6];
                            else ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+4];
                            ASV_Search_Index=isBL3?6:4;
                        } else if (strstr(ASV_Name_Search_Buffer,"NID_ENGINE")!=NULL && strlen(ASV_Name_Search_Buffer)==10 && Search_Id==10) {
                            if (isBL3 && !isVelaro) ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+6];
                            else ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+4];
                            ASV_Search_Index=isBL3?6:4;
                        } else if (strstr(ASV_Name_Search_Buffer,"NID_BG")!=NULL && strlen(ASV_Name_Search_Buffer)==6 && Search_Id==9) {
                            if (isBL3 && !isVelaro) ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+8];
                            else ASV_Search_Value = Message_Details_Storage[Current_Details_Search_Position+6];
                            ASV_Search_Index=isBL3?8:6;
                        }
                        if (ASV_Search_Value<=ASV_search_value_max && ASV_Search_Value>=ASV_search_value_min && !ASV_check) {
                            ASV_check=true;
                            ASV_increment=0;
                        }
                    }
                    if (!ASV_check) {
                        for (j=0;j<ASV_location_count;j++) {
                            if (ASV_Buffer[ASV_location_size*j]!='P' && ASV_Buffer[ASV_location_size*j]!='Q') {
                                if (atoi(&ASV_Buffer[1+ASV_location_size*j])==Search_Id) {
                                    if (atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*j])>0) {
                                        if (ASV_Buffer[ASVO_Factor+ASV_location_size*j-1]=='|') ASV_factor = pow(10,Message_Details_Storage[Current_Details_Search_Position+atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*j])]-1);
                                        else if (ASV_Buffer[ASVO_Factor+ASV_location_size*j-1]=='/') ASV_factor = 1/atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*j]);
                                        else if (ASV_Buffer[ASVO_Factor+ASV_location_size*j-1]=='*') ASV_factor = atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*j]);
                                    }
                                    ASV_switch_offset=get_ASV_switch_offset(j,Current_Details_Search_Position,Search_Version);
                                    if (ASV_switch_offset<0) ASV_Search_Value=-2*MAX_ASV_SEARCH; else ASV_Search_Value = ASV_factor*Message_Details_Storage[Current_Details_Search_Position-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j])+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])];
                                    if (strstr(ASV_Name_Search_Buffer,"T_TRAIN")!=NULL && strlen(ASV_Name_Search_Buffer)==7) {
                                        unsigned long long search_t_train = 65536LLU*(unsigned long long)(Message_Details_Storage[Current_Details_Search_Position-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j])+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])])+(unsigned long long)(Message_Details_Storage[1+Current_Details_Search_Position-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j])+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])]);
                                        ASV_Search_Value = 0.01*search_t_train;
                                    }
                                    ASV_Search_Value = roundf(ASV_Search_Value*1000)/1000;
                                    if (strstr(ASV_Name_Search_Buffer,"X_TEXT")!=NULL) {
                                        if (strlen(ASV_Value_Search_Buffer)==0) ASV_check=true;
                                        for (l=0;l<strlen(ASV_Value_Search_Buffer);l++) {
                                            ASV_check=false;
                                            ASV_Search_Value = Message_Details_Storage[l+Current_Details_Search_Position-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j])+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])];
                                            if (ASV_Search_Value!=ASV_Value_Search_Buffer[l]) break;
                                            ASV_check=true;
                                        }
                                        if (ASV_check) {
                                            ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j]);
                                            ASV_increment = 0;
                                        }
                                    } else if (ASV_search_value_min<=ASV_Search_Value && ASV_search_value_max>=ASV_Search_Value) {
                                        ASV_check = true;
                                        ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j]);
                                        ASV_increment = 0;
                                        break;
                                    } else if (!ASV_check && ASV_switch_offset>=0) {
                                        int iter_index = atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*j]);
                                        int iter_value = atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*j]);
                                        int max_iter = Message_Details_Storage[Current_Details_Search_Position+iter_index];
                                        int main_offset = atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*j]);
                                        int incremental_offset=0;
                                        int final_offset_1 = atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*j]);
                                        int final_offset_2 = atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*j]);
                                        for (l=0;l<max_iter;l++) {
                                            incremental_offset=get_asv_target_iter_offset_before(j,Current_Details_Search_Position+ASV_switch_offset+iter_index+l*iter_value,incremental_offset,Search_Version);
                                            if (ASV_switch_offset<0 || incremental_offset<0) ASV_Search_Value=-2*MAX_ASV_SEARCH; else ASV_Search_Value = ASV_factor*Message_Details_Storage[Current_Details_Search_Position+ASV_switch_offset+main_offset+l*iter_value+incremental_offset-final_offset_1+final_offset_2];
                                            if (incremental_offset<0) incremental_offset+=9999999;
                                            if ((ASV_Search_Value <= ASV_search_value_max && ASV_Search_Value >= ASV_search_value_min))  {
                                                ASV_check=true;
                                                ASV_Search_Index = ASV_switch_offset+main_offset+l*iter_value+incremental_offset-final_offset_1+final_offset_2;
                                                ASV_increment = 0;
                                                break;
                                            }
                                            incremental_offset=get_asv_target_iter_offset_after(j,Current_Details_Search_Position+ASV_switch_offset+iter_index+l*iter_value,incremental_offset,Search_Version);
                                        }
                                    }
                                }
                            } else {
                                ASV_packet_search_index = j;
                                break;
                            }
                        }
                    }
                }

                if (Current_Message.wParam==DAY_SEARCH_RQST) {
                    if (Message_Details_Storage[Current_Details_Search_Position-day_detail_offset]!=initial_day && Message_Details_Storage[Current_Details_Search_Position-year_detail_offset]!=72) {
                        SendMessage(MessageWindow,LB_SETCURSEL,Search_Message,0);
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)Search_Header,0);
                        break;
                    }
                }
                if (Current_Message.wParam==START_STOP_SEARCH_RQST) {
                    if ((Message_Details_Storage[Current_Details_Search_Position-speed_detail_offset]>0)!=initial_speed) {
                        SendMessage(MessageWindow,LB_SETCURSEL,Search_Message,0);
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)Search_Header,0);
                        break;
                    }
                }
                if (Current_Message.wParam==BALISE_SEARCH_RQST) {
                    if (Message_Details_Storage[Current_Details_Search_Position+8]!=initial_balise && Search_Id==6) {
                        SendMessage(MessageWindow,LB_SETCURSEL,Search_Message,0);
                        PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)Search_Header,0);
                        break;
                    }
                }
                newcountry_offset=0;
                if (Packet_Search_Buffer[0]!='\0' || ASV_packet_search_index>=0 || strstr(ASV_Name_Search_Buffer,"Q_DIR")!=NULL || strstr(ASV_Name_Search_Buffer,"L_PACKET")!=NULL) {
                    if (Linked_Balise_Search_Buffer[0]!='\0') Linked_Balise_Search_Check=false;
                    if (Packet_Search_Buffer[0]!='\0') Packet_Search_Check = false;
                    if (Search_Id<=10 && Search_Id>=6) {
                        if (Search_Message==Last_Message) Current_Details_Search_End_Position = End_Details_Position; else Current_Details_Search_End_Position = SendMessage(MessageWindow,LB_GETITEMDATA,Search_Message+1,0)-max_details_offset;
                        Search_Header=0;
                        for (j=Current_Details_Search_Position+1;j<Current_Details_Search_End_Position-1;j++) {
                            if (j<Current_Details_Search_Position+3 && isBL3) {j++; continue;}
                            if (start_searching_in_link>0) {
                                if (((j-start_searching_in_link==5) || (((j-start_searching_in_link-12)%6)==0 && j-start_searching_in_link>=13)) && Message_Details_Storage[j]==1) newcountry_offset++;
                                if (((j-start_searching_in_link==6+newcountry_offset) || (((j-start_searching_in_link-13)%6)==newcountry_offset && j-start_searching_in_link>=14)) && Message_Details_Storage[j]==Linked_Balise_Search) {
                                    Linked_Balise_Search_Check=true;
                                    break;
                                }
                            }
                            if (Message_Details_Storage[j]<0) {
                                if (strstr(ASV_Name_Search_Buffer,"Q_DIR")!=NULL && Message_Details_Storage[j]!=-256 && Search_Id!=10 && Message_Details_Storage[j+1]>=ASV_search_value_min && Message_Details_Storage[j+1]<=ASV_search_value_max) {
                                    ASV_check = true;
                                    ASV_Search_Index=1;
                                    ASV_increment=0;
                                }
                                if (strstr(ASV_Name_Search_Buffer,"L_PACKET")!=NULL) {
                                    if (Search_Id==10  && Message_Details_Storage[j+1]>=ASV_search_value_min && Message_Details_Storage[j+1]<=ASV_search_value_max) {ASV_check = true; ASV_Search_Index=1; ASV_increment=0;}
                                    if (Search_Id!=10  && Message_Details_Storage[j+2]>=ASV_search_value_min && Message_Details_Storage[j+2]<=ASV_search_value_max) {ASV_check = true; ASV_Search_Index=2; ASV_increment=0;}

                                }
                                Search_Header++;
                                    if (!ASV_check) {
                                        for (k=ASV_packet_search_index;k<ASV_location_count;k++) {
                                            if (ASV_check) break;
                                            if ((ASV_Buffer[k*ASV_location_size]=='P' && Search_Id==10) || (ASV_Buffer[k*ASV_location_size]=='Q' && Search_Id!=10)) {
                                                continue;
                                            }
                                            if (Message_Details_Storage[j]==-atoi(&ASV_Buffer[1+ASV_location_size*k])) {
                                                if (ASV_check) break;
                                                if (atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k])>0) {
                                                    if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='|') ASV_factor = pow(10,Message_Details_Storage[j+atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k])]-1);
                                                    else if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='/') ASV_factor = (float)(1.0/(float)atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k]));
                                                    else if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='*') ASV_factor = atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k]);
                                                }
                                                ASV_switch_offset=get_ASV_switch_offset(k,j,Search_Version);
                                                if (atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])>0) {
                                                    int max_ASV_iter = Message_Details_Storage[j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*k])];
                                                    incremental_asv_target_offset = 0;
                                                    for (l=0;l<max_ASV_iter;l++) {
                                                        if (ASV_switch_offset<0) break;
                                                        incremental_asv_target_offset=get_asv_target_iter_offset_before(k,j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k]),incremental_asv_target_offset,Search_Version);
                                                        if (ASV_switch_offset<0 || incremental_asv_target_offset<0) ASV_Search_Value=-2*MAX_ASV_SEARCH; else ASV_Search_Value = ASV_factor*Message_Details_Storage[j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])];
                                                        if (incremental_asv_target_offset<0) incremental_asv_target_offset+=9999999;
                                                        if (ASV_Search_Value>=0 && ASV_Clustered_inter>0) {
                                                            int clustered_iterations = (int)(ASV_Search_Value/ASV_factor);
                                                            for (m=0;m<clustered_iterations;m++) {
                                                                ASV_Search_Value = ASV_factor*Message_Details_Storage[j+ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])];
                                                                if (strstr(ASV_Name_Search_Buffer,"NC_CDDIFF")!=NULL && Message_Details_Storage[j+ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k-1])]!=0) continue;
                                                                if (strstr(ASV_Name_Search_Buffer,"NC_CDDIFF")!=NULL && Message_Details_Storage[j+ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k-1])]!=0 && Message_Details_Storage[Current_Details_Search_End_Position-version_detail_offset]>=32) continue;
                                                                if (strstr(ASV_Name_Search_Buffer,"NC_DIFF")!=NULL && Message_Details_Storage[j+ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k-1])]!=0) continue;
                                                                if (strstr(ASV_Name_Search_Buffer,"NC_CDDIFF")!=NULL && Message_Details_Storage[j+ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k-1])]==0 && Message_Details_Storage[Current_Details_Search_End_Position-version_detail_offset]>=32) continue;
                                                                ASV_Search_Value = roundf(ASV_Search_Value*1000)/1000;
                                                                if ((ASV_Search_Value <= ASV_search_value_max && ASV_Search_Value >= ASV_search_value_min))  {
                                                                    ASV_check=true;
                                                                    ASV_Search_Index = ASV_Clustered_inter+m*ASV_Clustered_offset+ASV_switch_offset+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                                    ASV_increment = 0;
                                                                    break;
                                                                }
                                                            }
                                                        } else {
                                                            ASV_Search_Value = roundf(ASV_Search_Value*1000)/1000;
                                                                if (strstr(ASV_Name_Search_Buffer,"NID_RADIO")!=NULL) {
                                                                    if (ASV_Value_Search_Buffer[0]=='\0') {
                                                                        ASV_check=true;
                                                                        ASV_Search_Index = ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k]);
                                                                        ASV_increment = 0;
                                                                        break;
                                                                    } else {
                                                                        unsigned long long nid_radio_search = 65536LLU*65536LLU*65536LLU*(unsigned long long)(Message_Details_Storage[j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])]);
                                                                        nid_radio_search += 65536LLU*65536LLU*(unsigned long long)(Message_Details_Storage[1+j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])]);
                                                                        nid_radio_search += 65536LLU*(unsigned long long)(Message_Details_Storage[2+j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])]);
                                                                        nid_radio_search += (unsigned long long)(Message_Details_Storage[3+j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])]);
                                                                        sprintf(Hexdec_Buffer,"+%I64x",nid_radio_search);
                                                                        for (m=0;m<strlen(Hexdec_Buffer);m++) {
                                                                            if (Hexdec_Buffer[m]=='f') {Hexdec_Buffer[m]='\0'; break;}
                                                                        }
                                                                        if (strstr(Hexdec_Buffer,ASV_Value_Search_Buffer)!=NULL) {
                                                                            ASV_check=true;
                                                                            ASV_Search_Index = 3+l;
                                                                            ASV_increment = 0;
                                                                            break;
                                                                        }
                                                                    }
                                                                } else if (ASV_Search_Value <= ASV_search_value_max && ASV_Search_Value >= ASV_search_value_min) {
                                                                ASV_check=true;
                                                                ASV_Search_Index = ASV_switch_offset+incremental_asv_target_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                                if (Message_Details_Storage[j]==-11 && ASV_Buffer[k*ASV_location_size]=='Q' && ASV_Search_Index>2 && Search_Version<32) ASV_Search_Index-=2;
                                                                ASV_increment = 0;
                                                                break;
                                                            }
                                                        }
                                                        incremental_asv_target_offset=get_asv_target_iter_offset_after(k,j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Iter_index+ASV_location_size*k])+l*atoi(&ASV_Buffer[ASVO_Iter_offset+ASV_location_size*k]),incremental_asv_target_offset,Search_Version);
                                                    }
                                                } else {
                                                    if (atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k])>0) {
                                                        if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='|') ASV_factor = pow(10,Message_Details_Storage[j+atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k])]-1);
                                                        else if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='/') ASV_factor = (float)(1.0/(float)atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k]));
                                                        else if (ASV_Buffer[ASVO_Factor+ASV_location_size*k-1]=='*') ASV_factor = atoi(&ASV_Buffer[ASVO_Factor+ASV_location_size*k]);
                                                    }
                                                    if (ASV_switch_offset<0) ASV_Search_Value=-2*MAX_ASV_SEARCH; else ASV_Search_Value = ASV_factor*Message_Details_Storage[j+ASV_switch_offset-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])];

                                                    if (strstr(ASV_Name_Search_Buffer,"DATA_TBL1+")!=NULL && strlen(ASV_Name_Search_Buffer)==10) {
                                                        if (strlen(ASV_Value_Search_Buffer)!=4) ASV_Search_Value = 0.1;
                                                        else {
                                                            ASV_search_value_max = hex2dec(ASV_Value_Search_Buffer);
                                                            ASV_search_value_min = ASV_search_value_max;
                                                        }
                                                    }

                                                    ASV_Search_Value = roundf(ASV_Search_Value*1000)/1000;
                                                    if (strstr(ASV_Name_Search_Buffer,"X_TEXT")!=NULL) {
                                                        if (strlen(ASV_Value_Search_Buffer)==0) ASV_check=true;
                                                        for (l=0;l<strlen(ASV_Value_Search_Buffer);l++) {
                                                            ASV_check=false;
                                                            ASV_Search_Value = Message_Details_Storage[j+l+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])];
                                                            if (ASV_Search_Value!=ASV_Value_Search_Buffer[l]) break;
                                                            ASV_check=true;
                                                        }
                                                        if (ASV_check) {
                                                            ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                            ASV_increment = 0;
                                                        }
                                                    } else if (strstr(ASV_Name_Search_Buffer,"NID_RADIO")!=NULL) {
                                                        if (ASV_Value_Search_Buffer[0]=='\0') {
                                                            ASV_check=true;
                                                            ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                            ASV_increment = 0;
                                                            break;
                                                        } else {
                                                            unsigned long long nid_radio_search = 65536LLU*65536LLU*65536LLU*(unsigned long long)(Message_Details_Storage[j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            nid_radio_search += 65536LLU*65536LLU*(unsigned long long)(Message_Details_Storage[1+j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            nid_radio_search += 65536LLU*(unsigned long long)(Message_Details_Storage[2+j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            nid_radio_search += (unsigned long long)(Message_Details_Storage[3+j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            sprintf(Hexdec_Buffer,"+%I64x",nid_radio_search);
                                                            for (l=0;l<strlen(Hexdec_Buffer);l++) {
                                                                if (Hexdec_Buffer[l]=='f') {Hexdec_Buffer[l]='\0'; break;}
                                                            }
                                                            if (strstr(Hexdec_Buffer,ASV_Value_Search_Buffer)!=NULL) {
                                                                ASV_check=true;
                                                                ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                                ASV_increment = 0;
                                                                break;
                                                            }
                                                        }
                                                    } else if (strstr(ASV_Name_Search_Buffer,"NID_OPERATIONAL")!=NULL) {
                                                        if (ASV_Value_Search_Buffer[0]=='\0') {
                                                            ASV_check=true;
                                                            ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                            ASV_increment = 0;
                                                            break;
                                                        } else {
                                                            unsigned long long nid_operationnal_search = 65536LLU*(unsigned long long)(Message_Details_Storage[j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            nid_operationnal_search += (unsigned long long)(Message_Details_Storage[1+j+ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])]);
                                                            sprintf(Hexdec_Buffer,"+%I64x",nid_operationnal_search);
                                                            for (l=0;l<strlen(Hexdec_Buffer);l++) {
                                                                if (Hexdec_Buffer[l]=='f') {Hexdec_Buffer[l]='\0'; break;}
                                                            }
                                                            if (strstr(Hexdec_Buffer,ASV_Value_Search_Buffer)!=NULL) {
                                                                ASV_check=true;
                                                                ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                                ASV_increment = 0;
                                                                break;
                                                            }
                                                        }
                                                    } else {
                                                        if (ASV_Search_Value<=ASV_search_value_max && ASV_Search_Value>=ASV_search_value_min) {
                                                            ASV_check=true;
                                                            ASV_Search_Index = ASV_switch_offset+atoi(&ASV_Buffer[ASVO_Main_offset+ASV_location_size*k])-atoi(&ASV_Buffer[ASVO_Final_offset+ASV_location_size*k])+atoi(&ASV_Buffer[ASVO_Final_offset+4+ASV_location_size*k]);
                                                            if (Message_Details_Storage[j]==-11 && ASV_Buffer[k*ASV_location_size]=='Q' && ASV_Search_Index>2 && Search_Version<32) ASV_Search_Index-=2;
                                                            if (Message_Details_Storage[j]==-133 && (strstr(ASV_Name_Search_Buffer,"NID_C")!=NULL || strstr(ASV_Name_Search_Buffer,"NID_BG")!=NULL || strstr(ASV_Name_Search_Buffer,"D_INFILL")!=NULL)) ASV_Search_Index-=3;
                                                            ASV_increment = 0;
                                                            break;
                                                        }
                                                    }
                                                }
                                            } else {
                                                ASV_check=false;
                                            }
                                        }
                                    }
                            }
                            if (Message_Details_Storage[j]<0) {
                                if ((!isBL3 || j>=Current_Details_Search_Position+3) && !Packet_Search_Check && Packet_Search_Buffer[0]!='\0' && ASV_Name_Search_Buffer=='\0') Search_Header++;
                                if (Message_Details_Storage[j]!=-5) start_searching_in_link=-1; else start_searching_in_link=j;
                            }
                            if (Message_Details_Storage[j]==-Packet_Search) {
                                Packet_Search_Check=true;
                                if (Linked_Balise_Search_Buffer[0]=='\0' && (ASV_Name_Search_Buffer[0]=='\0' || ASV_check)) break;
                            }
                            if (Packet_Search_Check && Linked_Balise_Search_Check && ASV_check) break;
                        }
                    }
                } else Packet_Search_Check = true;
                if (ASV_Name_Search_Buffer[0]=='\0') ASV_check=true;
                if (strstr(ASV_Name_Search_Buffer,"Q_SLEEPSESSION")!=NULL) ASV_Search_Index-=3;
                if ((Message_Details_Storage[Current_Details_Search_Position-mode_detail_offset])==6) initial_balise = -2;
                if (combinate_search_mode) {
                    Message_Search_Check = (Message_Search_Buffer[0]=='\0' || Id_Search==Search_Id);
                    Date_Search_Check = (Date_Search_Buffer[0]=='\0' || (Search_Day==Message_Details_Storage[Current_Details_Search_Position-day_detail_offset] && Search_Month==Message_Details_Storage[Current_Details_Search_Position-mon_detail_offset] && Search_Year==Message_Details_Storage[Current_Details_Search_Position-year_detail_offset]));
                    Train_Search_Check = (Train_Search_Buffer[0]=='\0' || Train_Search==Message_Details_Storage[Current_Details_Search_Position-train_detail_offset]);
                    Balise_Search_Check = (Balise_Search_Buffer[0]=='\0' || (Balise_Search==Message_Details_Storage[Current_Details_Search_Position+8] && 6==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset]));
                    Radio_Search_Check = (Radio_Search_Buffer[0]=='\0' || (Radio_Search==-Message_Details_Storage[Current_Details_Search_Position+(isBL3?2:0)] && (9==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset] || 10==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset])));
                    Speed_Search_Check = (Speed_Search_Buffer[0]=='\0' || Speed_Search<Message_Details_Storage[Current_Details_Search_Position-speed_detail_offset]);
                    Level_Search_Check = (Level_Search_Buffer[0]=='\0' || Level_Search==Message_Details_Storage[Current_Details_Search_Position-level_detail_offset]);
                    Mode_Search_Check = (Mode_Search_Buffer[0]=='\0' || Mode_Search==Message_Details_Storage[Current_Details_Search_Position-mode_detail_offset]);
                    Nid_c_Search_Check = (Nid_c_Search==-9999 || Nid_c_Search==Message_Details_Storage[Current_Details_Search_Position+7]);
                } else {
                    Message_Search_Check = (Id_Search==Search_Id);
                    Date_Search_Check = (Search_Day==Message_Details_Storage[Current_Details_Search_Position-day_detail_offset] && Search_Month==Message_Details_Storage[Current_Details_Search_Position-mon_detail_offset] && Search_Year==Message_Details_Storage[Current_Details_Search_Position-year_detail_offset]);
                    Train_Search_Check = (Train_Search==Message_Details_Storage[Current_Details_Search_Position-train_detail_offset]);
                    Balise_Search_Check = ((Balise_Search==Message_Details_Storage[Current_Details_Search_Position+8] && 6==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset]));
                    Radio_Search_Check = ((Radio_Search==-Message_Details_Storage[Current_Details_Search_Position+(isBL3?2:0)] && (9==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset] || 10==Message_Details_Storage[Current_Details_Search_Position-id_detail_offset])));
                    Speed_Search_Check = (Speed_Search<Message_Details_Storage[Current_Details_Search_Position-speed_detail_offset]);
                    Level_Search_Check = (Level_Search==Message_Details_Storage[Current_Details_Search_Position-level_detail_offset]);
                    Mode_Search_Check = (Mode_Search==Message_Details_Storage[Current_Details_Search_Position-mode_detail_offset]);
                    Nid_c_Search_Check = (Nid_c_Search==-9999 || Nid_c_Search==Message_Details_Storage[Current_Details_Search_Position+7]);
                    if (Message_Search_Buffer[0]=='\0') Message_Search_Check=false;
                    if (Date_Search_Buffer[0]=='\0') Date_Search_Check=false;
                    if (Train_Search_Buffer[0]=='\0') Train_Search_Check=false;
                    if (Balise_Search_Buffer[0]=='\0') Balise_Search_Check=false;
                    if (Radio_Search_Buffer[0]=='\0') Radio_Search_Check=false;
                    if (Speed_Search_Buffer[0]=='\0') Speed_Search_Check=false;
                    if (Level_Search_Buffer[0]=='\0') Level_Search_Check=false;
                    if (Mode_Search_Buffer[0]=='\0') Mode_Search_Check=false;
                    if (Packet_Search_Buffer[0]=='\0') Packet_Search_Check=false;
                    if (ASV_Value_Search_Buffer[0]=='\0') ASV_check=false;
                    if (Linked_Balise_Search_Buffer[0]=='\0') Linked_Balise_Search_Check=false;
                }
                if (((Current_Message.message!=SEARCH_RQST_MESSAGE && Message_Search_Check && Date_Search_Check && Train_Search_Check && Balise_Search_Check && Nid_c_Search_Check && Linked_Balise_Search_Check && ASV_check && Packet_Search_Check && Radio_Search_Check && Speed_Search_Check && Level_Search_Check && Mode_Search_Check) || (Current_Message.message==SEARCH_TRGR_MESSAGE && Balise_Search_Check && (Packet_Search_Buffer[0]=='\0' || Packet_Search_Check))) && combinate_search_mode) {
                    if (Search_Id!=6 && Search_Id!=9 && Search_Id!=10 && Search_Header!=0) Search_Header=0;
                    if ((Search_Id==9 || Search_Id==10) && ASV_Search_Index>4 && isBL3 && Search_Header==0) ASV_Search_Index--;
                    if ((Search_Id==9 || Search_Id==10) && ASV_Search_Index>2 && !isBL3 && Search_Header==0) ASV_Search_Index--;
                    SendMessage(MessageWindow,LB_SETCURSEL,Search_Message,0);
                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)Search_Header,-1);
                    if (Packet_Search_Buffer[0]!='\0' || ASV_Name_Search_Buffer[0]!='\0') {
                        PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,-1);
                    }
                    break;
                }
                if (((Current_Message.message!=SEARCH_RQST_MESSAGE && (Message_Search_Check || Date_Search_Check || Train_Search_Check || (Balise_Search_Check && Nid_c_Search_Check) || Linked_Balise_Search_Check || ASV_check || Packet_Search_Check || Radio_Search_Check || Speed_Search_Check || Level_Search_Check || Mode_Search_Check)) || (Current_Message.message==SEARCH_TRGR_MESSAGE && Balise_Search_Check && (Packet_Search_Buffer[0]=='\0' || Packet_Search_Check))) && !combinate_search_mode) {
                    if (Search_Id!=6 && Search_Id!=9 && Search_Id!=10 && Search_Header!=0) Search_Header=0;
                    if ((Search_Id==9 || Search_Id==10) && ASV_Search_Index>4 && isBL3 && Search_Header==0) ASV_Search_Index--;
                    if ((Search_Id==9 || Search_Id==10) && ASV_Search_Index>2 && !isBL3 && Search_Header==0) ASV_Search_Index--;
                    SendMessage(MessageWindow,LB_SETCURSEL,Search_Message,0);
                    PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,(WPARAM)Search_Header,-1);
                    if (Packet_Search_Buffer[0]!='\0' || ASV_Name_Search_Buffer[0]!='\0') {
                        PostMessage(HeadersWindow,SEL_CHANGE_MESSAGE,0,-1);
                    }
                    break;
                }

                Search_Progress = (100*i)/(Last_Message);
                SendMessage(SearchProgressWindow,PBM_SETPOS,Search_Progress,0);
            }
        ShowWindow(SearchProgressWindow, 0);
        continue;
        }
        if ((Current_Message.message==SEARCH_RQST_MESSAGE) || (Current_Message.message==WM_KEYDOWN && Current_Message.wParam==13 && Current_Window==SearchResetWindow) || (Current_Message.message==BTN_CLICKED_MESSAGE && Current_Message.wParam==(WPARAM)SearchResetWindow)) {
            SetWindowText(MessageSearchWindow,"");
            SetWindowText(DateSearchWindow,"");
            SetWindowText(TrainSearchWindow,"");
            SetWindowText(BaliseSearchWindow,"");
            SetWindowText(LinkedBaliseSearchWindow,"");
            SetWindowText(PacketSearchWindow,"");
            SetWindowText(RadioSearchWindow,"");
            SetWindowText(SpeedSearchWindow,"");
            SetWindowText(LevelSearchWindow,"");
            SetWindowText(ModeSearchWindow,"");
            SetWindowText(AdvancedSearchNameWindow,"");
            SetWindowText(AdvancedSearchValueWindow,"");
        }
        if (Current_Message.message==MAIN_QUIT_RQST) break;
        if (Current_Message.message==SEARCH_TRGR_MESSAGE) {
            SetWindowText(BaliseSearchWindow,"");
            SetWindowText(PacketSearchWindow,"");
            continue;
        }
        if (Current_Message.hwnd==SpeedProfileWindow && GetForegroundWindow()==MainWindow && (Current_Message.message==WM_LBUTTONDOWN || (IsWindowVisible(SpeedProfileWindow) && is_still_down>20))) {
            GetCursorPos(&pnt);
            if (pnt.y<(500*y_scale+MONITOR.top) && pnt.y>(50*y_scale+MONITOR.top)) {
                int x = pnt.x-(76*x_scale)-monitor_left-9;
                if (x>0 && x<1300*x_scale) {
                    SetFocus(Current_Message.hwnd);
                    if (is_still_down>20 && sdtrack_left != 0 && x<(630*x_scale)) x = 630*x_scale;
                    if (is_still_down>20 && sdtrack_right != Last_Message && x>(670*x_scale)) x = 670*x_scale;
                    unsigned long long cursor_dist = (unsigned long long)(x*SDTRACK_ZOOM/(1300*x_scale));
                    unsigned long long start_dist = (unsigned long long)(Distance_Storage[sdtrack_left]);
                    int running_dist;
                    for (running_dist=sdtrack_left;running_dist<=sdtrack_right;running_dist++) {
                        if (((Distance_Storage[running_dist]-start_dist)/3600)>cursor_dist) {
                            SendMessage(MessageWindow,LB_SETCURSEL,running_dist,0);
                            PostMessage(MessageWindow,SEL_CHANGE_MESSAGE,0,0);
                            RedrawWindow(SpeedProfileWindow,NULL,NULL,RDW_INVALIDATE|RDW_ERASENOW|RDW_UPDATENOW);
                            break;
                        }
                    }
                    continue;
                }
            }
        }

        TranslateMessage(&Current_Message);
        DispatchMessage(&Current_Message);
    }

    log_release();

    fclose(SETTINGS_FILE);

    free(Master_Bluffer);
    free(Message_Buffer);
    free(Current_Message_Buffer);
    free(Current_Search_Buffer);
    free(Current_Packet_Buffer);
    free(Path_Buffer);
    free(Remanent_Path_Buffer);
    free(Filename_Buffer);
    free(Hexdec_Buffer);
    free(DistanceWindow_Buffer);
    free(TimeWindow_Buffer);
    free(SpeedWindow_Buffer);
    free(Window_Buffer);
    free(Iterations_Buffer);
    free(Separator_Buffer);
    free(Error_Buffer);
    free(CSV_Command_Buffer);
    free(LBG_Command_Buffer);
    free(SL1_Command_Buffer);
    free(SL2_Command_Buffer);
    free(ASV_Buffer);
    free(Message_Search_Buffer);
    free(Date_Search_Buffer);
    free(Train_Search_Buffer);
    free(Balise_Search_Buffer);
    free(Linked_Balise_Search_Buffer);
    free(Packet_Search_Buffer);
    free(Radio_Search_Buffer);
    free(Speed_Search_Buffer);
    free(Level_Search_Buffer);
    free(Mode_Search_Buffer);
    free(Inter_Balise_Distance);
    free(ASV_Name_Search_Buffer);
    free(ASV_Value_Search_Buffer);
    free(mobile_buffer);
    free(username_buffer);
    free(command_buffer);
    free(current_file_buffer);

    DeleteObject(Gray_Brush);
    DeleteObject(Main_Brush);
    DeleteObject(Main_Font);
    DeleteObject(Purple_Brush);
    DeleteObject(Pink_Brush);
    DeleteObject(Lime_Brush);
    DeleteObject(Blue_Brush);
    DeleteObject(Cyan_Brush);
    DeleteObject(Green_Brush);
    DeleteObject(Red_Brush);
    DeleteObject(Black_Brush);
    DeleteObject(Azure_Brush);
    DeleteObject(Dark_Gray_Brush);
    DeleteObject(White_Brush);
    DeleteObject(Orange_Brush);
    DeleteObject(Peach_Brush);
    DeleteObject(NOMINAL_PEN);
    DeleteObject(ORANGE_PEN);
    DeleteObject(DOTTED_ORANGE_PEN);
    DeleteObject(CYAN_PEN);
    DeleteObject(GRAY_PEN);
    DeleteObject(NEW_BLACK_PEN);
    DeleteObject(PURPLE_PEN);
    DeleteObject(RED_PEN);
    DeleteObject(GREEN_PEN);

    return 0;
}
